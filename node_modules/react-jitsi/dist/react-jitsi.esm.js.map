{"version":3,"file":"react-jitsi.esm.js","sources":["../src/defaults.tsx","../src/utils.ts","../src/Jitsi.tsx"],"sourcesContent":["import React from 'react'\nimport * as Type from './types'\n\nexport const Loader = (): React.ReactElement => <div>Loading meeting...</div>\n\nexport const Props: Type.Props = {\n    domain: 'meet.jit.si',\n    roomName: (Math.random() + 0.48151642).toString(36).substring(2),\n}\n\nexport const ContainerStyle: React.CSSProperties = {\n    width: '800px',\n    height: '400px',\n}\n\nexport const FrameStyle = (loading: boolean): React.CSSProperties => ({\n    display: loading ? 'none' : 'block',\n    width: '100%',\n    height: '100%',\n})\n","export const importJitsiApi = (): Promise<void> => new Promise(async (resolve) => {\n    if(window.JitsiMeetExternalAPI) {\n        resolve(window.JitsiMeetExternalAPI)\n    } else {\n        const head = document.getElementsByTagName(\"head\")[0];\n        const script = document.createElement(\"script\"); \n\n        script.setAttribute(\"type\", \"text/javascript\");\n        script.setAttribute(\"src\", \"https://meet.jit.si/external_api.js\");\n\n        head.addEventListener(\"load\", function(event: any) {\n            if (event.target.nodeName === \"SCRIPT\") {\n                resolve(window.JitsiMeetExternalAPI)\n            }\n        }, true);\n\n        head.appendChild(script); \n    }\n})","import React, { useState, useEffect, useRef } from 'react'\nimport { Props, JitsiMeetAPIOptions } from './types'\nimport * as Default from './defaults'\nimport { importJitsiApi } from './utils'\n\nconst Jitsi: React.FC<Props> = (props: Props) => {\n    const {\n        containerStyle,\n        frameStyle,\n        loadingComponent,\n        onAPILoad,\n        onIframeLoad,\n        domain,\n        roomName,\n        password,\n        displayName,\n        config,\n        interfaceConfig,\n        noSSL,\n        jwt,\n        devices,\n        userInfo,\n    } = { ...Default.Props, ...props }\n\n    const [loading, setLoading] = useState(true)\n    const ref = useRef<HTMLDivElement | null>(null)\n\n    const Loader = loadingComponent || Default.Loader\n\n    const startConference = (JitsiMeetExternalAPI: any): void => {\n\n        try {\n\n            console.log('interfaceConfig', interfaceConfig);\n            \n\n            const options: JitsiMeetAPIOptions = {\n                roomName,\n                parentNode: ref.current,\n                configOverwrite: config,\n                interfaceConfigOverwrite: interfaceConfig,\n                noSSL,\n                jwt,\n                onLoad: onIframeLoad,\n                devices,\n                userInfo,\n            }\n\n            const api = new JitsiMeetExternalAPI(domain, options)\n\n            if (!api) throw new Error('Failed to create JitsiMeetExternalAPI istance')\n\n            if (onAPILoad) onAPILoad(api)\n\n            api.addEventListener('videoConferenceJoined', () => {\n\n                setLoading(false)\n\n                api.executeCommand('displayName', displayName)\n\n                if (domain === Default.Props.domain && password)\n                    api.executeCommand('password', password)\n\n            })\n\n            /** \n             * If we are on a self hosted Jitsi domain, we need to become moderators before setting a password\n             * Issue: https://community.jitsi.org/t/lock-failed-on-jitsimeetexternalapi/32060\n             */\n            api.addEventListener('participantRoleChanged', (e: { id: string; role: string }) => {\n\n                if (domain !== Default.Props.domain && password && e.role === 'moderator')\n                    api.executeCommand('password', password)\n\n            })\n\n        } catch (error) { console.error('Failed to start the conference', error) }\n\n    }\n\n    useEffect(() => { \n        importJitsiApi().then(jitsiApi => {\n            startConference(jitsiApi);\n        }).catch(err => {\n            console.error('Jitsi Meet API library not loaded.', err)\n        })\n    }, [])\n\n    return (\n        <div id='react-jitsi-container' style={{ ...Default.ContainerStyle, ...containerStyle }}>\n            {loading && <Loader />}\n            <div id='react-jitsi-frame' style={{ ...Default.FrameStyle(loading), ...frameStyle }} ref={ref} />\n        </div>\n    )\n}\n\nexport default Jitsi\n"],"names":["Loader","React","Props","domain","roomName","Math","random","toString","substring","ContainerStyle","width","height","FrameStyle","loading","display","importJitsiApi","Promise","resolve","window","JitsiMeetExternalAPI","head","document","getElementsByTagName","script","createElement","setAttribute","addEventListener","event","target","nodeName","appendChild","Jitsi","props","Default","containerStyle","frameStyle","loadingComponent","onAPILoad","onIframeLoad","password","displayName","config","interfaceConfig","noSSL","jwt","devices","userInfo","useState","setLoading","ref","useRef","startConference","console","log","options","parentNode","current","configOverwrite","interfaceConfigOverwrite","onLoad","api","Error","executeCommand","e","role","error","useEffect","then","jitsiApi","err","id","style"],"mappings":"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"}