{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/home/mfybaby/Documents/HealthStack2/HS-frontend/src/components/helpers/ClientSearch.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext, useEffect, useRef } from 'react'; //import {Route, Switch,  useRouteMatch, Link, NavLink, useHistory} from 'react-router-dom'\n\nimport client from '../../feathers';\nimport { DebounceInput } from 'react-debounce-input'; //import { useForm } from \"react-hook-form\";\n//import {useHistory} from 'react-router-dom'\n\nimport { UserContext, ObjectContext } from '../../context';\nimport { toast } from 'bulma-toast';\nimport { formatDistanceToNowStrict, format } from 'date-fns'; // eslint-disable-next-line\n//const searchfacility={};\n\nexport function ClientSearch(_ref) {\n  _s();\n\n  var _this = this;\n\n  var getSearchfacility = _ref.getSearchfacility,\n      clear = _ref.clear;\n  var ClientServ = client.service('client');\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      facilities = _useState2[0],\n      setFacilities = _useState2[1]; // eslint-disable-next-line\n\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      searchError = _useState4[0],\n      setSearchError = _useState4[1]; // eslint-disable-next-line\n\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      showPanel = _useState6[0],\n      setShowPanel = _useState6[1]; // eslint-disable-next-line\n\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      searchMessage = _useState8[0],\n      setSearchMessage = _useState8[1]; // eslint-disable-next-line \n\n\n  var _useState9 = useState(\"\"),\n      _useState10 = _slicedToArray(_useState9, 2),\n      simpa = _useState10[0],\n      setSimpa = _useState10[1]; // eslint-disable-next-line \n\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      chosen = _useState12[0],\n      setChosen = _useState12[1]; // eslint-disable-next-line \n\n\n  var _useState13 = useState(0),\n      _useState14 = _slicedToArray(_useState13, 2),\n      count = _useState14[0],\n      setCount = _useState14[1];\n\n  var inputEl = useRef(null);\n\n  var _useState15 = useState(\"\"),\n      _useState16 = _slicedToArray(_useState15, 2),\n      val = _useState16[0],\n      setVal = _useState16[1];\n\n  var _useContext = useContext(UserContext),\n      user = _useContext.user;\n\n  var _useContext2 = useContext(ObjectContext),\n      state = _useContext2.state;\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      productModal = _useState18[0],\n      setProductModal = _useState18[1];\n\n  var handleRow = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(obj) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return setChosen(true);\n\n            case 2:\n              //alert(\"something is chaning\")\n              getSearchfacility(obj);\n              _context.next = 5;\n              return setSimpa(obj.firstname + \" \" + obj.middlename + \" \" + obj.lastname + \" \" + obj.gender + \" \" + obj.phone);\n\n            case 5:\n              // setSelectedFacility(obj)\n              setShowPanel(false);\n              _context.next = 8;\n              return setCount(2);\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleRow(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleBlur = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleBlur(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var handleSearch = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(val) {\n      var field;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setVal(val);\n\n              if (!(val === \"\")) {\n                _context3.next = 5;\n                break;\n              }\n\n              setShowPanel(false);\n              getSearchfacility(false);\n              return _context3.abrupt(\"return\");\n\n            case 5:\n              field = 'name'; //field variable\n\n              if (!(val.length >= 3)) {\n                _context3.next = 10;\n                break;\n              }\n\n              ClientServ.find({\n                query: {\n                  $or: [{\n                    firstname: {\n                      $regex: val,\n                      $options: 'i'\n                    }\n                  }, {\n                    lastname: {\n                      $regex: val,\n                      $options: 'i'\n                    }\n                  }, {\n                    middlename: {\n                      $regex: val,\n                      $options: 'i'\n                    }\n                  }, {\n                    phone: {\n                      $regex: val,\n                      $options: 'i'\n                    }\n                  }, {\n                    clientTags: {\n                      $regex: val,\n                      $options: 'i'\n                    }\n                  }, {\n                    mrn: {\n                      $regex: val,\n                      $options: 'i'\n                    }\n                  }, {\n                    specificDetails: {\n                      $regex: val,\n                      $options: 'i'\n                    }\n                  }],\n                  facility: user.currentEmployee.facilityDetail._id,\n                  //storeId: state.StoreModule.selectedStore._id,\n                  $limit: 10,\n                  $sort: {\n                    createdAt: -1\n                  }\n                }\n              }).then(function (res) {\n                console.log(\"product  fetched successfully\");\n                console.log(res.data);\n                setFacilities(res.data);\n                setSearchMessage(\" product  fetched successfully\");\n                setShowPanel(true);\n              }).catch(function (err) {\n                toast({\n                  message: 'Error creating ProductEntry ' + err,\n                  type: 'is-danger',\n                  dismissible: true,\n                  pauseOnHover: true\n                });\n              });\n              _context3.next = 16;\n              break;\n\n            case 10:\n              console.log(\"less than 3 \");\n              console.log(val);\n              setShowPanel(false);\n              _context3.next = 15;\n              return setFacilities([]);\n\n            case 15:\n              console.log(facilities);\n\n            case 16:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleSearch(_x3) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var handleAddproduct = function handleAddproduct() {\n    setProductModal(true);\n  };\n\n  var handlecloseModal = function handlecloseModal() {\n    setProductModal(false);\n    handleSearch(val);\n  };\n\n  useEffect(function () {\n    if (clear) {\n      console.log(\"success has changed\", clear);\n      setSimpa(\"\");\n    }\n\n    return function () {};\n  }, [clear]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"control has-icons-left  \",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"dropdown \".concat(showPanel ? \"is-active\" : \"\"),\n          style: {\n            width: \"100%\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"dropdown-trigger\",\n            style: {\n              width: \"100%\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(DebounceInput, {\n              className: \"input is-small  is-expanded mb-0\",\n              type: \"text\",\n              placeholder: \"Search for Client\",\n              value: simpa,\n              minLength: 3,\n              debounceTimeout: 400,\n              onBlur: function onBlur(e) {\n                return handleBlur(e);\n              },\n              onChange: function onChange(e) {\n                return handleSearch(e.target.value);\n              },\n              inputRef: inputEl\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 168,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"icon is-small is-left\",\n              children: /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-search\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 178,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"dropdown-menu expanded\",\n            style: {\n              width: \"100%\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"dropdown-content\",\n              children: [facilities.length > 0 ? \"\" : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"dropdown-item selectadd\"\n                /* onClick={handleAddproduct} */\n                ,\n                children: [\" \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\" \", val, \" is not yet your client\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 183,\n                  columnNumber: 127\n                }, this), \" \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 183,\n                columnNumber: 52\n              }, this), facilities.map(function (facility, i) {\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"dropdown-item selectadd vht\",\n                  onClick: function onClick() {\n                    return handleRow(facility);\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      children: facility.firstname\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 189,\n                      columnNumber: 47\n                    }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"padleft\",\n                      children: facility.middlename\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 190,\n                      columnNumber: 41\n                    }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"padleft\",\n                      children: facility.lastname\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 191,\n                      columnNumber: 41\n                    }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"padleft\",\n                      children: [\" \", facility.dob && formatDistanceToNowStrict(new Date(facility.dob))]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 192,\n                      columnNumber: 41\n                    }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"padleft\",\n                      children: facility.gender\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 193,\n                      columnNumber: 41\n                    }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"padleft\",\n                      children: facility.profession\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 194,\n                      columnNumber: 41\n                    }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"padleft\",\n                      children: facility.phone\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 195,\n                      columnNumber: 41\n                    }, _this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 189,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 199,\n                    columnNumber: 41\n                  }, _this)]\n                }, facility._id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 187,\n                  columnNumber: 37\n                }, _this);\n              })]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal \".concat(productModal ? \"is-active\" : \"\"),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-background\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 37\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"header\", {\n          className: \"modal-card-head\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"modal-card-title\",\n            children: \"Choose Store\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 41\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"delete\",\n            \"aria-label\": \"close\",\n            onClick: handlecloseModal\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 41\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 41\n        }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n          className: \"modal-card-body\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 41\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 37\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 163,\n    columnNumber: 9\n  }, this);\n}\n\n_s(ClientSearch, \"t0O7bA3TZu/shxaYOPunHCyRtyY=\");\n\n_c = ClientSearch;\n\nvar _c;\n\n$RefreshReg$(_c, \"ClientSearch\");","map":{"version":3,"sources":["/home/mfybaby/Documents/HealthStack2/HS-frontend/src/components/helpers/ClientSearch.js"],"names":["React","useState","useContext","useEffect","useRef","client","DebounceInput","UserContext","ObjectContext","toast","formatDistanceToNowStrict","format","ClientSearch","getSearchfacility","clear","ClientServ","service","facilities","setFacilities","searchError","setSearchError","showPanel","setShowPanel","searchMessage","setSearchMessage","simpa","setSimpa","chosen","setChosen","count","setCount","inputEl","val","setVal","user","state","productModal","setProductModal","handleRow","obj","firstname","middlename","lastname","gender","phone","handleBlur","e","handleSearch","field","length","find","query","$or","$regex","$options","clientTags","mrn","specificDetails","facility","currentEmployee","facilityDetail","_id","$limit","$sort","createdAt","then","res","console","log","data","catch","err","message","type","dismissible","pauseOnHover","handleAddproduct","handlecloseModal","width","target","value","map","i","dob","Date","profession"],"mappings":"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","sourcesContent":["import React, {useState,useContext, useEffect,useRef} from 'react'\n//import {Route, Switch,  useRouteMatch, Link, NavLink, useHistory} from 'react-router-dom'\nimport client from '../../feathers'\nimport {DebounceInput} from 'react-debounce-input';\n//import { useForm } from \"react-hook-form\";\n//import {useHistory} from 'react-router-dom'\nimport {UserContext,ObjectContext} from '../../context'\nimport {toast} from 'bulma-toast'\nimport { formatDistanceToNowStrict, format } from 'date-fns'\n// eslint-disable-next-line\n//const searchfacility={};\n\n\nexport function ClientSearch({getSearchfacility,clear}) {\n    \n    const ClientServ=client.service('client')\n    const [facilities,setFacilities]=useState([])\n     // eslint-disable-next-line\n     const [searchError, setSearchError] =useState(false)\n     // eslint-disable-next-line\n    const [showPanel, setShowPanel] =useState(false)\n     // eslint-disable-next-line\n   const [searchMessage, setSearchMessage] = useState(\"\") \n   // eslint-disable-next-line \n   const [simpa,setSimpa]=useState(\"\")\n   // eslint-disable-next-line \n   const [chosen,setChosen]=useState(false)\n   // eslint-disable-next-line \n   const [count,setCount]=useState(0)\n   const inputEl=useRef(null)\n   const [val,setVal]=useState(\"\")\n   const {user} = useContext(UserContext) \n   const {state}=useContext(ObjectContext)\n    const [productModal,setProductModal]=useState(false)\n\n   const handleRow= async(obj)=>{\n        await setChosen(true)\n        //alert(\"something is chaning\")\n       getSearchfacility(obj)\n       \n       await setSimpa(obj.firstname + \" \"+ obj.middlename+ \" \"+obj.lastname + \" \"+obj.gender+\" \"+obj.phone )\n       \n        // setSelectedFacility(obj)\n        setShowPanel(false)\n        await setCount(2)\n        /* const    newfacilityModule={\n            selectedFacility:facility,\n            show :'detail'\n        }\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\n   //console.log(state)\n    }\n\n    const handleBlur=async(e)=>{\n       /*   if (count===2){\n             console.log(\"stuff was chosen\")\n         } */\n       \n       /*  console.log(\"blur\")\n         setShowPanel(false)\n        console.log(JSON.stringify(simpa))\n        if (simpa===\"\"){\n            console.log(facilities.length)\n            setSimpa(\"abc\")\n            setSimpa(\"\")\n            setFacilities([])\n            inputEl.current.setValue=\"\"\n        }\n        console.log(facilities.length)\n        console.log(inputEl.current) */\n    }\n    const handleSearch=async(val)=>{\n        setVal(val)\n        if (val===\"\"){\n            setShowPanel(false)\n            getSearchfacility(false)\n            return\n        }\n        const field='name' //field variable\n\n       \n        if (val.length>=3 ){\n            ClientServ.find({query: {\n                $or:[\n                    { firstname: {\n                        $regex:val,\n                        $options:'i' \n                    }},\n                    { lastname: {\n                        $regex:val,\n                        $options:'i' \n                    }},\n                    { middlename: {\n                        $regex:val,\n                        $options:'i' \n                    }},\n                    { phone: {\n                        $regex:val,\n                        $options:'i' \n                    }},\n                    { clientTags: {\n                        $regex:val,\n                        $options:'i' \n                    }},\n                    { mrn: {\n                        $regex:val,\n                        $options:'i' \n                    }},\n                    { specificDetails: {\n                        $regex:val,\n                        $options:'i' \n                    }},\n                ],\n              \n                 facility: user.currentEmployee.facilityDetail._id,\n                 //storeId: state.StoreModule.selectedStore._id,\n                 $limit:10,\n                 $sort: {\n                     createdAt: -1\n                   }\n                     }}).then((res)=>{\n              console.log(\"product  fetched successfully\") \n              console.log(res.data) \n                setFacilities(res.data)\n                 setSearchMessage(\" product  fetched successfully\")\n                 setShowPanel(true)\n             })\n             .catch((err)=>{\n                toast({\n                    message: 'Error creating ProductEntry ' + err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n             })\n         }\n        else{\n            console.log(\"less than 3 \")\n            console.log(val)\n            setShowPanel(false)\n            await setFacilities([])\n            console.log(facilities)\n        }\n    }\n\n    const handleAddproduct =()=>{\n        setProductModal(true) \n    }\n    const handlecloseModal =()=>{\n        setProductModal(false)\n        handleSearch(val)\n    }\n    useEffect(() => {\n       if (clear){\n           console.log(\"success has changed\",clear)\n           setSimpa(\"\")\n       }\n        return () => {\n            \n        }\n    }, [clear] )\n    return (\n        <div>\n            <div className=\"field\">\n                <div className=\"control has-icons-left  \">\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`} style={{width:\"100%\"}}>\n                        <div className=\"dropdown-trigger\" style={{width:\"100%\"}}>\n                            <DebounceInput className=\"input is-small  is-expanded mb-0\" \n                                type=\"text\" placeholder=\"Search for Client\"\n                                value={simpa}\n                                minLength={3}\n                                debounceTimeout={400}\n                                onBlur={(e)=>handleBlur(e)}\n                                onChange={(e)=>handleSearch(e.target.value)}\n                                inputRef={inputEl}\n                                  />\n                            <span className=\"icon is-small is-left\">\n                                <i className=\"fas fa-search\"></i>\n                            </span>\n                        </div>\n                        <div className=\"dropdown-menu expanded\" style={{width:\"100%\"}}>\n                            <div className=\"dropdown-content\">\n                          { facilities.length>0?\"\":<div className=\"dropdown-item selectadd\" /* onClick={handleAddproduct} */> <span> {val} is not yet your client</span> </div>}\n\n                              {facilities.map((facility, i)=>(\n                                    \n                                    <div className=\"dropdown-item selectadd vht\" key={facility._id} onClick={()=>handleRow(facility)}>\n                                        \n                                        <div ><span>{facility.firstname}</span>\n                                        <span className=\"padleft\">{facility.middlename}</span>\n                                        <span className=\"padleft\">{facility.lastname}</span>\n                                        <span className=\"padleft\"> {facility.dob && formatDistanceToNowStrict(new Date(facility.dob))}</span>\n                                        <span className=\"padleft\">{facility.gender}</span>\n                                        <span className=\"padleft\">{facility.profession}</span>\n                                        <span className=\"padleft\">{facility.phone}</span>\n                                        {/* <span className=\"padleft\">{facility.email}</span> */}\n                                        </div>\n                            \n                                        <br />\n                                    </div>\n                                    \n                                    ))}\n                                    \n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div className={`modal ${productModal?\"is-active\":\"\"}` }>\n                                    <div className=\"modal-background\"></div>\n                                    <div className=\"modal-card\">\n                                        <header className=\"modal-card-head\">\n                                        <p className=\"modal-card-title\">Choose Store</p>\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={handlecloseModal}></button>\n                                        </header>\n                                        <section className=\"modal-card-body\">\n                                        {/* <StoreList standalone=\"true\" /> */}\n                                        {/* <ProductCreate /> */}\n                                        </section>\n                                        {/* <footer className=\"modal-card-foot\">\n                                        <button className=\"button is-success\">Save changes</button>\n                                        <button className=\"button\">Cancel</button>\n                                        </footer> */}\n                                    </div>\n                                </div>       \n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}