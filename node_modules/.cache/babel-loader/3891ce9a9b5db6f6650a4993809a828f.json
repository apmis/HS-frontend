{"ast":null,"code":"import _defineProperty from \"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _objectSpread from \"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _regeneratorRuntime from \"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/home/mfybaby/Documents/HealthStack2/HS-frontend/src/components/Ward/DischargeCreate.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\n/* eslint-disable */\nimport React, { useState, useContext, useEffect, useRef } from 'react';\nimport client from '../../feathers';\nimport { DebounceInput } from 'react-debounce-input';\nimport { useForm } from \"react-hook-form\"; //import {useHistory} from 'react-router-dom'\n\nimport { UserContext, ObjectContext } from '../../context';\nimport { toast } from 'bulma-toast'; //import {ProductCreate} from './Products'\n\nimport Encounter from '../EncounterMgt/Encounter';\nimport ServiceSearch from '../helpers/ServiceSearch';\n\nvar random = require('random-string-generator'); // eslint-disable-next-line\n\n\nvar searchfacility = {};\nexport default function DischargeCreate() {\n  _s();\n\n  var _this = this;\n\n  // const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \n  //const [error, setError] =useState(false)\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      success = _useState2[0],\n      setSuccess = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      message = _useState4[0],\n      setMessage = _useState4[1]; // eslint-disable-next-line\n\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      facility = _useState6[0],\n      setFacility = _useState6[1];\n\n  var OrderServ = client.service('order');\n  var ClientServ = client.service('clinicaldocument');\n  var AdmissionServ = client.service('admission'); //const history = useHistory()\n\n  var _useContext = useContext(UserContext),\n      user = _useContext.user; //,setUser\n  // eslint-disable-next-line\n\n\n  var _useState7 = useState(),\n      _useState8 = _slicedToArray(_useState7, 2),\n      currentUser = _useState8[0],\n      setCurrentUser = _useState8[1];\n\n  var _useState9 = useState(\"Bill\"),\n      _useState10 = _slicedToArray(_useState9, 2),\n      type = _useState10[0],\n      setType = _useState10[1];\n\n  var _useState11 = useState(\"\"),\n      _useState12 = _slicedToArray(_useState11, 2),\n      documentNo = _useState12[0],\n      setDocumentNo = _useState12[1];\n\n  var _useState13 = useState(0),\n      _useState14 = _slicedToArray(_useState13, 2),\n      totalamount = _useState14[0],\n      setTotalamount = _useState14[1];\n\n  var _useState15 = useState(null),\n      _useState16 = _slicedToArray(_useState15, 2),\n      qamount = _useState16[0],\n      setQAmount = _useState16[1];\n\n  var _useState17 = useState(\"\"),\n      _useState18 = _slicedToArray(_useState17, 2),\n      productId = _useState18[0],\n      setProductId = _useState18[1];\n\n  var _useState19 = useState(\"\"),\n      _useState20 = _slicedToArray(_useState19, 2),\n      source = _useState20[0],\n      setSource = _useState20[1];\n\n  var _useState21 = useState(\"\"),\n      _useState22 = _slicedToArray(_useState21, 2),\n      date = _useState22[0],\n      setDate = _useState22[1];\n\n  var _useState23 = useState(\"\"),\n      _useState24 = _slicedToArray(_useState23, 2),\n      name = _useState24[0],\n      setName = _useState24[1];\n\n  var _useState25 = useState(\"\"),\n      _useState26 = _slicedToArray(_useState25, 2),\n      inventoryId = _useState26[0],\n      setInventoryId = _useState26[1];\n\n  var _useState27 = useState(\"\"),\n      _useState28 = _slicedToArray(_useState27, 2),\n      baseunit = _useState28[0],\n      setBaseunit = _useState28[1];\n\n  var _useState29 = useState(1),\n      _useState30 = _slicedToArray(_useState29, 2),\n      quantity = _useState30[0],\n      setQuantity = _useState30[1];\n\n  var _useState31 = useState(\"\"),\n      _useState32 = _slicedToArray(_useState31, 2),\n      sellingprice = _useState32[0],\n      setSellingPrice = _useState32[1];\n\n  var _useState33 = useState(0),\n      _useState34 = _slicedToArray(_useState33, 2),\n      costprice = _useState34[0],\n      setCostprice = _useState34[1];\n\n  var _useState35 = useState(\"\"),\n      _useState36 = _slicedToArray(_useState35, 2),\n      invquantity = _useState36[0],\n      setInvQuantity = _useState36[1];\n\n  var _useState37 = useState(0),\n      _useState38 = _slicedToArray(_useState37, 2),\n      calcamount = _useState38[0],\n      setCalcAmount = _useState38[1];\n\n  var _useState39 = useState([]),\n      _useState40 = _slicedToArray(_useState39, 2),\n      productItem = _useState40[0],\n      setProductItem = _useState40[1];\n\n  var _useState41 = useState(\"\"),\n      _useState42 = _slicedToArray(_useState41, 2),\n      billingId = _useState42[0],\n      setBilllingId = _useState42[1];\n\n  var _useState43 = useState(true),\n      _useState44 = _slicedToArray(_useState43, 2),\n      changeAmount = _useState44[0],\n      setChangeAmount = _useState44[1];\n\n  var _useState45 = useState(\"\"),\n      _useState46 = _slicedToArray(_useState45, 2),\n      paymentmode = _useState46[0],\n      setPaymentMode = _useState46[1];\n\n  var _useState47 = useState([]),\n      _useState48 = _slicedToArray(_useState47, 2),\n      paymentOptions = _useState48[0],\n      setPaymentOptions = _useState48[1];\n\n  var _useState49 = useState(\"\"),\n      _useState50 = _slicedToArray(_useState49, 2),\n      billMode = _useState50[0],\n      setBillMode = _useState50[1];\n\n  var _useState51 = useState(false),\n      _useState52 = _slicedToArray(_useState51, 2),\n      productModal = _useState52[0],\n      setProductModal = _useState52[1];\n\n  var _useState53 = useState(\"\"),\n      _useState54 = _slicedToArray(_useState53, 2),\n      obj = _useState54[0],\n      setObj = _useState54[1];\n\n  var _useState55 = useState(\"\"),\n      _useState56 = _slicedToArray(_useState55, 2),\n      objService = _useState56[0],\n      setObjService = _useState56[1];\n\n  var _useState57 = useState(\"\"),\n      _useState58 = _slicedToArray(_useState57, 2),\n      patient = _useState58[0],\n      setPatient = _useState58[1];\n\n  var _useState59 = useState(\"\"),\n      _useState60 = _slicedToArray(_useState59, 2),\n      contracts = _useState60[0],\n      setContracts = _useState60[1];\n\n  var _useState61 = useState(\"\"),\n      _useState62 = _slicedToArray(_useState61, 2),\n      category = _useState62[0],\n      setCategory = _useState62[1];\n\n  var _useState63 = useState(),\n      _useState64 = _slicedToArray(_useState63, 2),\n      chosenBed = _useState64[0],\n      setChosenBed = _useState64[1];\n\n  var _useState65 = useState(),\n      _useState66 = _slicedToArray(_useState65, 2),\n      bedObject = _useState66[0],\n      setBedObject = _useState66[1];\n\n  var _useContext2 = useContext(ObjectContext),\n      state = _useContext2.state,\n      setState = _useContext2.setState;\n\n  var inputEl = useRef(0);\n  var calcamount1;\n  var hidestatus;\n  var medication = state.DischargeModule.selectedDischarge;\n  /*  let physicalbeds=state.WardModule.selectedWard?.sublocations\n    console.log(medication) */\n\n  var showDocumentation = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setProductModal(true);\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function showDocumentation(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handlecloseModal = function handlecloseModal() {\n    setProductModal(false); // handleSearch(val)\n  };\n\n  var handleChangeMode = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(value) {\n      var billm;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return setPaymentMode(value);\n\n            case 2:\n              // console.log(paymentOptions)\n              billm = paymentOptions.filter(function (el) {\n                return el.name === value;\n              });\n              _context2.next = 5;\n              return setBillMode(billm[0]);\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleChangeMode(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleRow = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(ProductEntry) {\n      var newProductEntryModule;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              //console.log(\"b4\",state)\n              //console.log(\"handlerow\",ProductEntry)\n              //await setMedication(ProductEntry)\n              newProductEntryModule = {\n                selectedMedication: ProductEntry,\n                show: 'detail'\n              };\n              _context3.next = 3;\n              return setState(function (prevstate) {\n                return _objectSpread(_objectSpread({}, prevstate), {}, {\n                  medicationModule: newProductEntryModule\n                });\n              });\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleRow(_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var _useState67 = useState({\n    productitems: [],\n    date: date,\n    documentNo: documentNo,\n    type: type,\n    totalamount: totalamount,\n    source: source\n  }),\n      _useState68 = _slicedToArray(_useState67, 2),\n      productEntry = _useState68[0],\n      setProductEntry = _useState68[1];\n\n  var productItemI = {\n    productId: productId,\n    name: name,\n    quantity: quantity,\n    sellingprice: sellingprice,\n    amount: calcamount,\n    //||qamount\n    baseunit: baseunit,\n    costprice: costprice,\n    category: \"Prescription\",\n    //category===\"Inventory\"?\"Prescription\":category,\n    billingId: billingId,\n    billMode: billMode\n  };\n\n  var checkPrice = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(contracts, billMode) {\n      var contract, _contract, _contract2, _contract3;\n\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (!(billMode.type === \"HMO Cover\")) {\n                _context4.next = 22;\n                break;\n              }\n\n              if (!(billMode.detail.plan === \"NHIS\")) {\n                _context4.next = 13;\n                break;\n              }\n\n              //find contract for NHIS\n              contract = contracts.filter(function (el) {\n                return el.source_org_name === \"NHIS\";\n              });\n\n              if (!contract.length) {\n                _context4.next = 8;\n                break;\n              }\n\n              _context4.next = 6;\n              return setSellingPrice(contract[0].price);\n\n            case 6:\n              _context4.next = 11;\n              break;\n\n            case 8:\n              toast({\n                message: 'Please NHIS does not have cover/price for this service. Either set service price for NHIS, try another service or bill using cash',\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true\n              });\n              _context4.next = 11;\n              return setSellingPrice(0);\n\n            case 11:\n              _context4.next = 22;\n              break;\n\n            case 13:\n              _contract = contracts.filter(function (el) {\n                return el.source_org === billMode.detail.organizationId;\n              });\n\n              if (!_contract.length) {\n                _context4.next = 19;\n                break;\n              }\n\n              _context4.next = 17;\n              return setSellingPrice(_contract[0].price);\n\n            case 17:\n              _context4.next = 22;\n              break;\n\n            case 19:\n              toast({\n                message: 'Please HMO does not have cover/price for this service. Either set service price for HMO , try another drug, bill using cash or adjust amount ',\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true\n              });\n              _context4.next = 22;\n              return setSellingPrice(0);\n\n            case 22:\n              if (!(billMode.type === \"Company Cover\")) {\n                _context4.next = 32;\n                break;\n              }\n\n              //paymentmode\n              _contract2 = contracts.filter(function (el) {\n                return el.source_org === billMode.detail.organizationId;\n              });\n\n              if (!_contract2.length) {\n                _context4.next = 29;\n                break;\n              }\n\n              _context4.next = 27;\n              return setSellingPrice(_contract2[0].price);\n\n            case 27:\n              _context4.next = 32;\n              break;\n\n            case 29:\n              toast({\n                message: 'Please company does not have cover/price for this service. Either set service price for Company or try another drug or bill using cash',\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true\n              });\n              _context4.next = 32;\n              return setSellingPrice(0);\n\n            case 32:\n              if (!(billMode.type === \"Cash\" || billMode.type === \"Family Cover\")) {\n                _context4.next = 42;\n                break;\n              }\n\n              //paymentmode\n              _contract3 = contracts.filter(function (el) {\n                return el.source_org === el.dest_org;\n              });\n\n              if (!_contract3.length) {\n                _context4.next = 39;\n                break;\n              }\n\n              _context4.next = 37;\n              return setSellingPrice(_contract3[0].price);\n\n            case 37:\n              _context4.next = 42;\n              break;\n\n            case 39:\n              toast({\n                message: 'Please there is no cover/price for this service. Either set service price or try another service. Setting price at zero ',\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true\n              });\n              _context4.next = 42;\n              return setSellingPrice(0);\n\n            case 42:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function checkPrice(_x4, _x5) {\n      return _ref4.apply(this, arguments);\n    };\n  }(); // consider batchformat{batchno,expirydate,qtty,baseunit}\n  //consider baseunoit conversions\n\n\n  var getSearchfacility = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(service) {\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              if (service) {\n                _context5.next = 14;\n                break;\n              }\n\n              //\"clear stuff\"\n              setProductId(\"\");\n              setName(\"\");\n              setBaseunit(\"\");\n              setInventoryId(\"\");\n              setSellingPrice(0);\n              setInvQuantity(\"\");\n              setQAmount(null);\n              setCostprice(\"\");\n              setContracts(\"\");\n              setCategory(\"\");\n              setInventoryId(\"\");\n              setBilllingId(\"\"); // setCalcAmount(null)\n\n              return _context5.abrupt(\"return\");\n\n            case 14:\n              setContracts(service.contracts);\n              setProductId(service.productId);\n              setName(service.name);\n              setCategory(service.category); //Lab Order\n\n              setBaseunit(service.baseunit);\n              setInventoryId(service.inventoryId);\n              setBilllingId(service._id);\n              _context5.next = 23;\n              return setObj(service);\n\n            case 23:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function getSearchfacility(_x6) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {}, [obj]);\n  useEffect(function () {\n    setCurrentUser(user); //console.log(currentUser)\n\n    return function () {};\n  }, [user]);\n\n  var handleUpdateTotal = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return setTotalamount(function (prevtotal) {\n                return Number(prevtotal) + Number(calcamount);\n              });\n\n            case 2:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function handleUpdateTotal() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var handleChangeType = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(e) {\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return setType(e.target.value);\n\n            case 2:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n\n    return function handleChangeType(_x7) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  var handleAmount = /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n      return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return setQAmount(null);\n\n            case 2:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n\n    return function handleAmount() {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  var handleClickProd = /*#__PURE__*/function () {\n    var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n      var billInfo;\n      return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              if (!(quantity === 0 || quantity === \"\" || productId === \"\" || paymentmode === \"\")) {\n                _context9.next = 3;\n                break;\n              }\n\n              toast({\n                message: 'You need to choose a product and quantity to proceed',\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true\n              });\n              return _context9.abrupt(\"return\");\n\n            case 3:\n              _context9.next = 5;\n              return setSuccess(false);\n\n            case 5:\n              _context9.next = 7;\n              return setProductItem(function (prevProd) {\n                return prevProd.concat(productItemI);\n              });\n\n            case 7:\n              handleUpdateTotal(); // generate billing info\n\n              billInfo = {\n                orderInfo: {\n                  orderId: medication._id,\n                  orderObj: medication\n                },\n                serviceInfo: {\n                  price: productItemI.sellingprice,\n                  quantity: productItemI.quantity,\n                  productId: productItemI.productId,\n                  name: productItemI.name,\n                  baseunit: productItemI.baseunit,\n                  amount: productItemI.amount,\n                  billingId: productItemI.billingId,\n                  createdby: user._id\n                },\n                paymentInfo: {\n                  amountDue: productItemI.amount,\n                  paidup: 0,\n                  balance: productItemI.amount,\n                  paymentDetails: []\n                },\n                participantInfo: {\n                  billingFacility: medication.destination,\n                  billingFacilityName: medication.destination_name,\n                  locationId: state.StoreModule.selectedStore._id,\n                  //selected location,\n                  clientId: medication.clientId,\n                  client: medication.client,\n                  paymentmode: billMode\n                },\n                createdBy: user.id,\n                billing_status: \"Unpaid\"\n              }; //update order\n\n              OrderServ.patch(medication._id, {\n                order_status: \"Billed\",\n                //Billed\n                billInfo: billInfo\n              }).then(function (resp) {\n                // medication=resp\n                // console.log(resp)\n                handleRow(resp); //update dispense\n              }).catch(function (err) {\n                console.log(err);\n              }); //update status(billed) + action()\n              //?attached chosen product to medication\n              //dispense helper?\n\n              setName(\"\");\n              setBaseunit(\"\");\n              setQuantity(\"\");\n              setInventoryId(\"\");\n              setSellingPrice(\"\");\n              setInvQuantity(\"\");\n              handleAmount(); // setCalcAmount(null)\n\n              _context9.next = 19;\n              return setSuccess(true);\n\n            case 19:\n              getSearchfacility(false);\n              setObj(\"\");\n              /* console.log(success)\n              console.log(qamount)\n              console.log(productItem) */\n\n              setChangeAmount(true);\n\n            case 22:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee9);\n    }));\n\n    return function handleClickProd() {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n\n  var handleQtty = /*#__PURE__*/function () {\n    var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10(e) {\n      return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              /*  if (invquantity<e.target.value){\n                   toast({\n                       message: 'You can not sell more quantity than exist in inventory ' ,\n                       type: 'is-danger',\n                       dismissible: true,\n                       pauseOnHover: true,\n                     })\n                   return\n               } */\n              setQuantity(e.target.value);\n\n              if (e.target.vlue === \"\") {\n                setQuantity(1);\n              }\n              /*  calcamount1=quantity*sellingprice\n               await setCalcAmount(calcamount1) */\n              //console.log(calcamount)\n\n\n            case 2:\n            case \"end\":\n              return _context10.stop();\n          }\n        }\n      }, _callee10);\n    }));\n\n    return function handleQtty(_x8) {\n      return _ref10.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    setProductEntry({\n      date: date,\n      documentNo: documentNo,\n      type: type,\n      totalamount: totalamount,\n      source: source\n    });\n    setCalcAmount(quantity * sellingprice);\n    return function () {};\n  }, [date]);\n\n  var resetform = function resetform() {\n    setType(\"Sales\");\n    setDocumentNo(\"\");\n    setTotalamount(\"\");\n    setProductId(\"\");\n    setSource(\"\");\n    setDate(\"\");\n    setName(\"\");\n    setBaseunit();\n    setCostprice();\n    setProductItem([]);\n  };\n\n  var handleDischarge = /*#__PURE__*/function () {\n    var _ref11 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee12(e) {\n      var note, document, admission;\n      return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n        while (1) {\n          switch (_context12.prev = _context12.next) {\n            case 0:\n              //handle admit\n              //alert(\"something\")\n              //update order\n              //create admission resource\n              //?create bill?\n              note = {\n                Note: \"Patient was discharged from \" + medication.client.ward + \" \" + state.employeeLocation.locationType + \", bed:\" + medication.client.bed + \" at \" + Date().toLocaleString(),\n                Instruction: medication.instruction\n              }; //console.log(note)\n\n              document = {}; // data.createdby=user._id\n              // console.log(data);\n\n              if (user.currentEmployee) {\n                document.facility = user.currentEmployee.facilityDetail._id;\n                document.facilityname = user.currentEmployee.facilityDetail.facilityName; // or from facility dropdown\n              }\n\n              document.documentdetail = note;\n              console.log(document.documentdetail);\n              document.documentname = \"Discharge\"; //state.DocumentClassModule.selectedDocumentClass.name\n              // document.documentClassId=state.DocumentClassModule.selectedDocumentClass._id\n\n              document.location = state.employeeLocation.locationName + \" \" + state.employeeLocation.locationType;\n              document.locationId = state.employeeLocation.locationId;\n              document.client = medication.client._id;\n              document.clientname = medication.client.firstname + \" \" + medication.client.middlename + \" \" + medication.client.lastname;\n              document.clientobj = medication.client;\n              document.createdBy = user._id;\n              document.createdByname = user.firstname + \" \" + user.lastname;\n              document.status = \"completed\";\n              admission = {\n                //  encounter_id:{type: Schema.Types.ObjectId,},\n                //  hospitalization_id:{type: Schema.Types.ObjectId,},\n                //order\n                order: medication,\n                order_id: medication._id,\n                //location: ward/bed\n                ward_name: state.WardModule.selectedWard.typeName,\n                ward_id: state.WardModule.selectedWard._id,\n                bed: medication.client.bed,\n                bed_id: medication.client.bed_id,\n                facility: user.currentEmployee.facilityDetail._id,\n                //billing:perpertuity\n\n                /* bill:{type:Schema.Types.Mixed},\n                bill_id:{type: Schema.Types.ObjectId,}, */\n                //status\n                status: \"free\",\n                //client\n                client: medication.client,\n                client_id: medication.clientId,\n                //careteam\n                admissionhx: [],\n                careteam: [],\n                //start_time: new Date(),\n                end_time: new Date(),\n                createdby: user._id\n              };\n              document.admission = admission;\n              console.log(document);\n              e.preventDefault();\n              setMessage(\"\"); //  setError(false)\n\n              setSuccess(false); // data.createdby=user._id\n              // console.log(data);\n\n              /*   if (user.currentEmployee){\n               data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\n                } */\n              // data.locationType=\"Front Desk\"\n\n              ClientServ.create(document).then( /*#__PURE__*/function () {\n                var _ref12 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11(res) {\n                  var newProductEntryModule;\n                  return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n                    while (1) {\n                      switch (_context11.prev = _context11.next) {\n                        case 0:\n                          //console.log(JSON.stringify(res))\n                          // e.target.reset();\n\n                          /*  setMessage(\"Created Clinic successfully\") */\n                          setSuccess(true);\n                          toast({\n                            message: 'Discharge successfull',\n                            type: 'is-success',\n                            dismissible: true,\n                            pauseOnHover: true\n                          });\n                          setSuccess(false);\n                          setChosenBed();\n                          setBedObject();\n                          newProductEntryModule = {\n                            selectedDischarge: {},\n                            show: ''\n                          };\n                          _context11.next = 8;\n                          return setState(function (prevstate) {\n                            return _objectSpread(_objectSpread({}, prevstate), {}, {\n                              DischargeModule: newProductEntryModule\n                            });\n                          });\n\n                        case 8:\n                          medication = \"\";\n\n                        case 9:\n                        case \"end\":\n                          return _context11.stop();\n                      }\n                    }\n                  }, _callee11);\n                }));\n\n                return function (_x10) {\n                  return _ref12.apply(this, arguments);\n                };\n              }()).catch(function (err) {\n                toast({\n                  message: 'Error creating Discharge ' + err,\n                  type: 'is-danger',\n                  dismissible: true,\n                  pauseOnHover: true\n                });\n              });\n\n            case 21:\n            case \"end\":\n              return _context12.stop();\n          }\n        }\n      }, _callee12);\n    }));\n\n    return function handleDischarge(_x9) {\n      return _ref11.apply(this, arguments);\n    };\n  }();\n\n  var handleBed = function handleBed(e) {\n    //console.log(JSON.parse(e.target.value))\n    setChosenBed(e.target.value);\n    var simpa = physicalbeds.find(function (obj) {\n      return obj._id === e.target.value;\n    });\n    setBedObject(simpa);\n  };\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref13 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee13(e) {\n      return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n        while (1) {\n          switch (_context13.prev = _context13.next) {\n            case 0:\n              e.preventDefault();\n              setMessage(\"\"); //setError(false)\n\n              setSuccess(false);\n              _context13.next = 5;\n              return setProductEntry({\n                date: date,\n                documentNo: documentNo,\n                type: type,\n                totalamount: totalamount,\n                source: source\n              });\n\n            case 5:\n              productEntry.productitems = productItem;\n              productEntry.createdby = user._id;\n              productEntry.transactioncategory = \"debit\";\n\n              if (!user.currentEmployee) {\n                _context13.next = 12;\n                break;\n              }\n\n              productEntry.facility = user.currentEmployee.facilityDetail._id; // or from facility dropdown\n\n              _context13.next = 14;\n              break;\n\n            case 12:\n              toast({\n                message: 'You can not remove inventory from any organization',\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true\n              });\n              return _context13.abrupt(\"return\");\n\n            case 14:\n              if (!state.StoreModule.selectedStore._id) {\n                _context13.next = 18;\n                break;\n              }\n\n              productEntry.storeId = state.StoreModule.selectedStore._id;\n              _context13.next = 20;\n              break;\n\n            case 18:\n              toast({\n                message: 'You need to select a store before removing inventory',\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true\n              });\n              return _context13.abrupt(\"return\");\n\n            case 20:\n            case \"end\":\n              return _context13.stop();\n          }\n        }\n      }, _callee13);\n    }));\n\n    return function onSubmit(_x11) {\n      return _ref13.apply(this, arguments);\n    };\n  }();\n\n  var handleChangeAmount = function handleChangeAmount() {\n    setChangeAmount(function (rev) {\n      return !rev;\n    });\n  };\n\n  var newclient = /*#__PURE__*/function () {\n    var _ref14 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee14() {\n      return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n        while (1) {\n          switch (_context14.prev = _context14.next) {\n            case 0:\n              _context14.next = 2;\n              return setProductItem([]);\n\n            case 2:\n            case \"end\":\n              return _context14.stop();\n          }\n        }\n      }, _callee14);\n    }));\n\n    return function newclient() {\n      return _ref14.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    setPatient(medication.client);\n    var oldname = medication.clientname; // console.log(\"oldname\",oldname)\n\n    setSource(medication.clientname);\n    var newname = source; // console.log(\"newname\",newname)\n\n    if (oldname !== newname) {\n      //newclient\n      //recalculate bedspace: subtract occupied from physical space\n      setProductItem([]);\n      setTotalamount(0);\n    }\n\n    return function () {};\n  }, [medication]);\n  useEffect(function () {\n    //setPatient(medication.client)\n    setProductItem([]);\n    setTotalamount(0);\n    var paymentoptions = []; // const info = client.paymentinfo\n\n    var billme;\n    var obj;\n    patient && patient.paymentinfo.forEach(function (pay, i) {\n      if (pay.active) {\n        switch (pay.paymentmode) {\n          case 'Cash':\n            // code block\n            obj = createObj(pay, \"Cash\", \"Cash\", \"Cash\");\n            paymentoptions.push(obj);\n            setPaymentMode(\"Cash\");\n            billme = obj; // console.log(\"billme\",billme)\n\n            break;\n\n          case 'Family':\n            // code block\n            obj = createObj(pay, \"Family Cover\", \"familyCover\", \"Family Cover\");\n            paymentoptions.push(obj);\n            setPaymentMode(\"Family Cover\");\n            billme = obj; // console.log(\"billme\",billme)\n\n            break;\n\n          case 'Company':\n            // code block\n            var _name = \"Company: \" + pay.organizationName + \"(\" + pay.plan + \")\";\n\n            obj = createObj(pay, _name, \"CompanyCover\", \"Company Cover\");\n            paymentoptions.push(obj);\n            setPaymentMode(\"Company: \" + pay.organizationName + \"(\" + pay.plan + \")\");\n            billme = obj; // console.log(\"billme\",billme)\n\n            break;\n\n          case 'HMO':\n            // code block\n            var sname = \"HMO: \" + pay.organizationName + \"(\" + pay.plan + \")\";\n            obj = createObj(pay, sname, \"HMOCover\", \"HMO Cover\");\n            paymentoptions.push(obj);\n            setPaymentMode(\"HMO: \" + pay.organizationName + \"(\" + pay.plan + \")\");\n            billme = obj; //  console.log(\"billme\",billme)\n\n            break;\n\n          default: // code block\n\n        }\n      }\n    });\n    setPaymentOptions(paymentoptions);\n    setBillMode(billme); //console.log(paymentoptions)\n    // console.log(billMode)\n\n    return function () {};\n  }, [source]); //source\n\n  var findadmission = /*#__PURE__*/function () {\n    var _ref15 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee15() {\n      var admissiont;\n      return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n        while (1) {\n          switch (_context15.prev = _context15.next) {\n            case 0:\n              _context15.next = 2;\n              return AdmissionServ.find({\n                query: {\n                  order_id: medication._id\n                }\n              }).then(function (res) {\n                //  console.log(\"product  fetched successfully\") \n                //  console.log(res.data) \n                setChosenBed(res.data);\n                console.log(res.data);\n              }).catch(function (err) {\n                toast({\n                  message: 'Error creating ProductEntry ' + err,\n                  type: 'is-danger',\n                  dismissible: true,\n                  pauseOnHover: true\n                });\n              });\n\n            case 2:\n              admissiont = _context15.sent;\n              console.log(admissiont); // setChosenBed(admissiont)\n\n            case 4:\n            case \"end\":\n              return _context15.stop();\n          }\n        }\n      }, _callee15);\n    }));\n\n    return function findadmission() {\n      return _ref15.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    //get the admission info for the discharge order\n    var ward = state.WardModule.selectedWard;\n    return function () {};\n  }, []);\n  useEffect(function () {\n    // console.log(\"success\", success)\n    if (success) {\n      setSuccess(false);\n    }\n  }, [success]);\n\n  var createObj = function createObj(pay, name, cover, type) {\n    var details = {};\n    details = _objectSpread({}, pay);\n    details.type = type;\n    return {\n      name: name,\n      value: cover,\n      detail: details,\n      type: type\n    };\n  };\n\n  useEffect(function () {\n    //update selling price\n    if (!!billMode && !!contracts) {\n      // console.log(contracts)\n      checkPrice(contracts, billMode);\n    }\n\n    return function () {};\n  }, [obj]);\n  useEffect(function () {\n    calcamount1 = quantity * sellingprice;\n    setCalcAmount(calcamount1); // console.log(calcamount)\n\n    setChangeAmount(true);\n    return function () {};\n  }, [quantity, sellingprice]);\n  useEffect(function () {\n    if (!!billMode && !!contracts) {\n      checkPrice(contracts, billMode);\n    }\n\n    return function () {};\n  }, [billMode]); // console.log(\"simpa\")\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card card-overflow\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"card-header-title\",\n          children: \"Discharge Patient\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 778,\n          columnNumber: 18\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button is-success is-small btnheight mt-2\",\n          onClick: showDocumentation,\n          children: \"Documentation\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 781,\n          columnNumber: 18\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 777,\n        columnNumber: 14\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-content \",\n        children: [/*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: onSubmit,\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"field is-horizontal\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"field-body\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"field\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"control has-icons-left has-icons-right\",\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    className: \"input is-small\"\n                    /* ref={register({ required: true })} */\n                    ,\n                    value: source,\n                    name: \"client\",\n                    type: \"text\",\n                    onChange: function onChange(e) {\n                      return setSource(e.target.value);\n                    },\n                    placeholder: \"Client\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 804,\n                    columnNumber: 26\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"icon is-small is-left\",\n                    children: /*#__PURE__*/_jsxDEV(\"i\", {\n                      className: \"fas fa-hospital\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 806,\n                      columnNumber: 30\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 805,\n                    columnNumber: 26\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 803,\n                  columnNumber: 22\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 802,\n                columnNumber: 14\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"field\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"control\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"select is-small \",\n                    children: /*#__PURE__*/_jsxDEV(\"select\", {\n                      name: \"paymentmode\",\n                      value: paymentmode,\n                      onChange: function onChange(e) {\n                        return handleChangeMode(e.target.value);\n                      },\n                      className: \"selectadd\",\n                      children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                        value: \"\",\n                        children: \"Billing Mode \"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 814,\n                        columnNumber: 26\n                      }, this), paymentOptions.map(function (option, i) {\n                        return /*#__PURE__*/_jsxDEV(\"option\", {\n                          value: option.details,\n                          children: [\" \", option.name]\n                        }, i, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 816,\n                          columnNumber: 32\n                        }, _this);\n                      })]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 813,\n                      columnNumber: 26\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 812,\n                    columnNumber: 22\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 811,\n                  columnNumber: 18\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 810,\n                columnNumber: 18\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 787,\n              columnNumber: 14\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 786,\n            columnNumber: 14\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 785,\n          columnNumber: 14\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"label is-small\",\n          children: \"Discharge Order:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 837,\n          columnNumber: 10\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"field is-horizontal\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"field-body\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"field\",\n              style: {\n                width: \"40%\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"control has-icons-left\",\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  className: \"input is-small\"\n                  /* ref={register({ required: true })} */\n                  ,\n                  disabled: true,\n                  name: \"order\",\n                  value: medication.order,\n                  type: \"text\",\n                  onChange: function onChange(e) {\n                    return handleQtty(e);\n                  },\n                  placeholder: \"Quantity\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 842,\n                  columnNumber: 22\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 841,\n                columnNumber: 18\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"helper is-size-7\",\n                children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Instructions: \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 847,\n                  columnNumber: 53\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 847,\n                columnNumber: 18\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: medication.instruction\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 848,\n                columnNumber: 18\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 840,\n              columnNumber: 14\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 839,\n            columnNumber: 14\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 838,\n          columnNumber: 10\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"label is-small\",\n          children: [\"Current Bed: \", medication.client.bed]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 856,\n          columnNumber: 14\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"field mt-2 is-grouped\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"control\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"button is-success is-small\"\n                /* disabled={!productItem.length>0} */\n                ,\n                onClick: handleDischarge,\n                children: \"Discharge\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 877,\n                columnNumber: 22\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 876,\n              columnNumber: 18\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 875,\n            columnNumber: 18\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 872,\n          columnNumber: 10\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 783,\n        columnNumber: 14\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 776,\n      columnNumber: 14\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal \".concat(productModal ? \"is-active\" : \"\"),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-background\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 895,\n        columnNumber: 37\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-card  modalbkgrnd\",\n        children: [/*#__PURE__*/_jsxDEV(\"header\", {\n          className: \"modal-card-head  btnheight\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"modal-card-title\",\n            children: \"Documentation\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 898,\n            columnNumber: 41\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"delete\",\n            \"aria-label\": \"close\",\n            onClick: handlecloseModal\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 899,\n            columnNumber: 41\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 897,\n          columnNumber: 41\n        }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n          className: \"modal-card-body modalcolor\",\n          children: /*#__PURE__*/_jsxDEV(Encounter, {\n            standalone: \"true\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 903,\n            columnNumber: 42\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 901,\n          columnNumber: 41\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 896,\n        columnNumber: 37\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 894,\n      columnNumber: 14\n    }, this)]\n  }, void 0, true);\n}\n\n_s(DischargeCreate, \"2wEUZ1o8icZNK2lQeiH8EOANyN4=\");\n\n_c = DischargeCreate;\nexport function InventorySearch(_ref16) {\n  _s2();\n\n  var _this2 = this;\n\n  var getSearchfacility = _ref16.getSearchfacility,\n      clear = _ref16.clear;\n  var productServ = client.service('inventory');\n\n  var _useState69 = useState([]),\n      _useState70 = _slicedToArray(_useState69, 2),\n      facilities = _useState70[0],\n      setFacilities = _useState70[1]; // eslint-disable-next-line\n\n\n  var _useState71 = useState(false),\n      _useState72 = _slicedToArray(_useState71, 2),\n      searchError = _useState72[0],\n      setSearchError = _useState72[1]; // eslint-disable-next-line\n\n\n  var _useState73 = useState(false),\n      _useState74 = _slicedToArray(_useState73, 2),\n      showPanel = _useState74[0],\n      setShowPanel = _useState74[1]; // eslint-disable-next-line\n\n\n  var _useState75 = useState(\"\"),\n      _useState76 = _slicedToArray(_useState75, 2),\n      searchMessage = _useState76[0],\n      setSearchMessage = _useState76[1]; // eslint-disable-next-line \n\n\n  var _useState77 = useState(\"\"),\n      _useState78 = _slicedToArray(_useState77, 2),\n      simpa = _useState78[0],\n      setSimpa = _useState78[1]; // eslint-disable-next-line \n\n\n  var _useState79 = useState(false),\n      _useState80 = _slicedToArray(_useState79, 2),\n      chosen = _useState80[0],\n      setChosen = _useState80[1]; // eslint-disable-next-line \n\n\n  var _useState81 = useState(0),\n      _useState82 = _slicedToArray(_useState81, 2),\n      count = _useState82[0],\n      setCount = _useState82[1];\n\n  var inputEl = useRef(null);\n\n  var _useState83 = useState(\"\"),\n      _useState84 = _slicedToArray(_useState83, 2),\n      val = _useState84[0],\n      setVal = _useState84[1];\n\n  var _useContext3 = useContext(UserContext),\n      user = _useContext3.user;\n\n  var _useContext4 = useContext(ObjectContext),\n      state = _useContext4.state;\n\n  var _useState85 = useState(false),\n      _useState86 = _slicedToArray(_useState85, 2),\n      productModal = _useState86[0],\n      setProductModal = _useState86[1];\n\n  var handleRow = /*#__PURE__*/function () {\n    var _ref17 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee16(obj) {\n      return _regeneratorRuntime.wrap(function _callee16$(_context16) {\n        while (1) {\n          switch (_context16.prev = _context16.next) {\n            case 0:\n              _context16.next = 2;\n              return setChosen(true);\n\n            case 2:\n              //alert(\"something is chaning\")\n              getSearchfacility(obj);\n              _context16.next = 5;\n              return setSimpa(obj.name);\n\n            case 5:\n              // setSelectedFacility(obj)\n              setShowPanel(false);\n              _context16.next = 8;\n              return setCount(2);\n\n            case 8:\n            case \"end\":\n              return _context16.stop();\n          }\n        }\n      }, _callee16);\n    }));\n\n    return function handleRow(_x12) {\n      return _ref17.apply(this, arguments);\n    };\n  }();\n\n  var handleBlur = /*#__PURE__*/function () {\n    var _ref18 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee17(e) {\n      return _regeneratorRuntime.wrap(function _callee17$(_context17) {\n        while (1) {\n          switch (_context17.prev = _context17.next) {\n            case 0:\n            case \"end\":\n              return _context17.stop();\n          }\n        }\n      }, _callee17);\n    }));\n\n    return function handleBlur(_x13) {\n      return _ref18.apply(this, arguments);\n    };\n  }();\n\n  var handleSearch = /*#__PURE__*/function () {\n    var _ref19 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee18(value) {\n      var field, _query;\n\n      return _regeneratorRuntime.wrap(function _callee18$(_context18) {\n        while (1) {\n          switch (_context18.prev = _context18.next) {\n            case 0:\n              setVal(value);\n\n              if (!(value === \"\")) {\n                _context18.next = 5;\n                break;\n              }\n\n              setShowPanel(false);\n              getSearchfacility(false);\n              return _context18.abrupt(\"return\");\n\n            case 5:\n              field = 'name'; //field variable\n\n              if (!(value.length >= 3)) {\n                _context18.next = 10;\n                break;\n              }\n\n              productServ.find({\n                query: (_query = {}, _defineProperty(_query, field, {\n                  $regex: value,\n                  $options: 'i'\n                }), _defineProperty(_query, \"facility\", user.currentEmployee.facilityDetail._id), _defineProperty(_query, \"storeId\", state.StoreModule.selectedStore._id), _defineProperty(_query, \"$limit\", 10), _defineProperty(_query, \"$sort\", {\n                  createdAt: -1\n                }), _query)\n              }).then(function (res) {\n                //  console.log(\"product  fetched successfully\") \n                //  console.log(res.data) \n                setFacilities(res.data);\n                setSearchMessage(\" product  fetched successfully\");\n                setShowPanel(true);\n              }).catch(function (err) {\n                toast({\n                  message: 'Error creating ProductEntry ' + err,\n                  type: 'is-danger',\n                  dismissible: true,\n                  pauseOnHover: true\n                });\n              });\n              _context18.next = 13;\n              break;\n\n            case 10:\n              // console.log(\"less than 3 \")\n              // console.log(val)\n              setShowPanel(false);\n              _context18.next = 13;\n              return setFacilities([]);\n\n            case 13:\n            case \"end\":\n              return _context18.stop();\n          }\n        }\n      }, _callee18);\n    }));\n\n    return function handleSearch(_x14) {\n      return _ref19.apply(this, arguments);\n    };\n  }();\n\n  var handleAddproduct = function handleAddproduct() {\n    setProductModal(true);\n  };\n\n  var handlecloseModal = function handlecloseModal() {\n    setProductModal(false);\n    handleSearch(val);\n  };\n\n  useEffect(function () {\n    if (clear) {\n      //  console.log(\"success has changed\",clear)\n      setSimpa(\"\");\n    }\n\n    return function () {};\n  }, [clear]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"control has-icons-left  \",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"dropdown \".concat(showPanel ? \"is-active\" : \"\"),\n          style: {\n            width: \"100%\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"dropdown-trigger\",\n            style: {\n              width: \"100%\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(DebounceInput, {\n              className: \"input is-small  is-expanded\",\n              type: \"text\",\n              placeholder: \"Search Product\",\n              value: simpa,\n              minLength: 3,\n              debounceTimeout: 400,\n              onBlur: function onBlur(e) {\n                return handleBlur(e);\n              },\n              onChange: function onChange(e) {\n                return handleSearch(e.target.value);\n              },\n              inputRef: inputEl\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1043,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"icon is-small is-left\",\n              children: /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-search\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1053,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1052,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1042,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"dropdown-menu expanded\",\n            style: {\n              width: \"100%\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"dropdown-content\",\n              children: [facilities.length > 0 ? \"\" : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"dropdown-item\"\n                /* onClick={handleAddproduct} */\n                ,\n                children: [\" \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\" \", val, \" is not in your inventory\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1059,\n                  columnNumber: 117\n                }, this), \" \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1059,\n                columnNumber: 52\n              }, this), facilities.map(function (facility, i) {\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"dropdown-item\",\n                  onClick: function onClick() {\n                    return handleRow(facility);\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: facility.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1065,\n                      columnNumber: 46\n                    }, _this2)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1065,\n                    columnNumber: 41\n                  }, _this2), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                        children: facility.quantity\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1066,\n                        columnNumber: 52\n                      }, _this2)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1066,\n                      columnNumber: 46\n                    }, _this2), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: [facility.baseunit, \"(s) remaining\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1067,\n                      columnNumber: 41\n                    }, _this2), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"padleft\",\n                      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                        children: \"Price:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1068,\n                        columnNumber: 67\n                      }, _this2), \" N\", facility.sellingprice]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1068,\n                      columnNumber: 41\n                    }, _this2)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1066,\n                    columnNumber: 41\n                  }, _this2)]\n                }, facility._id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1063,\n                  columnNumber: 37\n                }, _this2);\n              })]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1058,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1057,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1041,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1040,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1039,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1038,\n    columnNumber: 9\n  }, this);\n}\n\n_s2(InventorySearch, \"t0O7bA3TZu/shxaYOPunHCyRtyY=\");\n\n_c2 = InventorySearch;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"DischargeCreate\");\n$RefreshReg$(_c2, \"InventorySearch\");","map":{"version":3,"sources":["/home/mfybaby/Documents/HealthStack2/HS-frontend/src/components/Ward/DischargeCreate.js"],"names":["React","useState","useContext","useEffect","useRef","client","DebounceInput","useForm","UserContext","ObjectContext","toast","Encounter","ServiceSearch","random","require","searchfacility","DischargeCreate","success","setSuccess","message","setMessage","facility","setFacility","OrderServ","service","ClientServ","AdmissionServ","user","currentUser","setCurrentUser","type","setType","documentNo","setDocumentNo","totalamount","setTotalamount","qamount","setQAmount","productId","setProductId","source","setSource","date","setDate","name","setName","inventoryId","setInventoryId","baseunit","setBaseunit","quantity","setQuantity","sellingprice","setSellingPrice","costprice","setCostprice","invquantity","setInvQuantity","calcamount","setCalcAmount","productItem","setProductItem","billingId","setBilllingId","changeAmount","setChangeAmount","paymentmode","setPaymentMode","paymentOptions","setPaymentOptions","billMode","setBillMode","productModal","setProductModal","obj","setObj","objService","setObjService","patient","setPatient","contracts","setContracts","category","setCategory","chosenBed","setChosenBed","bedObject","setBedObject","state","setState","inputEl","calcamount1","hidestatus","medication","DischargeModule","selectedDischarge","showDocumentation","value","handlecloseModal","handleChangeMode","billm","filter","el","handleRow","ProductEntry","newProductEntryModule","selectedMedication","show","prevstate","medicationModule","productitems","productEntry","setProductEntry","productItemI","amount","checkPrice","detail","plan","contract","source_org_name","length","price","dismissible","pauseOnHover","source_org","organizationId","dest_org","getSearchfacility","_id","handleUpdateTotal","prevtotal","Number","handleChangeType","e","target","handleAmount","handleClickProd","prevProd","concat","billInfo","orderInfo","orderId","orderObj","serviceInfo","createdby","paymentInfo","amountDue","paidup","balance","paymentDetails","participantInfo","billingFacility","destination","billingFacilityName","destination_name","locationId","StoreModule","selectedStore","clientId","createdBy","id","billing_status","patch","order_status","then","resp","catch","err","console","log","handleQtty","vlue","resetform","handleDischarge","note","Note","ward","employeeLocation","locationType","bed","Date","toLocaleString","Instruction","instruction","document","currentEmployee","facilityDetail","facilityname","facilityName","documentdetail","documentname","location","locationName","clientname","firstname","middlename","lastname","clientobj","createdByname","status","admission","order","order_id","ward_name","WardModule","selectedWard","typeName","ward_id","bed_id","client_id","admissionhx","careteam","end_time","preventDefault","create","res","handleBed","simpa","physicalbeds","find","onSubmit","transactioncategory","storeId","handleChangeAmount","rev","newclient","oldname","newname","paymentoptions","billme","paymentinfo","forEach","pay","i","active","createObj","push","organizationName","sname","findadmission","query","data","admissiont","cover","details","map","option","width","InventorySearch","clear","productServ","facilities","setFacilities","searchError","setSearchError","showPanel","setShowPanel","searchMessage","setSearchMessage","setSimpa","chosen","setChosen","count","setCount","val","setVal","handleBlur","handleSearch","field","$regex","$options","createdAt","handleAddproduct"],"mappings":"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","sourcesContent":["/* eslint-disable */\nimport React, {useState,useContext, useEffect,useRef} from 'react'\nimport client from '../../feathers'\nimport {DebounceInput} from 'react-debounce-input';\nimport { useForm } from \"react-hook-form\";\n//import {useHistory} from 'react-router-dom'\nimport {UserContext,ObjectContext} from '../../context'\nimport {toast} from 'bulma-toast'\n//import {ProductCreate} from './Products'\nimport Encounter from '../EncounterMgt/Encounter';\nimport  ServiceSearch  from '../helpers/ServiceSearch';\nvar random = require('random-string-generator');\n// eslint-disable-next-line\nconst searchfacility={};\n\nexport default function DischargeCreate(){\n    // const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \n     //const [error, setError] =useState(false)\n     const [success, setSuccess] =useState(false)\n     const [message,setMessage] = useState(\"\")\n     // eslint-disable-next-line\n     const [facility,setFacility] = useState()\n   \n     const OrderServ=client.service('order')\n     const ClientServ=client.service('clinicaldocument')\n     const AdmissionServ=client.service('admission')\n     //const history = useHistory()\n     const {user} = useContext(UserContext) //,setUser\n     // eslint-disable-next-line\n     const [currentUser,setCurrentUser] = useState()\n     const [type,setType] = useState(\"Bill\")\n     const [documentNo,setDocumentNo] = useState(\"\")\n     const [totalamount,setTotalamount] = useState(0)\n     const [qamount,setQAmount] = useState(null)\n     const [productId,setProductId] = useState(\"\")\n     const [source,setSource] = useState(\"\")\n     const [date,setDate] = useState(\"\")\n     const [name,setName] = useState(\"\")\n     const [inventoryId,setInventoryId] = useState(\"\")\n     const [baseunit,setBaseunit] = useState(\"\")\n     const [quantity,setQuantity] = useState(1)\n     const [sellingprice,setSellingPrice] = useState(\"\")\n     const [costprice,setCostprice] = useState(0)\n     const [invquantity,setInvQuantity] = useState(\"\")\n     const [calcamount,setCalcAmount] = useState(0)\n     const [productItem,setProductItem] = useState([])\n      const [billingId,setBilllingId]=useState(\"\")  \n      const [changeAmount, setChangeAmount] = useState(true)\n      const [paymentmode, setPaymentMode] = useState(\"\")\n      const [paymentOptions, setPaymentOptions]=useState([])\n      const [billMode, setBillMode]=useState(\"\")\n      const [productModal, setProductModal]=useState(false)\n      const [obj, setObj]=useState(\"\")\n      const [objService, setObjService]=useState(\"\")\n      const [patient, setPatient]=useState(\"\")\n      const [contracts, setContracts]=useState(\"\")\n      const [category, setCategory]=useState(\"\")\n      const [chosenBed, setChosenBed]=useState()\n      const [bedObject, setBedObject]=useState()\n\n     const {state,setState}=useContext(ObjectContext)\n     const inputEl = useRef(0);\n     let calcamount1\n     let hidestatus\n  \n\n    \n  let medication =state.DischargeModule.selectedDischarge\n /*  let physicalbeds=state.WardModule.selectedWard?.sublocations\n   console.log(medication) */\n\n  const showDocumentation = async (value)=>{\n    setProductModal(true)\n  }\n  const handlecloseModal =()=>{\n    setProductModal(false)\n   // handleSearch(val)\n    }\n\n\n    const handleChangeMode= async(value)=>{\n       // console.log(value)\n       await setPaymentMode(value)\n       // console.log(paymentOptions)\n       let billm= paymentOptions.filter(el=>el.name===value)\n       await setBillMode(billm[0])\n        //console.log(billm)\n        // at startup\n        // check payment mode options from patient financial info\n        // load that to select options\n        // default to HMO-->company-->family-->cash\n        //when chosen\n        //append payment mode to order\n        //check service contract for pricing info\n        // calculate pricing \n        // pricing\n\n\n    }\n\n    const handleRow= async(ProductEntry)=>{\n    //console.log(\"b4\",state)\n\n    //console.log(\"handlerow\",ProductEntry)\n\n    //await setMedication(ProductEntry)\n\n            const    newProductEntryModule={\n                selectedMedication:ProductEntry,\n                show :'detail'\n            }\n            await setState((prevstate)=>({...prevstate, medicationModule:newProductEntryModule}))\n   //console.log(state)\n  // ProductEntry.show=!ProductEntry.show\n\n        } \n \n     const [productEntry,setProductEntry]=useState({\n         productitems:[],\n         date,\n         documentNo,\n         type,\n         totalamount,\n         source,\n \n     })\n  \n     const productItemI={\n         productId,\n         name,\n         quantity,\n         sellingprice,\n         amount:calcamount, //||qamount\n         baseunit,\n         costprice,\n         category:\"Prescription\",  //category===\"Inventory\"?\"Prescription\":category,\n         billingId,\n         billMode\n \n     }\n\n     const checkPrice= async(contracts,billMode)=>{\n         \n\n        if( billMode.type===\"HMO Cover\"){ //paymentmode\n         if (billMode.detail.plan===\"NHIS\"){\n             //find contract for NHIS\n             let contract=contracts.filter(el=>el.source_org_name===\"NHIS\")\n             if (contract.length){\n                // console.log(contract[0].price)\n               await  setSellingPrice(contract[0].price)     \n          }else{\n             toast({\n                 message: 'Please NHIS does not have cover/price for this service. Either set service price for NHIS, try another service or bill using cash',\n                 type: 'is-danger',\n                 dismissible: true,\n                 pauseOnHover: true,\n               })\n              await setSellingPrice(0)\n          }\n\n         }else{\n\n         let contract=contracts.filter(el=>el.source_org===billMode.detail.organizationId)\n         if (contract.length){\n           // console.log(contract[0].price)\n            await setSellingPrice(contract[0].price)\n            \n          }else{\n         toast({\n             message: 'Please HMO does not have cover/price for this service. Either set service price for HMO , try another drug, bill using cash or adjust amount ',\n             type: 'is-danger',\n             dismissible: true,\n             pauseOnHover: true,\n           })\n           await setSellingPrice(0)\n      }\n     \n     }\n     }\n     if( billMode.type===\"Company Cover\"){ //paymentmode\n         let contract=contracts.filter(el=>el.source_org===billMode.detail.organizationId)\n         if (contract.length){\n        // console.log(contract[0].price)\n       await   setSellingPrice(contract[0].price)\n         \n        \n        }else{\n\n         toast({\n             message: 'Please company does not have cover/price for this service. Either set service price for Company or try another drug or bill using cash',\n             type: 'is-danger',\n             dismissible: true,\n             pauseOnHover: true,\n           })\n         await  setSellingPrice(0)   \n      }\n\n  }\n  if( billMode.type===\"Cash\" || billMode.type===\"Family Cover\"){ //paymentmode\n     let contract=contracts.filter(el=>el.source_org===el.dest_org)\n     if (contract.length){\n    // console.log(contract[0].price)\n     await setSellingPrice(contract[0].price)\n    \n    \n         }else{\n\n     toast({\n         message: 'Please there is no cover/price for this service. Either set service price or try another service. Setting price at zero ',\n         type: 'is-danger',\n         dismissible: true,\n         pauseOnHover: true,\n       })\n       await setSellingPrice(0)   \n  }\n\n  }\n\n    }\n     // consider batchformat{batchno,expirydate,qtty,baseunit}\n     //consider baseunoit conversions\n     const getSearchfacility=async (service)=>{\n        // console.log(obj)\n       \n        if (!service){\n            //\"clear stuff\"\n            setProductId(\"\")\n            setName(\"\")\n            setBaseunit(\"\")\n            setInventoryId(\"\")\n            setSellingPrice(0)\n            setInvQuantity(\"\")\n            setQAmount(null)\n            setCostprice(\"\")\n            setContracts(\"\")\n            setCategory(\"\")\n            setInventoryId(\"\")\n            setBilllingId(\"\")\n           // setCalcAmount(null)\n            return\n        }\n \n        setContracts(service.contracts)\n         setProductId(service.productId)\n         setName(service.name)\n         setCategory(service.category) //Lab Order\n         setBaseunit(service.baseunit)\n         setInventoryId(service.inventoryId)\n         setBilllingId(service._id)\n         await setObj(service)\n\n       \n    }\n     useEffect(() => {\n      \n     }, [obj])\n\n     useEffect(() => {\n         setCurrentUser(user)\n         //console.log(currentUser)\n         return () => {\n         \n         }\n     }, [user])\n \n     const handleUpdateTotal=async ()=>{\n        await setTotalamount(prevtotal=>Number(prevtotal) + Number(calcamount))\n     }\n \n     const handleChangeType=async (e)=>{\n         //console.log(e.target.value)\n         await setType(e.target.value)\n     }\n \n     const handleAmount= async()=>{\n         await setQAmount(null)\n        // alert(\"Iam chaning qamount\")\n     }\n\n     const handleClickProd=async()=>{\n       /*   console.log(\"amount: \",productItemI.amount)\n         console.log(\"qamount: \",qamount)\n         console.log(\"calcamount: \",calcamount) */\n        if ( quantity===0||quantity===\"\"|| productId===\"\"||paymentmode===\"\" ){\n            toast({\n                message: 'You need to choose a product and quantity to proceed',\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true,\n              }) \n              return \n        }\n\n         await setSuccess(false)\n         await setProductItem(\n             prevProd=>prevProd.concat(productItemI)\n         )\n        handleUpdateTotal()\n            // generate billing info\n            const billInfo={\n                orderInfo:{\n                    orderId:medication._id,\n                    orderObj:medication,\n                  },\n                  serviceInfo:{            \n                    price: productItemI.sellingprice,\n                    quantity: productItemI.quantity,\n                    productId: productItemI.productId,\n                    name: productItemI.name,\n                    baseunit: productItemI.baseunit,\n                    amount:productItemI.amount,\n                    billingId:productItemI.billingId,\n                    createdby:user._id,\n                  },\n                  paymentInfo:{\n                    amountDue:productItemI.amount,\n                    paidup:0,\n                    balance:productItemI.amount,\n                    paymentDetails:[]\n              \n                  },\n                  participantInfo:{\n                    billingFacility:medication.destination,\n                    billingFacilityName:medication.destination_name,\n                    locationId:state.StoreModule.selectedStore._id, //selected location,\n                    clientId:medication.clientId,\n                    client:medication.client,\n                    paymentmode:billMode\n                  },\n                  createdBy:user.id,\n                  billing_status:\"Unpaid\"\n                }\n\n        //update order\n        \n        OrderServ.patch(medication._id,{\n            order_status:\"Billed\", //Billed\n            billInfo,\n        }).then((resp)=>{\n           // medication=resp\n           // console.log(resp)\n             handleRow(resp) \n            //update dispense\n\n        })\n        .catch((err)=>{\n            console.log(err)\n        })\n        \n        //update status(billed) + action()\n        //?attached chosen product to medication\n        //dispense helper?\n         setName(\"\")\n         setBaseunit(\"\")\n         setQuantity(\"\")\n         setInventoryId(\"\")\n         setSellingPrice(\"\")\n         setInvQuantity(\"\")\n             handleAmount()\n        // setCalcAmount(null)\n        await setSuccess(true)\n        getSearchfacility(false)\n        setObj(\"\")\n        /* console.log(success)\n        console.log(qamount)\n        console.log(productItem) */\n        setChangeAmount(true)\n       \n     }\n  \n \n     const handleQtty=async(e)=>{\n        /*  if (invquantity<e.target.value){\n             toast({\n                 message: 'You can not sell more quantity than exist in inventory ' ,\n                 type: 'is-danger',\n                 dismissible: true,\n                 pauseOnHover: true,\n               })\n             return\n         } */\n         setQuantity(e.target.value)\n         if (e.target.vlue===\"\"){\n            setQuantity(1)\n         }\n        /*  calcamount1=quantity*sellingprice\n         await setCalcAmount(calcamount1) */\n         //console.log(calcamount)\n     }\n \n     useEffect( () => {\n          setProductEntry({\n             \n             date,\n             documentNo,\n             type,\n             totalamount,\n             source,\n         })\n        setCalcAmount(quantity*sellingprice) \n         return () => {\n             \n         }\n     },[date])\n \n     const resetform=()=>{\n      setType(\"Sales\")\n     setDocumentNo(\"\")\n     setTotalamount(\"\")\n     setProductId(\"\")\n     setSource(\"\")\n     setDate(\"\")\n     setName(\"\")\n     setBaseunit()\n     setCostprice()\n     setProductItem([])\n     }\n\n\n     const handleDischarge= async(e)=>{ //handle admit\n\n    //alert(\"something\")\n    //update order\n    //create admission resource\n    //?create bill?\n\n    const note={\n       Note:\"Patient was discharged from \" + medication.client.ward + \" \" + state.employeeLocation.locationType + \", bed:\"+ medication.client.bed +\" at \" +  Date().toLocaleString(),\n       Instruction: medication.instruction\n    }\n\n    //console.log(note)\n    let document={}\n    // data.createdby=user._id\n    // console.log(data);\n        if (user.currentEmployee){\n        document.facility=user.currentEmployee.facilityDetail._id \n        document.facilityname=user.currentEmployee.facilityDetail.facilityName // or from facility dropdown\n        }\n        document.documentdetail=note\n        console.log(document.documentdetail)\n        document.documentname=\"Discharge\" //state.DocumentClassModule.selectedDocumentClass.name\n        // document.documentClassId=state.DocumentClassModule.selectedDocumentClass._id\n        document.location=state.employeeLocation.locationName+\" \"+state.employeeLocation.locationType\n        document.locationId=state.employeeLocation.locationId\n        document.client=medication.client._id\n        document.clientname=medication.client.firstname+ \" \"+ medication.client.middlename+\" \"+ medication.client.lastname\n        document.clientobj=medication.client\n        document.createdBy=user._id\n        document.createdByname=user.firstname+ \" \"+user.lastname\n        document.status=\"completed\"\n\n\n    const   admission={\n              //  encounter_id:{type: Schema.Types.ObjectId,},\n              //  hospitalization_id:{type: Schema.Types.ObjectId,},\n                //order\n                order:medication,\n                order_id:medication._id,\n\n                //location: ward/bed\n                ward_name:state.WardModule.selectedWard.typeName,\n                ward_id:state.WardModule.selectedWard._id,\n                bed:medication.client.bed,\n                bed_id:medication.client.bed_id,\n                facility:user.currentEmployee.facilityDetail._id,\n                //billing:perpertuity\n                /* bill:{type:Schema.Types.Mixed},\n                bill_id:{type: Schema.Types.ObjectId,}, */\n                //status\n                status:\"free\",\n                //client\n                client:medication.client,\n                client_id:medication.clientId,\n                //careteam\n                admissionhx:[],\n                careteam:[],\n                //start_time: new Date(),\n                end_time:new Date(),\n                createdby:user._id,\n              \n                }\n               document.admission=admission\n               console.log(document)\n                e.preventDefault();\n                setMessage(\"\")\n              //  setError(false)\n                setSuccess(false)\n                 // data.createdby=user._id\n                 // console.log(data);\n                /*   if (user.currentEmployee){\n                 data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\n                  } */\n                 // data.locationType=\"Front Desk\"\n                 ClientServ.create(document)\n                .then(async (res)=>{\n                        //console.log(JSON.stringify(res))\n                       // e.target.reset();\n                       /*  setMessage(\"Created Clinic successfully\") */\n                        setSuccess(true)\n                        toast({\n                            message: 'Discharge successfull',\n                            type: 'is-success',\n                            dismissible: true,\n                            pauseOnHover: true,\n                          })\n                          setSuccess(false)\n                          setChosenBed()                        \n                          setBedObject()\n                          const    newProductEntryModule={\n                            selectedDischarge:{},\n                            show :''\n                        }\n                      await setState((prevstate)=>({...prevstate, DischargeModule:newProductEntryModule}))\n                      medication=\"\"\n                    })\n                    .catch((err)=>{\n                        toast({\n                            message: 'Error creating Discharge ' + err,\n                            type: 'is-danger',\n                            dismissible: true,\n                            pauseOnHover: true,\n                          })\n                    }) \n    }\n \n\n    const handleBed=(e)=>{\n        //console.log(JSON.parse(e.target.value))\n       setChosenBed(e.target.value)\n        let simpa= physicalbeds.find(obj=>obj._id===e.target.value)\n        setBedObject(simpa)\n\n    }\n\n     const onSubmit = async(e) =>{\n         e.preventDefault();\n         setMessage(\"\")\n         //setError(false)\n         setSuccess(false)\n         await setProductEntry({\n             \n             date,\n             documentNo,\n             type,\n             totalamount,\n             source,\n         })\n         productEntry.productitems=productItem\n         productEntry.createdby=user._id\n         productEntry.transactioncategory=\"debit\"\n           if (user.currentEmployee){\n          productEntry.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\n           }else{\n             toast({\n                 message: 'You can not remove inventory from any organization',\n                 type: 'is-danger',\n                 dismissible: true,\n                 pauseOnHover: true,\n               }) \n               return\n           }\n           \n           if (state.StoreModule.selectedStore._id){\n             productEntry.storeId=state.StoreModule.selectedStore._id\n           }else{\n             toast({\n                 message: 'You need to select a store before removing inventory',\n                 type: 'is-danger',\n                 dismissible: true,\n                 pauseOnHover: true,\n               }) \n               return\n           }\n           \n \n       } \n \n  \n    const handleChangeAmount=()=>{\n        setChangeAmount((rev)=>(!rev))\n        \n    }\n\n    const newclient=async ()=>{\n        await  setProductItem([])\n    }\n\n    useEffect(() => {\n        setPatient(medication.client)\n        const oldname=medication.clientname\n       // console.log(\"oldname\",oldname)\n        setSource(medication.clientname)\n\n        const newname=source\n       // console.log(\"newname\",newname)\n        if (oldname!==newname){\n            //newclient\n\n            //recalculate bedspace: subtract occupied from physical space\n\n        \n        setProductItem([])\n        setTotalamount(0)\n\n        }\n       \n\n\n        return () => {\n           \n        }\n    }, [medication])\n\n    useEffect(() => {\n        //setPatient(medication.client)\n        setProductItem([])\n        setTotalamount(0)\n        const paymentoptions= []\n       // const info = client.paymentinfo\n        let billme\n       let obj\n       patient &&  patient.paymentinfo.forEach((pay,i)=>{ \n           if (pay.active){\n       \n            switch(pay.paymentmode) {\n                case 'Cash':\n                  // code block\n                  obj=createObj(pay,\"Cash\",\"Cash\",\"Cash\" )\n                \n                  paymentoptions.push(obj)\n                  setPaymentMode(\"Cash\")\n                  billme=obj\n                 // console.log(\"billme\",billme)\n                  break;\n                case 'Family':\n                  // code block\n                  obj=createObj(pay,\"Family Cover\",\"familyCover\", \"Family Cover\")\n                  paymentoptions.push(obj)\n                  setPaymentMode(\"Family Cover\")\n                  billme=obj\n                 // console.log(\"billme\",billme)\n                  break;\n                case 'Company':\n                  // code block\n                  let name=\"Company: \" + pay.organizationName + \"(\" + pay.plan+\")\"\n\n                  obj=createObj(pay,name,\"CompanyCover\", \"Company Cover\" )\n                      paymentoptions.push(obj)\n                      setPaymentMode(\"Company: \" + pay.organizationName + \"(\" + pay.plan+\")\")\n                     billme=obj\n                    // console.log(\"billme\",billme)\n                  break;\n                case 'HMO':\n                  // code block\n                 let  sname=\"HMO: \" + pay.organizationName + \"(\" + pay.plan+\")\"\n\n                  obj=createObj(pay,sname,\"HMOCover\", \"HMO Cover\" )\n                      paymentoptions.push(obj)\n                      setPaymentMode(\"HMO: \" + pay.organizationName + \"(\" + pay.plan+\")\")\n                     billme=obj\n                   //  console.log(\"billme\",billme)\n                  break;\n                default:\n                  // code block\n              }\n            }\n            })\n                    \n          \n        setPaymentOptions(paymentoptions)\n        setBillMode(billme)\n       //console.log(paymentoptions)\n       // console.log(billMode)\n        return () => {\n           \n        }\n    }, [source]) //source\n\n    const findadmission= async()=>{\n\n        const admissiont= await AdmissionServ.find({\n            query:{\n                order_id: medication._id\n            }\n        }).then((res)=>{\n         //  console.log(\"product  fetched successfully\") \n         //  console.log(res.data) \n             setChosenBed(res.data)\n            \n             console.log(res.data)\n          })\n          .catch((err)=>{\n             toast({\n                 message: 'Error creating ProductEntry ' + err,\n                 type: 'is-danger',\n                 dismissible: true,\n                 pauseOnHover: true,\n               })\n          })\n          console.log(admissiont)\n         // setChosenBed(admissiont)\n    }\n\n     useEffect(() => {\n       //get the admission info for the discharge order\n       \n       \n         const ward= state.WardModule.selectedWard\n         return () => {\n             \n         }\n     }, [])\n\n     useEffect(() => {\n        // console.log(\"success\", success)\n         if (success){\n             setSuccess(false)\n         }\n       \n      }, [success])\n\n      const createObj= (pay,name,cover,type)=>{\n        let details={}\n          details= {...pay}\n          details.type=type\n  \n      return {\n              name,\n              value:cover,\n              detail:details,\n              type,\n          }\n  \n      }\n\n      useEffect(() => {\n        \n        //update selling price\n        if (!!billMode && !!contracts){\n           // console.log(contracts)\n            checkPrice(contracts,billMode)\n        }\n       \n        return () => {\n           \n        }\n    }, [obj])\n\n     useEffect(() => {\n        calcamount1=quantity*sellingprice\n         setCalcAmount(calcamount1)\n        // console.log(calcamount)\n         setChangeAmount(true)\n        return () => {\n            \n        }\n    }, [quantity,sellingprice])\n\n    useEffect(() => {\n       \n        if (!!billMode && !!contracts){\n            \n            checkPrice(contracts,billMode)\n        }\n        \n        return () => {\n            \n        }\n    }, [billMode])\n\n// console.log(\"simpa\")\n     return (\n         <>\n             <div className=\"card card-overflow\">\n             <div className=\"card-header\">\n                 <p className=\"card-header-title\">\n                    Discharge Patient\n                 </p>\n                 <button className=\"button is-success is-small btnheight mt-2\" onClick={showDocumentation}>Documentation</button>\n             </div>\n             <div className=\"card-content \">\n    \n             <form onSubmit={onSubmit}> {/* handleSubmit(onSubmit) */}\n             <div className=\"field is-horizontal\">\n             <div className=\"field-body\">\n            {/*  <div className=\"field\">    \n                 <div className=\"control\">\n                     <div className=\"select is-small\">\n                         <select name=\"type\" value={type} onChange={handleChangeType} className=\"selectadd\">\n                            <option value=\"\">Choose Type </option>\n                             <option value=\"Dispense\">Dispense</option>\n                             <option value=\"Bill\">Bill </option> */}\n                             {/* <option value=\"Dispense\">Dispense</option>\n                             <option value=\"Audit\">Audit</option> */}\n                 {/*         </select>\n                     </div>\n                 </div>\n             </div>\n */}\n             <div className=\"field\">\n                     <p className=\"control has-icons-left has-icons-right\">\n                         <input className=\"input is-small\" /* ref={register({ required: true })} */ value={source} name=\"client\" type=\"text\" onChange={e=>setSource(e.target.value)} placeholder=\"Client\" />\n                         <span className=\"icon is-small is-left\">\n                             <i className=\"fas fa-hospital\"></i>\n                         </span>                    \n                     </p>\n                 </div>\n                 <div className=\"field\">    \n                 <div className=\"control\">\n                     <div className=\"select is-small \">\n                         <select name=\"paymentmode\" value={paymentmode} onChange={(e)=>handleChangeMode(e.target.value)} className=\"selectadd\" >\n                         <option value=\"\">Billing Mode </option>\n                           {paymentOptions.map((option,i)=>(\n                               <option key={i} value={option.details}> {option.name}</option>\n                           ))}\n                           \n                            \n                            {/*  <option value=\"Cash\">Cash</option>\n                             <option value=\"Family\">Family </option>\n                            <option value=\"Company Cover\">Company Cover</option>\n                             <option value=\"HMO\">HMO</option> */}\n                         </select>\n                     </div>\n                 </div>\n             </div>\n            \n             </div>\n             </div> \n                \n                 </form>   \n                \n            \n          {/* array of ProductEntry items */}\n         \n         <label className=\"label is-small\">Discharge Order:</label>\n         <div className=\"field is-horizontal\">\n             <div className=\"field-body\">\n             <div className=\"field\" style={{width:\"40%\"}}>\n                 <p className=\"control has-icons-left\" >\n                     <input className=\"input is-small\"  /* ref={register({ required: true })} */ disabled  name=\"order\" value={medication.order} type=\"text\" onChange={ e=> handleQtty(e)} placeholder=\"Quantity\"  />\n                   \n                    {/*  <span className=\"helper is-size-7\"><strong>Instruction: </strong>{medication.instruction}</span> */}\n                    \n                 </p>\n                 <span className=\"helper is-size-7\"><strong>Instructions: </strong></span>\n                 <p>\n                 {medication.instruction}\n                 </p>\n\n             </div> \n            \n             </div>\n             </div>\n             <label className=\"label is-small\">Current Bed: {medication.client.bed}</label>\n                {/*  {!!state.WardModule.selectedWard.sublocations &&<div>\n               \n\n                        <select name=\"bed\" value={chosenBed} onChange={(e)=>handleBed(e)} className=\"selectadd\" >         \n                         <option value=\"\">Choose Bed </option>\n                           {physicalbeds.map((locat,i)=>(\n                               <option key={i} value={locat._id}> {locat.typeName}</option>\n                           ))}\n\n                         </select>\n                     </div>} */}\n\n\n        \n             \n         <div>\n             \n             \n                 <div className=\"field mt-2 is-grouped\">\n                 <p className=\"control\">\n                     <button className=\"button is-success is-small\" /* disabled={!productItem.length>0} */ onClick={handleDischarge}>\n                      Discharge\n                     </button>\n                 </p>\n                {/*  <p className=\"control\">\n                     <button className=\"button is-warning is-small\" disabled={!productItem.length>0} onClick={onSubmit} >\n                         Clear\n                     </button>\n                 </p> */}\n                 </div>\n                 </div>\n            \n             \n             \n             \n             </div>\n             </div>\n             <div className={`modal ${productModal?\"is-active\":\"\"}` }>\n                                    <div className=\"modal-background\"></div>\n                                    <div className=\"modal-card  modalbkgrnd\">\n                                        <header className=\"modal-card-head  btnheight\">\n                                        <p className=\"modal-card-title\">Documentation</p>\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={handlecloseModal}></button>\n                                        </header>\n                                        <section className=\"modal-card-body modalcolor\">\n                                      \n                                         <Encounter standalone=\"true\" />\n                                        </section> \n                                        {/* <footer className=\"modal-card-foot\">\n                                        <button className=\"button is-success\">Save changes</button>\n                                        <button className=\"button\">Cancel</button>\n                                        </footer>  */}\n                                   </div>\n                                </div>      \n         </>\n     )\n    \n }\n\n export  function InventorySearch({getSearchfacility,clear}) {\n    \n    const productServ=client.service('inventory')\n    const [facilities,setFacilities]=useState([])\n     // eslint-disable-next-line\n     const [searchError, setSearchError] =useState(false)\n     // eslint-disable-next-line\n    const [showPanel, setShowPanel] =useState(false)\n     // eslint-disable-next-line\n   const [searchMessage, setSearchMessage] = useState(\"\") \n   // eslint-disable-next-line \n   const [simpa,setSimpa]=useState(\"\")\n   // eslint-disable-next-line \n   const [chosen,setChosen]=useState(false)\n   // eslint-disable-next-line \n   const [count,setCount]=useState(0)\n   const inputEl=useRef(null)\n   const [val,setVal]=useState(\"\")\n   const {user} = useContext(UserContext) \n   const {state}=useContext(ObjectContext)\n    const [productModal,setProductModal]=useState(false)\n\n   const handleRow= async(obj)=>{\n        await setChosen(true)\n        //alert(\"something is chaning\")\n       getSearchfacility(obj)\n       \n       await setSimpa(obj.name)\n       \n        // setSelectedFacility(obj)\n        setShowPanel(false)\n        await setCount(2)\n        /* const    newfacilityModule={\n            selectedFacility:facility,\n            show :'detail'\n        }\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\n   //console.log(state)\n    }\n    const handleBlur=async(e)=>{\n        /*  if (count===2){\n             console.log(\"stuff was chosen\")\n         }\n        */\n       /*  console.log(\"blur\")\n         setShowPanel(false)\n        console.log(JSON.stringify(simpa))\n        if (simpa===\"\"){\n            console.log(facilities.length)\n            setSimpa(\"abc\")\n            setSimpa(\"\")\n            setFacilities([])\n            inputEl.current.setValue=\"\"\n        }\n        console.log(facilities.length)\n        console.log(inputEl.current) */\n    }\n    const handleSearch=async(value)=>{\n        setVal(value)\n        if (value===\"\"){\n            setShowPanel(false)\n            getSearchfacility(false)\n            return\n        }\n        const field='name' //field variable\n\n       \n        if (value.length>=3 ){\n            productServ.find({query: {     //service\n                 [field]: {\n                     $regex:value,\n                     $options:'i'\n                    \n                 },\n                 facility: user.currentEmployee.facilityDetail._id,\n                 storeId: state.StoreModule.selectedStore._id,\n                 $limit:10,\n                 $sort: {\n                     createdAt: -1\n                   }\n                     }}).then((res)=>{\n            //  console.log(\"product  fetched successfully\") \n            //  console.log(res.data) \n                setFacilities(res.data)\n                 setSearchMessage(\" product  fetched successfully\")\n                 setShowPanel(true)\n             })\n             .catch((err)=>{\n                toast({\n                    message: 'Error creating ProductEntry ' + err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n             })\n         }\n        else{\n           // console.log(\"less than 3 \")\n           // console.log(val)\n            setShowPanel(false)\n            await setFacilities([])\n           // console.log(facilities)\n        }\n    }\n\n    const handleAddproduct =()=>{\n        setProductModal(true) \n    }\n    const handlecloseModal =()=>{\n        setProductModal(false)\n        handleSearch(val)\n    }\n    useEffect(() => {\n       if (clear){\n         //  console.log(\"success has changed\",clear)\n           setSimpa(\"\")\n       }\n        return () => {\n            \n        }\n    }, [clear] )\n    return (\n        <div>\n            <div className=\"field\">\n                <div className=\"control has-icons-left  \">\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`} style={{width:\"100%\"}}>\n                        <div className=\"dropdown-trigger\" style={{width:\"100%\"}}>\n                            <DebounceInput className=\"input is-small  is-expanded\" \n                                type=\"text\" placeholder=\"Search Product\"\n                                value={simpa}\n                                minLength={3}\n                                debounceTimeout={400}\n                                onBlur={(e)=>handleBlur(e)}\n                                onChange={(e)=>handleSearch(e.target.value)}\n                                inputRef={inputEl}\n                                  />\n                            <span className=\"icon is-small is-left\">\n                                <i className=\"fas fa-search\"></i>\n                            </span>\n                        </div>\n                        {/* {searchError&&<div>{searchMessage}</div>} */}\n                        <div className=\"dropdown-menu expanded\" style={{width:\"100%\"}}>\n                            <div className=\"dropdown-content\">\n                          { facilities.length>0?\"\":<div className=\"dropdown-item\" /* onClick={handleAddproduct} */> <span> {val} is not in your inventory</span> </div>}\n\n                              {facilities.map((facility, i)=>(\n                                    \n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\n                                        \n                                        <div><span>{facility.name}</span></div>\n                                        <div><span><strong>{facility.quantity}</strong></span>\n                                        <span>{facility.baseunit}(s) remaining</span>\n                                        <span className=\"padleft\"><strong>Price:</strong> N{facility.sellingprice}</span></div>\n                                        \n                                    </div>\n                                    \n                                    ))}\n                                    \n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}