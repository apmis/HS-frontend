{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from'react';import client from'../feathers';import{useForm}from\"react-hook-form\";import{useHistory}from'react-router-dom';import{UserContext}from'../context';import{toast}from'bulma-toast';export default function Login(){var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,watch=_useForm.watch,errors=_useForm.errors;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];// const userServ=client.service('/users')\nvar history=useHistory();var _useContext=useContext(UserContext),setUser=_useContext.setUser;var onSubmit=function onSubmit(data,e){e.preventDefault();/* setErrorMessage(\"\")\n        setError(false) */var email=data.email;var password=data.password;client.authenticate({strategy:'local',email:email,password:password}).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// console.log(JSON.stringify(res.user))\ne.target.reset();_context.next=3;return setUser(res.user);case 3://console.log(user)\nlocalStorage.setItem(\"user\",JSON.stringify(res.user));history.push(\"/app\");case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(err){//setErrorMessage(\"Error loggin in User, probable network issues \"+ err )\ntoast({message:'Error loggin in User, probable network issues '+err,type:'is-danger',dismissible:true,pauseOnHover:true});});};return/*#__PURE__*/_jsx(\"section\",{className:\"section\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"columns is-centered\",children:/*#__PURE__*/_jsx(\"div\",{className:\"column is-4 \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card v-centered\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-header-title\",children:\"Health Stack\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-content\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left has-icons-right\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input\",ref:register({required:true}),name:\"email\",type:\"email\",placeholder:\"Email\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-envelope\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input\",ref:register({required:true}),name:\"password\",type:\"password\",placeholder:\"Password\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-lock\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-success is-small\",children:\"Login\"})})}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"message\",children:[\" \",errorMessage]})]})})]})})})})});}","map":{"version":3,"sources":["/home/mfybaby/Documents/HealthStack2/HS-frontend/src/components/Login.js"],"names":["React","useState","useContext","client","useForm","useHistory","UserContext","toast","Login","register","handleSubmit","watch","errors","error","setError","errorMessage","setErrorMessage","history","setUser","onSubmit","data","e","preventDefault","email","password","authenticate","strategy","then","res","target","reset","user","localStorage","setItem","JSON","stringify","push","catch","err","message","type","dismissible","pauseOnHover","required"],"mappings":"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","sourcesContent":["import React, {useState,useContext} from 'react'\nimport client from '../feathers'\nimport { useForm } from \"react-hook-form\";\nimport {useHistory} from 'react-router-dom'\nimport {UserContext} from '../context'\nimport {toast} from 'bulma-toast'\n\nexport default function Login() {\n    const { register, handleSubmit, watch, errors } = useForm();\n    const [error, setError] =useState(true)\n    const [errorMessage,setErrorMessage] = useState(\"\")\n   // const userServ=client.service('/users')\n    const history = useHistory()\n    const {/* user, */setUser} = useContext(UserContext)\n\n   \nconst onSubmit = (data,e) =>{\n        e.preventDefault();\n        /* setErrorMessage(\"\")\n        setError(false) */\n           const  email=data.email\n           const password=data.password\n         \n          \n          client.authenticate({\n            strategy:'local',\n            email,\n            password\n        }).then(async (res)=>{\n               // console.log(JSON.stringify(res.user))\n                e.target.reset();\n               await setUser(res.user)\n              //console.log(user)\n               localStorage.setItem(\"user\",JSON.stringify(res.user))\n               history.push(\"/app\")\n\n            })\n            .catch((err)=>{\n                //setErrorMessage(\"Error loggin in User, probable network issues \"+ err )\n                toast({\n                    message: 'Error loggin in User, probable network issues ' + err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n            })\n\n      } \n\n    return (\n        <section className=\"section\">\n        <div className=\"container\">\n        <div className=\"columns is-centered\">\n        <div className=\"column is-4 \">\n        <div className=\"card v-centered\">\n            <div className=\"card-header\">\n                <p className=\"card-header-title\">\n                    Health Stack\n                </p>\n            </div>\n            <div className=\"card-content\">\n            <form onSubmit={handleSubmit(onSubmit)}>\n           <div className=\"field\">\n            <p className=\"control has-icons-left has-icons-right\">\n                <input className=\"input\" ref={register({ required: true })}  name=\"email\" type=\"email\" placeholder=\"Email\" />\n                  <span className=\"icon is-small is-left\">\n                     <i className=\"fas fa-envelope\"></i>\n                </span>\n                \n            </p>\n        </div>\n        <div className=\"field\">\n            <p className=\"control has-icons-left\">\n                <input className=\"input\" ref={register({ required: true })} name=\"password\" type=\"password\" placeholder=\"Password\"/>\n                <span className=\"icon is-small is-left\">\n                <i className=\"fas fa-lock\"></i>\n                </span>\n            </p>\n        </div>\n        <div className=\"field\">\n            <p className=\"control\">\n                <button className=\"button is-success is-small\">\n                    Login\n                </button>\n            </p>\n        </div>\n        { error && <div className=\"message\"> {errorMessage}</div>}\n        </form>\n    </div>\n    </div>\n    </div>\n    </div>\n    </div>\n    </section>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}