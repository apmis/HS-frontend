{"ast":null,"code":"import _defineProperty from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable */import React,{useState,useContext,useEffect,useRef}from'react';import client from'../../feathers';import{DebounceInput}from'react-debounce-input';import{useForm}from\"react-hook-form\";//import {useHistory} from 'react-router-dom'\nimport{UserContext,ObjectContext}from'../../context';import{toast}from'bulma-toast';/* import FacilityAccount from \"./FacilityAccount\" */ // eslint-disable-next-line\nvar searchfacility={};export default function Ledgers(){var _useContext=useContext(ObjectContext),state=_useContext.state;//,setState\n// eslint-disable-next-line\nvar _useState=useState(),_useState2=_slicedToArray(_useState,2),selectedInventory=_useState2[0],setSelectedInventory=_useState2[1];alert(\"ledger\");//const [showState,setShowState]=useState() //create|modify|detail\nreturn/*#__PURE__*/_jsx(\"section\",{className:\"section remPadTop\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"columns \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"column is-5 \",children:/*#__PURE__*/_jsx(LedgerList,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"column is-7 \",children:state.SelectedClient.show==='detail'&&/*#__PURE__*/_jsx(LedgerAccount,{})})]})});}export function LedgerAccount(){var _facility$;var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue;//, watch, errors, reset \nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),success=_useState6[0],setSuccess=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),message=_useState8[0],setMessage=_useState8[1];// eslint-disable-next-line\nvar _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),facility=_useState10[0],setFacility=_useState10[1];var InventoryServ=client.service('subwallettransactions');var SubwalletServ=client.service('subwallet');//const history = useHistory()\nvar _useContext2=useContext(UserContext),user=_useContext2.user;//,setUser\nvar _useContext3=useContext(ObjectContext),state=_useContext3.state,setState=_useContext3.setState;// eslint-disable-next-line\nvar _useState11=useState(),_useState12=_slicedToArray(_useState11,2),currentUser=_useState12[0],setCurrentUser=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),balance=_useState14[0],setBalance=_useState14[1];var clientSel=state.SelectedClient.client;var getSearchfacility=function getSearchfacility(obj){/*   \n        setValue(\"facility\", obj._id,  {\n            shouldValidate: true,\n            shouldDirty: true\n        }) */};useEffect(function(){setCurrentUser(user);//console.log(currentUser)\nreturn function(){};},[user]);//check user for facility or get list of facility  \n/*  useEffect(()=>{\n        //setFacility(user.activeInventory.FacilityId)//\n      if (!user.stacker){\n          console.log(currentUser)\n        setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\n            shouldValidate: true,\n            shouldDirty: true\n        }) \n      }\n    }) */useEffect(function(){getaccountdetails();getBalance();return function(){};},[clientSel]);var getaccountdetails=function getaccountdetails(){InventoryServ.find({query:{facility:user.currentEmployee.facilityDetail._id,client:clientSel.client,// storeId:state.StoreModule.selectedStore._id,\n// category:\"credit\",\n$sort:{createdAt:-1}}}).then(function(res){console.log(res);setFacility(res.data);//e.target.reset();\n/*  setMessage(\"Created Inventory successfully\") */ // setSuccess(true)\ntoast({message:'Account details succesful',type:'is-success',dismissible:true,pauseOnHover:true});// setSuccess(false)\n}).catch(function(err){toast({message:'Error getting account details '+err,type:'is-danger',dismissible:true,pauseOnHover:true});});};var getBalance=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var findProductEntry;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return SubwalletServ.find({query:{client:clientSel.client,organization:user.currentEmployee.facilityDetail._id,//storeId:state.StoreModule.selectedStore._id,\n//clientId:state.ClientModule.selectedClient._id,\n$limit:100,$sort:{createdAt:-1}}});case 2:findProductEntry=_context.sent;console.log(findProductEntry);// console.log(\"balance\", findProductEntry.data[0].amount)\nif(!(findProductEntry.data.length>0)){_context.next=9;break;}_context.next=7;return setBalance(findProductEntry.data[0].amount);case 7:_context.next=11;break;case 9:_context.next=11;return setBalance(0);case 11:case\"end\":return _context.stop();}}},_callee);}));return function getBalance(){return _ref.apply(this,arguments);};}();var onSubmit=function onSubmit(data,e){e.preventDefault();setMessage(\"\");setError(false);setSuccess(false);// data.createdby=user._id\nconsole.log(data);if(user.currentEmployee){data.facility=user.currentEmployee.facilityDetail._id;// or from facility dropdown\n}};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card cardheight\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"card-header-title\",children:[\"Account Details: \",(_facility$=facility[0])===null||_facility$===void 0?void 0:_facility$.fromName]}),/*#__PURE__*/_jsxs(\"button\",{className:\"button is-success is-small btnheight mt-2\",children:[\"Current Balance: N \",balance]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-content \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"columns \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"column is-6 \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card cardht80\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-header-title\",children:\"Credit\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-content vscrollable mx-0.5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"table-container pullup \",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable mx-0.5\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Serial No\",children:\"S/No\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Cost Price\",children:\"Date\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Quantity\",children:\"Amount\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Base Unit\",children:\"Mode\"})})]})}),/*#__PURE__*/_jsx(\"tfoot\",{}),/*#__PURE__*/_jsx(\"tbody\",{children:facility.map(function(Inventory,i){return/*#__PURE__*/_jsx(_Fragment,{children:Inventory.category===\"credit\"&&/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:i+1}),/*#__PURE__*/_jsx(\"td\",{children:new Date(Inventory.createdAt).toLocaleString('en-GB')}),\" \",/*#__PURE__*/_jsx(\"td\",{children:Inventory.amount}),/*#__PURE__*/_jsx(\"td\",{children:Inventory.paymentmode})]},Inventory._id)});})})]})})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"column is-6 \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card cardht80\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-header-title\",children:\"Debit\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-content vscrollable mx-0.5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"table-container pullup \",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table is-striped is-narrow is-hoverable  is-scrollable mx-0.5\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Serial No\",children:\"S/No\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Cost Price\",children:\"Date\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Description\",children:\"Description\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Quantity\",children:\"Amount\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Base Unit\",children:\"Mode\"})})]})}),/*#__PURE__*/_jsx(\"tfoot\",{}),/*#__PURE__*/_jsx(\"tbody\",{children:facility.map(function(Inventory,i){return/*#__PURE__*/_jsx(_Fragment,{children:Inventory.category===\"debit\"&&/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:i+1}),/*#__PURE__*/_jsx(\"td\",{children:new Date(Inventory.createdAt).toLocaleString('en-GB')}),\" \",/*#__PURE__*/_jsx(\"th\",{children:Inventory.description}),/*#__PURE__*/_jsx(\"td\",{children:Inventory.amount}),/*#__PURE__*/_jsx(\"td\",{children:Inventory.paymentmode})]},Inventory._id)});})})]})})})]})})]})})]})});}export function LedgerList(){// const { register, handleSubmit, watch, errors } = useForm();\n// eslint-disable-next-line\nvar _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),error=_useState16[0],setError=_useState16[1];// eslint-disable-next-line\nvar _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),success=_useState18[0],setSuccess=_useState18[1];// eslint-disable-next-line\nvar _useState19=useState(\"\"),_useState20=_slicedToArray(_useState19,2),message=_useState20[0],setMessage=_useState20[1];var LocationServ=client.service('chartsofaccount');//const history = useHistory()\n// const {user,setUser} = useContext(UserContext)\nvar _useState21=useState([]),_useState22=_slicedToArray(_useState21,2),facilities=_useState22[0],setFacilities=_useState22[1];// eslint-disable-next-line\nvar _useState23=useState(),_useState24=_slicedToArray(_useState23,2),selectedLocation=_useState24[0],setSelectedLocation=_useState24[1];//\n// eslint-disable-next-line\nvar _useContext4=useContext(ObjectContext),state=_useContext4.state,setState=_useContext4.setState;// eslint-disable-next-line\nvar _useContext5=useContext(UserContext),user=_useContext5.user,setUser=_useContext5.setUser;var handleCreateNew=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var newLocationModule;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:newLocationModule={selectedAccount:{},show:'create'};_context2.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{ChartAccountModule:newLocationModule});});case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function handleCreateNew(){return _ref2.apply(this,arguments);};}();var handleRow=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(Location){var newLocationModule;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return setSelectedLocation(Location);case 2:newLocationModule={selectedAccount:Location,show:'detail'};_context3.next=5;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{ChartAccountModule:newLocationModule});});case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function handleRow(_x){return _ref3.apply(this,arguments);};}();var handleSearch=function handleSearch(val){var _query;var field='name';console.log(val);LocationServ.find({query:(_query={},_defineProperty(_query,field,{$regex:val,$options:'i'}),_defineProperty(_query,\"facility\",user.currentEmployee.facilityDetail._id||\"\"),_defineProperty(_query,\"$limit\",100),_defineProperty(_query,\"$sort\",{accountType:1}),_query)}).then(function(res){console.log(res);setFacilities(res.data);setMessage(\" Location  fetched successfully\");setSuccess(true);}).catch(function(err){console.log(err);setMessage(\"Error fetching Location, probable network issues \"+err);setError(true);});};var getFacilities=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var findLocation,_findLocation;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!user.currentEmployee){_context4.next=8;break;}_context4.next=3;return LocationServ.find({query:{/*  facility:user.currentEmployee.facilityDetail._id, */$limit:2000,$sort:{accountType:1}}});case 3:findLocation=_context4.sent;_context4.next=6;return setFacilities(findLocation.data);case 6:_context4.next=14;break;case 8:if(!user.stacker){_context4.next=14;break;}_context4.next=11;return LocationServ.find({query:{$limit:2000,$sort:{accountType:1}}});case 11:_findLocation=_context4.sent;_context4.next=14;return setFacilities(_findLocation.data);case 14:case\"end\":return _context4.stop();}}},_callee4);}));return function getFacilities(){return _ref4.apply(this,arguments);};}();useEffect(function(){return function(){};},[]);useEffect(function(){if(user){getFacilities();}else{/* const localUser= localStorage.getItem(\"user\")\n                     const user1=JSON.parse(localUser)\n                     console.log(localUser)\n                     console.log(user1)\n                     fetchUser(user1)\n                     console.log(user)\n                     getFacilities(user) */}LocationServ.on('created',function(obj){return getFacilities();});LocationServ.on('updated',function(obj){return getFacilities();});LocationServ.on('patched',function(obj){return getFacilities();});LocationServ.on('removed',function(obj){return getFacilities();});return function(){};},[]);//todo: pagination and vertical scroll bar\nreturn/*#__PURE__*/_jsx(_Fragment,{children:user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"level\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"level-left\",children:/*#__PURE__*/_jsx(\"div\",{className:\"level-item\",children:/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left  \",children:[/*#__PURE__*/_jsx(DebounceInput,{className:\"input is-small \",type:\"text\",placeholder:\"Search Locations\",minLength:3,debounceTimeout:400,onChange:function onChange(e){return handleSearch(e.target.value);}}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search\"})})]})})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"level-item\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"is-size-6 has-text-weight-medium\",children:\"List of Accounts \"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"level-right\",children:/*#__PURE__*/_jsx(\"div\",{className:\"level-item\",children:/*#__PURE__*/_jsx(\"div\",{className:\"level-item\",children:/*#__PURE__*/_jsx(\"div\",{className:\"button is-success is-small\",onClick:handleCreateNew,children:\"New\"})})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container pullup  vscrola\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Serial No\",children:\"S/No\"})}),/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Account Type\",children:\"Account Type\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Account Class\",children:\"Class\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Subclass\",children:\"Subclass\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Code\",children:\"Code\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Description\",children:\"Description\"})}),user.stacker&&/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Facility\",children:\"Facility\"})})]})}),/*#__PURE__*/_jsx(\"tfoot\",{}),/*#__PURE__*/_jsx(\"tbody\",{children:facilities.map(function(Location,i){return/*#__PURE__*/_jsxs(\"tr\",{onClick:function onClick(){return handleRow(Location);},className:Location._id===((selectedLocation===null||selectedLocation===void 0?void 0:selectedLocation._id)||null)?\"is-selected\":\"\",children:[/*#__PURE__*/_jsx(\"th\",{children:i+1}),/*#__PURE__*/_jsx(\"th\",{children:Location.accountName}),/*#__PURE__*/_jsx(\"td\",{children:Location.accountType}),/*#__PURE__*/_jsx(\"td\",{children:Location.class}),/*#__PURE__*/_jsx(\"td\",{children:Location.subclass}),/*#__PURE__*/_jsx(\"td\",{children:Location.code}),/*#__PURE__*/_jsx(\"td\",{children:Location.description}),user.stacker&&/*#__PURE__*/_jsx(\"td\",{children:Location.facility})]},Location._id);})})]})})]}):/*#__PURE__*/_jsx(\"div\",{children:\"loading\"})});}","map":{"version":3,"sources":["/home/mfybaby/Documents/HealthStack2/HS-frontend/src/components/Accounts/Ledgers.js"],"names":["React","useState","useContext","useEffect","useRef","client","DebounceInput","useForm","UserContext","ObjectContext","toast","searchfacility","Ledgers","state","selectedInventory","setSelectedInventory","alert","SelectedClient","show","LedgerAccount","register","handleSubmit","setValue","error","setError","success","setSuccess","message","setMessage","facility","setFacility","InventoryServ","service","SubwalletServ","user","setState","currentUser","setCurrentUser","balance","setBalance","clientSel","getSearchfacility","obj","getaccountdetails","getBalance","find","query","currentEmployee","facilityDetail","_id","$sort","createdAt","then","res","console","log","data","type","dismissible","pauseOnHover","catch","err","organization","$limit","findProductEntry","length","amount","onSubmit","e","preventDefault","fromName","map","Inventory","i","category","Date","toLocaleString","paymentmode","description","LedgerList","LocationServ","facilities","setFacilities","selectedLocation","setSelectedLocation","setUser","handleCreateNew","newLocationModule","selectedAccount","prevstate","ChartAccountModule","handleRow","Location","handleSearch","val","field","$regex","$options","accountType","getFacilities","findLocation","stacker","on","target","value","accountName","class","subclass","code"],"mappings":"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","sourcesContent":["/* eslint-disable */\nimport React, {useState,useContext, useEffect,useRef} from 'react'\nimport client from '../../feathers'\nimport {DebounceInput} from 'react-debounce-input';\nimport { useForm } from \"react-hook-form\";\n//import {useHistory} from 'react-router-dom'\nimport {UserContext,ObjectContext} from '../../context'\nimport {toast} from 'bulma-toast'\n/* import FacilityAccount from \"./FacilityAccount\" */\n// eslint-disable-next-line\nconst searchfacility={};\n\n\nexport default function Ledgers() {\n    const {state}=useContext(ObjectContext) //,setState\n    // eslint-disable-next-line\n    const [selectedInventory,setSelectedInventory]=useState()\n    alert(\"ledger\")\n    //const [showState,setShowState]=useState() //create|modify|detail\n    \n    return(\n        <section className= \"section remPadTop\">\n           {/*  <div className=\"level\">\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Inventory  Module</span></div>\n            </div> */}\n            <div className=\"columns \">\n                <div className=\"column is-5 \">\n                    <LedgerList />\n                </div>\n           <div className=\"column is-7 \">\n          \n                { (state.SelectedClient.show ==='detail') && <LedgerAccount />}\n                {/*  {(state.InventoryModule.show ==='detail')&&<InventoryDetail  />}\n                {(state.InventoryModule.show ==='modify')&&<InventoryModify Inventory={selectedInventory} />}*/}\n               \n            </div> \n\n            </div>                            \n            </section>\n       \n    )\n    \n}\n\nexport function LedgerAccount(){\n    const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \n    const [error, setError] =useState(false)\n    const [success, setSuccess] =useState(false)\n    const [message,setMessage] = useState(\"\")\n    // eslint-disable-next-line\n    const [facility,setFacility] = useState([])\n    const InventoryServ=client.service('subwallettransactions')\n    const SubwalletServ=client.service('subwallet')\n    //const history = useHistory()\n    const {user} = useContext(UserContext) //,setUser\n    const {state,setState}=useContext(ObjectContext)\n    // eslint-disable-next-line\n    const [currentUser,setCurrentUser] = useState()\n    const [balance, setBalance]=useState(0)\n\n\n    const clientSel= state.SelectedClient.client\n    const getSearchfacility=(obj)=>{\n      /*   \n        setValue(\"facility\", obj._id,  {\n            shouldValidate: true,\n            shouldDirty: true\n        }) */\n    }\n    \n    useEffect(() => {\n        setCurrentUser(user)\n        //console.log(currentUser)\n        return () => {\n        \n        }\n    }, [user])\n\n  //check user for facility or get list of facility  \n   /*  useEffect(()=>{\n        //setFacility(user.activeInventory.FacilityId)//\n      if (!user.stacker){\n          console.log(currentUser)\n        setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\n            shouldValidate: true,\n            shouldDirty: true\n        }) \n      }\n    }) */\n\n    useEffect(() => {\n        getaccountdetails()\n        getBalance()\n        return () => {\n           \n        }\n    }, [clientSel])\n\n\n\n    const getaccountdetails=()=>{\n        InventoryServ.find({query: {\n            facility:user.currentEmployee.facilityDetail._id,\n            client:clientSel.client,\n           // storeId:state.StoreModule.selectedStore._id,\n           // category:\"credit\",\n            \n            $sort: {\n                createdAt: -1\n            }\n            }})\n        .then((res)=>{\n                console.log(res)\n                setFacility(res.data)\n                //e.target.reset();\n               /*  setMessage(\"Created Inventory successfully\") */\n               // setSuccess(true)\n                toast({\n                    message: 'Account details succesful',\n                    type: 'is-success',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n                 // setSuccess(false)\n            })\n            .catch((err)=>{\n                toast({\n                    message: 'Error getting account details ' + err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n            })\n    }\n\n    const getBalance=async ()=>{\n        const findProductEntry= await SubwalletServ.find(\n            {query: {\n               \n                client:clientSel.client,\n                organization:user.currentEmployee.facilityDetail._id,\n                //storeId:state.StoreModule.selectedStore._id,\n                //clientId:state.ClientModule.selectedClient._id,\n                $limit:100,\n                $sort: {\n                    createdAt: -1\n                }\n                }})\n                 console.log(findProductEntry)\n    \n         // console.log(\"balance\", findProductEntry.data[0].amount)\n            if (findProductEntry.data.length>0){\n                await setBalance(findProductEntry.data[0].amount)\n            }else{\n                await setBalance(0) \n                \n            } \n    \n          //  await setState((prevstate)=>({...prevstate, currentClients:findProductEntry.groupedOrder}))\n            }   \n    \n\n    const onSubmit = (data,e) =>{\n        e.preventDefault();\n        setMessage(\"\")\n        setError(false)\n        setSuccess(false)\n         // data.createdby=user._id\n          console.log(data);\n          if (user.currentEmployee){\n         data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\n          }\n        \n\n      } \n    \n\n    return (\n        <>\n            <div className=\"card cardheight\">\n                <div className=\"card-header\">\n                    <p className=\"card-header-title\">\n                        Account Details: {facility[0]?.fromName}\n                    </p>\n                    <button className=\"button is-success is-small btnheight mt-2\" >\n                    Current Balance: N {balance}\n                 </button>\n                </div>\n                <div className=\"card-content \">\n                \n           {/*  <div className=\"level\"> vscrollable\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Inventory  Module</span></div>\n            </div> */}\n            <div className=\"columns \">\n                <div className=\"column is-6 \">\n                    <div className=\"card cardht80\">\n                            <div className=\"card-header\">\n                                <p className=\"card-header-title\">\n                                    Credit\n                                </p>\n                            </div>\n                            <div className=\"card-content vscrollable mx-0.5\">\n                                   \n                                    <div className=\"table-container pullup \">\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable mx-0.5\">\n                                    <thead>\n                                        <tr>\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\n                                        <th><abbr title=\"Cost Price\">Date</abbr></th>\n                                        <th><abbr title=\"Quantity\">Amount</abbr></th>\n                                        <th><abbr title=\"Base Unit\">Mode</abbr></th>\n                                       {/*  <th><abbr title=\"Stock Value\">Stock Value</abbr></th>\n                                         \n                                        <th><abbr title=\"Selling Price\">Selling Price</abbr></th>\n                                        <th><abbr title=\"Re-Order Level\">Re-Order Level</abbr></th>\n                                        <th><abbr title=\"Expiry\">Expiry</abbr></th> \n                                        <th><abbr title=\"Actions\">Actions</abbr></th> */}\n                                        </tr>\n                                    </thead>\n                                    <tfoot>\n                                        \n                                    </tfoot>\n                                    <tbody>\n                                        {facility.map((Inventory, i)=>(\n                                        <>\n                                        {Inventory.category===\"credit\" && \n                                            <tr key={Inventory._id} >\n                                            <th>{i+1}</th>\n                                            <td>{new Date(Inventory.createdAt).toLocaleString('en-GB')}</td> {/*add time  */}\n                                            \n                                            <td>{Inventory.amount}</td>\n                                            <td>{Inventory.paymentmode}</td>\n                                            {/* <td>{Inventory.stockvalue}</td>\n                                            <td>{Inventory.costprice}</td>\n                                            <td>{Inventory.sellingprice}</td>\n                                            <td>{Inventory.reorder_level}</td> \n                                            <td>{Inventory.expiry}</td>\n                                            <td><span   className=\"showAction\"  >...</span></td> */}\n                                           \n                                            </tr>\n                                             }\n                                             </>\n                                        ))}\n                                    </tbody>\n                                    </table>\n                                    \n                </div>              \n                                   \n                            </div>\n                    </div>\n                </div>\n           <div className=\"column is-6 \">\n                <div className=\"card cardht80\">\n                            <div className=\"card-header\">\n                                <p className=\"card-header-title\">\n                                Debit\n                                </p>\n                            </div>\n                            <div className=\"card-content vscrollable mx-0.5\">\n                                   \n                                    <div className=\"table-container pullup \">\n                                <table className=\"table is-striped is-narrow is-hoverable  is-scrollable mx-0.5\">\n                                    <thead>\n                                        <tr>\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\n                                        <th><abbr title=\"Cost Price\">Date</abbr></th>\n                                         <th><abbr title=\"Description\">Description</abbr></th> \n                                        \n                                        <th><abbr title=\"Quantity\">Amount</abbr></th>\n                                        <th><abbr title=\"Base Unit\">Mode</abbr></th>\n                                       {/*  <th><abbr title=\"Stock Value\">Stock Value</abbr></th>\n                                         \n                                        <th><abbr title=\"Selling Price\">Selling Price</abbr></th>\n                                        <th><abbr title=\"Re-Order Level\">Re-Order Level</abbr></th>\n                                        <th><abbr title=\"Expiry\">Expiry</abbr></th> \n                                        <th><abbr title=\"Actions\">Actions</abbr></th> */}\n                                        </tr>\n                                    </thead>\n                                    <tfoot>\n                                        \n                                    </tfoot>\n                                    <tbody>\n                                        {facility.map((Inventory, i)=>(\n                                        <>\n                                          {Inventory.category===\"debit\" && <tr key={Inventory._id} >\n                                            <th>{i+1}</th>\n                                            <td>{new Date(Inventory.createdAt).toLocaleString('en-GB')}</td> {/*add time  */}\n                                            <th>{Inventory.description}</th>\n                                            <td>{Inventory.amount}</td>\n                                            <td>{Inventory.paymentmode}</td>\n                                            {/* <td>{Inventory.stockvalue}</td>\n                                            <td>{Inventory.costprice}</td>\n                                            <td>{Inventory.sellingprice}</td>\n                                            <td>{Inventory.reorder_level}</td> \n                                            <td>{Inventory.expiry}</td>\n                                            <td><span   className=\"showAction\"  >...</span></td> */}\n                                           \n                                            </tr>\n\n                                            }\n                                        </>\n                                        ))}\n                                    </tbody>\n                                    </table>\n                                    \n                </div>              \n                                    \n                            </div>\n                    </div>\n               \n            </div> \n\n            </div>                            \n           \n            \n                </div>\n            </div>\n        </>\n    )\n   \n}\n\nexport function LedgerList(){\n    // const { register, handleSubmit, watch, errors } = useForm();\n     // eslint-disable-next-line\n     const [error, setError] =useState(false)\n      // eslint-disable-next-line\n     const [success, setSuccess] =useState(false)\n      // eslint-disable-next-line\n    const [message, setMessage] = useState(\"\") \n     const LocationServ=client.service('chartsofaccount')\n     //const history = useHistory()\n    // const {user,setUser} = useContext(UserContext)\n     const [facilities,setFacilities]=useState([])\n      // eslint-disable-next-line\n    const [selectedLocation, setSelectedLocation]=useState() //\n     // eslint-disable-next-line\n     const {state,setState}=useContext(ObjectContext)\n     // eslint-disable-next-line\n     const {user,setUser}=useContext(UserContext)\n \n \n \n     const handleCreateNew = async()=>{\n         const    newLocationModule={\n             selectedAccount:{},\n             show :'create'\n             }\n        await setState((prevstate)=>({...prevstate,  ChartAccountModule:newLocationModule}))\n        //console.log(state)\n         \n \n     }\n     const handleRow= async(Location)=>{\n         //console.log(\"b4\",state)\n \n         //console.log(\"handlerow\",Location)\n \n         await setSelectedLocation(Location)\n \n         const    newLocationModule={\n             selectedAccount:Location,\n             show :'detail'\n         }\n        await setState((prevstate)=>({...prevstate,  ChartAccountModule:newLocationModule}))\n        //console.log(state)\n \n     }\n \n    const handleSearch=(val)=>{\n        const field='name'\n        console.log(val)\n        LocationServ.find({query: {\n                 [field]: {\n                     $regex:val,\n                     $options:'i'\n                    \n                 },\n                facility:user.currentEmployee.facilityDetail._id || \"\",\n                 $limit:100,\n                 $sort: {\n                     accountType: 1\n                   }\n                     }}).then((res)=>{\n                 console.log(res)\n                setFacilities(res.data)\n                 setMessage(\" Location  fetched successfully\")\n                 setSuccess(true) \n             })\n             .catch((err)=>{\n                 console.log(err)\n                 setMessage(\"Error fetching Location, probable network issues \"+ err )\n                 setError(true)\n             })\n         }\n    \n         const getFacilities= async()=>{\n             if (user.currentEmployee){\n             \n         const findLocation= await LocationServ.find(\n                 {query: {\n                    /*  facility:user.currentEmployee.facilityDetail._id, */\n                     $limit:2000,\n                     $sort: {\n                         accountType: 1\n                     }\n                     }})\n \n          await setFacilities(findLocation.data)\n                 }\n                 else {\n                     if (user.stacker){\n                         const findLocation= await LocationServ.find(\n                             {query: {\n                                 \n                                 $limit:2000,\n                                 $sort: {\n                                     accountType: 1\n                                 }\n                                 }})\n             \n                     await setFacilities(findLocation.data)\n \n                     }\n                 }\n           /*   .then((res)=>{\n                 console.log(res)\n                     setFacilities(res.data)\n                     setMessage(\" Location  fetched successfully\")\n                     setSuccess(true)\n                 })\n                 .catch((err)=>{\n                     setMessage(\"Error creating Location, probable network issues \"+ err )\n                     setError(true)\n                 }) */\n             }\n             \n             useEffect(() => {\n              \n \n                 return () => {\n                     \n \n                 }\n             },[])\n \n             useEffect(() => {\n                \n                 if (user){\n                     getFacilities()\n                 }else{\n                     /* const localUser= localStorage.getItem(\"user\")\n                     const user1=JSON.parse(localUser)\n                     console.log(localUser)\n                     console.log(user1)\n                     fetchUser(user1)\n                     console.log(user)\n                     getFacilities(user) */\n                 }\n                 LocationServ.on('created', (obj)=>getFacilities())\n                 LocationServ.on('updated', (obj)=>getFacilities())\n                 LocationServ.on('patched', (obj)=>getFacilities())\n                 LocationServ.on('removed', (obj)=>getFacilities())\n                 return () => {\n                 \n                 }\n             },[])\n \n \n     //todo: pagination and vertical scroll bar\n \n     return(\n         <>\n            {user?( <>  \n                 <div className=\"level\">\n                     <div className=\"level-left\">\n                         <div className=\"level-item\">\n                             <div className=\"field\">\n                                 <p className=\"control has-icons-left  \">\n                                     <DebounceInput className=\"input is-small \" \n                                         type=\"text\" placeholder=\"Search Locations\"\n                                         minLength={3}\n                                         debounceTimeout={400}\n                                         onChange={(e)=>handleSearch(e.target.value)} />\n                                     <span className=\"icon is-small is-left\">\n                                         <i className=\"fas fa-search\"></i>\n                                     </span>\n                                 </p>\n                             </div>\n                         </div>\n                     </div>\n                     <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Accounts </span></div>\n                     <div className=\"level-right\">\n                         <div className=\"level-item\"> \n                             <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\n                         </div>\n                     </div>\n \n                 </div>\n                 <div className=\"table-container pullup  vscrola\">\n                                 <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\n                                     <thead>\n                                         <tr>\n                                         <th><abbr title=\"Serial No\">S/No</abbr></th>\n                                         <th>Name</th>\n                                         <th><abbr title=\"Account Type\">Account Type</abbr></th>\n                                        <th><abbr title=\"Account Class\">Class</abbr></th>\n                                          <th><abbr title=\"Subclass\">Subclass</abbr></th>\n                                          <th><abbr title=\"Code\">Code</abbr></th>\n                                         <th><abbr title=\"Description\">Description</abbr></th>\n                                         \n                                        {/*  <th><abbr title=\"Departmental Unit\">Departmental Unit</abbr></th>  */}\n                                        {user.stacker && <th><abbr title=\"Facility\">Facility</abbr></th>}\n                                         {/* <th><abbr title=\"Actions\">Actions</abbr></th> */}\n                                         </tr>\n                                     </thead>\n                                     <tfoot>\n                                         \n                                     </tfoot>\n                                     <tbody>\n                                         {facilities.map((Location, i)=>(\n \n                                             <tr key={Location._id} onClick={()=>handleRow(Location)} className={Location._id===(selectedLocation?._id||null)?\"is-selected\":\"\"}>\n                                             <th>{i+1}</th>\n                                             <th>{Location.accountName}</th>\n                                             <td>{Location.accountType}</td>\n                                             <td>{Location.class}</td>\n                                             <td>{Location.subclass}</td>\n                                             <td>{Location.code}</td>\n                                             <td>{Location.description}</td>\n                                                {/*  <td>{Location.deptunit}</td>  */}\n                                            {user.stacker &&  <td>{Location.facility}</td>}\n                                            {/*  <td><span   className=\"showAction\"  >...</span></td> */}\n                                            \n                                             </tr>\n \n                                         ))}\n                                     </tbody>\n                                     </table>\n                                     \n                 </div>              \n             </>):<div>loading</div>}\n             </>\n               \n     )\n     }"]},"metadata":{},"sourceType":"module"}