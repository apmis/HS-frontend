{"ast":null,"code":"import _defineProperty from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable */import React,{useState,useContext,useEffect,useRef}from'react';import client from'../../feathers';import{DebounceInput}from'react-debounce-input';import{useForm}from\"react-hook-form\";//import {useHistory} from 'react-router-dom'\nimport{UserContext,ObjectContext}from'../../context';import{toast}from'bulma-toast';import{ProductCreate}from'./Products';import{formatDistanceToNowStrict,format,subDays,addDays}from'date-fns';import DatePicker from\"react-datepicker\";import InfiniteScroll from\"react-infinite-scroll-component\";import\"react-datepicker/dist/react-datepicker.css\";// eslint-disable-next-line\nvar searchfacility={};export default function ProductEntry(){var _useContext=useContext(ObjectContext),state=_useContext.state;//,setState\n// eslint-disable-next-line\nvar _useState=useState(),_useState2=_slicedToArray(_useState,2),selectedProductEntry=_useState2[0],setSelectedProductEntry=_useState2[1];//const [showState,setShowState]=useState() //create|modify|detail\nreturn/*#__PURE__*/_jsx(\"section\",{className:\"section remPadTop\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"columns \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"column is-6 \",children:/*#__PURE__*/_jsx(ProductEntryList,{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"column is-6 \",children:[state.ProductEntryModule.show==='create'&&/*#__PURE__*/_jsx(ProductEntryCreate,{}),state.ProductEntryModule.show==='detail'&&/*#__PURE__*/_jsx(ProductEntryDetail,{}),state.ProductEntryModule.show==='modify'&&/*#__PURE__*/_jsx(ProductEntryModify,{ProductEntry:selectedProductEntry})]})]})});}export function ProductEntryCreate(){// const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),success=_useState6[0],setSuccess=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),message=_useState8[0],setMessage=_useState8[1];// eslint-disable-next-line\nvar _useState9=useState(),_useState10=_slicedToArray(_useState9,2),facility=_useState10[0],setFacility=_useState10[1];var ProductEntryServ=client.service('productentry');//const history = useHistory()\nvar _useContext2=useContext(UserContext),user=_useContext2.user;//,setUser\n// eslint-disable-next-line\nvar _useState11=useState(),_useState12=_slicedToArray(_useState11,2),currentUser=_useState12[0],setCurrentUser=_useState12[1];var _useState13=useState(\"Purchase Invoice\"),_useState14=_slicedToArray(_useState13,2),type=_useState14[0],setType=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),documentNo=_useState16[0],setDocumentNo=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),totalamount=_useState18[0],setTotalamount=_useState18[1];var _useState19=useState(\"\"),_useState20=_slicedToArray(_useState19,2),productId=_useState20[0],setProductId=_useState20[1];var _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),source=_useState22[0],setSource=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),date=_useState24[0],setDate=_useState24[1];var _useState25=useState(\"\"),_useState26=_slicedToArray(_useState25,2),name=_useState26[0],setName=_useState26[1];var _useState27=useState(\"\"),_useState28=_slicedToArray(_useState27,2),baseunit=_useState28[0],setBaseunit=_useState28[1];var _useState29=useState(\"\"),_useState30=_slicedToArray(_useState29,2),quantity=_useState30[0],setQuantity=_useState30[1];var _useState31=useState(\"\"),_useState32=_slicedToArray(_useState31,2),costprice=_useState32[0],setCostprice=_useState32[1];var _useState33=useState([]),_useState34=_slicedToArray(_useState33,2),productItem=_useState34[0],setProductItem=_useState34[1];var _useContext3=useContext(ObjectContext),state=_useContext3.state;/*  const [productEntry,setProductEntry]=useState({\n        productitems:[],\n        date,\n        documentNo,\n        type,\n        totalamount,\n        source,\n\n    })\n  */var productItemI={productId:productId,name:name,quantity:quantity,costprice:costprice,amount:quantity*costprice,baseunit:baseunit};// consider batchformat{batchno,expirydate,qtty,baseunit}\n//consider baseunoit conversions\nvar getSearchfacility=function getSearchfacility(obj){setProductId(obj._id);setName(obj.name);setBaseunit(obj.baseunit);/*  setValue(\"facility\", obj._id,  {\n            shouldValidate: true,\n            shouldDirty: true\n        }) */};useEffect(function(){setCurrentUser(user);//console.log(currentUser)\nreturn function(){};},[user]);var handleChangeType=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return setType(e.target.value);case 2:case\"end\":return _context.stop();}}},_callee);}));return function handleChangeType(_x){return _ref.apply(this,arguments);};}();var handleClickProd=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(!productId||!quantity||!costprice)){_context2.next=3;break;}toast({message:'Kindly choose Product,price and quantity',type:'is-danger',dismissible:true,pauseOnHover:true});return _context2.abrupt(\"return\");case 3:_context2.next=5;return setSuccess(false);case 5:setProductItem(function(prevProd){return prevProd.concat(productItemI);});setName(\"\");setBaseunit(\"\");setQuantity(\"\");setCostprice(\"\");_context2.next=12;return setSuccess(true);case 12:case\"end\":return _context2.stop();}}},_callee2);}));return function handleClickProd(){return _ref2.apply(this,arguments);};}();var handleDate=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(date){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setDate(date);case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function handleDate(_x2){return _ref3.apply(this,arguments);};}();var resetform=function resetform(){setType(\"Purchase Invoice\");setDocumentNo(\"\");setTotalamount(\"\");setProductId(\"\");setSource(\"\");setDate(\"\");setName(\"\");setBaseunit(\"\");setCostprice(\"\");setProductItem([]);};var onSubmit=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e){var confirm,productEntry;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:confirm=window.confirm(\"Are you sure you want to save this entry ?\");if(!confirm){_context4.next=26;break;}e.preventDefault();setMessage(\"\");setError(false);setSuccess(false);if(date){_context4.next=9;break;}toast({message:'Kindly choose date',type:'is-danger',dismissible:true,pauseOnHover:true});return _context4.abrupt(\"return\");case 9:productEntry={date:date,documentNo:documentNo,type:type,totalamount:totalamount,source:source};productEntry.productitems=productItem;productEntry.createdby=user._id;productEntry.transactioncategory=\"credit\";//console.log(\"b4 facility\",productEntry);\nif(!user.currentEmployee){_context4.next=17;break;}productEntry.facility=user.currentEmployee.facilityDetail._id;// or from facility dropdown\n_context4.next=19;break;case 17:toast({message:'You can not add inventory to any organization',type:'is-danger',dismissible:true,pauseOnHover:true});return _context4.abrupt(\"return\");case 19:if(!state.StoreModule.selectedStore._id){_context4.next=23;break;}productEntry.storeId=state.StoreModule.selectedStore._id;_context4.next=25;break;case 23:toast({message:'You need to select a store before adding inventory',type:'is-danger',dismissible:true,pauseOnHover:true});return _context4.abrupt(\"return\");case 25://console.log(\"b4 create\",productEntry);\nProductEntryServ.create(productEntry).then(function(res){//console.log(JSON.stringify(res))\nresetform();/*  setMessage(\"Created ProductEntry successfully\") */setSuccess(true);toast({message:'ProductEntry created succesfully',type:'is-success',dismissible:true,pauseOnHover:true});setSuccess(false);setProductItem([]);}).catch(function(err){toast({message:'Error creating ProductEntry '+err,type:'is-danger',dismissible:true,pauseOnHover:true});});case 26:case\"end\":return _context4.stop();}}},_callee4);}));return function onSubmit(_x3){return _ref4.apply(this,arguments);};}();var removeEntity=function removeEntity(entity,i){//console.log(entity)\nsetProductItem(function(prev){return prev.filter(function(obj,index){return index!==i;});});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card card-overflow\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-header-title\",children:\"Create ProductEntry: Initialization, Purchase Invoice, Audit\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content \",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,children:[\" \",/*#__PURE__*/_jsx(\"div\",{className:\"field is-horizontal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"field-body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:/*#__PURE__*/_jsx(\"div\",{className:\"select is-small\",children:/*#__PURE__*/_jsxs(\"select\",{name:\"type\",value:type,onChange:handleChangeType,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Choose Type \"}),/*#__PURE__*/_jsx(\"option\",{value:\"Purchase Invoice\",children:\"Purchase Invoice \"}),/*#__PURE__*/_jsx(\"option\",{value:\"Initialization\",children:\"Initialization\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Audit\",children:\"Audit\"})]})})})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left has-icons-right\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\"/* ref={register({ required: true })} */,value:source,name:\"supplier\",type:\"text\",onChange:function onChange(e){return setSource(e.target.value);},placeholder:\"Supplier\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-hospital\"})})]})})]})}),\" \",/*#__PURE__*/_jsx(\"div\",{className:\"field is-horizontal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"field-body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"div\",{className:\"control has-icons-left has-icons-right\",children:/*#__PURE__*/_jsx(DatePicker,{selected:date,onChange:function onChange(date){return handleDate(date);},dateFormat:\"dd/MM/yyyy\",placeholderText:\"Pick Date\"//isClearable\n})})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\"/* ref={register} */,name:\"documentNo\",value:documentNo,type:\"text\",onChange:function onChange(e){return setDocumentNo(e.target.value);},placeholder:\" Invoice Number\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-phone-alt\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\"/* ref={register({ required: true })} */,value:totalamount,name:\"totalamount\",type:\"text\",onChange:/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(e){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return setTotalamount(e.target.value);case 2:return _context5.abrupt(\"return\",_context5.sent);case 3:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x4){return _ref5.apply(this,arguments);};}(),placeholder:\" Total Amount\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-coins\"})})]})})]})})]}),/*#__PURE__*/_jsx(\"label\",{className:\"label is-small\",children:\"Add Product Items:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field is-horizontal\",children:/*#__PURE__*/_jsx(\"div\",{className:\"field-body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"field is-expanded\"/* style={ !user.stacker?{display:\"none\"}:{}} */,children:[/*#__PURE__*/_jsx(ProductSearch,{getSearchfacility:getSearchfacility,clear:success}),/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left \",style:{display:\"none\"},children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\"/* ref={register ({ required: true }) }  */ /* add array no */,value:productId,name:\"productId\",type:\"text\",onChange:function onChange(e){return setProductId(e.target.value);},placeholder:\"Product Id\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas  fa-map-marker-alt\"})})]})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"field is-horizontal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"field-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\"/* ref={register({ required: true })} */,name:\"quantity\",value:quantity,type:\"text\",onChange:function onChange(e){return setQuantity(e.target.value);},placeholder:\"Quantity\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-envelope\"})})]}),/*#__PURE__*/_jsx(\"label\",{children:baseunit})]}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\"/* ref={register({ required: true })} */,name:\"costprice\",value:costprice,type:\"text\",onChange:function onChange(e){return setCostprice(e.target.value);},placeholder:\"Cost Price\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-dollar-sign\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-info is-small  is-pulled-right minHt\",children:/*#__PURE__*/_jsx(\"span\",{className:\"is-small\",onClick:handleClickProd,children:\" +\"})})})})]})}),productItem.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Product Items:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container  vscrol\",id:\"scrollableDiv\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table is-striped  is-hoverable is-fullwidth is-scrollable \",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Serial No\",children:\"S/No\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Type\",children:\"Name\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Type\",children:\"Quanitity\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Document No\",children:\"Unit\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Cost Price\",children:\"Cost Price\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Cost Price\",children:\"Amount\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Actions\",children:\"Actions\"})})]})}),/*#__PURE__*/_jsx(\"tfoot\",{}),/*#__PURE__*/_jsx(\"tbody\",{children:productItem.map(function(ProductEntry,i){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:i+1}),/*#__PURE__*/_jsx(\"td\",{children:ProductEntry.name}),/*#__PURE__*/_jsx(\"th\",{children:ProductEntry.quantity}),/*#__PURE__*/_jsx(\"td\",{children:ProductEntry.baseunit}),/*#__PURE__*/_jsx(\"td\",{children:ProductEntry.costprice}),/*#__PURE__*/_jsx(\"td\",{children:ProductEntry.amount}),/*#__PURE__*/_jsx(\"td\",{onClick:function onClick(){return removeEntity(ProductEntry,i);},children:/*#__PURE__*/_jsx(\"span\",{className:\"showAction\",children:\"x\"})})]},i);})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"field mt-2\",children:/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-success is-small\",disabled:!productItem.length>0,onClick:onSubmit,children:\"Create\"})})})]})]})]})});}export function ProductEntryList(){// const { register, handleSubmit, watch, errors } = useForm();\n// eslint-disable-next-line\nvar _useState35=useState(false),_useState36=_slicedToArray(_useState35,2),error=_useState36[0],setError=_useState36[1];// eslint-disable-next-line\nvar _useState37=useState(false),_useState38=_slicedToArray(_useState37,2),success=_useState38[0],setSuccess=_useState38[1];// eslint-disable-next-line\nvar _useState39=useState(\"\"),_useState40=_slicedToArray(_useState39,2),message=_useState40[0],setMessage=_useState40[1];var ProductEntryServ=client.service('productentry');//const history = useHistory()\n// const {user,setUser} = useContext(UserContext)\nvar _useState41=useState([]),_useState42=_slicedToArray(_useState41,2),facilities=_useState42[0],setFacilities=_useState42[1];// eslint-disable-next-line\nvar _useState43=useState(),_useState44=_slicedToArray(_useState43,2),selectedProductEntry=_useState44[0],setSelectedProductEntry=_useState44[1];//\n// eslint-disable-next-line\nvar _useContext4=useContext(ObjectContext),state=_useContext4.state,setState=_useContext4.setState;// eslint-disable-next-line\nvar _useContext5=useContext(UserContext),user=_useContext5.user,setUser=_useContext5.setUser;var _useState45=useState(0),_useState46=_slicedToArray(_useState45,2),page=_useState46[0],setPage=_useState46[1];var _useState47=useState(20),_useState48=_slicedToArray(_useState47,2),limit=_useState48[0],setLimit=_useState48[1];var _useState49=useState(0),_useState50=_slicedToArray(_useState49,2),total=_useState50[0],setTotal=_useState50[1];var _useState51=useState(true),_useState52=_slicedToArray(_useState51,2),restful=_useState52[0],setRestful=_useState52[1];var _useState53=useState(false),_useState54=_slicedToArray(_useState53,2),next=_useState54[0],setNext=_useState54[1];var handleCreateNew=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var newProductEntryModule;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:newProductEntryModule={selectedProductEntry:{},show:'create'};_context6.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{ProductEntryModule:newProductEntryModule});});case 3:case\"end\":return _context6.stop();}}},_callee6);}));return function handleCreateNew(){return _ref6.apply(this,arguments);};}();var handleRow=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(ProductEntry){var newProductEntryModule;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return setSelectedProductEntry(ProductEntry);case 2:newProductEntryModule={selectedProductEntry:ProductEntry,show:'detail'};_context7.next=5;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{ProductEntryModule:newProductEntryModule});});case 5:case\"end\":return _context7.stop();}}},_callee7);}));return function handleRow(_x5){return _ref7.apply(this,arguments);};}();var handleSearch=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(val){var field;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:field='source';//console.log(val)\nProductEntryServ.find({query:{$or:[{source:{$regex:val,$options:'i'}},{type:{$regex:val,$options:'i'}}],storeId:state.StoreModule.selectedStore._id,facility:user.currentEmployee.facilityDetail._id||\"\",$limit:100,$sort:{createdAt:-1}}}).then(function(res){//console.log(res)\nsetFacilities(res.data);setTotal(res.total);setMessage(\" ProductEntry  fetched successfully\");setSuccess(true);}).catch(function(err){//  console.log(err)\nsetMessage(\"Error fetching ProductEntry, probable network issues \"+err);setError(true);});case 2:case\"end\":return _context8.stop();}}},_callee8);}));return function handleSearch(_x6){return _ref8.apply(this,arguments);};}();var getFacilities=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){var findProductEntry,_findProductEntry;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:if(!user.currentEmployee){_context9.next=11;break;}_context9.next=3;return ProductEntryServ.find({query:{facility:user.currentEmployee.facilityDetail._id,storeId:state.StoreModule.selectedStore._id,$limit:limit,$skip:page*limit,/*  $limit:20, */$sort:{createdAt:-1}}});case 3:findProductEntry=_context9.sent;_context9.next=6;return setTotal(findProductEntry.total);case 6:_context9.next=8;return setFacilities(function(prevstate){return prevstate.concat(findProductEntry.data);});case 8:if(findProductEntry.total>findProductEntry.skip){setNext(true);setPage(function(page){return page+1;});}else{setNext(false);}_context9.next=17;break;case 11:if(!user.stacker){_context9.next=17;break;}_context9.next=14;return ProductEntryServ.find({query:{$limit:20,$sort:{createdAt:-1}}});case 14:_findProductEntry=_context9.sent;_context9.next=17;return setFacilities(_findProductEntry.data);case 17:case\"end\":return _context9.stop();}}},_callee9);}));return function getFacilities(){return _ref9.apply(this,arguments);};}();var getNewFacilities=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(){var findProductEntry,_findProductEntry2;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:if(!user.currentEmployee){_context10.next=6;break;}_context10.next=3;return ProductEntryServ.find({query:{facility:user.currentEmployee.facilityDetail._id,storeId:state.StoreModule.selectedStore._id,$limit:limit,//$skip:page * limit,\n/*  $limit:20, */$sort:{createdAt:-1}}}).then(function(resp){setTotal(resp.total);setFacilities(resp.data);if(resp.total>resp.data.length){setNext(true);setPage(function(page){return page+1;});}else{setNext(false);}}).catch(function(err){console.log(err);});case 3:findProductEntry=_context10.sent;_context10.next=12;break;case 6:if(!user.stacker){_context10.next=12;break;}_context10.next=9;return ProductEntryServ.find({query:{$limit:20,$sort:{createdAt:-1}}});case 9:_findProductEntry2=_context10.sent;_context10.next=12;return setFacilities(_findProductEntry2.data);case 12:case\"end\":return _context10.stop();}}},_callee10);}));return function getNewFacilities(){return _ref10.apply(this,arguments);};}();var getUpdatedFacilities=/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(){var findProductEntry;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return ProductEntryServ.find({query:{facility:user.currentEmployee.facilityDetail._id,storeId:state.employeeLocation.locationId,$limit:limit,$sort:{createdAt:-1}}}).then(function(resp){setTotal(resp.total);updatelist(resp.data);//setFacilities(resp.data)\nif(resp.total>resp.data.length){setNext(true);setPage(function(page){return page+1;});}else{setNext(false);}}).catch(function(err){console.log(err);});case 2:findProductEntry=_context11.sent;case 3:case\"end\":return _context11.stop();}}},_callee11);}));return function getUpdatedFacilities(){return _ref11.apply(this,arguments);};}();useEffect(function(){if(!state.StoreModule.selectedStore){toast({message:'kindly select a store',type:'is-danger',dismissible:true,pauseOnHover:true});return;//  getFacilities()\n}ProductEntryServ.on('created',function(obj){return getUpdatedFacilities();});ProductEntryServ.on('updated',function(obj){return getUpdatedFacilities();});ProductEntryServ.on('patched',function(obj){return getUpdatedFacilities();});ProductEntryServ.on('removed',function(obj){return getUpdatedFacilities();});return function(){};},[]);var updatelist=/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(data){return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return setFacilities(data);case 2:case\"end\":return _context12.stop();}}},_callee12);}));return function updatelist(_x7){return _ref12.apply(this,arguments);};}();var updates=function updates(){// setFacilities([])\nrest1();};useEffect(function(){rest1();return function(){};},[state.StoreModule.selectedStore._id]);//todo: pagination and vertical scroll bar\nvar rest1=/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(){return _regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:setPage(0);setTotal(0);getNewFacilities();case 3:case\"end\":return _context13.stop();}}},_callee13);}));return function rest1(){return _ref13.apply(this,arguments);};}();var handleDelete=/*#__PURE__*/function(){var _ref14=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee14(obj){var confirm;return _regeneratorRuntime.wrap(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:confirm=window.confirm(\"Are you sure you want to delete this entry with Document No: \".concat(obj.documentNo,\" ?\"));if(!confirm){_context14.next=4;break;}_context14.next=4;return ProductEntryServ.remove(obj._id).then(function(resp){toast({message:'Sucessfuly deleted ProductEntry ',type:'is-success',dismissible:true,pauseOnHover:true});}).catch(function(err){toast({message:'Error deleting ProductEntry '+err,type:'is-danger',dismissible:true,pauseOnHover:true});});case 4:case\"end\":return _context14.stop();}}},_callee14);}));return function handleDelete(_x8){return _ref14.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:state.StoreModule.selectedStore?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"level\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"level-left\",children:/*#__PURE__*/_jsx(\"div\",{className:\"level-item\",children:/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left  \",children:[/*#__PURE__*/_jsx(DebounceInput,{className:\"input is-small \",type:\"text\",placeholder:\"Search Type or Source\",minLength:3,debounceTimeout:400,onChange:function onChange(e){return handleSearch(e.target.value);}}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search\"})})]})})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"level-item\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"is-size-6 has-text-weight-medium\",children:\"List of Product Additions to Inventory \"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"level-right\",children:/*#__PURE__*/_jsx(\"div\",{className:\"level-item\",children:/*#__PURE__*/_jsx(\"div\",{className:\"level-item\",children:/*#__PURE__*/_jsx(\"div\",{className:\"button is-success is-small\",onClick:handleCreateNew,children:\"New\"})})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container pullup vscrola\",id:\"scrollableDiv\",children:/*#__PURE__*/_jsx(InfiniteScroll,{dataLength:facilities.length,next:getFacilities,hasMore:total>facilities.length,loader:/*#__PURE__*/_jsx(\"h4\",{children:\"Loading...\"}),scrollableTarget:\"scrollableDiv\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Serial No\",children:\"S/No\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Date\",children:\"Date\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Type\",children:\"Type\"})}),/*#__PURE__*/_jsx(\"th\",{children:\"Source\"}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Document No\",children:\"Document No\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Total Amount\",children:\"Total Amount\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Actions\",children:\"Actions\"})})]})}),/*#__PURE__*/_jsx(\"tfoot\",{}),/*#__PURE__*/_jsx(\"tbody\",{children:facilities.map(function(ProductEntry,i){return/*#__PURE__*/_jsxs(\"tr\",{onClick:function onClick(){return handleRow(ProductEntry);},children:[/*#__PURE__*/_jsx(\"th\",{children:i+1}),/*#__PURE__*/_jsx(\"td\",{children:ProductEntry.date?/*#__PURE__*/_jsx(_Fragment,{children:format(new Date(ProductEntry.date),\"dd-MM-yy HH:mm\")}):\"\"}),/*#__PURE__*/_jsx(\"th\",{children:ProductEntry.type}),/*#__PURE__*/_jsx(\"td\",{children:ProductEntry.source}),/*#__PURE__*/_jsx(\"td\",{children:ProductEntry.documentNo}),/*#__PURE__*/_jsx(\"td\",{children:ProductEntry.totalamount}),/*#__PURE__*/_jsx(\"td\",{onClick:function onClick(){return handleDelete(ProductEntry);},children:/*#__PURE__*/_jsx(\"span\",{className:\"showAction\",children:\"X\"})})]},ProductEntry._id);})})]})})})]}):/*#__PURE__*/_jsx(\"div\",{children:\"loading... \"})});}export function ProductEntryDetail(){//const { register, handleSubmit, watch, setValue } = useForm(); //errors,\n// eslint-disable-next-line\nvar _useState55=useState(false),_useState56=_slicedToArray(_useState55,2),error=_useState56[0],setError=_useState56[1];//, \n//const [success, setSuccess] =useState(false)\n// eslint-disable-next-line\nvar _useState57=useState(\"\"),_useState58=_slicedToArray(_useState57,2),message=_useState58[0],setMessage=_useState58[1];//,\n//const ProductEntryServ=client.service('/ProductEntry')\n//const history = useHistory()\n//const {user,setUser} = useContext(UserContext)\nvar _useContext6=useContext(ObjectContext),state=_useContext6.state,setState=_useContext6.setState;var ProductEntry=state.ProductEntryModule.selectedProductEntry;var handleEdit=/*#__PURE__*/function(){var _ref15=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee15(){var newProductEntryModule;return _regeneratorRuntime.wrap(function _callee15$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:newProductEntryModule={selectedProductEntry:ProductEntry,show:'modify'};_context15.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{ProductEntryModule:newProductEntryModule});});case 3:case\"end\":return _context15.stop();}}},_callee15);}));return function handleEdit(){return _ref15.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-header-title\",children:\"ProductEntry Details\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content vscrollable\",children:[/*#__PURE__*/_jsx(\"table\",{children:/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-hospital\"})}),\"Type\"]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"is-size-7 padleft\",name:\"name\",children:[\" \",ProductEntry.type,\" \"]})}),/*#__PURE__*/_jsx(\"td\",{}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small padleft\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-map-signs\"})}),\"Supplier:\"]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"is-size-7 padleft\",name:\"ProductEntryType\",children:[ProductEntry.source,\" \"]})})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-hospital\"})}),\"Date:\"]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"is-size-7 padleft\",name:\"name\",children:[\" \",format(new Date(ProductEntry.date),\"dd-MM-yy HH:mm\"),\" \"]})}),/*#__PURE__*/_jsx(\"td\",{}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small padleft\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-map-signs\"})}),\"Invoice No:\"]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"is-size-7 padleft\",name:\"ProductEntryType\",children:[ProductEntry.documentNo,\" \"]})})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-hospital\"})}),\"Total Amount:\"]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"is-size-7 padleft\",name:\"name\",children:[\" \",ProductEntry.totalamount,\" \"]})})]})]})}),/*#__PURE__*/_jsx(\"label\",{className:\"label is-size-7 mt-2\",children:\"Product Items:\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"table is-striped  is-hoverable is-fullwidth is-scrollable \",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Serial No\",children:\"S/No\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Type\",children:\"Name\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Type\",children:\"Quanitity\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Document No\",children:\"Unit\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Cost Price\",children:\"Cost Price\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Cost Price\",children:\"Amount\"})})]})}),/*#__PURE__*/_jsx(\"tfoot\",{}),/*#__PURE__*/_jsx(\"tbody\",{children:ProductEntry.productitems.map(function(ProductEntry,i){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:i+1}),/*#__PURE__*/_jsx(\"td\",{children:ProductEntry.name}),/*#__PURE__*/_jsx(\"th\",{children:ProductEntry.quantity}),/*#__PURE__*/_jsx(\"td\",{children:ProductEntry.baseunit}),/*#__PURE__*/_jsx(\"td\",{children:ProductEntry.costprice}),/*#__PURE__*/_jsx(\"td\",{children:ProductEntry.amount})]},i);})})]})]})]})});}export function ProductEntryModify(){var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue,reset=_useForm.reset,errors=_useForm.errors;//watch, errors,\n// eslint-disable-next-line \nvar _useState59=useState(false),_useState60=_slicedToArray(_useState59,2),error=_useState60[0],setError=_useState60[1];// eslint-disable-next-line \nvar _useState61=useState(false),_useState62=_slicedToArray(_useState61,2),success=_useState62[0],setSuccess=_useState62[1];// eslint-disable-next-line \nvar _useState63=useState(\"\"),_useState64=_slicedToArray(_useState63,2),message=_useState64[0],setMessage=_useState64[1];// eslint-disable-next-line \nvar ProductEntryServ=client.service('productentry');//const history = useHistory()\n// eslint-disable-next-line\nvar _useContext7=useContext(UserContext),user=_useContext7.user;var _useContext8=useContext(ObjectContext),state=_useContext8.state,setState=_useContext8.setState;var ProductEntry=state.ProductEntryModule.selectedProductEntry;useEffect(function(){setValue(\"name\",ProductEntry.name,{shouldValidate:true,shouldDirty:true});setValue(\"ProductEntryType\",ProductEntry.ProductEntryType,{shouldValidate:true,shouldDirty:true});return function(){};});var handleCancel=/*#__PURE__*/function(){var _ref16=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee16(){var newProductEntryModule;return _regeneratorRuntime.wrap(function _callee16$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:newProductEntryModule={selectedProductEntry:{},show:'create'};_context16.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{ProductEntryModule:newProductEntryModule});});case 3:case\"end\":return _context16.stop();}}},_callee16);}));return function handleCancel(){return _ref16.apply(this,arguments);};}();var changeState=function changeState(){var newProductEntryModule={selectedProductEntry:{},show:'create'};setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{ProductEntryModule:newProductEntryModule});});};var handleDelete=/*#__PURE__*/function(){var _ref17=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee17(){var conf,dleteId;return _regeneratorRuntime.wrap(function _callee17$(_context17){while(1){switch(_context17.prev=_context17.next){case 0:conf=window.confirm(\"Are you sure you want to delete this data?\");dleteId=ProductEntry._id;if(conf){ProductEntryServ.remove(dleteId).then(function(res){//console.log(JSON.stringify(res))\nreset();/*  setMessage(\"Deleted ProductEntry successfully\")\n                setSuccess(true)\n                changeState()\n               setTimeout(() => {\n                setSuccess(false)\n                }, 200); */toast({message:'ProductEntry deleted succesfully',type:'is-success',dismissible:true,pauseOnHover:true});changeState();}).catch(function(err){// setMessage(\"Error deleting ProductEntry, probable network issues \"+ err )\n// setError(true)\ntoast({message:\"Error deleting ProductEntry, probable network issues or \"+err,type:'is-danger',dismissible:true,pauseOnHover:true});});}case 3:case\"end\":return _context17.stop();}}},_callee17);}));return function handleDelete(){return _ref17.apply(this,arguments);};}();var onSubmit=function onSubmit(data,e){e.preventDefault();setSuccess(false);// console.log(data)\ndata.facility=ProductEntry.facility;//console.log(data);\nProductEntryServ.patch(ProductEntry._id,data).then(function(res){//console.log(JSON.stringify(res))\n// e.target.reset();\n// setMessage(\"updated ProductEntry successfully\")\ntoast({message:'ProductEntry updated succesfully',type:'is-success',dismissible:true,pauseOnHover:true});changeState();}).catch(function(err){//setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\n// setError(true)\ntoast({message:\"Error updating ProductEntry, probable network issues or \"+err,type:'is-danger',dismissible:true,pauseOnHover:true});});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-header-title\",children:\"ProductEntry Details-Modify\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content vscrollable\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small\",children:[\" Name\",/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left has-icons-right\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input  is-small\",ref:register({required:true}),name:\"name\",type:\"text\",placeholder:\"Name\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-hospital\"})})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small\",children:[\"ProductEntry Type\",/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left has-icons-right\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small \",ref:register({required:true}),disabled:true,name:\"ProductEntryType\",type:\"text\",placeholder:\"ProductEntry Type\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-map-signs\"})})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field  is-grouped mt-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"button is-success is-small\",onClick:handleSubmit(onSubmit),children:\"Save\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-warning is-small\",onClick:handleCancel,children:\"Cancel\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-danger is-small\",onClick:function onClick(){return handleDelete();},type:\"delete\",children:\"Delete\"})})]})]})]})});}export function ProductSearch(_ref18){var getSearchfacility=_ref18.getSearchfacility,clear=_ref18.clear;var productServ=client.service('products');var _useState65=useState([]),_useState66=_slicedToArray(_useState65,2),facilities=_useState66[0],setFacilities=_useState66[1];// eslint-disable-next-line\nvar _useState67=useState(false),_useState68=_slicedToArray(_useState67,2),searchError=_useState68[0],setSearchError=_useState68[1];// eslint-disable-next-line\nvar _useState69=useState(false),_useState70=_slicedToArray(_useState69,2),showPanel=_useState70[0],setShowPanel=_useState70[1];// eslint-disable-next-line\nvar _useState71=useState(\"\"),_useState72=_slicedToArray(_useState71,2),searchMessage=_useState72[0],setSearchMessage=_useState72[1];// eslint-disable-next-line \nvar _useState73=useState(\"\"),_useState74=_slicedToArray(_useState73,2),simpa=_useState74[0],setSimpa=_useState74[1];// eslint-disable-next-line \nvar _useState75=useState(false),_useState76=_slicedToArray(_useState75,2),chosen=_useState76[0],setChosen=_useState76[1];// eslint-disable-next-line \nvar _useState77=useState(0),_useState78=_slicedToArray(_useState77,2),count=_useState78[0],setCount=_useState78[1];var inputEl=useRef(null);var _useState79=useState(\"\"),_useState80=_slicedToArray(_useState79,2),val=_useState80[0],setVal=_useState80[1];var _useState81=useState(false),_useState82=_slicedToArray(_useState81,2),productModal=_useState82[0],setProductModal=_useState82[1];var handleRow=/*#__PURE__*/function(){var _ref19=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee18(obj){return _regeneratorRuntime.wrap(function _callee18$(_context18){while(1){switch(_context18.prev=_context18.next){case 0:_context18.next=2;return setChosen(true);case 2://alert(\"something is chaning\")\ngetSearchfacility(obj);_context18.next=5;return setSimpa(obj.name);case 5:// setSelectedFacility(obj)\nsetShowPanel(false);_context18.next=8;return setCount(2);case 8:case\"end\":return _context18.stop();}}},_callee18);}));return function handleRow(_x9){return _ref19.apply(this,arguments);};}();var handleBlur=/*#__PURE__*/function(){var _ref20=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee19(e){return _regeneratorRuntime.wrap(function _callee19$(_context19){while(1){switch(_context19.prev=_context19.next){case 0:case\"end\":return _context19.stop();}}},_callee19);}));return function handleBlur(_x10){return _ref20.apply(this,arguments);};}();var handleSearch=/*#__PURE__*/function(){var _ref21=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee20(value){var field,_query;return _regeneratorRuntime.wrap(function _callee20$(_context20){while(1){switch(_context20.prev=_context20.next){case 0:setVal(value);if(!(value===\"\")){_context20.next=4;break;}setShowPanel(false);return _context20.abrupt(\"return\");case 4:field='name';//field variable\nif(!(value.length>=3)){_context20.next=9;break;}productServ.find({query:(_query={},_defineProperty(_query,field,{$regex:value,$options:'i'}),_defineProperty(_query,\"$limit\",10),_defineProperty(_query,\"$sort\",{createdAt:-1}),_query)}).then(function(res){// console.log(\"product  fetched successfully\") \n// console.log(res.data) \nsetFacilities(res.data);setSearchMessage(\" product  fetched successfully\");setShowPanel(true);}).catch(function(err){toast({message:'Error creating ProductEntry '+err,type:'is-danger',dismissible:true,pauseOnHover:true});});_context20.next=12;break;case 9:// console.log(\"less than 3 \")\n// console.log(val)\nsetShowPanel(false);_context20.next=12;return setFacilities([]);case 12:case\"end\":return _context20.stop();}}},_callee20);}));return function handleSearch(_x11){return _ref21.apply(this,arguments);};}();var handleAddproduct=function handleAddproduct(){setProductModal(true);};var handlecloseModal=function handlecloseModal(){setProductModal(false);handleSearch(val);};useEffect(function(){if(clear){// console.log(\"success has changed\",clear)\nsetSimpa(\"\");}return function(){};},[clear]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"div\",{className:\"control has-icons-left  \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown \".concat(showPanel?\"is-active\":\"\",\" wt100\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-trigger wt100\",children:[/*#__PURE__*/_jsx(DebounceInput,{className:\"input is-small \",type:\"text\",placeholder:\"Search Product\",value:simpa,minLength:3,debounceTimeout:400,onBlur:function onBlur(e){return handleBlur(e);},onChange:function onChange(e){return handleSearch(e.target.value);},inputRef:inputEl}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-menu wt100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-content\",children:[facilities.length>0?\"\":/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-item\",onClick:handleAddproduct,children:[\" \",/*#__PURE__*/_jsxs(\"span\",{children:[\"Add \",val,\" to product list\"]}),\" \"]}),facilities.map(function(facility,i){return/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-item \",onClick:function onClick(){return handleRow(facility);},children:[/*#__PURE__*/_jsx(\"span\",{children:facility.name}),/*#__PURE__*/_jsxs(\"span\",{children:[\"(\",facility.baseunit,\")\"]})]},facility._id);})]})})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal \".concat(productModal?\"is-active\":\"\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-background\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-card\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"modal-card-head minHt\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"modal-card-title\",children:\"Product\"}),/*#__PURE__*/_jsx(\"button\",{className:\"delete\",\"aria-label\":\"close\",onClick:handlecloseModal})]}),/*#__PURE__*/_jsx(\"section\",{className:\"modal-card-body\",children:/*#__PURE__*/_jsx(ProductCreate,{})})]})]})]});}","map":{"version":3,"sources":["/home/mfybaby/Documents/HealthStack2/HS-frontend/src/components/Pharmacy/ProductEntry.js"],"names":["React","useState","useContext","useEffect","useRef","client","DebounceInput","useForm","UserContext","ObjectContext","toast","ProductCreate","formatDistanceToNowStrict","format","subDays","addDays","DatePicker","InfiniteScroll","searchfacility","ProductEntry","state","selectedProductEntry","setSelectedProductEntry","ProductEntryModule","show","ProductEntryCreate","error","setError","success","setSuccess","message","setMessage","facility","setFacility","ProductEntryServ","service","user","currentUser","setCurrentUser","type","setType","documentNo","setDocumentNo","totalamount","setTotalamount","productId","setProductId","source","setSource","date","setDate","name","setName","baseunit","setBaseunit","quantity","setQuantity","costprice","setCostprice","productItem","setProductItem","productItemI","amount","getSearchfacility","obj","_id","handleChangeType","e","target","value","handleClickProd","dismissible","pauseOnHover","prevProd","concat","handleDate","resetform","onSubmit","confirm","window","preventDefault","productEntry","productitems","createdby","transactioncategory","currentEmployee","facilityDetail","StoreModule","selectedStore","storeId","create","then","res","catch","err","removeEntity","entity","i","prev","filter","index","display","length","map","ProductEntryList","facilities","setFacilities","setState","setUser","page","setPage","limit","setLimit","total","setTotal","restful","setRestful","next","setNext","handleCreateNew","newProductEntryModule","prevstate","handleRow","handleSearch","val","field","find","query","$or","$regex","$options","$limit","$sort","createdAt","data","getFacilities","$skip","findProductEntry","skip","stacker","getNewFacilities","resp","console","log","getUpdatedFacilities","employeeLocation","locationId","updatelist","on","updates","rest1","handleDelete","remove","Date","ProductEntryDetail","handleEdit","ProductEntryModify","register","handleSubmit","setValue","reset","errors","shouldValidate","shouldDirty","ProductEntryType","handleCancel","changeState","conf","dleteId","patch","required","ProductSearch","clear","productServ","searchError","setSearchError","showPanel","setShowPanel","searchMessage","setSearchMessage","simpa","setSimpa","chosen","setChosen","count","setCount","inputEl","setVal","productModal","setProductModal","handleBlur","handleAddproduct","handlecloseModal"],"mappings":"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","sourcesContent":["/* eslint-disable */\nimport React, {useState,useContext, useEffect,useRef} from 'react'\nimport client from '../../feathers'\nimport {DebounceInput} from 'react-debounce-input';\nimport { useForm } from \"react-hook-form\";\n//import {useHistory} from 'react-router-dom'\nimport {UserContext,ObjectContext} from '../../context'\nimport {toast} from 'bulma-toast'\nimport {ProductCreate} from './Products'\nimport { formatDistanceToNowStrict, format, subDays,addDays } from 'date-fns'\nimport DatePicker from \"react-datepicker\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\n\nimport \"react-datepicker/dist/react-datepicker.css\";\n// eslint-disable-next-line\nconst searchfacility={};\n\n\nexport default function ProductEntry() {\n    const {state}=useContext(ObjectContext) //,setState\n    // eslint-disable-next-line\n    const [selectedProductEntry,setSelectedProductEntry]=useState()\n    //const [showState,setShowState]=useState() //create|modify|detail\n    \n    return(\n        <section className= \"section remPadTop\">\n           {/*  <div className=\"level\">\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">ProductEntry  Module</span></div>\n            </div> */}\n            <div className=\"columns \">\n            <div className=\"column is-6 \">\n                <ProductEntryList />\n                </div>\n            <div className=\"column is-6 \">\n                {(state.ProductEntryModule.show ==='create')&&<ProductEntryCreate />}\n                {(state.ProductEntryModule.show ==='detail')&&<ProductEntryDetail  />}\n                {(state.ProductEntryModule.show ==='modify')&&<ProductEntryModify ProductEntry={selectedProductEntry} />}\n               \n            </div>\n\n            </div>                            \n            </section>\n       \n    )\n    \n}\n\nexport function ProductEntryCreate(){\n   // const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \n    const [error, setError] =useState(false)\n    const [success, setSuccess] =useState(false)\n    const [message,setMessage] = useState(\"\")\n    // eslint-disable-next-line\n    const [facility,setFacility] = useState()\n    const ProductEntryServ=client.service('productentry')\n    //const history = useHistory()\n    const {user} = useContext(UserContext) //,setUser\n    // eslint-disable-next-line\n    const [currentUser,setCurrentUser] = useState()\n    const [type,setType] = useState(\"Purchase Invoice\")\n    const [documentNo,setDocumentNo] = useState(\"\")\n    const [totalamount,setTotalamount] = useState(\"\")\n    const [productId,setProductId] = useState(\"\")\n    const [source,setSource] = useState(\"\")\n    const [date,setDate] = useState(\"\")\n    const [name,setName] = useState(\"\")\n    const [baseunit,setBaseunit] = useState(\"\")\n    const [quantity,setQuantity] = useState(\"\")\n    const [costprice,setCostprice] = useState(\"\")\n    const [productItem,setProductItem] = useState([])\n    const {state}=useContext(ObjectContext)\n    \n   /*  const [productEntry,setProductEntry]=useState({\n        productitems:[],\n        date,\n        documentNo,\n        type,\n        totalamount,\n        source,\n\n    })\n  */\n    const productItemI={\n        productId,\n        name,\n        quantity,\n        costprice,\n        amount:quantity*costprice,\n        baseunit\n\n    }\n    // consider batchformat{batchno,expirydate,qtty,baseunit}\n    //consider baseunoit conversions\n    const getSearchfacility=(obj)=>{\n\n        setProductId(obj._id)\n        setName(obj.name)\n        setBaseunit(obj.baseunit)\n        \n       /*  setValue(\"facility\", obj._id,  {\n            shouldValidate: true,\n            shouldDirty: true\n        }) */\n    }\n    \n    useEffect(() => {\n        setCurrentUser(user)\n        //console.log(currentUser)\n        return () => {\n        \n        }\n    }, [user])\n\n    const handleChangeType=async (e)=>{\n        await setType(e.target.value)\n    }\n    const handleClickProd=async()=>{\n        if(!productId||!quantity||!costprice){\n            toast({\n                message: 'Kindly choose Product,price and quantity',\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true,\n              }) \n              return\n        }\n        await setSuccess(false)\n        setProductItem(\n            prevProd=>prevProd.concat(productItemI)\n        )\n        setName(\"\")\n        setBaseunit(\"\")\n        setQuantity(\"\")\n        setCostprice(\"\")\n        await setSuccess(true)\n      // console.log(success)\n     //  console.log(productItem)\n    }\n    const handleDate=async (date)=>{\n        setDate(date)\n        \n    }\n    \n\n    const resetform=()=>{\n     setType(\"Purchase Invoice\")\n    setDocumentNo(\"\")\n    setTotalamount(\"\")\n    setProductId(\"\")\n    setSource(\"\")\n    setDate(\"\")\n    setName(\"\")\n    setBaseunit(\"\")\n    setCostprice(\"\")\n    setProductItem([])\n    }\n\n    const onSubmit = async(e) =>{\n        let confirm =window.confirm(`Are you sure you want to save this entry ?`)\n        if (confirm){\n        e.preventDefault();\n        setMessage(\"\")\n        setError(false)\n        setSuccess(false)\n        if (!date){\n          \n            toast({\n                message: 'Kindly choose date',\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true,\n              }) \n              return\n          }\n\n        let productEntry={\n            \n            date,\n            documentNo,\n            type,\n            totalamount,\n            source,\n        }\n        productEntry.productitems=productItem\n        productEntry.createdby=user._id\n        productEntry.transactioncategory=\"credit\"\n\n          //console.log(\"b4 facility\",productEntry);\n          if (user.currentEmployee){\n         productEntry.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\n          }else{\n            toast({\n                message: 'You can not add inventory to any organization',\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true,\n              }) \n              return\n          }\n          if (state.StoreModule.selectedStore._id){\n            productEntry.storeId=state.StoreModule.selectedStore._id\n          }else{\n            toast({\n                message: 'You need to select a store before adding inventory',\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true,\n              }) \n              return\n\n          }\n          //console.log(\"b4 create\",productEntry);\n        ProductEntryServ.create(productEntry)\n        .then((res)=>{\n                //console.log(JSON.stringify(res))\n                resetform()\n               /*  setMessage(\"Created ProductEntry successfully\") */\n                setSuccess(true)\n                toast({\n                    message: 'ProductEntry created succesfully',\n                    type: 'is-success',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n                  setSuccess(false)\n                  setProductItem([])\n            })\n            .catch((err)=>{\n                toast({\n                    message: 'Error creating ProductEntry ' + err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n            })\n        }\n      } \n    const removeEntity=(entity,i)=>{\n    //console.log(entity)\n        setProductItem(prev=>prev.filter((obj,index)=>index!==i ))\n    }\n    \n\n    return (\n        <>\n            <div className=\"card card-overflow\">\n            <div className=\"card-header\">\n                <p className=\"card-header-title\">\n                    Create ProductEntry: Initialization, Purchase Invoice, Audit\n                </p>\n            </div>\n            <div className=\"card-content \">\n   \n            <form onSubmit={onSubmit}> {/* handleSubmit(onSubmit) */}\n            <div className=\"field is-horizontal\">\n            <div className=\"field-body\">\n            <div className=\"field\">    \n                <div className=\"control\">\n                    <div className=\"select is-small\">\n                        <select name=\"type\" value={type} onChange={handleChangeType}>\n                           <option value=\"\">Choose Type </option>\n                            <option value=\"Purchase Invoice\">Purchase Invoice </option>\n                            <option value=\"Initialization\">Initialization</option>\n                            <option value=\"Audit\">Audit</option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n            <div className=\"field\">\n                    <p className=\"control has-icons-left has-icons-right\">\n                        <input className=\"input is-small\" /* ref={register({ required: true })} */ value={source} name=\"supplier\" type=\"text\" onChange={e=>setSource(e.target.value)} placeholder=\"Supplier\" />\n                        <span className=\"icon is-small is-left\">\n                            <i className=\"fas fa-hospital\"></i>\n                        </span>                    \n                    </p>\n                </div>\n           \n            </div>\n            </div> {/* horizontal end */}\n           \n               <div className=\"field is-horizontal\">\n               <div className=\"field-body\">\n               <div className=\"field\">\n                <div className=\"control has-icons-left has-icons-right\">\n                <DatePicker \n                            selected={date} \n                            onChange={date => handleDate(date)} \n                            dateFormat=\"dd/MM/yyyy\"\n                            placeholderText=\"Pick Date\"\n                            \n                            //isClearable\n                            />\n                  {/*   <input className=\"input is-small\"   ref={register({ required: true })}  value={date}  name=\"date\" type=\"text\" onChange={e=>setDate(e.target.value)} placeholder=\"Date\" />\n                    <span className=\"icon is-small is-left\">\n                        <i className=\"fas fa-map-signs\"></i>\n                    </span> */}\n                </div>\n            </div>\n            <div className=\"field\">\n                <p className=\"control has-icons-left\">\n                    <input className=\"input is-small\" /* ref={register} */ name=\"documentNo\" value={documentNo} type=\"text\" onChange={e=>setDocumentNo(e.target.value)} placeholder=\" Invoice Number\"/>\n                    <span className=\"icon is-small is-left\">\n                    <i className=\"fas fa-phone-alt\"></i>\n                    </span>\n                </p>\n            </div>\n            <div className=\"field\">\n                <p className=\"control has-icons-left\">\n                    <input className=\"input is-small\" /* ref={register({ required: true })} */ value={totalamount} name=\"totalamount\" type=\"text\" onChange={async e=> await setTotalamount(e.target.value)} placeholder=\" Total Amount\"/>\n                    <span className=\"icon is-small is-left\">\n                    <i className=\"fas fa-coins\"></i>\n                    </span>\n                </p>\n            </div>\n\n                </div> \n                </div> \n               \n                </form>   \n               \n           \n         {/* array of ProductEntry items */}\n        \n        <label className=\"label is-small\">Add Product Items:</label>\n         <div className=\"field is-horizontal\">\n            <div className=\"field-body\">\n            <div className=\"field is-expanded\"  /* style={ !user.stacker?{display:\"none\"}:{}} */ >\n                    <ProductSearch  getSearchfacility={getSearchfacility} clear={success} /> \n                    <p className=\"control has-icons-left \" style={{display:\"none\"}}>\n                        <input className=\"input is-small\" /* ref={register ({ required: true }) }  *//* add array no */  value={productId} name=\"productId\" type=\"text\" onChange={e=>setProductId(e.target.value)} placeholder=\"Product Id\" />\n                        <span className=\"icon is-small is-left\">\n                        <i className=\"fas  fa-map-marker-alt\"></i>\n                        </span>\n                    </p>\n                </div>\n                </div>\n                </div>\n                <div className=\"field is-horizontal\">\n            <div className=\"field-body\">\n                <div className=\"field\">\n                <p className=\"control has-icons-left\">\n                    <input className=\"input is-small\" /* ref={register({ required: true })} */ name=\"quantity\" value={quantity} type=\"text\" onChange={e=>setQuantity(e.target.value)} placeholder=\"Quantity\"  />\n                    <span className=\"icon is-small is-left\">\n                    <i className=\"fas fa-envelope\"></i>\n                    </span>\n                </p>\n        <label >{baseunit}</label>\n            </div> \n            <div className=\"field\">\n                <p className=\"control has-icons-left\">\n                    <input className=\"input is-small\" /* ref={register({ required: true })} */ name=\"costprice\" value={costprice} type=\"text\" onChange={e=>setCostprice(e.target.value)} placeholder=\"Cost Price\"  />\n                    <span className=\"icon is-small is-left\">\n                    <i className=\"fas fa-dollar-sign\"></i>\n                    </span>\n                </p>\n            </div> \n            <div className=\"field\">\n            <p className=\"control\">\n                    <button className=\"button is-info is-small  is-pulled-right minHt\">\n                      <span className=\"is-small\" onClick={handleClickProd}> +</span>\n                    </button>\n                </p>\n            </div>\n            </div>\n         </div>\n            \n       {(productItem.length>0) && <div>\n            <label>Product Items:</label>\n            <div className=\"table-container  vscrol\" id=\"scrollableDiv\">\n         <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\n                <thead>\n                    <tr>\n                    <th><abbr title=\"Serial No\">S/No</abbr></th>\n                    <th><abbr title=\"Type\">Name</abbr></th>\n                    <th><abbr title=\"Type\">Quanitity</abbr></th>\n                    <th><abbr title=\"Document No\">Unit</abbr></th>\n                    <th><abbr title=\"Cost Price\">Cost Price</abbr></th>\n                    <th><abbr title=\"Cost Price\">Amount</abbr></th>\n                    <th><abbr title=\"Actions\">Actions</abbr></th>\n                    </tr>\n                </thead>\n                <tfoot>\n                    \n                </tfoot>\n                <tbody>\n                   { productItem.map((ProductEntry, i)=>(\n\n                        <tr key={i}>\n                        <th>{i+1}</th>\n                        <td>{ProductEntry.name}</td>\n                        <th>{ProductEntry.quantity}</th>\n                        <td>{ProductEntry.baseunit}</td>\n                        <td>{ProductEntry.costprice}</td>\n                        <td>{ProductEntry.amount}</td>\n                        <td onClick={()=>removeEntity(ProductEntry,i)}><span className=\"showAction\"  >x</span></td>\n                        \n                        </tr>\n\n                    ))}\n                </tbody>\n                </table>\n                </div>\n                <div className=\"field mt-2\">\n                <p className=\"control\">\n                    <button className=\"button is-success is-small\" disabled={!productItem.length>0} onClick={onSubmit}>\n                        Create\n                    </button>\n                </p>\n                </div>\n                </div>\n           \n            }\n            \n            \n            </div>\n            </div>\n        </>\n    )\n   \n}\n\nexport function ProductEntryList(){\n   // const { register, handleSubmit, watch, errors } = useForm();\n    // eslint-disable-next-line\n    const [error, setError] =useState(false)\n     // eslint-disable-next-line\n    const [success, setSuccess] =useState(false)\n     // eslint-disable-next-line\n   const [message, setMessage] = useState(\"\") \n    const ProductEntryServ=client.service('productentry')\n    //const history = useHistory()\n   // const {user,setUser} = useContext(UserContext)\n    const [facilities,setFacilities]=useState([])\n     // eslint-disable-next-line\n   const [selectedProductEntry, setSelectedProductEntry]=useState() //\n    // eslint-disable-next-line\n    const {state,setState}=useContext(ObjectContext)\n    // eslint-disable-next-line\n    const {user,setUser}=useContext(UserContext)\n    const [page, setPage] = useState(0) \n    const [limit, setLimit] = useState(20) \n    const [total, setTotal] = useState(0) \n    const [restful, setRestful] = useState(true) \n    const [next, setNext] = useState(false) \n\n    const handleCreateNew = async()=>{\n        const    newProductEntryModule={\n            selectedProductEntry:{},\n            show :'create'\n            }\n       await setState((prevstate)=>({...prevstate, ProductEntryModule:newProductEntryModule}))\n       //console.log(state)\n        \n\n    }\n    const handleRow= async(ProductEntry)=>{\n        //console.log(\"b4\",state)\n\n        //console.log(\"handlerow\",ProductEntry)\n\n        await setSelectedProductEntry(ProductEntry)\n\n        const    newProductEntryModule={\n            selectedProductEntry:ProductEntry,\n            show :'detail'\n        }\n       await setState((prevstate)=>({...prevstate, ProductEntryModule:newProductEntryModule}))\n       //console.log(state)\n\n    }\n\n   const handleSearch=async(val)=>{\n       const field='source'\n       //console.log(val)\n       ProductEntryServ.find({query: {\n              $or:[\n                  {\n                    source: {\n                        $regex:val,\n                        $options:'i'  \n                    }\n                  },\n                  {\n                    type:{\n                        $regex:val,\n                        $options:'i' \n                    }\n                  }\n                 \n\n              ],\n                \n                storeId:state.StoreModule.selectedStore._id,\n               facility:user.currentEmployee.facilityDetail._id || \"\",\n                $limit:100,\n                $sort: {\n                    createdAt: -1\n                  }\n                    }}).then((res)=>{\n               //console.log(res)\n               setFacilities(res.data)\n               setTotal(res.total)\n                setMessage(\" ProductEntry  fetched successfully\")\n                setSuccess(true) \n            })\n            .catch((err)=>{\n              //  console.log(err)\n                setMessage(\"Error fetching ProductEntry, probable network issues \"+ err )\n                setError(true)\n            })\n    }\n   \n    const getFacilities= async()=>{\n            if (user.currentEmployee){\n         \n        const findProductEntry= await ProductEntryServ.find(\n                {query: {\n                    facility:user.currentEmployee.facilityDetail._id,\n                    storeId:state.StoreModule.selectedStore._id,\n                    $limit:limit,\n                    $skip:page * limit,\n                   /*  $limit:20, */\n                    $sort: {\n                        createdAt: -1\n                    }\n                    }})\n\n        \n        await setTotal(findProductEntry.total)\n        await setFacilities(prevstate=>prevstate.concat(findProductEntry.data))\n        if (findProductEntry.total> findProductEntry.skip){\n            setNext(true)\n          \n              setPage(page=>page+1)\n           } else{\n            setNext(false)  \n           }    \n                }\n                else {\n                    if (user.stacker){\n                      \n                        const findProductEntry= await ProductEntryServ.find(\n                            {query: {\n                                \n                                $limit:20,\n                                $sort: {\n                                    createdAt: -1\n                                }\n                                }})\n            \n                    await setFacilities(findProductEntry.data)\n\n                    }\n                }\n        \n    }\n\n    const getNewFacilities= async()=>{\n                if (user.currentEmployee){\n              \n            const findProductEntry= await ProductEntryServ.find(\n                    {query: {\n                        facility:user.currentEmployee.facilityDetail._id,\n                        storeId:state.StoreModule.selectedStore._id,\n                        $limit:limit,\n                        //$skip:page * limit,\n                       /*  $limit:20, */\n                        $sort: {\n                            createdAt: -1\n                        }\n                        }}).then((resp)=>{\n                            setTotal(resp.total)\n                            setFacilities(resp.data)\n                            if (resp.total> resp.data.length){\n                                setNext(true)\n                               \n                                  setPage(page=>page+1)\n                               } else{\n                                setNext(false)  \n                               }    \n\n                        })\n                        .catch((err)=>{\n                            console.log(err) \n                        })\n            }\n            else {\n                     if (user.stacker){\n                        \n                        const findProductEntry= await ProductEntryServ.find(\n                            {query: {\n                                \n                                $limit:20,\n                                $sort: {\n                                    createdAt: -1\n                                }\n                                }})\n            \n                    await setFacilities(findProductEntry.data)\n                \n                    }\n                }\n            \n    }\n            \n    const getUpdatedFacilities= async()=>{\n       \n        const findProductEntry= await ProductEntryServ.find(  \n            {query: {\n                facility:user.currentEmployee.facilityDetail._id,\n                storeId:state.employeeLocation.locationId,\n                $limit:limit,\n             \n                $sort: {\n                    createdAt: -1\n                }\n                }}).then((resp)=>{\n                   \n                    setTotal(resp.total)\n                    updatelist(resp.data)\n                    //setFacilities(resp.data)\n                    if (resp.total> resp.data.length){\n                        setNext(true)\n                          setPage(page=>page+1)\n                       } else{\n                        setNext(false)  \n                       }    \n\n                })\n                .catch((err)=>{\n                    console.log(err) \n                })\n    }\n  \n    useEffect(() => {\n               \n        if (!state.StoreModule.selectedStore){\n            toast({\n                message: 'kindly select a store',\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true,\n                }) \n                return\n          //  getFacilities()\n\n        }\n        ProductEntryServ.on('created', (obj)=>getUpdatedFacilities())\n        ProductEntryServ.on('updated', (obj)=>getUpdatedFacilities())\n        ProductEntryServ.on('patched', (obj)=>getUpdatedFacilities())\n        ProductEntryServ.on('removed', (obj)=>getUpdatedFacilities())\n        return () => {\n           \n        }\n    },[])\n\n    const updatelist=async(data)=>{\n       await setFacilities(data)\n    }\n    const updates=()=>{\n       // setFacilities([])\n        rest1()\n    }\n\n    useEffect(() => {\n        rest1()\n        return () => {\n            \n        }\n    }, [state.StoreModule.selectedStore._id])\n    //todo: pagination and vertical scroll bar\n  \n\n    const rest1 = async ()=>{\n       setPage(0) \n       setTotal(0) \n       getNewFacilities()\n    }\n    const handleDelete= async(obj)=>{\n        let confirm =window.confirm(`Are you sure you want to delete this entry with Document No: ${obj.documentNo} ?`)\n        if (confirm){\n        await ProductEntryServ.remove(obj._id).then((resp)=>{\n            toast({\n                message: 'Sucessfuly deleted ProductEntry ' ,\n                type: 'is-success',\n                dismissible: true,\n                pauseOnHover: true,\n            })\n        })\n        .catch((err)=>{\n            toast({\n                message: 'Error deleting ProductEntry ' + err,\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true,\n            })\n        })\n        }\n    }\n\n    return(\n        <>\n           {state.StoreModule.selectedStore?( <>  \n                <div className=\"level\">\n                    <div className=\"level-left\">\n                        <div className=\"level-item\">\n                            <div className=\"field\">\n                                <p className=\"control has-icons-left  \">\n                                    <DebounceInput className=\"input is-small \" \n                                        type=\"text\" placeholder=\"Search Type or Source\"\n                                        minLength={3}\n                                        debounceTimeout={400}\n                                        onChange={(e)=>handleSearch(e.target.value)} />\n                                    <span className=\"icon is-small is-left\">\n                                        <i className=\"fas fa-search\"></i>\n                                    </span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Product Additions to Inventory </span></div>\n                    <div className=\"level-right\">\n                        <div className=\"level-item\"> \n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\n                        </div>\n                    </div>\n\n                </div>\n\n                <div className=\"table-container pullup vscrola\" id=\"scrollableDiv\">\n              \n                  <InfiniteScroll\n                        dataLength={facilities.length}\n                        next={getFacilities}\n                        hasMore={ total>facilities.length}\n                        loader={<h4>Loading...</h4>}\n                        scrollableTarget=\"scrollableDiv\"\n                    > \n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\n                                    <thead>\n                                        <tr>\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\n                                        <th><abbr title=\"Date\">Date</abbr></th>\n                                        <th><abbr title=\"Type\">Type</abbr></th>\n                                        <th>Source</th>\n                                        <th><abbr title=\"Document No\">Document No</abbr></th>\n                                        <th><abbr title=\"Total Amount\">Total Amount</abbr></th>\n                                        {/* <th><abbr title=\"Enteredby\">Entered By</abbr></th> */} \n                                         <th><abbr title=\"Actions\">Actions</abbr></th> \n                                        </tr>\n                                    </thead>\n                                    <tfoot>\n                                        \n                                    </tfoot>\n                                    <tbody>\n                                        {facilities.map((ProductEntry, i)=>(\n\n                                            <tr key={ProductEntry._id} onClick={()=>handleRow(ProductEntry)}>\n                                            <th>{i+1}</th>\n                                            <td>{ProductEntry.date?<>{format(new Date(ProductEntry.date),\"dd-MM-yy HH:mm\")}</>:\"\"}</td>\n                                            <th>{ProductEntry.type}</th>\n                                            <td>{ProductEntry.source}</td>\n                                            <td>{ProductEntry.documentNo}</td>\n                                            <td>{ProductEntry.totalamount}</td>\n                                          {/*   <td>{ProductEntry.enteredby}</td> */}\n                                           <td onClick={()=>handleDelete(ProductEntry)}><span className=\"showAction\"  >X</span></td> \n                                           \n                                            </tr>\n\n                                        ))}\n                                    </tbody>\n                                    </table>\n                                 </InfiniteScroll>   \n                                    \n                </div>              \n            </>):<div>loading... </div>}\n            </>\n              \n    )\n}\n\n\nexport function ProductEntryDetail(){\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\n     // eslint-disable-next-line\n    const [error, setError] =useState(false) //, \n    //const [success, setSuccess] =useState(false)\n     // eslint-disable-next-line\n    const [message, setMessage] = useState(\"\") //,\n    //const ProductEntryServ=client.service('/ProductEntry')\n    //const history = useHistory()\n    //const {user,setUser} = useContext(UserContext)\n    const {state,setState} = useContext(ObjectContext)\n\n   \n\n   const ProductEntry =state.ProductEntryModule.selectedProductEntry \n\n    const handleEdit= async()=>{\n        const    newProductEntryModule={\n            selectedProductEntry:ProductEntry,\n            show :'modify'\n        }\n       await setState((prevstate)=>({...prevstate, ProductEntryModule:newProductEntryModule}))\n       //console.log(state)\n       \n    }\n\n \n    return (\n        <>\n        <div className=\"card \">\n            <div className=\"card-header\">\n                <p className=\"card-header-title\">\n                    ProductEntry Details\n                </p>\n            </div>\n            <div className=\"card-content vscrollable\">\n           \n                <table> \n                <tbody>         \n                <tr>\n                    <td>\n                      <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\n                            <i className=\"fas fa-hospital\"></i>\n                        </span>                    \n                        Type\n                        </label>\n                    </td>\n                    <td>\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {ProductEntry.type} </span>\n                    </td>\n                    <td>\n\n                    </td>\n                    <td>\n                        <label className=\"label is-small padleft\"><span className=\"icon is-small is-left\">\n                            <i className=\"fas fa-map-signs\"></i>\n                        </span>Supplier:\n                        </label>\n                    </td>\n                    <td>\n                        <span className=\"is-size-7 padleft\"   name=\"ProductEntryType\">{ProductEntry.source} </span> \n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\n                        <i className=\"fas fa-hospital\"></i>\n                        </span>                    \n                        Date:\n                        </label>\n                    </td>\n                    <td>\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {format(new Date(ProductEntry.date),\"dd-MM-yy HH:mm\")} </span>\n                    </td>\n                    <td>\n                                \n                    </td>\n                    <td>\n                        <label className=\"label is-small padleft\"><span className=\"icon is-small is-left\">\n                            <i className=\"fas fa-map-signs\"></i>\n                        </span>Invoice No:\n                        </label>\n                    </td>\n                    \n                    <td>\n                         <span className=\"is-size-7 padleft\"   name=\"ProductEntryType\">{ProductEntry.documentNo} </span> \n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                \n                        <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\n                        <i className=\"fas fa-hospital\"></i>\n                    </span>            \n                        Total Amount:\n                    </label>\n                    </td>\n                    <td>\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {ProductEntry.totalamount} </span>\n                    </td>\n                </tr>\n\n                </tbody> \n            </table> \n            <label className=\"label is-size-7 mt-2\">Product Items:</label>\n         <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\n                <thead>\n                    <tr>\n                    <th><abbr title=\"Serial No\">S/No</abbr></th>\n                    <th><abbr title=\"Type\">Name</abbr></th>\n                    <th><abbr title=\"Type\">Quanitity</abbr></th>\n                    <th><abbr title=\"Document No\">Unit</abbr></th>\n                    <th><abbr title=\"Cost Price\">Cost Price</abbr></th>\n                    <th><abbr title=\"Cost Price\">Amount</abbr></th>\n                   \n                    </tr>\n                </thead>\n                <tfoot>\n                    \n                </tfoot>\n                <tbody>\n                   { ProductEntry.productitems.map((ProductEntry, i)=>(\n\n                        <tr key={i}>\n                        <th>{i+1}</th>\n                        <td>{ProductEntry.name}</td>\n                        <th>{ProductEntry.quantity}</th>\n                        <td>{ProductEntry.baseunit}</td>\n                        <td>{ProductEntry.costprice}</td>\n                        <td>{ProductEntry.amount}</td>\n                        \n                        \n                        </tr>\n\n                    ))}\n                </tbody>\n                </table>\n            \n           \n        </div>\n        </div>\n        </>\n    )\n   \n   \n}\n\nexport function ProductEntryModify(){\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\n    // eslint-disable-next-line \n    const [error, setError] =useState(false)\n    // eslint-disable-next-line \n    const [success, setSuccess] =useState(false)\n    // eslint-disable-next-line \n    const [message,setMessage] = useState(\"\")\n    // eslint-disable-next-line \n    const ProductEntryServ=client.service('productentry')\n    //const history = useHistory()\n     // eslint-disable-next-line\n    const {user} = useContext(UserContext)\n    const {state,setState} = useContext(ObjectContext)\n\n    const ProductEntry =state.ProductEntryModule.selectedProductEntry \n\n        useEffect(() => {\n            setValue(\"name\", ProductEntry.name,  {\n                shouldValidate: true,\n                shouldDirty: true\n            })\n            setValue(\"ProductEntryType\", ProductEntry.ProductEntryType,  {\n                shouldValidate: true,\n                shouldDirty: true\n            })\n    \n            \n            return () => {\n                \n            }\n        })\n\n   const handleCancel=async()=>{\n    const    newProductEntryModule={\n        selectedProductEntry:{},\n        show :'create'\n      }\n   await setState((prevstate)=>({...prevstate, ProductEntryModule:newProductEntryModule}))\n   //console.log(state)\n           }\n\n\n        const changeState =()=>{\n        const    newProductEntryModule={\n            selectedProductEntry:{},\n            show :'create'\n        }\n        setState((prevstate)=>({...prevstate, ProductEntryModule:newProductEntryModule}))\n\n        }\n    const handleDelete=async()=>{\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\n        \n        const dleteId=ProductEntry._id\n        if (conf){\n             \n        ProductEntryServ.remove(dleteId)\n        .then((res)=>{\n                //console.log(JSON.stringify(res))\n                reset();\n               /*  setMessage(\"Deleted ProductEntry successfully\")\n                setSuccess(true)\n                changeState()\n               setTimeout(() => {\n                setSuccess(false)\n                }, 200); */\n                toast({\n                    message: 'ProductEntry deleted succesfully',\n                    type: 'is-success',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n                changeState()\n            })\n            .catch((err)=>{\n               // setMessage(\"Error deleting ProductEntry, probable network issues \"+ err )\n               // setError(true)\n                toast({\n                    message: \"Error deleting ProductEntry, probable network issues or \"+ err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n            })\n        }\n    }\n        \n    const onSubmit = (data,e) =>{\n        e.preventDefault();\n        \n        setSuccess(false)\n       // console.log(data)\n        data.facility=ProductEntry.facility\n          //console.log(data);\n          \n        ProductEntryServ.patch(ProductEntry._id,data)\n        .then((res)=>{\n                //console.log(JSON.stringify(res))\n               // e.target.reset();\n               // setMessage(\"updated ProductEntry successfully\")\n                 toast({\n                    message: 'ProductEntry updated succesfully',\n                    type: 'is-success',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n                  \n                changeState()\n\n            })\n            .catch((err)=>{\n                //setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\n               // setError(true)\n                toast({\n                    message: \"Error updating ProductEntry, probable network issues or \"+ err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n            })\n\n      } \n     \n      \n    return (\n        \n        <>\n        <div className=\"card \">\n            <div className=\"card-header\">\n                <p className=\"card-header-title\">\n                    ProductEntry Details-Modify\n                </p>\n            </div>\n            <div className=\"card-content vscrollable\">\n           \n            <form onSubmit={handleSubmit(onSubmit)}>\n                <div className=\"field\">\n                    <label className=\"label is-small\"> Name\n                    <p className=\"control has-icons-left has-icons-right\">\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"name\" type=\"text\" placeholder=\"Name\" />\n                        <span className=\"icon is-small is-left\">\n                            <i className=\"fas fa-hospital\"></i>\n                        </span>                    \n                    </p>\n                    </label>\n                    </div>\n                <div className=\"field\">\n                <label className=\"label is-small\">ProductEntry Type\n                    <p className=\"control has-icons-left has-icons-right\">\n                    <input className=\"input is-small \" ref={register({ required: true })} disabled name=\"ProductEntryType\" type=\"text\" placeholder=\"ProductEntry Type\" />\n                    <span className=\"icon is-small is-left\">\n                        <i className=\"fas fa-map-signs\"></i>\n                    </span>\n                    \n                </p>\n                </label>\n                </div>\n           \n           \n           \n            </form>\n            \n            <div className=\"field  is-grouped mt-2\" >\n                <p className=\"control\">\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\n                        Save\n                    </button>\n                </p>\n                <p className=\"control\">\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\n                        Cancel\n                    </button>\n                </p>\n                <p className=\"control\">\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\n                       Delete\n                    </button>\n                </p>\n            </div>\n        </div>\n        </div>\n        </>\n    )\n   \n   \n                \n}   \n\nexport  function ProductSearch({getSearchfacility,clear}) {\n    \n    const productServ=client.service('products')\n    const [facilities,setFacilities]=useState([])\n     // eslint-disable-next-line\n     const [searchError, setSearchError] =useState(false)\n     // eslint-disable-next-line\n    const [showPanel, setShowPanel] =useState(false)\n     // eslint-disable-next-line\n   const [searchMessage, setSearchMessage] = useState(\"\") \n   // eslint-disable-next-line \n   const [simpa,setSimpa]=useState(\"\")\n   // eslint-disable-next-line \n   const [chosen,setChosen]=useState(false)\n   // eslint-disable-next-line \n   const [count,setCount]=useState(0)\n   const inputEl=useRef(null)\n   const [val,setVal]=useState(\"\")\n    const [productModal,setProductModal]=useState(false)\n\n   const handleRow= async(obj)=>{\n        await setChosen(true)\n        //alert(\"something is chaning\")\n       getSearchfacility(obj)\n       \n       await setSimpa(obj.name)\n       \n        // setSelectedFacility(obj)\n        setShowPanel(false)\n        await setCount(2)\n        /* const    newfacilityModule={\n            selectedFacility:facility,\n            show :'detail'\n        }\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\n   //console.log(state)\n}\n    const handleBlur=async(e)=>{\n       \n    }\n    const handleSearch=async(value)=>{\n        setVal(value)\n        if (value===\"\"){\n            setShowPanel(false)\n            return\n        }\n        const field='name' //field variable\n\n       \n        if (value.length>=3 ){\n            productServ.find({query: {     //service\n                 [field]: {\n                     $regex:value,\n                     $options:'i'\n                    \n                 },\n                 $limit:10,\n                 $sort: {\n                     createdAt: -1\n                   }\n                     }}).then((res)=>{\n             // console.log(\"product  fetched successfully\") \n             // console.log(res.data) \n                setFacilities(res.data)\n                 setSearchMessage(\" product  fetched successfully\")\n                 setShowPanel(true)\n             })\n             .catch((err)=>{\n                toast({\n                    message: 'Error creating ProductEntry ' + err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n             })\n         }\n        else{\n           // console.log(\"less than 3 \")\n           // console.log(val)\n            setShowPanel(false)\n            await setFacilities([])\n           // console.log(facilities)\n        }\n    }\n\n    const handleAddproduct =()=>{\n        setProductModal(true) \n    }\n    const handlecloseModal =()=>{\n        setProductModal(false)\n        handleSearch(val)\n    }\n    useEffect(() => {\n       if (clear){\n          // console.log(\"success has changed\",clear)\n           setSimpa(\"\")\n       }\n        return () => {\n            \n        }\n    }, [clear] )\n    return (\n        <div>\n            <div className=\"field\">\n                <div className=\"control has-icons-left  \">\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"} wt100`}>\n                        <div className=\"dropdown-trigger wt100\">\n                            <DebounceInput className=\"input is-small \" \n                                type=\"text\" placeholder=\"Search Product\"\n                                value={simpa}\n                                minLength={3}\n                                debounceTimeout={400}\n                                onBlur={(e)=>handleBlur(e)}\n                                onChange={(e)=>handleSearch(e.target.value)}\n                                inputRef={inputEl}\n                                  />\n                            <span className=\"icon is-small is-left\">\n                                <i className=\"fas fa-search\"></i>\n                            </span>\n                        </div>\n                        {/* {searchError&&<div>{searchMessage}</div>} */}\n                        <div className=\"dropdown-menu wt100\" >\n                            <div className=\"dropdown-content\">\n                          { facilities.length>0?\"\":<div className=\"dropdown-item\" onClick={handleAddproduct}> <span>Add {val} to product list</span> </div>}\n\n                              {facilities.map((facility, i)=>(\n                                    \n                                    <div className=\"dropdown-item \" key={facility._id} onClick={()=>handleRow(facility)}>\n                                        \n                                        <span>{facility.name}</span><span>({facility.baseunit})</span>\n                                        \n                                    </div>\n                                    \n                                    ))}\n                                    \n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div className={`modal ${productModal?\"is-active\":\"\"}` }>\n                                    <div className=\"modal-background\"></div>\n                                    <div className=\"modal-card\">\n                                        <header className=\"modal-card-head minHt\">\n                                        <p className=\"modal-card-title\">Product</p>\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={handlecloseModal}></button>\n                                        </header>\n                                        <section className=\"modal-card-body\">\n                                        {/* <StoreList standalone=\"true\" /> */}\n                                        <ProductCreate />\n                                        </section>\n                                        {/* <footer className=\"modal-card-foot\">\n                                        <button className=\"button is-success\">Save changes</button>\n                                        <button className=\"button\">Cancel</button>\n                                        </footer> */}\n                                    </div>\n                                </div>       \n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}