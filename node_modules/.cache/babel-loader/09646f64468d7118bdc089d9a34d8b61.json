{"ast":null,"code":"import _defineProperty from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable */import React,{useState,useContext,useEffect,useRef}from'react';import client from'../../feathers';import{DebounceInput}from'react-debounce-input';import{useForm}from\"react-hook-form\";//import {useHistory} from 'react-router-dom'\nimport{UserContext,ObjectContext}from'../../context';import{toast}from'bulma-toast';import FacilityAccount from\"./Preauthorization\";// eslint-disable-next-line\nvar searchfacility={};export default function Collections(){var _useContext=useContext(ObjectContext),state=_useContext.state;//,setState\n// eslint-disable-next-line\nvar _useState=useState(),_useState2=_slicedToArray(_useState,2),selectedInventory=_useState2[0],setSelectedInventory=_useState2[1];//const [showState,setShowState]=useState() //create|modify|detail\nreturn/*#__PURE__*/_jsx(\"section\",{className:\"section remPadTop\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"columns \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"column is-5 \",children:/*#__PURE__*/_jsx(CollectionList,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"column is-7 \",children:state.SelectedClient.show==='detail'&&/*#__PURE__*/_jsx(ClientAccount,{})})]})});}export function ClientAccount(){var _facility$;var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue;//, watch, errors, reset \nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),success=_useState6[0],setSuccess=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),message=_useState8[0],setMessage=_useState8[1];// eslint-disable-next-line\nvar _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),facility=_useState10[0],setFacility=_useState10[1];var InventoryServ=client.service('subwallettransactions');var SubwalletServ=client.service('subwallet');//const history = useHistory()\nvar _useContext2=useContext(UserContext),user=_useContext2.user;//,setUser\nvar _useContext3=useContext(ObjectContext),state=_useContext3.state,setState=_useContext3.setState;// eslint-disable-next-line\nvar _useState11=useState(),_useState12=_slicedToArray(_useState11,2),currentUser=_useState12[0],setCurrentUser=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),balance=_useState14[0],setBalance=_useState14[1];var clientSel=state.SelectedClient.client;var getSearchfacility=function getSearchfacility(obj){/*   \n        setValue(\"facility\", obj._id,  {\n            shouldValidate: true,\n            shouldDirty: true\n        }) */};useEffect(function(){setCurrentUser(user);//console.log(currentUser)\nreturn function(){};},[user]);//check user for facility or get list of facility  \n/*  useEffect(()=>{\n        //setFacility(user.activeInventory.FacilityId)//\n      if (!user.stacker){\n          console.log(currentUser)\n        setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\n            shouldValidate: true,\n            shouldDirty: true\n        }) \n      }\n    }) */useEffect(function(){getaccountdetails();getBalance();return function(){};},[clientSel]);var getaccountdetails=function getaccountdetails(){InventoryServ.find({query:{facility:user.currentEmployee.facilityDetail._id,client:clientSel.client,// storeId:state.StoreModule.selectedStore._id,\n// category:\"credit\",\n$sort:{createdAt:-1}}}).then(function(res){console.log(res);setFacility(res.data);//e.target.reset();\n/*  setMessage(\"Created Inventory successfully\") */ // setSuccess(true)\ntoast({message:'Account details succesful',type:'is-success',dismissible:true,pauseOnHover:true});// setSuccess(false)\n}).catch(function(err){toast({message:'Error getting account details '+err,type:'is-danger',dismissible:true,pauseOnHover:true});});};var getBalance=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var findProductEntry;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return SubwalletServ.find({query:{client:clientSel.client,organization:user.currentEmployee.facilityDetail._id,//storeId:state.StoreModule.selectedStore._id,\n//clientId:state.ClientModule.selectedClient._id,\n$limit:100,$sort:{createdAt:-1}}});case 2:findProductEntry=_context.sent;console.log(findProductEntry);// console.log(\"balance\", findProductEntry.data[0].amount)\nif(!(findProductEntry.data.length>0)){_context.next=9;break;}_context.next=7;return setBalance(findProductEntry.data[0].amount);case 7:_context.next=11;break;case 9:_context.next=11;return setBalance(0);case 11:case\"end\":return _context.stop();}}},_callee);}));return function getBalance(){return _ref.apply(this,arguments);};}();var onSubmit=function onSubmit(data,e){e.preventDefault();setMessage(\"\");setError(false);setSuccess(false);// data.createdby=user._id\nconsole.log(data);if(user.currentEmployee){data.facility=user.currentEmployee.facilityDetail._id;// or from facility dropdown\n}};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card cardheight\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"card-header-title\",children:[\"Account Details: \",(_facility$=facility[0])===null||_facility$===void 0?void 0:_facility$.fromName]}),/*#__PURE__*/_jsxs(\"button\",{className:\"button is-success is-small btnheight mt-2\",children:[\"Current Balance: N \",balance]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-content \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"columns \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"column is-6 \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card cardht80\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-header-title\",children:\"Credit\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-content vscrollable mx-0.5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"table-container pullup \",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable mx-0.5\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Serial No\",children:\"S/No\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Cost Price\",children:\"Date\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Quantity\",children:\"Amount\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Base Unit\",children:\"Mode\"})})]})}),/*#__PURE__*/_jsx(\"tfoot\",{}),/*#__PURE__*/_jsx(\"tbody\",{children:facility.map(function(Inventory,i){return/*#__PURE__*/_jsx(_Fragment,{children:Inventory.category===\"credit\"&&/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:i+1}),/*#__PURE__*/_jsx(\"td\",{children:new Date(Inventory.createdAt).toLocaleString('en-GB')}),\" \",/*#__PURE__*/_jsx(\"td\",{children:Inventory.amount}),/*#__PURE__*/_jsx(\"td\",{children:Inventory.paymentmode})]},Inventory._id)});})})]})})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"column is-6 \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card cardht80\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-header-title\",children:\"Debit\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-content vscrollable mx-0.5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"table-container pullup \",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table is-striped is-narrow is-hoverable  is-scrollable mx-0.5\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Serial No\",children:\"S/No\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Cost Price\",children:\"Date\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Description\",children:\"Description\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Quantity\",children:\"Amount\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Base Unit\",children:\"Mode\"})})]})}),/*#__PURE__*/_jsx(\"tfoot\",{}),/*#__PURE__*/_jsx(\"tbody\",{children:facility.map(function(Inventory,i){return/*#__PURE__*/_jsx(_Fragment,{children:Inventory.category===\"debit\"&&/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:i+1}),/*#__PURE__*/_jsx(\"td\",{children:new Date(Inventory.createdAt).toLocaleString('en-GB')}),\" \",/*#__PURE__*/_jsx(\"th\",{children:Inventory.description}),/*#__PURE__*/_jsx(\"td\",{children:Inventory.amount}),/*#__PURE__*/_jsx(\"td\",{children:Inventory.paymentmode})]},Inventory._id)});})})]})})})]})})]})})]})});}export function CollectionList(){// const { register, handleSubmit, watch, errors } = useForm();\n// eslint-disable-next-line\nvar _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),error=_useState16[0],setError=_useState16[1];// eslint-disable-next-line\nvar _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),success=_useState18[0],setSuccess=_useState18[1];// eslint-disable-next-line\nvar _useState19=useState(\"\"),_useState20=_slicedToArray(_useState19,2),message=_useState20[0],setMessage=_useState20[1];var InventoryServ=client.service('subwallettransactions');//const history = useHistory()\n// const {user,setUser} = useContext(UserContext)\nvar _useState21=useState([]),_useState22=_slicedToArray(_useState21,2),facilities=_useState22[0],setFacilities=_useState22[1];// eslint-disable-next-line\nvar _useState23=useState(),_useState24=_slicedToArray(_useState23,2),selectedInventory=_useState24[0],setSelectedInventory=_useState24[1];//\n// eslint-disable-next-line\nvar _useContext4=useContext(ObjectContext),state=_useContext4.state,setState=_useContext4.setState;// eslint-disable-next-line\nvar _useContext5=useContext(UserContext),user=_useContext5.user,setUser=_useContext5.setUser;var handleCreateNew=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var newInventoryModule;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:newInventoryModule={selectedInventory:{},show:'create'};_context2.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function handleCreateNew(){return _ref2.apply(this,arguments);};}();var handleRow=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(Inventory){var newInventoryModule;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return setSelectedInventory(Inventory);case 2:newInventoryModule={client:Inventory,show:'detail'};_context3.next=5;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{SelectedClient:newInventoryModule});});case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function handleRow(_x){return _ref3.apply(this,arguments);};}();var handleSearch=function handleSearch(val){var _query;var field='fromName';console.log(val);InventoryServ.find({query:(_query={},_defineProperty(_query,field,{$regex:val,$options:'i'}),_defineProperty(_query,\"facility\",user.currentEmployee.facilityDetail._id||\"\"),_defineProperty(_query,\"$limit\",20),_defineProperty(_query,\"$sort\",{createdAt:-1}),_query)}).then(function(res){//console.log(res)\nsetFacilities(res.data);/* setMessage(\" Inventory  fetched successfully\")\n                setSuccess(true)  */}).catch(function(err){console.log(err);toast({message:'Error during search '+err,type:'is-danger',dismissible:true,pauseOnHover:true});});};var getFacilities=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var DAY_MS,findInventory,_findInventory;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!user.currentEmployee){_context4.next=9;break;}DAY_MS=30*24*60*60*1000;_context4.next=4;return InventoryServ.find({query:{facility:user.currentEmployee.facilityDetail._id,// storeId:state.StoreModule.selectedStore._id,\ncategory:\"credit\",createdAt:{$gt:new Date().getTime()-DAY_MS//last 30days\n},$sort:{createdAt:-1}}});case 4:findInventory=_context4.sent;_context4.next=7;return setFacilities(findInventory.data);case 7:_context4.next=15;break;case 9:if(!user.stacker){_context4.next=15;break;}_context4.next=12;return InventoryServ.find({query:{$limit:20,$sort:{createdAt:-1}}});case 12:_findInventory=_context4.sent;_context4.next=15;return setFacilities(_findInventory.data);case 15:case\"end\":return _context4.stop();}}},_callee4);}));return function getFacilities(){return _ref4.apply(this,arguments);};}();useEffect(function(){console.log(facilities);//getFacilities(user)\nreturn function(){};},[facilities]);useEffect(function(){if(user){getFacilities();}else{/* const localUser= localStorage.getItem(\"user\")\n                    const user1=JSON.parse(localUser)\n                    console.log(localUser)\n                    console.log(user1)\n                    fetchUser(user1)\n                    console.log(user)\n                    getFacilities(user) */}InventoryServ.on('created',function(obj){return getFacilities();});InventoryServ.on('updated',function(obj){return getFacilities();});InventoryServ.on('patched',function(obj){return getFacilities();});InventoryServ.on('removed',function(obj){return getFacilities();});return function(){};},[]);useEffect(function(){getFacilities();return function(){};},[state.StoreModule.selectedStore]);//todo: pagination and vertical scroll bar\nreturn/*#__PURE__*/_jsx(_Fragment,{children:user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"level\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"level-left\",children:/*#__PURE__*/_jsx(\"div\",{className:\"level-item\",children:/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left  \",children:[/*#__PURE__*/_jsx(DebounceInput,{className:\"input is-small \",type:\"text\",placeholder:\"Search Collections\",minLength:3,debounceTimeout:400,onChange:function onChange(e){return handleSearch(e.target.value);}}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search\"})})]})})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"level-item\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"is-size-6 has-text-weight-medium\",children:\"Collections in last 30 days \"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"level-right\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container pullup \",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Serial No\",children:\"S/No\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Cost Price\",children:\"Date\"})}),/*#__PURE__*/_jsx(\"th\",{children:\"Client\"}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Quantity\",children:\"Amount\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Base Unit\",children:\"Mode\"})})]})}),/*#__PURE__*/_jsx(\"tfoot\",{}),/*#__PURE__*/_jsx(\"tbody\",{children:facilities.map(function(Inventory,i){return/*#__PURE__*/_jsxs(\"tr\",{onClick:function onClick(){return handleRow(Inventory);},className:Inventory._id===((selectedInventory===null||selectedInventory===void 0?void 0:selectedInventory._id)||null)?\"is-selected\":\"\",children:[/*#__PURE__*/_jsx(\"th\",{children:i+1}),/*#__PURE__*/_jsx(\"td\",{children:new Date(Inventory.createdAt).toLocaleString('en-GB')}),\" \",/*#__PURE__*/_jsx(\"th\",{children:Inventory.fromName}),/*#__PURE__*/_jsx(\"td\",{children:Inventory.amount}),/*#__PURE__*/_jsx(\"td\",{children:Inventory.paymentmode})]},Inventory._id);})})]})})]}):/*#__PURE__*/_jsx(\"div\",{children:\"loading\"})});}export function InventoryDetail(){//const { register, handleSubmit, watch, setValue } = useForm(); //errors,\n// eslint-disable-next-line\nvar _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),error=_useState26[0],setError=_useState26[1];//, \n//const [success, setSuccess] =useState(false)\n// eslint-disable-next-line\nvar _useState27=useState(\"\"),_useState28=_slicedToArray(_useState27,2),message=_useState28[0],setMessage=_useState28[1];//,\n//const InventoryServ=client.service('/Inventory')\n//const history = useHistory()\n//const {user,setUser} = useContext(UserContext)\nvar _useContext6=useContext(ObjectContext),state=_useContext6.state,setState=_useContext6.setState;var _useContext7=useContext(UserContext),user=_useContext7.user;//,setUser\nvar Inventory=state.InventoryModule.selectedInventory;console.log(\"selected\",Inventory);var getFacilities=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var findProductEntry;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return client.service('productentry').find({query:{'productitems.productId':Inventory.productId,facility:user.currentEmployee.facilityDetail._id,storeId:state.StoreModule.selectedStore._id,$limit:20,$sort:{createdAt:-1}}});case 2:findProductEntry=_context5.sent;console.log(findProductEntry);case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function getFacilities(){return _ref5.apply(this,arguments);};}();useEffect(function(){getFacilities();return function(){};},[Inventory]);/* await setFacilities(findProductEntry.data)\n        }\n        else {\n            if (user.stacker){ */ /* toast({\n                    message: 'You do not qualify to view this',\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  }) \n                  return */ /*  const findProductEntry= await ProductEntryServ.find(\n                    {query: {\n                        \n                        $limit:20,\n                        $sort: {\n                            createdAt: -1\n                        }\n                        }})\n    \n            await setFacilities(findProductEntry.data)\n\n            }\n        }  */ /*   .then((res)=>{\n        console.log(res)\n            setFacilities(res.data)\n            setMessage(\" ProductEntry  fetched successfully\")\n            setSuccess(true)\n        })\n        .catch((err)=>{\n            setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\n            setError(true)\n        }) */var handleEdit=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var newInventoryModule;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:newInventoryModule={selectedInventory:Inventory,show:'modify'};_context6.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});case 3:case\"end\":return _context6.stop();}}},_callee6);}));return function handleEdit(){return _ref6.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-header-title\",children:\"Inventory Details\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content vscrollable\",children:[/*#__PURE__*/_jsx(\"table\",{children:/*#__PURE__*/_jsx(\"tbody\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-hospital\"})}),\"Product Name:\"]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"is-size-7 padleft\",name:\"name\",children:/*#__PURE__*/_jsxs(\"strong\",{children:[\" \",Inventory.name,\" \"]})})})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"field mt-2 is-grouped\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-success is-small\",onClick:handleEdit,children:\"Set Price\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-danger is-small\"/*  onClick={handleSetPrice} */,children:\"Audit\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-info is-small\"/* onClick={handleEdit} */,children:\"Transaction History\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-warning is-small\"/* onClick={handleEdit} */,children:\"Reorder Level\"})})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"message\",children:[\" \",message]})]})]})});}export function InventoryModify(){var _useForm2=useForm(),register=_useForm2.register,handleSubmit=_useForm2.handleSubmit,setValue=_useForm2.setValue,reset=_useForm2.reset,errors=_useForm2.errors;//watch, errors,\n// eslint-disable-next-line \nvar _useState29=useState(false),_useState30=_slicedToArray(_useState29,2),error=_useState30[0],setError=_useState30[1];// eslint-disable-next-line \nvar _useState31=useState(false),_useState32=_slicedToArray(_useState31,2),success=_useState32[0],setSuccess=_useState32[1];// eslint-disable-next-line \nvar _useState33=useState(\"\"),_useState34=_slicedToArray(_useState33,2),message=_useState34[0],setMessage=_useState34[1];var _useState35=useState(),_useState36=_slicedToArray(_useState35,2),billservice=_useState36[0],setBillService=_useState36[1];// eslint-disable-next-line \nvar InventoryServ=client.service('inventory');//const history = useHistory()\n// eslint-disable-next-line\nvar _useContext8=useContext(UserContext),user=_useContext8.user;var _useContext9=useContext(ObjectContext),state=_useContext9.state,setState=_useContext9.setState;var billServ=client.service('billing');var Inventory=state.InventoryModule.selectedInventory;// set inventory\nvar handleSetPrice=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var service,contractSel;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return billServ.get(Inventory.billingId);case 2:service=_context7.sent;// get the service\ncontractSel=service.contracts.filter(function(element){return element.source_org===Inventory.facility&&element.dest_org===Inventory.facility;});setValue(\"price\",contractSel[0].price,{shouldValidate:true,shouldDirty:true});setValue(\"oldprice\",contractSel[0].price,{shouldValidate:true,shouldDirty:true});_context7.next=8;return setBillService(service);case 8:console.log(contractSel,service);case 9:case\"end\":return _context7.stop();}}},_callee7);}));return function handleSetPrice(){return _ref7.apply(this,arguments);};}();useEffect(function(){handleSetPrice();return function(){};},[]);var handleCancel=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var newInventoryModule;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:newInventoryModule={selectedInventory:{},show:'detail'};_context8.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});case 3:case\"end\":return _context8.stop();}}},_callee8);}));return function handleCancel(){return _ref8.apply(this,arguments);};}();var changeState=function changeState(){var newInventoryModule={selectedInventory:{},show:'detail'};setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});};var handleDelete=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){var conf,dleteId;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:conf=window.confirm(\"Are you sure you want to delete this data?\");dleteId=Inventory._id;if(conf){InventoryServ.remove(dleteId).then(function(res){//console.log(JSON.stringify(res))\nreset();/*  setMessage(\"Deleted Inventory successfully\")\n                setSuccess(true)\n                changeState()\n               setTimeout(() => {\n                setSuccess(false)\n                }, 200); */toast({message:'Inventory deleted succesfully',type:'is-success',dismissible:true,pauseOnHover:true});changeState();}).catch(function(err){// setMessage(\"Error deleting Inventory, probable network issues \"+ err )\n// setError(true)\ntoast({message:\"Error deleting Inventory, probable network issues or \"+err,type:'is-danger',dismissible:true,pauseOnHover:true});});}case 3:case\"end\":return _context9.stop();}}},_callee9);}));return function handleDelete(){return _ref9.apply(this,arguments);};}();/* ()=> setValue(\"firstName\", \"Bill\", , {\n            shouldValidate: true,\n            shouldDirty: true\n          })) */var onSubmit=function onSubmit(data,e){e.preventDefault();setSuccess(false);console.log(data);// data.facility=Inventory.facility\n//console.log(data);\nvar contractSel=billservice.contracts.filter(function(element){return element.source_org===Inventory.facility&&element.dest_org===Inventory.facility;});contractSel[0].price=data.price;billServ.patch(billservice._id,billservice).then(function(res){//console.log(JSON.stringify(res))\n// e.target.reset();\n// setMessage(\"updated Inventory successfully\")\ntoast({message:'Price updated succesfully',type:'is-success',dismissible:true,pauseOnHover:true});changeState();}).catch(function(err){//setMessage(\"Error creating Inventory, probable network issues \"+ err )\n// setError(true)\ntoast({message:\"Error updating Price, probable network issues or \"+err,type:'is-danger',dismissible:true,pauseOnHover:true});});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"card-header-title\",children:[\"Set Price for \",Inventory.name,\" per \",Inventory.baseunit]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content vscrollable\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small\",children:[\" New Selling Price\",/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left has-icons-right\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input  is-small\",ref:register({required:true}),name:\"price\",type:\"text\",placeholder:\"Name\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-hospital\"})})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small\",children:[\"Old Price\",/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left has-icons-right\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small \",ref:register({required:true}),disabled:true,name:\"oldprice\",type:\"text\",placeholder:\"Inventory Type\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-map-signs\"})})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field  is-grouped mt-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"button is-success is-small\",onClick:handleSubmit(onSubmit),children:\"Save\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-warning is-small\",onClick:handleCancel,children:\"Cancel\"})})]})]})]})});}export function ProductSearch(_ref10){var getSearchfacility=_ref10.getSearchfacility,clear=_ref10.clear;var facilityServ=client.service('products');var _useState37=useState([]),_useState38=_slicedToArray(_useState37,2),facilities=_useState38[0],setFacilities=_useState38[1];// eslint-disable-next-line\nvar _useState39=useState(false),_useState40=_slicedToArray(_useState39,2),searchError=_useState40[0],setSearchError=_useState40[1];// eslint-disable-next-line\nvar _useState41=useState(false),_useState42=_slicedToArray(_useState41,2),showPanel=_useState42[0],setShowPanel=_useState42[1];// eslint-disable-next-line\nvar _useState43=useState(\"\"),_useState44=_slicedToArray(_useState43,2),searchMessage=_useState44[0],setSearchMessage=_useState44[1];// eslint-disable-next-line \nvar _useState45=useState(\"\"),_useState46=_slicedToArray(_useState45,2),simpa=_useState46[0],setSimpa=_useState46[1];// eslint-disable-next-line \nvar _useState47=useState(false),_useState48=_slicedToArray(_useState47,2),chosen=_useState48[0],setChosen=_useState48[1];// eslint-disable-next-line \nvar _useState49=useState(0),_useState50=_slicedToArray(_useState49,2),count=_useState50[0],setCount=_useState50[1];var inputEl=useRef(null);var handleRow=/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(obj){return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return setChosen(true);case 2://alert(\"something is chaning\")\ngetSearchfacility(obj);_context10.next=5;return setSimpa(obj.facilityName);case 5:// setSelectedFacility(obj)\nsetShowPanel(false);_context10.next=8;return setCount(2);case 8:case\"end\":return _context10.stop();}}},_callee10);}));return function handleRow(_x2){return _ref11.apply(this,arguments);};}();var handleBlur=/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(e){return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:if(count===2){console.log(\"stuff was chosen\");}/*  console.log(\"blur\")\n         setShowPanel(false)\n        console.log(JSON.stringify(simpa))\n        if (simpa===\"\"){\n            console.log(facilities.length)\n            setSimpa(\"abc\")\n            setSimpa(\"\")\n            setFacilities([])\n            inputEl.current.setValue=\"\"\n        }\n        console.log(facilities.length)\n        console.log(inputEl.current) */case 1:case\"end\":return _context11.stop();}}},_callee11);}));return function handleBlur(_x3){return _ref12.apply(this,arguments);};}();var handleSearch=/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(val){var field,_query2;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:field='name';//field variable\nif(!(val.length>=3)){_context12.next=5;break;}facilityServ.find({query:(_query2={},_defineProperty(_query2,field,{$regex:val,$options:'i'}),_defineProperty(_query2,\"$limit\",10),_defineProperty(_query2,\"$sort\",{createdAt:-1}),_query2)}).then(function(res){console.log(\"facility  fetched successfully\");setFacilities(res.data);setSearchMessage(\" facility  fetched successfully\");setShowPanel(true);}).catch(function(err){console.log(err);setSearchMessage(\"Error searching facility, probable network issues \"+err);setSearchError(true);});_context12.next=11;break;case 5:console.log(\"less than 3 \");console.log(val);setShowPanel(false);_context12.next=10;return setFacilities([]);case 10:console.log(facilities);case 11:case\"end\":return _context12.stop();}}},_callee12);}));return function handleSearch(_x4){return _ref13.apply(this,arguments);};}();useEffect(function(){if(clear){setSimpa(\"\");}return function(){};},[clear]);return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"div\",{className:\"control has-icons-left  \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown \".concat(showPanel?\"is-active\":\"\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-trigger\",children:[/*#__PURE__*/_jsx(DebounceInput,{className:\"input is-small \",type:\"text\",placeholder:\"Search Product\",value:simpa,minLength:1,debounceTimeout:400,onBlur:function onBlur(e){return handleBlur(e);},onChange:function onChange(e){return handleSearch(e.target.value);},inputRef:inputEl}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search\"})})]}),searchError&&/*#__PURE__*/_jsx(\"div\",{children:searchMessage}),/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-menu\",children:/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-content\",children:facilities.map(function(facility,i){return/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-item\",onClick:function onClick(){return handleRow(facility);},children:/*#__PURE__*/_jsx(\"span\",{children:facility.facilityName})},facility._id);})})})]})})})});}","map":{"version":3,"sources":["/home/mfybaby/Documents/HealthStack2/HS-frontend/src/components/ManagedCare/Referral.js"],"names":["React","useState","useContext","useEffect","useRef","client","DebounceInput","useForm","UserContext","ObjectContext","toast","FacilityAccount","searchfacility","Collections","state","selectedInventory","setSelectedInventory","SelectedClient","show","ClientAccount","register","handleSubmit","setValue","error","setError","success","setSuccess","message","setMessage","facility","setFacility","InventoryServ","service","SubwalletServ","user","setState","currentUser","setCurrentUser","balance","setBalance","clientSel","getSearchfacility","obj","getaccountdetails","getBalance","find","query","currentEmployee","facilityDetail","_id","$sort","createdAt","then","res","console","log","data","type","dismissible","pauseOnHover","catch","err","organization","$limit","findProductEntry","length","amount","onSubmit","e","preventDefault","fromName","map","Inventory","i","category","Date","toLocaleString","paymentmode","description","CollectionList","facilities","setFacilities","setUser","handleCreateNew","newInventoryModule","prevstate","InventoryModule","handleRow","handleSearch","val","field","$regex","$options","getFacilities","DAY_MS","$gt","getTime","findInventory","stacker","on","StoreModule","selectedStore","target","value","InventoryDetail","productId","storeId","handleEdit","name","InventoryModify","reset","errors","billservice","setBillService","billServ","handleSetPrice","get","billingId","contractSel","contracts","filter","element","source_org","dest_org","price","shouldValidate","shouldDirty","handleCancel","changeState","handleDelete","conf","window","confirm","dleteId","remove","patch","baseunit","required","ProductSearch","clear","facilityServ","searchError","setSearchError","showPanel","setShowPanel","searchMessage","setSearchMessage","simpa","setSimpa","chosen","setChosen","count","setCount","inputEl","facilityName","handleBlur"],"mappings":"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","sourcesContent":["/* eslint-disable */\nimport React, {useState,useContext, useEffect,useRef} from 'react'\nimport client from '../../feathers'\nimport {DebounceInput} from 'react-debounce-input';\nimport { useForm } from \"react-hook-form\";\n//import {useHistory} from 'react-router-dom'\nimport {UserContext,ObjectContext} from '../../context'\nimport {toast} from 'bulma-toast'\nimport FacilityAccount from \"./Preauthorization\"\n// eslint-disable-next-line\nconst searchfacility={};\n\n\nexport default function Collections() {\n    const {state}=useContext(ObjectContext) //,setState\n    // eslint-disable-next-line\n    const [selectedInventory,setSelectedInventory]=useState()\n    //const [showState,setShowState]=useState() //create|modify|detail\n    \n    return(\n        <section className= \"section remPadTop\">\n           {/*  <div className=\"level\">\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Inventory  Module</span></div>\n            </div> */}\n            <div className=\"columns \">\n                <div className=\"column is-5 \">\n                    <CollectionList />\n                </div>\n           <div className=\"column is-7 \">\n          \n                { (state.SelectedClient.show ==='detail') && <ClientAccount />}\n                {/*  {(state.InventoryModule.show ==='detail')&&<InventoryDetail  />}\n                {(state.InventoryModule.show ==='modify')&&<InventoryModify Inventory={selectedInventory} />}*/}\n               \n            </div> \n\n            </div>                            \n            </section>\n       \n    )\n    \n}\n\nexport function ClientAccount(){\n    const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \n    const [error, setError] =useState(false)\n    const [success, setSuccess] =useState(false)\n    const [message,setMessage] = useState(\"\")\n    // eslint-disable-next-line\n    const [facility,setFacility] = useState([])\n    const InventoryServ=client.service('subwallettransactions')\n    const SubwalletServ=client.service('subwallet')\n    //const history = useHistory()\n    const {user} = useContext(UserContext) //,setUser\n    const {state,setState}=useContext(ObjectContext)\n    // eslint-disable-next-line\n    const [currentUser,setCurrentUser] = useState()\n    const [balance, setBalance]=useState(0)\n\n\n    const clientSel= state.SelectedClient.client\n    const getSearchfacility=(obj)=>{\n      /*   \n        setValue(\"facility\", obj._id,  {\n            shouldValidate: true,\n            shouldDirty: true\n        }) */\n    }\n    \n    useEffect(() => {\n        setCurrentUser(user)\n        //console.log(currentUser)\n        return () => {\n        \n        }\n    }, [user])\n\n  //check user for facility or get list of facility  \n   /*  useEffect(()=>{\n        //setFacility(user.activeInventory.FacilityId)//\n      if (!user.stacker){\n          console.log(currentUser)\n        setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\n            shouldValidate: true,\n            shouldDirty: true\n        }) \n      }\n    }) */\n\n    useEffect(() => {\n        getaccountdetails()\n        getBalance()\n        return () => {\n           \n        }\n    }, [clientSel])\n\n\n\n    const getaccountdetails=()=>{\n        InventoryServ.find({query: {\n            facility:user.currentEmployee.facilityDetail._id,\n            client:clientSel.client,\n           // storeId:state.StoreModule.selectedStore._id,\n           // category:\"credit\",\n            \n            $sort: {\n                createdAt: -1\n            }\n            }})\n        .then((res)=>{\n                console.log(res)\n                setFacility(res.data)\n                //e.target.reset();\n               /*  setMessage(\"Created Inventory successfully\") */\n               // setSuccess(true)\n                toast({\n                    message: 'Account details succesful',\n                    type: 'is-success',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n                 // setSuccess(false)\n            })\n            .catch((err)=>{\n                toast({\n                    message: 'Error getting account details ' + err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n            })\n    }\n\n    const getBalance=async ()=>{\n        const findProductEntry= await SubwalletServ.find(\n            {query: {\n               \n                client:clientSel.client,\n                organization:user.currentEmployee.facilityDetail._id,\n                //storeId:state.StoreModule.selectedStore._id,\n                //clientId:state.ClientModule.selectedClient._id,\n                $limit:100,\n                $sort: {\n                    createdAt: -1\n                }\n                }})\n                 console.log(findProductEntry)\n    \n         // console.log(\"balance\", findProductEntry.data[0].amount)\n            if (findProductEntry.data.length>0){\n                await setBalance(findProductEntry.data[0].amount)\n            }else{\n                await setBalance(0) \n                \n            } \n    \n          //  await setState((prevstate)=>({...prevstate, currentClients:findProductEntry.groupedOrder}))\n            }   \n    \n\n    const onSubmit = (data,e) =>{\n        e.preventDefault();\n        setMessage(\"\")\n        setError(false)\n        setSuccess(false)\n         // data.createdby=user._id\n          console.log(data);\n          if (user.currentEmployee){\n         data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\n          }\n        \n\n      } \n    \n\n    return (\n        <>\n            <div className=\"card cardheight\">\n                <div className=\"card-header\">\n                    <p className=\"card-header-title\">\n                        Account Details: {facility[0]?.fromName}\n                    </p>\n                    <button className=\"button is-success is-small btnheight mt-2\" >\n                    Current Balance: N {balance}\n                 </button>\n                </div>\n                <div className=\"card-content \">\n                \n           {/*  <div className=\"level\"> vscrollable\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Inventory  Module</span></div>\n            </div> */}\n            <div className=\"columns \">\n                <div className=\"column is-6 \">\n                    <div className=\"card cardht80\">\n                            <div className=\"card-header\">\n                                <p className=\"card-header-title\">\n                                    Credit\n                                </p>\n                            </div>\n                            <div className=\"card-content vscrollable mx-0.5\">\n                                   \n                                    <div className=\"table-container pullup \">\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable mx-0.5\">\n                                    <thead>\n                                        <tr>\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\n                                        <th><abbr title=\"Cost Price\">Date</abbr></th>\n                                        <th><abbr title=\"Quantity\">Amount</abbr></th>\n                                        <th><abbr title=\"Base Unit\">Mode</abbr></th>\n                                       {/*  <th><abbr title=\"Stock Value\">Stock Value</abbr></th>\n                                         \n                                        <th><abbr title=\"Selling Price\">Selling Price</abbr></th>\n                                        <th><abbr title=\"Re-Order Level\">Re-Order Level</abbr></th>\n                                        <th><abbr title=\"Expiry\">Expiry</abbr></th> \n                                        <th><abbr title=\"Actions\">Actions</abbr></th> */}\n                                        </tr>\n                                    </thead>\n                                    <tfoot>\n                                        \n                                    </tfoot>\n                                    <tbody>\n                                        {facility.map((Inventory, i)=>(\n                                        <>\n                                        {Inventory.category===\"credit\" && \n                                            <tr key={Inventory._id} >\n                                            <th>{i+1}</th>\n                                            <td>{new Date(Inventory.createdAt).toLocaleString('en-GB')}</td> {/*add time  */}\n                                            \n                                            <td>{Inventory.amount}</td>\n                                            <td>{Inventory.paymentmode}</td>\n                                            {/* <td>{Inventory.stockvalue}</td>\n                                            <td>{Inventory.costprice}</td>\n                                            <td>{Inventory.sellingprice}</td>\n                                            <td>{Inventory.reorder_level}</td> \n                                            <td>{Inventory.expiry}</td>\n                                            <td><span   className=\"showAction\"  >...</span></td> */}\n                                           \n                                            </tr>\n                                             }\n                                             </>\n                                        ))}\n                                    </tbody>\n                                    </table>\n                                    \n                </div>              \n                                   \n                            </div>\n                    </div>\n                </div>\n           <div className=\"column is-6 \">\n                <div className=\"card cardht80\">\n                            <div className=\"card-header\">\n                                <p className=\"card-header-title\">\n                                Debit\n                                </p>\n                            </div>\n                            <div className=\"card-content vscrollable mx-0.5\">\n                                   \n                                    <div className=\"table-container pullup \">\n                                <table className=\"table is-striped is-narrow is-hoverable  is-scrollable mx-0.5\">\n                                    <thead>\n                                        <tr>\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\n                                        <th><abbr title=\"Cost Price\">Date</abbr></th>\n                                         <th><abbr title=\"Description\">Description</abbr></th> \n                                        \n                                        <th><abbr title=\"Quantity\">Amount</abbr></th>\n                                        <th><abbr title=\"Base Unit\">Mode</abbr></th>\n                                       {/*  <th><abbr title=\"Stock Value\">Stock Value</abbr></th>\n                                         \n                                        <th><abbr title=\"Selling Price\">Selling Price</abbr></th>\n                                        <th><abbr title=\"Re-Order Level\">Re-Order Level</abbr></th>\n                                        <th><abbr title=\"Expiry\">Expiry</abbr></th> \n                                        <th><abbr title=\"Actions\">Actions</abbr></th> */}\n                                        </tr>\n                                    </thead>\n                                    <tfoot>\n                                        \n                                    </tfoot>\n                                    <tbody>\n                                        {facility.map((Inventory, i)=>(\n                                        <>\n                                          {Inventory.category===\"debit\" && <tr key={Inventory._id} >\n                                            <th>{i+1}</th>\n                                            <td>{new Date(Inventory.createdAt).toLocaleString('en-GB')}</td> {/*add time  */}\n                                            <th>{Inventory.description}</th>\n                                            <td>{Inventory.amount}</td>\n                                            <td>{Inventory.paymentmode}</td>\n                                            {/* <td>{Inventory.stockvalue}</td>\n                                            <td>{Inventory.costprice}</td>\n                                            <td>{Inventory.sellingprice}</td>\n                                            <td>{Inventory.reorder_level}</td> \n                                            <td>{Inventory.expiry}</td>\n                                            <td><span   className=\"showAction\"  >...</span></td> */}\n                                           \n                                            </tr>\n\n                                            }\n                                        </>\n                                        ))}\n                                    </tbody>\n                                    </table>\n                                    \n                </div>              \n                                    \n                            </div>\n                    </div>\n               \n            </div> \n\n            </div>                            \n           \n            \n                </div>\n            </div>\n        </>\n    )\n   \n}\n\nexport function CollectionList(){\n   // const { register, handleSubmit, watch, errors } = useForm();\n    // eslint-disable-next-line\n    const [error, setError] =useState(false)\n     // eslint-disable-next-line\n    const [success, setSuccess] =useState(false)\n     // eslint-disable-next-line\n   const [message, setMessage] = useState(\"\") \n    const InventoryServ=client.service('subwallettransactions')\n    //const history = useHistory()\n   // const {user,setUser} = useContext(UserContext)\n    const [facilities,setFacilities]=useState([])\n     // eslint-disable-next-line\n   const [selectedInventory, setSelectedInventory]=useState() //\n    // eslint-disable-next-line\n    const {state,setState}=useContext(ObjectContext)\n    // eslint-disable-next-line\n    const {user,setUser}=useContext(UserContext)\n\n\n\n    const handleCreateNew = async()=>{\n        const    newInventoryModule={\n            selectedInventory:{},\n            show :'create'\n            }\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n       //console.log(state)\n    }\n\n    const handleRow= async(Inventory)=>{\n        //console.log(\"b4\",state)\n\n        //console.log(\"handlerow\",Inventory)\n\n        await setSelectedInventory(Inventory)\n\n        const    newInventoryModule={\n            client:Inventory,\n            show :'detail'\n        }\n       await setState((prevstate)=>({...prevstate, SelectedClient:newInventoryModule}))\n       //console.log(state)\n\n    }\n\n   const handleSearch=(val)=>{\n       const field='fromName'\n       console.log(val)\n       InventoryServ.find({query: {\n                [field]: {\n                    $regex:val,\n                    $options:'i'\n                   \n                },\n               facility:user.currentEmployee.facilityDetail._id || \"\",\n                $limit:20,\n                $sort: {\n                    createdAt: -1\n                  }\n                    }}).then((res)=>{\n                //console.log(res)\n               setFacilities(res.data)\n                /* setMessage(\" Inventory  fetched successfully\")\n                setSuccess(true)  */\n            })\n            .catch((err)=>{\n                console.log(err)\n                toast({\n                    message: 'Error during search ' +err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n               \n            })\n        }\n   \n        const getFacilities= async()=>{\n            if (user.currentEmployee){\n                const DAY_MS = 30*24 * 60 * 60 * 1000;\n        const findInventory= await InventoryServ.find(\n                {query: {\n                    facility:user.currentEmployee.facilityDetail._id,\n                   // storeId:state.StoreModule.selectedStore._id,\n                    category:\"credit\",\n                    createdAt:{\n                        $gt: new Date().getTime() - DAY_MS //last 30days\n\n                    },\n                    $sort: {\n                        createdAt: -1\n                    }\n                    }})\n\n         await setFacilities(findInventory.data)\n                }\n                else {\n                    if (user.stacker){\n                        const findInventory= await InventoryServ.find(\n                            {query: {\n                                \n                                $limit:20,\n                                $sort: {\n                                    createdAt: -1\n                                }\n                                }})\n            \n                    await setFacilities(findInventory.data)\n\n                    }\n                }\n          /*   .then((res)=>{\n                console.log(res)\n                    setFacilities(res.data)\n                    setMessage(\" Inventory  fetched successfully\")\n                    setSuccess(true)\n                })\n                .catch((err)=>{\n                    setMessage(\"Error creating Inventory, probable network issues \"+ err )\n                    setError(true)\n                }) */\n            }\n            \n            useEffect(() => {\n               \n                    console.log(facilities)\n                    //getFacilities(user)\n              \n                return () => {\n                    \n\n                }\n            },[facilities])\n\n            useEffect(() => {\n               \n                if (user){\n                    getFacilities()\n                }else{\n                    /* const localUser= localStorage.getItem(\"user\")\n                    const user1=JSON.parse(localUser)\n                    console.log(localUser)\n                    console.log(user1)\n                    fetchUser(user1)\n                    console.log(user)\n                    getFacilities(user) */\n                }\n                InventoryServ.on('created', (obj)=>getFacilities())\n                InventoryServ.on('updated', (obj)=>getFacilities())\n                InventoryServ.on('patched', (obj)=>getFacilities())\n                InventoryServ.on('removed', (obj)=>getFacilities())\n                return () => {\n                \n                }\n            },[])\n        \n        useEffect(() => {\n            getFacilities()\n            return () => {\n               \n            }\n        }, [state.StoreModule.selectedStore])\n\n    //todo: pagination and vertical scroll bar\n\n    return(\n        <>\n           {user?( <>  \n                <div className=\"level\">\n                    <div className=\"level-left\">\n                        <div className=\"level-item\">\n                            <div className=\"field\">\n                                <p className=\"control has-icons-left  \">\n                                    <DebounceInput className=\"input is-small \" \n                                        type=\"text\" placeholder=\"Search Collections\"\n                                        minLength={3}\n                                        debounceTimeout={400}\n                                        onChange={(e)=>handleSearch(e.target.value)} />\n                                    <span className=\"icon is-small is-left\">\n                                        <i className=\"fas fa-search\"></i>\n                                    </span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Collections in last 30 days </span></div>\n                    <div className=\"level-right\">\n                        {/* <div className=\"level-item\"> \n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\n                        </div> */}\n                    </div>\n\n                </div>\n                <div className=\"table-container pullup \">\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\n                                    <thead>\n                                        <tr>\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\n                                        <th><abbr title=\"Cost Price\">Date</abbr></th>\n                                        {/* <th><abbr title=\"Category\">Category</abbr></th> */}\n                                        <th>Client</th>\n                                        <th><abbr title=\"Quantity\">Amount</abbr></th>\n                                        <th><abbr title=\"Base Unit\">Mode</abbr></th>\n                                       {/*  <th><abbr title=\"Stock Value\">Stock Value</abbr></th>\n                                         \n                                        <th><abbr title=\"Selling Price\">Selling Price</abbr></th>\n                                        <th><abbr title=\"Re-Order Level\">Re-Order Level</abbr></th>\n                                        <th><abbr title=\"Expiry\">Expiry</abbr></th> \n                                        <th><abbr title=\"Actions\">Actions</abbr></th> */}\n                                        </tr>\n                                    </thead>\n                                    <tfoot>\n                                        \n                                    </tfoot>\n                                    <tbody>\n                                        {facilities.map((Inventory, i)=>(\n\n                                            <tr key={Inventory._id} onClick={()=>handleRow(Inventory)} className={Inventory._id===(selectedInventory?._id||null)?\"is-selected\":\"\"}>\n                                            <th>{i+1}</th>\n                                            <td>{new Date(Inventory.createdAt).toLocaleString('en-GB')}</td> {/*add time  */}\n                                            <th>{Inventory.fromName}</th>\n                                            <td>{Inventory.amount}</td>\n                                            <td>{Inventory.paymentmode}</td>\n                                            {/* <td>{Inventory.stockvalue}</td>\n                                            <td>{Inventory.costprice}</td>\n                                            <td>{Inventory.sellingprice}</td>\n                                            <td>{Inventory.reorder_level}</td> \n                                            <td>{Inventory.expiry}</td>\n                                            <td><span   className=\"showAction\"  >...</span></td> */}\n                                           \n                                            </tr>\n\n                                        ))}\n                                    </tbody>\n                                    </table>\n                                    \n                </div>              \n            </>):<div>loading</div>}\n            </>\n              \n    )\n    }\n\n\nexport function InventoryDetail(){\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\n     // eslint-disable-next-line\n    const [error, setError] =useState(false) //, \n    //const [success, setSuccess] =useState(false)\n     // eslint-disable-next-line\n    const [message, setMessage] = useState(\"\") //,\n    //const InventoryServ=client.service('/Inventory')\n    //const history = useHistory()\n    //const {user,setUser} = useContext(UserContext)\n    const {state,setState} = useContext(ObjectContext)\n    const {user} = useContext(UserContext) //,setUser\n    \n   \n\n   const Inventory =state.InventoryModule.selectedInventory \n   console.log(\"selected\",Inventory)\n\n   \n  const getFacilities= async()=>{\n     const findProductEntry= await client.service('productentry').find(\n        {query: {\n            'productitems.productId':Inventory.productId,\n            facility:user.currentEmployee.facilityDetail._id,\n            storeId:state.StoreModule.selectedStore._id,\n            $limit:20,\n            $sort: {\n                createdAt: -1\n            }\n            }})\n\n        console.log(findProductEntry)\n       }\n    \n       useEffect(() => {\n        getFacilities()\n           return () => {\n               \n           }\n       }, [Inventory])\n /* await setFacilities(findProductEntry.data)\n        }\n        else {\n            if (user.stacker){ */\n                /* toast({\n                    message: 'You do not qualify to view this',\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  }) \n                  return */\n               /*  const findProductEntry= await ProductEntryServ.find(\n                    {query: {\n                        \n                        $limit:20,\n                        $sort: {\n                            createdAt: -1\n                        }\n                        }})\n    \n            await setFacilities(findProductEntry.data)\n\n            }\n        }  */\n  /*   .then((res)=>{\n        console.log(res)\n            setFacilities(res.data)\n            setMessage(\" ProductEntry  fetched successfully\")\n            setSuccess(true)\n        })\n        .catch((err)=>{\n            setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\n            setError(true)\n        }) */\n    \n    \n\n\n\n    const handleEdit= async()=>{\n        const    newInventoryModule={\n            selectedInventory:Inventory,\n            show :'modify'\n        }\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n       //console.log(state)\n       \n    }\n \n    return (\n        <>\n        <div className=\"card \">\n            <div className=\"card-header\">\n                <p className=\"card-header-title\">\n                    Inventory Details\n                </p>\n            </div>\n            <div className=\"card-content vscrollable\">\n           \n                <table> \n                <tbody>         \n                <tr>\n                    <td>\n                \n                    <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\n                            <i className=\"fas fa-hospital\"></i>\n                        </span>                    \n                        Product Name: \n                        </label>\n                        </td>\n                        <td>\n                        <span className=\"is-size-7 padleft\"   name=\"name\"><strong> {Inventory.name} </strong></span>\n                        </td>\n                    </tr>\n                   {/*  <tr>\n                    <td>\n                <label className=\"label is-small\"><span className=\"icon is-small is-left\">\n                        <i className=\"fas fa-map-signs\"></i>\n                    </span>Inventory Type:\n                    </label></td>\n                    <td>\n                    <span className=\"is-size-7 padleft\"   name=\"InventoryType\">{Inventory.InventoryType} </span> \n                    </td>\n                </tr> */}\n\n            </tbody> \n            </table> \n           \n            <div className=\"field mt-2 is-grouped\">\n                <p className=\"control\">\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\n                        Set Price\n                    </button>\n                </p>\n                <p className=\"control\">\n                    <button className=\"button is-danger is-small\"  /*  onClick={handleSetPrice} */>\n                        Audit\n                    </button>\n                </p>\n                <p className=\"control\">\n                    <button className=\"button is-info is-small\" /* onClick={handleEdit} */>\n                        Transaction History\n                    </button>\n                </p>\n                <p className=\"control\">\n                    <button className=\"button is-warning is-small\" /* onClick={handleEdit} */>\n                        Reorder Level\n                    </button>\n                </p>\n            </div>\n            { error && <div className=\"message\"> {message}</div>}\n           \n        </div>\n        </div>\n        </>\n    )\n   \n   \n}\n\nexport function InventoryModify(){\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\n    // eslint-disable-next-line \n    const [error, setError] =useState(false)\n    // eslint-disable-next-line \n    const [success, setSuccess] =useState(false)\n    // eslint-disable-next-line \n    const [message,setMessage] = useState(\"\")\n    const [billservice,setBillService] = useState()\n    // eslint-disable-next-line \n    const InventoryServ=client.service('inventory')\n    //const history = useHistory()\n     // eslint-disable-next-line\n    const {user} = useContext(UserContext)\n    const {state,setState} = useContext(ObjectContext)\n    const billServ=client.service('billing')\n\n    const Inventory =state.InventoryModule.selectedInventory // set inventory\n    const handleSetPrice = async()=>{\n    \n        const service = await  billServ.get(Inventory.billingId) // get the service\n            const contractSel= service.contracts.filter(element=>(element.source_org===Inventory.facility && element.dest_org===Inventory.facility))\n            \n            setValue(\"price\", contractSel[0].price,  {\n                shouldValidate: true,\n                shouldDirty: true\n            })\n            setValue(\"oldprice\", contractSel[0].price,  {\n                shouldValidate: true,\n                shouldDirty: true\n            })\n            await setBillService(service)\n            console.log(contractSel,service)\n    }\n \n        useEffect(() => {\n            handleSetPrice()\n     \n            return () => {\n                \n            }\n        },[])\n\n   const handleCancel=async()=>{\n   \n    const    newInventoryModule={\n        selectedInventory:{},\n        show :'detail'\n      }\n        await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n   //console.log(state)\n           }\n\n\n        const changeState =()=>{\n            const    newInventoryModule={\n                selectedInventory:{},\n                show :'detail'\n            }\n        setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n\n        }\n\n\n    const handleDelete=async()=>{\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\n        \n        const dleteId=Inventory._id\n        if (conf){\n             \n        InventoryServ.remove(dleteId)\n        .then((res)=>{\n                //console.log(JSON.stringify(res))\n                reset();\n               /*  setMessage(\"Deleted Inventory successfully\")\n                setSuccess(true)\n                changeState()\n               setTimeout(() => {\n                setSuccess(false)\n                }, 200); */\n                toast({\n                    message: 'Inventory deleted succesfully',\n                    type: 'is-success',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n                changeState()\n            })\n            .catch((err)=>{\n               // setMessage(\"Error deleting Inventory, probable network issues \"+ err )\n               // setError(true)\n                toast({\n                    message: \"Error deleting Inventory, probable network issues or \"+ err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n            })\n        }\n    }\n        \n\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\n            shouldValidate: true,\n            shouldDirty: true\n          })) */\n    const onSubmit = (data,e) =>{\n        e.preventDefault();\n        \n        setSuccess(false)\n        console.log(data)\n       // data.facility=Inventory.facility\n          //console.log(data);\n          const contractSel= billservice.contracts.filter(element=>(element.source_org===Inventory.facility && element.dest_org===Inventory.facility))\n          contractSel[0].price=data.price \n          billServ.patch(billservice._id,billservice)\n        .then((res)=>{\n                //console.log(JSON.stringify(res))\n               // e.target.reset();\n               // setMessage(\"updated Inventory successfully\")\n                 toast({\n                    message: 'Price updated succesfully',\n                    type: 'is-success',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n                  \n                changeState()\n\n            })\n            .catch((err)=>{\n                //setMessage(\"Error creating Inventory, probable network issues \"+ err )\n               // setError(true)\n                toast({\n                    message: \"Error updating Price, probable network issues or \"+ err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n            }) \n\n      } \n     \n      \n    return (\n        \n        <>\n        <div className=\"card \">\n            <div className=\"card-header\">\n                <p className=\"card-header-title\">\n                    Set Price for {Inventory.name} per {Inventory.baseunit}\n                </p>\n            </div>\n            <div className=\"card-content vscrollable\">\n           \n            <form onSubmit={handleSubmit(onSubmit)}>\n                <div className=\"field\">\n                    <label className=\"label is-small\"> New Selling Price\n                    <p className=\"control has-icons-left has-icons-right\">\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"price\" type=\"text\" placeholder=\"Name\" />\n                        <span className=\"icon is-small is-left\">\n                            <i className=\"fas fa-hospital\"></i>\n                        </span>                    \n                    </p>\n                    </label>\n                    </div>\n                <div className=\"field\">\n                <label className=\"label is-small\">Old Price\n                    <p className=\"control has-icons-left has-icons-right\">\n                    <input className=\"input is-small \" ref={register({ required: true })} disabled name=\"oldprice\" type=\"text\" placeholder=\"Inventory Type\" />\n                    <span className=\"icon is-small is-left\">\n                        <i className=\"fas fa-map-signs\"></i>\n                    </span>\n                    \n                </p>\n                </label>\n                </div>\n           \n           \n           \n            </form>\n            \n            <div className=\"field  is-grouped mt-2\" >\n                <p className=\"control\">\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\n                        Save\n                    </button>\n                </p>\n                <p className=\"control\">\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\n                        Cancel\n                    </button>\n                </p>\n               {/*  <p className=\"control\">\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\n                       Delete\n                    </button>\n                </p> */}\n            </div>\n        </div>\n        </div>\n        </>\n    )\n   \n   \n                \n}   \n\nexport  function ProductSearch({getSearchfacility,clear}) {\n    \n    const facilityServ=client.service('products')\n    const [facilities,setFacilities]=useState([])\n     // eslint-disable-next-line\n     const [searchError, setSearchError] =useState(false)\n     // eslint-disable-next-line\n    const [showPanel, setShowPanel] =useState(false)\n     // eslint-disable-next-line\n   const [searchMessage, setSearchMessage] = useState(\"\") \n   // eslint-disable-next-line \n   const [simpa,setSimpa]=useState(\"\")\n   // eslint-disable-next-line \n   const [chosen,setChosen]=useState(false)\n   // eslint-disable-next-line \n   const [count,setCount]=useState(0)\n   const inputEl=useRef(null)\n\n\n   const handleRow= async(obj)=>{\n        await setChosen(true)\n        //alert(\"something is chaning\")\n       getSearchfacility(obj)\n       \n       await setSimpa(obj.facilityName)\n       \n        // setSelectedFacility(obj)\n        setShowPanel(false)\n        await setCount(2)\n        /* const    newfacilityModule={\n            selectedFacility:facility,\n            show :'detail'\n        }\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\n   //console.log(state)\n}\n    const handleBlur=async(e)=>{\n         if (count===2){\n             console.log(\"stuff was chosen\")\n         }\n       \n       /*  console.log(\"blur\")\n         setShowPanel(false)\n        console.log(JSON.stringify(simpa))\n        if (simpa===\"\"){\n            console.log(facilities.length)\n            setSimpa(\"abc\")\n            setSimpa(\"\")\n            setFacilities([])\n            inputEl.current.setValue=\"\"\n        }\n        console.log(facilities.length)\n        console.log(inputEl.current) */\n    }\n    const handleSearch=async(val)=>{\n        \n        const field='name' //field variable\n       \n        if (val.length>=3){\n            facilityServ.find({query: {     //service\n                 [field]: {\n                     $regex:val,\n                     $options:'i'\n                    \n                 },\n                 $limit:10,\n                 $sort: {\n                     createdAt: -1\n                   }\n                     }}).then((res)=>{\n              console.log(\"facility  fetched successfully\") \n                setFacilities(res.data)\n                 setSearchMessage(\" facility  fetched successfully\")\n                 setShowPanel(true)\n             })\n             .catch((err)=>{\n                 console.log(err)\n                 setSearchMessage(\"Error searching facility, probable network issues \"+ err )\n                 setSearchError(true)\n             })\n         }\n        else{\n            console.log(\"less than 3 \")\n            console.log(val)\n            setShowPanel(false)\n            await setFacilities([])\n            console.log(facilities)\n        }\n    }\n    useEffect(() => {\n       if (clear){\n           setSimpa(\"\")\n       }\n        return () => {\n            \n        }\n    }, [clear] )\n    return (\n        <div>\n            <div className=\"field\">\n                <div className=\"control has-icons-left  \">\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`}>\n                        <div className=\"dropdown-trigger\">\n                            <DebounceInput className=\"input is-small \" \n                                type=\"text\" placeholder=\"Search Product\"\n                                value={simpa}\n                                minLength={1}\n                                debounceTimeout={400}\n                                onBlur={(e)=>handleBlur(e)}\n                                onChange={(e)=>handleSearch(e.target.value)}\n                                inputRef={inputEl}\n                                  />\n                            <span className=\"icon is-small is-left\">\n                                <i className=\"fas fa-search\"></i>\n                            </span>\n                        </div>\n                        {searchError&&<div>{searchMessage}</div>}\n                        <div className=\"dropdown-menu\" >\n                            <div className=\"dropdown-content\">\n                            {facilities.map((facility, i)=>(\n                                    \n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\n                                        \n                                        <span>{facility.facilityName}</span>\n                                        \n                                    </div>\n                                    \n                                    ))}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n          \n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}