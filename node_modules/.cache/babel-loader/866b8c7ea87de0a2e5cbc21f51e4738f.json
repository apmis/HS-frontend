{"ast":null,"code":"import _defineProperty from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable */import React,{useState,useContext,useEffect,useRef}from'react';import client from'../../feathers';import{DebounceInput}from'react-debounce-input';import{useForm}from\"react-hook-form\";//import {useHistory} from 'react-router-dom'\nimport{UserContext,ObjectContext}from'../../context';import{toast}from'bulma-toast';import InfiniteScroll from\"react-infinite-scroll-component\";import DatePicker from\"react-datepicker\";import{formatDistanceToNowStrict,format,subDays,addDays}from'date-fns';import{ProductEntryCreate}from'./ProductEntry';import\"react-datepicker/dist/react-datepicker.css\";// eslint-disable-next-line\nvar searchfacility={};export default function Inventory(){var _useContext=useContext(ObjectContext),state=_useContext.state;//,setState\n// eslint-disable-next-line\nvar _useState=useState(),_useState2=_slicedToArray(_useState,2),selectedInventory=_useState2[0],setSelectedInventory=_useState2[1];//const [showState,setShowState]=useState() //create|modify|detail\nreturn/*#__PURE__*/_jsx(\"section\",{className:\"section remPadTop\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"columns \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"column is-8 \",children:/*#__PURE__*/_jsx(InventoryList,{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"column is-4 \",children:[state.InventoryModule.show==='create'&&/*#__PURE__*/_jsx(InventoryCreate,{}),state.InventoryModule.show==='detail'&&/*#__PURE__*/_jsx(InventoryDetail,{}),state.InventoryModule.show==='modify'&&/*#__PURE__*/_jsx(InventoryModify,{Inventory:selectedInventory}),state.InventoryModule.show==='reorder'&&/*#__PURE__*/_jsx(InventoryReorder,{Inventory:selectedInventory}),state.InventoryModule.show==='batch'&&/*#__PURE__*/_jsx(InventoryBatches,{Inventory:selectedInventory}),state.InventoryModule.show==='audit'&&/*#__PURE__*/_jsx(ProductEntryCreate,{Inventory:selectedInventory})]})]})});}export function InventoryCreate(){var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue;//, watch, errors, reset \nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),success=_useState6[0],setSuccess=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),message=_useState8[0],setMessage=_useState8[1];// eslint-disable-next-line\nvar _useState9=useState(),_useState10=_slicedToArray(_useState9,2),facility=_useState10[0],setFacility=_useState10[1];var InventoryServ=client.service('inventory');//const history = useHistory()\nvar _useContext2=useContext(UserContext),user=_useContext2.user;//,setUser\n// eslint-disable-next-line\nvar _useState11=useState(),_useState12=_slicedToArray(_useState11,2),currentUser=_useState12[0],setCurrentUser=_useState12[1];var getSearchfacility=function getSearchfacility(obj){setValue(\"facility\",obj._id,{shouldValidate:true,shouldDirty:true});};useEffect(function(){setCurrentUser(user);//console.log(currentUser)\nreturn function(){};},[user]);//check user for facility or get list of facility  \nuseEffect(function(){//setFacility(user.activeInventory.FacilityId)//\nif(!user.stacker){//console.log(currentUser)\nsetValue(\"facility\",user.currentEmployee.facilityDetail._id,{shouldValidate:true,shouldDirty:true});}});var onSubmit=function onSubmit(data,e){e.preventDefault();setMessage(\"\");setError(false);setSuccess(false);// data.createdby=user._id\n//console.log(data);\nif(user.currentEmployee){data.facility=user.currentEmployee.facilityDetail._id;// or from facility dropdown\n}InventoryServ.create(data).then(function(res){//console.log(JSON.stringify(res))\ne.target.reset();/*  setMessage(\"Created Inventory successfully\") */setSuccess(true);toast({message:'Inventory created succesfully',type:'is-success',dismissible:true,pauseOnHover:true});setSuccess(false);}).catch(function(err){toast({message:'Error creating Inventory '+err,type:'is-danger',dismissible:true,pauseOnHover:true});});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-header-title\",children:\"Create Inventory: Product Entry- Initialization, Purchase Invoice, Audit\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-content vscrollable\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"div\",{class:\"control\",children:/*#__PURE__*/_jsx(\"div\",{class:\"select is-small\",children:/*#__PURE__*/_jsxs(\"select\",{children:[/*#__PURE__*/_jsx(\"option\",{children:\"Purchase Invoice \"}),/*#__PURE__*/_jsx(\"option\",{children:\"Initialization\"}),/*#__PURE__*/_jsx(\"option\",{children:\"Audit\"})]})})})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left\",children:[\" \",/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\",ref:register({required:true}),name:\"type\",type:\"text\",placeholder:\"Type of Product Entry\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\" fas fa-user-md \"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left has-icons-right\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\",ref:register({required:true}),name:\"supplier\",type:\"text\",placeholder:\"Supplier\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-hospital\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left has-icons-right\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\",ref:register({required:true}),name:\"date\",type:\"text\",placeholder:\"Date\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-map-signs\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\",ref:register({required:true}),name:\"totalamount\",type:\"text\",placeholder:\" Total Amount\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-phone-alt\"})})]})}),/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-info is-small  is-pulled-right\",children:/*#__PURE__*/_jsx(\"span\",{className:\"is-small\",children:\" +\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\"/* style={ !user.stacker?{display:\"none\"}:{}} */,children:[/*#__PURE__*/_jsx(ProductSearch,{getSearchfacility:getSearchfacility,clear:success}),/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left \",style:{display:\"none\"},children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\",ref:register({required:true})/* add array no */,name:\"productId\",type:\"text\",placeholder:\"Product Id\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas  fa-map-marker-alt\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\",ref:register({required:true}),name:\"quantity\",type:\"text\",placeholder:\"Quantity\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-envelope\"})})]}),/*#__PURE__*/_jsx(\"label\",{className:\"label is-small\",children:\"Base Unit\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\",ref:register({required:true}),name:\"costprice\",type:\"text\",placeholder:\"Cost Price\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-envelope\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-success is-small\",children:\"Create\"})})})]})})]})});}export function InventoryList(){// const { register, handleSubmit, watch, errors } = useForm();\n// eslint-disable-next-line\nvar _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),error=_useState14[0],setError=_useState14[1];// eslint-disable-next-line\nvar _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),success=_useState16[0],setSuccess=_useState16[1];// eslint-disable-next-line\nvar _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),message=_useState18[0],setMessage=_useState18[1];var InventoryServ=client.service('inventory');//const history = useHistory()\n// const {user,setUser} = useContext(UserContext)\nvar _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),facilities=_useState20[0],setFacilities=_useState20[1];// eslint-disable-next-line\nvar _useState21=useState(),_useState22=_slicedToArray(_useState21,2),selectedInventory=_useState22[0],setSelectedInventory=_useState22[1];//\n// eslint-disable-next-line\nvar _useContext3=useContext(ObjectContext),state=_useContext3.state,setState=_useContext3.setState;// eslint-disable-next-line\nvar _useContext4=useContext(UserContext),user=_useContext4.user,setUser=_useContext4.setUser;var _useState23=useState(0),_useState24=_slicedToArray(_useState23,2),page=_useState24[0],setPage=_useState24[1];var _useState25=useState(20),_useState26=_slicedToArray(_useState25,2),limit=_useState26[0],setLimit=_useState26[1];var _useState27=useState(0),_useState28=_slicedToArray(_useState27,2),total=_useState28[0],setTotal=_useState28[1];// const store = state.StoreModule.selectedStore\nvar pages=0;var handleCreateNew=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var newInventoryModule;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:newInventoryModule={selectedInventory:{},show:'create'};_context.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});case 3:case\"end\":return _context.stop();}}},_callee);}));return function handleCreateNew(){return _ref.apply(this,arguments);};}();var handleRow=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(Inventory){var newInventoryModule;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return setSelectedInventory(Inventory);case 2:newInventoryModule={selectedInventory:Inventory,show:'detail'};_context2.next=5;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function handleRow(_x){return _ref2.apply(this,arguments);};}();var handleSearch=function handleSearch(val){var _query;var field='name';//console.log(val)\nInventoryServ.find({query:(_query={},_defineProperty(_query,field,{$regex:val,$options:'i'}),_defineProperty(_query,\"facility\",user.currentEmployee.facilityDetail._id||\"\"),_defineProperty(_query,\"storeId\",state.StoreModule.selectedStore._id),_defineProperty(_query,\"$limit\",100),_defineProperty(_query,\"$sort\",{name:1}),_query)}).then(function(res){//console.log(res)\nsetFacilities(res.data);setTotal(res.total);setMessage(\" Inventory  fetched successfully\");setSuccess(true);}).catch(function(err){console.log(err);setMessage(\"Error fetching Inventory, probable network issues \"+err);setError(true);});};var getInventories=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var allInventory,findInventory;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!user.currentEmployee){_context3.next=14;break;}if(page===1){setPage(2);}_context3.next=4;return InventoryServ.find({query:{facility:user.currentEmployee.facilityDetail._id,storeId:state.StoreModule.selectedStore._id,$limit:limit,$skip:page*limit,$sort:{name:1}}});case 4:allInventory=_context3.sent;_context3.next=7;return setTotal(allInventory.total);case 7:if(!(allInventory.total>facilities.length)){_context3.next=10;break;}_context3.next=10;return setPage(function(page){return page++;});case 10:updatelist(allInventory.data);// pages++\nconsole.log(allInventory);//\n// console.log(0>0)\n// console.log(total,facilities.length)\n_context3.next=20;break;case 14:if(!user.stacker){_context3.next=20;break;}_context3.next=17;return InventoryServ.find({query:{$limit:20,$sort:{createdAt:-1}}});case 17:findInventory=_context3.sent;_context3.next=20;return setFacilities(findInventory.data);case 20:case\"end\":return _context3.stop();}}},_callee3);}));return function getInventories(){return _ref3.apply(this,arguments);};}();var getNewInventories=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var allInventory,findInventory;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!user.currentEmployee){_context4.next=12;break;}_context4.next=3;return InventoryServ.find({query:{facility:user.currentEmployee.facilityDetail._id,storeId:state.StoreModule.selectedStore._id,$limit:2000,//limit,\n/*  $skip:page * limit, */$sort:{name:1}}});case 3:allInventory=_context4.sent;console.log(\"this is data\",allInventory);// await setFacilities(findInventory.data)\n_context4.next=7;return setTotal(allInventory.total);case 7:_context4.next=9;return setFacilities(allInventory.data);case 9:if(allInventory.total>allInventory.data.length){// setNext(true)\nsetPage(function(page){return page+1;});}else{//setNext(fals \n}// pages++\n// console.log(findProduct)\n//\n// console.log(0>0)\n// console.log(total,facilities.length)\n_context4.next=18;break;case 12:if(!user.stacker){_context4.next=18;break;}_context4.next=15;return InventoryServ.find({query:{$limit:20,$sort:{createdAt:-1}}});case 15:findInventory=_context4.sent;_context4.next=18;return setFacilities(findInventory.data);case 18:case\"end\":return _context4.stop();}}},_callee4);}));return function getNewInventories(){return _ref4.apply(this,arguments);};}();useEffect(function(){InventoryServ.on('created',function(obj){return rest();});InventoryServ.on('updated',function(obj){return rest();});InventoryServ.on('patched',function(obj){return rest();});InventoryServ.on('removed',function(obj){return rest();});return function(){};},[]);var rest=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0://console.log(\"starting rest\")\nsetPage(0);setTotal(0);getNewInventories();//await  setPage(0) \ncase 3:case\"end\":return _context5.stop();}}},_callee5);}));return function rest(){return _ref5.apply(this,arguments);};}();var updatelist=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(data){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return setFacilities(function(prevdata){return prevdata.concat(data);});case 2:case\"end\":return _context6.stop();}}},_callee6);}));return function updatelist(_x2){return _ref6.apply(this,arguments);};}();useEffect(function(){rest();return function(){};},[state.StoreModule.selectedStore]);useEffect(function(){console.log(page);return function(){};},[page]);//todo: pagination and vertical scroll bar\nreturn/*#__PURE__*/_jsx(_Fragment,{children:user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"level\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"level-left\",children:/*#__PURE__*/_jsx(\"div\",{className:\"level-item\",children:/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left  \",children:[/*#__PURE__*/_jsx(DebounceInput,{className:\"input is-small \",type:\"text\",placeholder:\"Search Inventory\",minLength:3,debounceTimeout:400,onChange:function onChange(e){return handleSearch(e.target.value);}}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search\"})})]})})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"level-item\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"is-size-6 has-text-weight-medium\",children:\"Inventory \"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container pullup vscrola\",id:\"scrollableDiv\",children:/*#__PURE__*/_jsx(InfiniteScroll,{dataLength:facilities.length,next:getInventories,hasMore:total>facilities.length,loader:/*#__PURE__*/_jsx(\"h4\",{children:\"Loading...\"}),scrollableTarget:\"scrollableDiv\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Serial No\",children:\"S/No\"})}),/*#__PURE__*/_jsx(\"th\",{children:\"Product\"}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Quantity\",children:\"Quantity\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Base Unit\",children:\"Base Unit\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Stock Value\",children:\"Stock Value\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Cost Price\",children:\"Cost Price\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Selling Price\",children:\"Selling Price\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Re-Order Level\",children:\"Re-Order Level\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Expiry\",children:\"Expiry\"})})]})}),/*#__PURE__*/_jsx(\"tfoot\",{}),/*#__PURE__*/_jsx(\"tbody\",{children:facilities.map(function(Inventory,i){return/*#__PURE__*/_jsxs(\"tr\",{onClick:function onClick(){return handleRow(Inventory);},className:Inventory._id===((selectedInventory===null||selectedInventory===void 0?void 0:selectedInventory._id)||null)?\"is-selected\":\"\",style:{backgroundColor:Inventory.buy?\"pink\":\"\"},children:[/*#__PURE__*/_jsx(\"th\",{children:i+1}),/*#__PURE__*/_jsx(\"th\",{children:Inventory.name}),/*#__PURE__*/_jsx(\"td\",{children:Inventory.quantity}),/*#__PURE__*/_jsx(\"td\",{children:Inventory.baseunit}),/*#__PURE__*/_jsx(\"td\",{children:Inventory.stockvalue.toLocaleString('en-US',{maximumFractionDigits:2})}),/*#__PURE__*/_jsx(\"td\",{children:Inventory.costprice?Inventory.costprice.toFixed(2):\"\"}),/*#__PURE__*/_jsx(\"td\",{children:Inventory.sellingprice}),/*#__PURE__*/_jsx(\"td\",{children:Inventory.reorder_level}),/*#__PURE__*/_jsx(\"td\",{style:{backgroundColor:Inventory.expiry?\"red\":\"\"},children:Inventory.expiry?\"Exist\":\"\"})]},Inventory._id);})})]})})})]}):/*#__PURE__*/_jsx(\"div\",{children:\"loading\"})});}export function InventoryDetail(){//const { register, handleSubmit, watch, setValue } = useForm(); //errors,\n// eslint-disable-next-line\nvar _useState29=useState(false),_useState30=_slicedToArray(_useState29,2),error=_useState30[0],setError=_useState30[1];//, \n//const [success, setSuccess] =useState(false)\n// eslint-disable-next-line\nvar _useState31=useState(\"\"),_useState32=_slicedToArray(_useState31,2),message=_useState32[0],setMessage=_useState32[1];//,\n//const InventoryServ=client.service('/Inventory')\n//const history = useHistory()\n//const {user,setUser} = useContext(UserContext)\nvar _useContext5=useContext(ObjectContext),state=_useContext5.state,setState=_useContext5.setState;var _useContext6=useContext(UserContext),user=_useContext6.user;//,setUser\nvar Inventory=state.InventoryModule.selectedInventory;//console.log(\"selected\",Inventory)\nvar getFacilities=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var findProductEntry;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return client.service('productentry').find({query:{'productitems.productId':Inventory.productId,facility:user.currentEmployee.facilityDetail._id,storeId:state.StoreModule.selectedStore._id,$limit:20,$sort:{createdAt:-1}}});case 2:findProductEntry=_context7.sent;case 3:case\"end\":return _context7.stop();}}},_callee7);}));return function getFacilities(){return _ref7.apply(this,arguments);};}();useEffect(function(){getFacilities();return function(){};},[Inventory]);var handleEdit=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var newInventoryModule;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:newInventoryModule={selectedInventory:Inventory,show:'modify'};_context8.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});case 3:case\"end\":return _context8.stop();}}},_callee8);}));return function handleEdit(){return _ref8.apply(this,arguments);};}();var handleReorder=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){var newInventoryModule;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:newInventoryModule={selectedInventory:Inventory,show:'reorder'};_context9.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});case 3:case\"end\":return _context9.stop();}}},_callee9);}));return function handleReorder(){return _ref9.apply(this,arguments);};}();var handleBatch=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(){var newInventoryModule;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:newInventoryModule={selectedInventory:Inventory,show:'batch'};_context10.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});case 3:case\"end\":return _context10.stop();}}},_callee10);}));return function handleBatch(){return _ref10.apply(this,arguments);};}();var handleAudit=/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(){var newInventoryModule;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:newInventoryModule={selectedInventory:Inventory,show:'audit'};_context11.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});case 3:case\"end\":return _context11.stop();}}},_callee11);}));return function handleAudit(){return _ref11.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-header-title\",children:\"Inventory Details\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content vscrollable\",children:[/*#__PURE__*/_jsx(\"table\",{children:/*#__PURE__*/_jsx(\"tbody\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-hospital\"})}),\"Product Name:\"]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"is-size-7 padleft\",name:\"name\",children:/*#__PURE__*/_jsxs(\"strong\",{children:[\" \",Inventory.name,\" \"]})})})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"field mt-2 is-grouped\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-success is-small\",onClick:handleEdit,children:\"Set Price\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-info is-small\",onClick:handleBatch,children:\"Batches\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-warning is-small\",onClick:handleReorder,children:\"Reorder Level\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-danger is-small\",onClick:handleAudit,children:\"Audit\"})})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"message\",children:[\" \",message]})]})]})});}export function InventoryModify(){var _useForm2=useForm(),register=_useForm2.register,handleSubmit=_useForm2.handleSubmit,setValue=_useForm2.setValue,reset=_useForm2.reset,errors=_useForm2.errors;//watch, errors,\n// eslint-disable-next-line \nvar _useState33=useState(false),_useState34=_slicedToArray(_useState33,2),error=_useState34[0],setError=_useState34[1];// eslint-disable-next-line \nvar _useState35=useState(false),_useState36=_slicedToArray(_useState35,2),success=_useState36[0],setSuccess=_useState36[1];// eslint-disable-next-line \nvar _useState37=useState(\"\"),_useState38=_slicedToArray(_useState37,2),message=_useState38[0],setMessage=_useState38[1];var _useState39=useState(),_useState40=_slicedToArray(_useState39,2),billservice=_useState40[0],setBillService=_useState40[1];// eslint-disable-next-line \nvar InventoryServ=client.service('inventory');//const history = useHistory()\n// eslint-disable-next-line\nvar _useContext7=useContext(UserContext),user=_useContext7.user;var _useContext8=useContext(ObjectContext),state=_useContext8.state,setState=_useContext8.setState;var billServ=client.service('billing');var Inventory=state.InventoryModule.selectedInventory;// set inventory\nvar handleSetPrice=/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(){var service,contractSel;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return billServ.get(Inventory.billingId);case 2:service=_context12.sent;// get the service\ncontractSel=service.contracts.filter(function(element){return element.source_org===Inventory.facility&&element.dest_org===Inventory.facility;});setValue(\"price\",contractSel[0].price,{shouldValidate:true,shouldDirty:true});setValue(\"oldprice\",contractSel[0].price,{shouldValidate:true,shouldDirty:true});_context12.next=8;return setBillService(service);case 8:case\"end\":return _context12.stop();}}},_callee12);}));return function handleSetPrice(){return _ref12.apply(this,arguments);};}();useEffect(function(){handleSetPrice();return function(){};},[]);var handleCancel=/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(){var newInventoryModule;return _regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:newInventoryModule={selectedInventory:{},show:'details'};_context13.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});case 3:case\"end\":return _context13.stop();}}},_callee13);}));return function handleCancel(){return _ref13.apply(this,arguments);};}();var changeState=function changeState(){var newInventoryModule={selectedInventory:{},show:'detail'};setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});};var handleDelete=/*#__PURE__*/function(){var _ref14=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee14(){var conf,dleteId;return _regeneratorRuntime.wrap(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:conf=window.confirm(\"Are you sure you want to delete this data?\");dleteId=Inventory._id;if(conf){InventoryServ.remove(dleteId).then(function(res){////console.log(JSON.stringify(res))\nreset();/*  setMessage(\"Deleted Inventory successfully\")\n                setSuccess(true)\n                changeState()\n               setTimeout(() => {\n                setSuccess(false)\n                }, 200); */toast({message:'Inventory deleted succesfully',type:'is-success',dismissible:true,pauseOnHover:true});changeState();}).catch(function(err){// setMessage(\"Error deleting Inventory, probable network issues \"+ err )\n// setError(true)\ntoast({message:\"Error deleting Inventory, probable network issues or \"+err,type:'is-danger',dismissible:true,pauseOnHover:true});});}case 3:case\"end\":return _context14.stop();}}},_callee14);}));return function handleDelete(){return _ref14.apply(this,arguments);};}();/* ()=> setValue(\"firstName\", \"Bill\", , {\n            shouldValidate: true,\n            shouldDirty: true\n          })) */var onSubmit=function onSubmit(data,e){e.preventDefault();setSuccess(false);//console.log(data)\n// data.facility=Inventory.facility\n//console.log(data);\nvar contractSel=billservice.contracts.filter(function(element){return element.source_org===Inventory.facility&&element.dest_org===Inventory.facility;});contractSel[0].price=data.price;billServ.patch(billservice._id,billservice).then(function(res){//console.log(JSON.stringify(res))\n// e.target.reset();\n// setMessage(\"updated Inventory successfully\")\ntoast({message:'Price updated succesfully',type:'is-success',dismissible:true,pauseOnHover:true});changeState();}).catch(function(err){//setMessage(\"Error creating Inventory, probable network issues \"+ err )\n// setError(true)\ntoast({message:\"Error updating Price, probable network issues or \"+err,type:'is-danger',dismissible:true,pauseOnHover:true});});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"card-header-title\",children:[\"Set Price for \",Inventory.name,\" per \",Inventory.baseunit]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content vscrollable\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small\",children:[\" New Selling Price\",/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left has-icons-right\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input  is-small\",ref:register({required:true}),name:\"price\",type:\"text\",placeholder:\"Name\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-hospital\"})})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small\",children:[\"Old Price\",/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left has-icons-right\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small \",ref:register({required:true}),disabled:true,name:\"oldprice\",type:\"text\",placeholder:\"Inventory Type\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-map-signs\"})})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field  is-grouped mt-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"button is-success is-small\",onClick:handleSubmit(onSubmit),children:\"Save\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-warning is-small\",onClick:handleCancel,children:\"Cancel\"})})]})]})]})});}export function InventoryReorder(){var _useForm3=useForm(),register=_useForm3.register,handleSubmit=_useForm3.handleSubmit,setValue=_useForm3.setValue,reset=_useForm3.reset,errors=_useForm3.errors;//watch, errors,\n// eslint-disable-next-line \nvar _useState41=useState(false),_useState42=_slicedToArray(_useState41,2),error=_useState42[0],setError=_useState42[1];// eslint-disable-next-line \nvar _useState43=useState(false),_useState44=_slicedToArray(_useState43,2),success=_useState44[0],setSuccess=_useState44[1];// eslint-disable-next-line \nvar _useState45=useState(\"\"),_useState46=_slicedToArray(_useState45,2),message=_useState46[0],setMessage=_useState46[1];var _useState47=useState(),_useState48=_slicedToArray(_useState47,2),billservice=_useState48[0],setBillService=_useState48[1];// eslint-disable-next-line \nvar InventoryServ=client.service('inventory');//const history = useHistory()\n// eslint-disable-next-line\nvar _useContext9=useContext(UserContext),user=_useContext9.user;var _useContext10=useContext(ObjectContext),state=_useContext10.state,setState=_useContext10.setState;var billServ=client.service('billing');var Inventory=state.InventoryModule.selectedInventory;// set inventory\n// console.log(Inventory)\nuseEffect(function(){setValue(\"reorder_level\",Inventory.reorder_level,{shouldValidate:true,shouldDirty:true});setValue(\"oldlevel\",Inventory.reorder_level,{shouldValidate:true,shouldDirty:true});return function(){};},[]);var handleCancel=/*#__PURE__*/function(){var _ref15=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee15(){var newInventoryModule;return _regeneratorRuntime.wrap(function _callee15$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:newInventoryModule={selectedInventory:{},show:'detail'};_context15.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});case 3:case\"end\":return _context15.stop();}}},_callee15);}));return function handleCancel(){return _ref15.apply(this,arguments);};}();var changeState=function changeState(){var newInventoryModule={selectedInventory:{},show:'detail'};setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});};var onSubmit=function onSubmit(data,e){e.preventDefault();setSuccess(false);InventoryServ.patch(Inventory._id,{reorder_level:data.reorder_level}).then(function(res){toast({message:'Reorder level updated succesfully',type:'is-success',dismissible:true,pauseOnHover:true});changeState();}).catch(function(err){toast({message:\"Error updating Reorder level, probable network issues or \"+err,type:'is-danger',dismissible:true,pauseOnHover:true});});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"card-header-title\",children:[\"Set ReOrder Level for \",Inventory.name,\" \"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content vscrollable\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small\",children:[\" New Reorder Level\",/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left has-icons-right\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input  is-small\",ref:register({required:true}),name:\"reorder_level\",type:\"text\",placeholder:\"New Reorder Level\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-hospital\"})})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"label is-small\",children:[\"Old Reorder Level\",/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left has-icons-right\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small \",ref:register(),disabled:true,name:\"oldlevel\",type:\"text\",placeholder:\"Old Reorder Level\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-map-signs\"})})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field  is-grouped mt-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"button is-success is-small\",onClick:handleSubmit(onSubmit),children:\"Save\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-warning is-small\",onClick:handleCancel,children:\"Cancel\"})})]})]})]})});}export function InventoryBatches(){var _useForm4=useForm(),register=_useForm4.register,handleSubmit=_useForm4.handleSubmit,setValue=_useForm4.setValue,reset=_useForm4.reset,errors=_useForm4.errors;//watch, errors,\n// eslint-disable-next-line \nvar _useState49=useState(false),_useState50=_slicedToArray(_useState49,2),error=_useState50[0],setError=_useState50[1];// eslint-disable-next-line \nvar _useState51=useState(false),_useState52=_slicedToArray(_useState51,2),success=_useState52[0],setSuccess=_useState52[1];// eslint-disable-next-line \nvar _useState53=useState(\"\"),_useState54=_slicedToArray(_useState53,2),message=_useState54[0],setMessage=_useState54[1];var _useState55=useState(),_useState56=_slicedToArray(_useState55,2),billservice=_useState56[0],setBillService=_useState56[1];// eslint-disable-next-line \nvar InventoryServ=client.service('inventory');//const history = useHistory()\n// eslint-disable-next-line\nvar _useContext11=useContext(UserContext),user=_useContext11.user;var _useContext12=useContext(ObjectContext),state=_useContext12.state,setState=_useContext12.setState;var billServ=client.service('billing');var _useState57=useState(\"\"),_useState58=_slicedToArray(_useState57,2),batchNo=_useState58[0],setBatchNo=_useState58[1];var _useState59=useState(\"\"),_useState60=_slicedToArray(_useState59,2),quantity=_useState60[0],setQuantity=_useState60[1];var _useState61=useState(\"\"),_useState62=_slicedToArray(_useState61,2),expirydate=_useState62[0],setExpiryDate=_useState62[1];var _useState63=useState([]),_useState64=_slicedToArray(_useState63,2),facilities=_useState64[0],setFacilities=_useState64[1];var _useState65=useState([]),_useState66=_slicedToArray(_useState65,2),productItem=_useState66[0],setProductItem=_useState66[1];var Inventory=state.InventoryModule.selectedInventory;// set inventory\n// setProductItem(Inventory.batches)\n// console.log(Inventory)\n//\nuseEffect(function(){setProductItem(Inventory.batches);return function(){};},[]);var handleClickProd=/*#__PURE__*/function(){var _ref16=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee16(){var productItemI;return _regeneratorRuntime.wrap(function _callee16$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:if(!(!batchNo||!quantity||!expirydate)){_context16.next=3;break;}toast({message:'Kindly enter Batch Number,expiry date and quantity',type:'is-danger',dismissible:true,pauseOnHover:true});return _context16.abrupt(\"return\");case 3:productItemI={batchNo:batchNo,expirydate:expirydate,quantity:quantity};//  await setSuccess(false)\nsetProductItem(function(prevProd){return prevProd.concat(productItemI);});setBatchNo(\"\");setQuantity(\"\");setExpiryDate(\"\");// await setSuccess(true)\n// setBaseunit(\"\")\n// console.log(success)\n//  console.log(productItem)\ncase 8:case\"end\":return _context16.stop();}}},_callee16);}));return function handleClickProd(){return _ref16.apply(this,arguments);};}();var handleCancel=/*#__PURE__*/function(){var _ref17=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee17(){var newInventoryModule;return _regeneratorRuntime.wrap(function _callee17$(_context17){while(1){switch(_context17.prev=_context17.next){case 0:newInventoryModule={selectedInventory:{},show:'details'};_context17.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});case 3:case\"end\":return _context17.stop();}}},_callee17);}));return function handleCancel(){return _ref17.apply(this,arguments);};}();var changeState=function changeState(){var newInventoryModule={selectedInventory:{},show:'details'};setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{InventoryModule:newInventoryModule});});};var onSubmit=function onSubmit(data,e){e.preventDefault();setSuccess(false);InventoryServ.patch(Inventory._id,{batches:productItem}).then(function(res){toast({message:'Batch updated succesfully',type:'is-success',dismissible:true,pauseOnHover:true});changeState();}).catch(function(err){toast({message:\"Error updating Batch, probable network issues or \"+err,type:'is-danger',dismissible:true,pauseOnHover:true});});};var handleBatchdel=function handleBatchdel(obj,i){var confirm=window.confirm(\"Are you sure you want to delete this batch?\");if(confirm){// setProductItem(prev=>prev.filter((obj,index)=>index!==i ))\nsetProductItem(function(obj){return obj.filter(function(el,index){return index!==i;});});}};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card  card-overflow\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"card-header-title\",children:[\"Batches for \",Inventory.name,\" \"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content vscrollable\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"field is-horizontal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"field-body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"p\",{className:\"control \",children:/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\"/* ref={register({ required: true })} */,name:\"batchNo\",value:batchNo,type:\"text\",onChange:function onChange(e){return setBatchNo(e.target.value);},placeholder:\"Batch Number\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(DatePicker,{selected:expirydate,onChange:function onChange(date){return setExpiryDate(date);},dateFormat:\"MM/yyyy\",placeholderText:\"Expiry Date\"/*  isClearable */})}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"control \",children:/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\"/* ref={register({ required: true })} */,name:\"quantity\",value:quantity,type:\"text\",onChange:function onChange(e){return setQuantity(e.target.value);},placeholder:\"Quantity\"})}),/*#__PURE__*/_jsx(\"label\",{children:Inventory.baseunit})]}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-info is-small  is-pulled-right minHt\",children:/*#__PURE__*/_jsx(\"span\",{className:\"is-small\",onClick:handleClickProd,children:\" +\"})})})})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"table\",{className:\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Serial No\",children:\"S/No\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Batch\",children:\"Batch\"})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Quantity\",children:\"Quantity\"})}),/*#__PURE__*/_jsx(\"th\",{children:\"Expiry Date\"}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"abbr\",{title:\"Actions\",children:\"Actions\"})})]})}),/*#__PURE__*/_jsx(\"tfoot\",{}),/*#__PURE__*/_jsx(\"tbody\",{children:productItem.map(function(ProductEntry,i){return/*#__PURE__*/_jsxs(\"tr\",{style:{backgroundColor:ProductEntry.expiry?\"red\":\"\"},children:[/*#__PURE__*/_jsx(\"th\",{children:i+1}),/*#__PURE__*/_jsx(\"td\",{children:ProductEntry.batchNo}),/*#__PURE__*/_jsx(\"td\",{children:ProductEntry.quantity}),/*#__PURE__*/_jsx(\"th\",{children:ProductEntry.expirydate?/*#__PURE__*/_jsx(_Fragment,{children:format(new Date(ProductEntry.expirydate),\"MM-yyyy\")}):\"\"}),/*#__PURE__*/_jsx(\"td\",{onClick:function onClick(){return handleBatchdel(ProductEntry,i);},children:/*#__PURE__*/_jsx(\"span\",{className:\"showAction\",children:\"x\"})})]},i);})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"field  is-grouped mt-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"button is-success is-small\",onClick:handleSubmit(onSubmit),children:\"Save\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-warning is-small\",onClick:handleCancel,children:\"Cancel\"})})]})]})]})});}export function ProductSearch(_ref18){var getSearchfacility=_ref18.getSearchfacility,clear=_ref18.clear;var facilityServ=client.service('products');var _useState67=useState([]),_useState68=_slicedToArray(_useState67,2),facilities=_useState68[0],setFacilities=_useState68[1];// eslint-disable-next-line\nvar _useState69=useState(false),_useState70=_slicedToArray(_useState69,2),searchError=_useState70[0],setSearchError=_useState70[1];// eslint-disable-next-line\nvar _useState71=useState(false),_useState72=_slicedToArray(_useState71,2),showPanel=_useState72[0],setShowPanel=_useState72[1];// eslint-disable-next-line\nvar _useState73=useState(\"\"),_useState74=_slicedToArray(_useState73,2),searchMessage=_useState74[0],setSearchMessage=_useState74[1];// eslint-disable-next-line \nvar _useState75=useState(\"\"),_useState76=_slicedToArray(_useState75,2),simpa=_useState76[0],setSimpa=_useState76[1];// eslint-disable-next-line \nvar _useState77=useState(false),_useState78=_slicedToArray(_useState77,2),chosen=_useState78[0],setChosen=_useState78[1];// eslint-disable-next-line \nvar _useState79=useState(0),_useState80=_slicedToArray(_useState79,2),count=_useState80[0],setCount=_useState80[1];var inputEl=useRef(null);var handleRow=/*#__PURE__*/function(){var _ref19=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee18(obj){return _regeneratorRuntime.wrap(function _callee18$(_context18){while(1){switch(_context18.prev=_context18.next){case 0:_context18.next=2;return setChosen(true);case 2://alert(\"something is chaning\")\ngetSearchfacility(obj);_context18.next=5;return setSimpa(obj.facilityName);case 5:// setSelectedFacility(obj)\nsetShowPanel(false);_context18.next=8;return setCount(2);case 8:case\"end\":return _context18.stop();}}},_callee18);}));return function handleRow(_x3){return _ref19.apply(this,arguments);};}();var handleBlur=/*#__PURE__*/function(){var _ref20=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee19(e){return _regeneratorRuntime.wrap(function _callee19$(_context19){while(1){switch(_context19.prev=_context19.next){case 0:case\"end\":return _context19.stop();}}},_callee19);}));return function handleBlur(_x4){return _ref20.apply(this,arguments);};}();var handleSearch=/*#__PURE__*/function(){var _ref21=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee20(val){var field,_query2;return _regeneratorRuntime.wrap(function _callee20$(_context20){while(1){switch(_context20.prev=_context20.next){case 0:field='name';//field variable\nif(!(val.length>=3)){_context20.next=5;break;}facilityServ.find({query:(_query2={},_defineProperty(_query2,field,{$regex:val,$options:'i'}),_defineProperty(_query2,\"$limit\",10),_defineProperty(_query2,\"$sort\",{createdAt:-1}),_query2)}).then(function(res){//console.log(\"facility  fetched successfully\") \nsetFacilities(res.data);setSearchMessage(\" facility  fetched successfully\");setShowPanel(true);}).catch(function(err){console.log(err);setSearchMessage(\"Error searching facility, probable network issues \"+err);setSearchError(true);});_context20.next=8;break;case 5://console.log(\"less than 3 \")\n//console.log(val)\nsetShowPanel(false);_context20.next=8;return setFacilities([]);case 8:case\"end\":return _context20.stop();}}},_callee20);}));return function handleSearch(_x5){return _ref21.apply(this,arguments);};}();useEffect(function(){if(clear){setSimpa(\"\");}return function(){};},[clear]);return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"div\",{className:\"control has-icons-left  \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown \".concat(showPanel?\"is-active\":\"\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-trigger\",children:[/*#__PURE__*/_jsx(DebounceInput,{className:\"input is-small \",type:\"text\",placeholder:\"Search Product\",value:simpa,minLength:1,debounceTimeout:400,onBlur:function onBlur(e){return handleBlur(e);},onChange:function onChange(e){return handleSearch(e.target.value);},inputRef:inputEl}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search\"})})]}),searchError&&/*#__PURE__*/_jsx(\"div\",{children:searchMessage}),/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-menu\",children:/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-content\",children:facilities.map(function(facility,i){return/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-item\",onClick:function onClick(){return handleRow(facility);},children:/*#__PURE__*/_jsx(\"span\",{children:facility.facilityName})},facility._id);})})})]})})})});}","map":{"version":3,"sources":["/home/mfybaby/Documents/HealthStack2/HS-frontend/src/components/Pharmacy/InventoryStore.js"],"names":["React","useState","useContext","useEffect","useRef","client","DebounceInput","useForm","UserContext","ObjectContext","toast","InfiniteScroll","DatePicker","formatDistanceToNowStrict","format","subDays","addDays","ProductEntryCreate","searchfacility","Inventory","state","selectedInventory","setSelectedInventory","InventoryModule","show","InventoryCreate","register","handleSubmit","setValue","error","setError","success","setSuccess","message","setMessage","facility","setFacility","InventoryServ","service","user","currentUser","setCurrentUser","getSearchfacility","obj","_id","shouldValidate","shouldDirty","stacker","currentEmployee","facilityDetail","onSubmit","data","e","preventDefault","create","then","res","target","reset","type","dismissible","pauseOnHover","catch","err","required","display","InventoryList","facilities","setFacilities","setState","setUser","page","setPage","limit","setLimit","total","setTotal","pages","handleCreateNew","newInventoryModule","prevstate","handleRow","handleSearch","val","field","find","query","$regex","$options","StoreModule","selectedStore","name","console","log","getInventories","storeId","$limit","$skip","$sort","allInventory","length","updatelist","createdAt","findInventory","getNewInventories","on","rest","prevdata","concat","value","map","i","backgroundColor","buy","quantity","baseunit","stockvalue","toLocaleString","maximumFractionDigits","costprice","toFixed","sellingprice","reorder_level","expiry","InventoryDetail","getFacilities","productId","findProductEntry","handleEdit","handleReorder","handleBatch","handleAudit","InventoryModify","errors","billservice","setBillService","billServ","handleSetPrice","get","billingId","contractSel","contracts","filter","element","source_org","dest_org","price","handleCancel","changeState","handleDelete","conf","window","confirm","dleteId","remove","patch","InventoryReorder","InventoryBatches","batchNo","setBatchNo","setQuantity","expirydate","setExpiryDate","productItem","setProductItem","batches","handleClickProd","productItemI","prevProd","handleBatchdel","el","index","date","ProductEntry","Date","ProductSearch","clear","facilityServ","searchError","setSearchError","showPanel","setShowPanel","searchMessage","setSearchMessage","simpa","setSimpa","chosen","setChosen","count","setCount","inputEl","facilityName","handleBlur"],"mappings":"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","sourcesContent":["/* eslint-disable */\nimport React, {useState,useContext, useEffect,useRef} from 'react'\nimport client from '../../feathers'\nimport {DebounceInput} from 'react-debounce-input';\nimport { useForm } from \"react-hook-form\";\n//import {useHistory} from 'react-router-dom'\nimport {UserContext,ObjectContext} from '../../context'\nimport {toast} from 'bulma-toast'\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport DatePicker from \"react-datepicker\";\nimport { formatDistanceToNowStrict, format, subDays,addDays } from 'date-fns'\nimport { ProductEntryCreate } from './ProductEntry';\n\nimport \"react-datepicker/dist/react-datepicker.css\";\n\n// eslint-disable-next-line\nconst searchfacility={};\n\n\nexport default function Inventory() {\n    const {state}=useContext(ObjectContext) //,setState\n    // eslint-disable-next-line\n    const [selectedInventory,setSelectedInventory]=useState()\n    //const [showState,setShowState]=useState() //create|modify|detail\n    \n    return(\n        <section className= \"section remPadTop\">\n           {/*  <div className=\"level\">\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Inventory  Module</span></div>\n            </div> */}\n            <div className=\"columns \">\n            <div className=\"column is-8 \">\n                <InventoryList />\n                </div>\n            <div className=\"column is-4 \">\n                {(state.InventoryModule.show ==='create')&&<InventoryCreate />}\n                {(state.InventoryModule.show ==='detail')&&<InventoryDetail  />}\n                {(state.InventoryModule.show ==='modify')&&<InventoryModify Inventory={selectedInventory} />}\n                {(state.InventoryModule.show ==='reorder')&&<InventoryReorder Inventory={selectedInventory} />}\n                {(state.InventoryModule.show ==='batch')&&<InventoryBatches Inventory={selectedInventory} />}\n                {(state.InventoryModule.show ==='audit')&&<ProductEntryCreate  Inventory={selectedInventory} />}\n            </div>\n\n            </div>                            \n            </section>\n       \n    )\n    \n}\n\nexport function InventoryCreate(){\n    const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \n    const [error, setError] =useState(false)\n    const [success, setSuccess] =useState(false)\n    const [message,setMessage] = useState(\"\")\n    // eslint-disable-next-line\n    const [facility,setFacility] = useState()\n    const InventoryServ=client.service('inventory')\n    //const history = useHistory()\n    const {user} = useContext(UserContext) //,setUser\n    // eslint-disable-next-line\n    const [currentUser,setCurrentUser] = useState()\n    \n\n\n    const getSearchfacility=(obj)=>{\n        \n        setValue(\"facility\", obj._id,  {\n            shouldValidate: true,\n            shouldDirty: true\n        })\n    }\n    \n    useEffect(() => {\n        setCurrentUser(user)\n        //console.log(currentUser)\n        return () => {\n        \n        }\n    }, [user])\n\n  //check user for facility or get list of facility  \n    useEffect(()=>{\n        //setFacility(user.activeInventory.FacilityId)//\n      if (!user.stacker){\n          //console.log(currentUser)\n        setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\n            shouldValidate: true,\n            shouldDirty: true\n        }) \n      }\n    })\n\n    const onSubmit = (data,e) =>{\n        e.preventDefault();\n        setMessage(\"\")\n        setError(false)\n        setSuccess(false)\n         // data.createdby=user._id\n          //console.log(data);\n          if (user.currentEmployee){\n         data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\n          }\n        InventoryServ.create(data)\n        .then((res)=>{\n                //console.log(JSON.stringify(res))\n                e.target.reset();\n               /*  setMessage(\"Created Inventory successfully\") */\n                setSuccess(true)\n                toast({\n                    message: 'Inventory created succesfully',\n                    type: 'is-success',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n                  setSuccess(false)\n            })\n            .catch((err)=>{\n                toast({\n                    message: 'Error creating Inventory ' + err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n            })\n\n      } \n\n    return (\n        <>\n            <div className=\"card \">\n            <div className=\"card-header\">\n                <p className=\"card-header-title\">\n                    Create Inventory: Product Entry- Initialization, Purchase Invoice, Audit\n                </p>\n            </div>\n            <div className=\"card-content vscrollable\">\n   \n            <form onSubmit={handleSubmit(onSubmit)}>\n            <div className=\"field\">    \n                <div class=\"control\">\n                    <div class=\"select is-small\">\n                        <select>\n                            <option>Purchase Invoice </option>\n                            <option>Initialization</option>\n                            <option>Audit</option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n            <div className=\"field\">\n                <p className=\"control has-icons-left\"> {/* Audit/initialization/Purchase Invoice */}\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"type\" type=\"text\" placeholder=\"Type of Product Entry\"/>\n                    <span className=\"icon is-small is-left\">\n                    <i className=\" fas fa-user-md \"></i>\n                    </span>\n                </p>\n            </div>\n                <div className=\"field\">\n                    <p className=\"control has-icons-left has-icons-right\">\n                        <input className=\"input is-small\" ref={register({ required: true })}  name=\"supplier\" type=\"text\" placeholder=\"Supplier\" />\n                        <span className=\"icon is-small is-left\">\n                            <i className=\"fas fa-hospital\"></i>\n                        </span>                    \n                    </p>\n                </div>\n                <div className=\"field\">\n                    <p className=\"control has-icons-left has-icons-right\">\n                    <input className=\"input is-small\" ref={register({ required: true })}  name=\"date\" type=\"text\" placeholder=\"Date\" />\n                    <span className=\"icon is-small is-left\">\n                        <i className=\"fas fa-map-signs\"></i>\n                    </span>\n                    \n                </p>\n            </div>\n            \n            <div className=\"field\">\n                <p className=\"control has-icons-left\">\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"totalamount\" type=\"text\" placeholder=\" Total Amount\"/>\n                    <span className=\"icon is-small is-left\">\n                    <i className=\"fas fa-phone-alt\"></i>\n                    </span>\n                </p>\n            </div>\n           \n         {/* array of inventory items */}\n         <p className=\"control\">\n                    <button className=\"button is-info is-small  is-pulled-right\">\n                      <span className=\"is-small\"> +</span>\n                    </button>\n                </p>\n           <div className=\"field\"  /* style={ !user.stacker?{display:\"none\"}:{}} */ >\n                <ProductSearch  getSearchfacility={getSearchfacility} clear={success} /> \n                <p className=\"control has-icons-left \" style={{display:\"none\"}}>\n                    <input className=\"input is-small\" ref={register ({ required: true }) } /* add array no */ name=\"productId\" type=\"text\" placeholder=\"Product Id\" />\n                    <span className=\"icon is-small is-left\">\n                    <i className=\"fas  fa-map-marker-alt\"></i>\n                    </span>\n                </p>\n            </div>\n           \n               <div className=\"field\">\n                <p className=\"control has-icons-left\">\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"quantity\" type=\"text\" placeholder=\"Quantity\"  />\n                    <span className=\"icon is-small is-left\">\n                    <i className=\"fas fa-envelope\"></i>\n                    </span>\n                </p>\n                <label className=\"label is-small\">Base Unit</label>\n            </div> \n            <div className=\"field\">\n                <p className=\"control has-icons-left\">\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"costprice\" type=\"text\" placeholder=\"Cost Price\"  />\n                    <span className=\"icon is-small is-left\">\n                    <i className=\"fas fa-envelope\"></i>\n                    </span>\n                </p>\n            </div> \n           {/*  <div className=\"field\">\n                <div className=\"control has-icons-left\">\n                    <div className=\"dropdown \">\n                        <div className=\"dropdown-trigger\">\n                            <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\n                            <span className=\"icon is-small is-left\">\n                            <i className=\"fas fa-hospital-symbol\"></i>\n                            </span>\n                        </div>\n                        <div className=\"dropdown-menu\">\n                            <div className=\"dropdown-content\">\n                                <div className=\"dropdown-item\">\n                                    simpa\n                                </div>\n                                <div className=\"dropdown-item is-active\">\n                                    simpa 2\n                                </div>\n                                <div className=\"dropdown-item\">\n                                    simpa 3\n                                </div>\n                                <div className=\"dropdown-item\">\n                                    simpa 4\n                                </div>\n                            </div>\n                        </div>   \n                    </div>\n                </div>\n            </div>\n            <div className=\"field\">\n                <p className=\"control has-icons-left\">\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Department Unit\"/>\n                    <span className=\"icon is-small is-left\">\n                    <i className=\"fas fa-clinic-medical\"></i>\n                    </span>\n                </p>\n            </div>\n            <div className=\"field\">\n                <p className=\"control has-icons-left\">\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"password\" type=\"text\" placeholder=\"password\"/>\n                    <span className=\"icon is-small is-left\">\n                    <i className=\"fas fa-clinic-medical\"></i>\n                    </span>\n                </p>\n            </div> */}\n            <div className=\"field\">\n                <p className=\"control\">\n                    <button className=\"button is-success is-small\">\n                        Create\n                    </button>\n                </p>\n            </div>\n            \n            </form>\n            </div>\n            </div>\n        </>\n    )\n   \n}\n\nexport function InventoryList(){\n   // const { register, handleSubmit, watch, errors } = useForm();\n    // eslint-disable-next-line\n    const [error, setError] =useState(false)\n     // eslint-disable-next-line\n    const [success, setSuccess] =useState(false)\n     // eslint-disable-next-line\n   const [message, setMessage] = useState(\"\") \n    const InventoryServ=client.service('inventory')\n    //const history = useHistory()\n   // const {user,setUser} = useContext(UserContext)\n    const [facilities,setFacilities]=useState([])\n     // eslint-disable-next-line\n   const [selectedInventory, setSelectedInventory]=useState() //\n    // eslint-disable-next-line\n    const {state,setState}=useContext(ObjectContext)\n    // eslint-disable-next-line\n    const {user,setUser}=useContext(UserContext)\n    const [page, setPage] = useState(0) \n    const [limit, setLimit] = useState(20) \n    const [total, setTotal] = useState(0) \n\n   // const store = state.StoreModule.selectedStore\n    let pages =0\n    const handleCreateNew = async()=>{\n        const    newInventoryModule={\n            selectedInventory:{},\n            show :'create'\n            }\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n       //console.log(state)\n    }\n\n    const handleRow= async(Inventory)=>{\n        //console.log(\"b4\",state)\n\n        //console.log(\"handlerow\",Inventory)\n\n        await setSelectedInventory(Inventory)\n\n        const    newInventoryModule={\n            selectedInventory:Inventory,\n            show :'detail'\n        }\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n       //console.log(state)\n\n    }\n\n    const handleSearch=(val)=>{\n       const field='name'\n       //console.log(val)\n       InventoryServ.find({query: {\n                [field]: {\n                    $regex:val,\n                    $options:'i'\n                   \n                },\n               facility:user.currentEmployee.facilityDetail._id || \"\",\n               storeId:state.StoreModule.selectedStore._id,\n                $limit:100,\n                $sort: {\n                    name: 1\n                  }\n                    }}).then((res)=>{\n                //console.log(res)\n               setFacilities(res.data)\n               setTotal(res.total)\n                setMessage(\" Inventory  fetched successfully\")\n                setSuccess(true) \n            })\n            .catch((err)=>{\n                console.log(err)\n                setMessage(\"Error fetching Inventory, probable network issues \"+ err )\n                setError(true)\n            })\n    }\n   \n    const getInventories= async()=>{\n            if (user.currentEmployee){\n            \n              if (page===1){\n                  setPage(2)\n              }\n            const allInventory= await InventoryServ.find(\n                    {query: {\n                        facility:user.currentEmployee.facilityDetail._id,\n                        storeId:state.StoreModule.selectedStore._id,\n                        $limit:limit,\n                        $skip:page * limit,\n                        $sort: {\n                            name: 1\n                        }\n                        }})\n                        //console.log(\"this is data\", allInventory)\n           // await setFacilities(findInventory.data)\n          // await setFacilities(prevstate=>prevstate.concat(allInventory.data))\n           await setTotal(allInventory.total)\n         \n           if (allInventory.total > facilities.length){\n            await  setPage(page=>page++)\n           }\n\n           updatelist(allInventory.data)\n          // pages++\n         console.log(allInventory)\n            //\n        // console.log(0>0)\n        // console.log(total,facilities.length)\n                }\n                else {\n                    if (user.stacker){\n                        const findInventory= await InventoryServ.find(\n                            {query: {\n                                \n                                $limit:20,\n                                $sort: {\n                                    createdAt: -1\n                                }\n                                }})\n            \n                    await setFacilities(findInventory.data)\n\n                    }\n                }\n    }\n    \n    const getNewInventories= async()=>{\n        if (user.currentEmployee){\n        \n          \n        const allInventory= await InventoryServ.find(\n                {query: {\n                    facility:user.currentEmployee.facilityDetail._id,\n                    storeId:state.StoreModule.selectedStore._id,\n                    $limit:2000, //limit,\n                   /*  $skip:page * limit, */\n                    $sort: {\n                        name: 1\n                    }\n                    }})\n                    console.log(\"this is data\", allInventory)\n       // await setFacilities(findInventory.data)\n       await setTotal(allInventory.total)\n       await setFacilities(allInventory.data)\n     \n       if (allInventory.total> allInventory.data.length){\n       // setNext(true)\n          setPage(page=>page+1)\n       } else{\n        //setNext(fals \n       }    \n\n      // pages++\n    // console.log(findProduct)\n        //\n    // console.log(0>0)\n    // console.log(total,facilities.length)\n            }\n            else {\n                if (user.stacker){\n                    const findInventory= await InventoryServ.find(\n                        {query: {\n                            \n                            $limit:20,\n                            $sort: {\n                                createdAt: -1\n                            }\n                            }})\n        \n                await setFacilities(findInventory.data)\n\n                }\n            }\n    }\n\n    useEffect(() => {\n               \n               \n                InventoryServ.on('created', (obj)=>rest())\n                InventoryServ.on('updated', (obj)=>rest())\n                InventoryServ.on('patched', (obj)=>rest())\n                InventoryServ.on('removed', (obj)=>rest())\n                return () => {\n                    \n                }\n    },[])\n\n    const rest = async ()=>{\n        //console.log(\"starting rest\")\n       setPage(0) \n       setTotal(0) \n       getNewInventories()\n         //await  setPage(0) \n\n    }\n\n    const updatelist=async(data)=>{\n        await setFacilities(prevdata=>prevdata.concat(data))\n     }\n     \n    useEffect(() => {\n       \n            rest() \n            return () => {\n               \n            }\n    }, [state.StoreModule.selectedStore])\n\n    useEffect(() => {\n       console.log(page)\n        return () => {\n           \n        }\n    }, [page])\n\n    //todo: pagination and vertical scroll bar\n\n    return(\n        <>\n           {user?( <>  \n                <div className=\"level\">\n                    <div className=\"level-left\">\n                        <div className=\"level-item\">\n                            <div className=\"field\">\n                                <p className=\"control has-icons-left  \">\n                                    <DebounceInput className=\"input is-small \" \n                                        type=\"text\" placeholder=\"Search Inventory\"\n                                        minLength={3}\n                                        debounceTimeout={400}\n                                        onChange={(e)=>handleSearch(e.target.value)} />\n                                    <span className=\"icon is-small is-left\">\n                                        <i className=\"fas fa-search\"></i>\n                                    </span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Inventory </span></div>\n                    {/* <div className=\"level-right\">\n                        <div className=\"level-item\"> \n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\n                        </div>\n                    </div> */}\n\n                </div>\n\n                <div className=\"table-container pullup vscrola\" id=\"scrollableDiv\" >\n                    <InfiniteScroll\n                        dataLength={facilities.length}\n                        next={getInventories}\n                        hasMore={total>facilities.length}\n                        loader={<h4>Loading...</h4>}\n                        scrollableTarget=\"scrollableDiv\"\n                    >\n                \n                    <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\n                                \n                        <thead>\n                            <tr>\n                            <th><abbr title=\"Serial No\">S/No</abbr></th>\n                            {/* <th><abbr title=\"Category\">Category</abbr></th> */}\n                            <th>Product</th>\n                            <th><abbr title=\"Quantity\">Quantity</abbr></th>\n                            <th><abbr title=\"Base Unit\">Base Unit</abbr></th>\n                            <th><abbr title=\"Stock Value\">Stock Value</abbr></th>\n                                <th><abbr title=\"Cost Price\">Cost Price</abbr></th>\n                            <th><abbr title=\"Selling Price\">Selling Price</abbr></th>\n                            <th><abbr title=\"Re-Order Level\">Re-Order Level</abbr></th>\n                            <th><abbr title=\"Expiry\">Expiry</abbr></th> \n                            {/* <th><abbr title=\"Actions\">Actions</abbr></th> */}\n                            </tr>\n                        </thead>\n                        <tfoot>\n                            \n                        </tfoot>\n                        <tbody>\n                            {facilities.map((Inventory, i)=>(\n\n                                <tr key={Inventory._id} \n                                    onClick={()=>handleRow(Inventory)} \n                                    className={Inventory._id===(selectedInventory?._id||null)?\"is-selected\":\"\"} \n                                   style={{backgroundColor:Inventory.buy?\"pink\":\"\"}} \n                                   >\n                                <th>{i+1}</th>\n                                {/* <td>{Inventory.productDetail.category}</td> */}\n                                <th>{Inventory.name}</th>\n                                <td>{Inventory.quantity}</td>\n                                <td>{Inventory.baseunit}</td>\n                                <td>{Inventory.stockvalue.toLocaleString('en-US', {maximumFractionDigits:2})}</td>\n                                <td>{Inventory.costprice? Inventory.costprice.toFixed(2):\"\"}</td>\n                                <td>{Inventory.sellingprice}</td>\n                                <td>{Inventory.reorder_level}</td> \n                                <td style={{backgroundColor:Inventory.expiry?\"red\":\"\"}} >{Inventory.expiry?\"Exist\":\"\"}</td>\n                                {/* <td><span className=\"showAction\"  >...</span></td> */}\n                                \n                                </tr>\n\n                            ))}\n                        </tbody>\n                        </table>\n                        </InfiniteScroll> \n                </div>              \n            </>):<div>loading</div>}\n            </>\n              \n    )\n    }\n\n\nexport function InventoryDetail(){\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\n     // eslint-disable-next-line\n    const [error, setError] =useState(false) //, \n    //const [success, setSuccess] =useState(false)\n     // eslint-disable-next-line\n    const [message, setMessage] = useState(\"\") //,\n    //const InventoryServ=client.service('/Inventory')\n    //const history = useHistory()\n    //const {user,setUser} = useContext(UserContext)\n    const {state,setState} = useContext(ObjectContext)\n    const {user} = useContext(UserContext) //,setUser\n    \n   \n\n   const Inventory =state.InventoryModule.selectedInventory \n   //console.log(\"selected\",Inventory)\n\n   \n  const getFacilities= async()=>{\n     const findProductEntry= await client.service('productentry').find(\n        {query: {\n            'productitems.productId':Inventory.productId,\n            facility:user.currentEmployee.facilityDetail._id,\n            storeId:state.StoreModule.selectedStore._id,\n            $limit:20,\n            $sort: {\n                createdAt: -1\n            }\n            }})\n\n        //console.log(findProductEntry)\n       }\n    \n       useEffect(() => {\n        getFacilities()\n           return () => {\n               \n           }\n       }, [Inventory])\n\n    const handleEdit= async()=>{\n        const    newInventoryModule={\n            selectedInventory:Inventory,\n            show :'modify'\n        }\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n       //console.log(state)\n       \n    }\n    const handleReorder= async()=>{\n        const    newInventoryModule={\n            selectedInventory:Inventory,\n            show :'reorder'\n        }\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n       //console.log(state)\n       \n    }\n    const handleBatch= async()=>{\n        const    newInventoryModule={\n            selectedInventory:Inventory,\n            show :'batch'\n        }\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n       //console.log(state)\n       \n    }\n    const handleAudit= async()=>{\n        const    newInventoryModule={\n            selectedInventory:Inventory,\n            show :'audit'\n        }\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n       //console.log(state)\n       \n    }\n    return (\n        <>\n        <div className=\"card \">\n            <div className=\"card-header\">\n                <p className=\"card-header-title\">\n                    Inventory Details\n                </p>\n            </div>\n            <div className=\"card-content vscrollable\">\n           \n                <table> \n                <tbody>         \n                <tr>\n                    <td>\n                \n                    <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\n                            <i className=\"fas fa-hospital\"></i>\n                        </span>                    \n                        Product Name: \n                        </label>\n                        </td>\n                        <td>\n                        <span className=\"is-size-7 padleft\"   name=\"name\"><strong> {Inventory.name} </strong></span>\n                        </td>\n                    </tr>\n            </tbody> \n            </table> \n           \n            <div className=\"field mt-2 is-grouped\">\n                <p className=\"control\">\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\n                        Set Price\n                    </button>\n                </p>\n               {/*  <p className=\"control\">\n                    <button className=\"button is-danger is-small\"   onClick={handleSetPrice}>\n                        Audit\n                    </button>\n                </p>*/}\n                <p className=\"control\">\n                    <button className=\"button is-info is-small\" onClick={handleBatch} >\n                        Batches\n                    </button>\n                </p>\n                <p className=\"control\">\n                    <button className=\"button is-warning is-small\"  onClick={handleReorder} >\n                        Reorder Level\n                    </button>\n                </p> \n                <p className=\"control\">\n                    <button className=\"button is-danger is-small\"  onClick={handleAudit} >\n                       Audit\n                    </button>\n                </p> \n            </div>\n            { error && <div className=\"message\"> {message}</div>}\n           \n        </div>\n        </div>\n        </>\n    )\n   \n   \n}\n\nexport function InventoryModify(){\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\n    // eslint-disable-next-line \n    const [error, setError] =useState(false)\n    // eslint-disable-next-line \n    const [success, setSuccess] =useState(false)\n    // eslint-disable-next-line \n    const [message,setMessage] = useState(\"\")\n    const [billservice,setBillService] = useState()\n    // eslint-disable-next-line \n    const InventoryServ=client.service('inventory')\n    //const history = useHistory()\n     // eslint-disable-next-line\n    const {user} = useContext(UserContext)\n    const {state,setState} = useContext(ObjectContext)\n    const billServ=client.service('billing')\n\n    const Inventory =state.InventoryModule.selectedInventory // set inventory\n    const handleSetPrice = async()=>{\n    \n        const service = await  billServ.get(Inventory.billingId) // get the service\n            const contractSel= service.contracts.filter(element=>(element.source_org===Inventory.facility && element.dest_org===Inventory.facility))\n            \n            setValue(\"price\", contractSel[0].price,  {\n                shouldValidate: true,\n                shouldDirty: true\n            })\n            setValue(\"oldprice\", contractSel[0].price,  {\n                shouldValidate: true,\n                shouldDirty: true\n            })\n            await setBillService(service)\n            //console.log(contractSel,service)\n    }\n \n        useEffect(() => {\n            handleSetPrice()\n     \n            return () => {\n                \n            }\n        },[])\n\n   const handleCancel=async()=>{\n   \n    const    newInventoryModule={\n        selectedInventory:{},\n        show :'details'\n      }\n        await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n   ////console.log(state)\n           }\n\n\n        const changeState =()=>{\n            const    newInventoryModule={\n                selectedInventory:{},\n                show :'detail'\n            }\n        setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n\n        }\n\n\n    const handleDelete=async()=>{\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\n        \n        const dleteId=Inventory._id\n        if (conf){\n             \n        InventoryServ.remove(dleteId)\n        .then((res)=>{\n                ////console.log(JSON.stringify(res))\n                reset();\n               /*  setMessage(\"Deleted Inventory successfully\")\n                setSuccess(true)\n                changeState()\n               setTimeout(() => {\n                setSuccess(false)\n                }, 200); */\n                toast({\n                    message: 'Inventory deleted succesfully',\n                    type: 'is-success',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n                changeState()\n            })\n            .catch((err)=>{\n               // setMessage(\"Error deleting Inventory, probable network issues \"+ err )\n               // setError(true)\n                toast({\n                    message: \"Error deleting Inventory, probable network issues or \"+ err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n            })\n        }\n    }\n        \n\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\n            shouldValidate: true,\n            shouldDirty: true\n          })) */\n    const onSubmit = (data,e) =>{\n        e.preventDefault();\n        \n        setSuccess(false)\n        //console.log(data)\n       // data.facility=Inventory.facility\n          //console.log(data);\n          const contractSel= billservice.contracts.filter(element=>(element.source_org===Inventory.facility && element.dest_org===Inventory.facility))\n          contractSel[0].price=data.price \n          billServ.patch(billservice._id,billservice)\n        .then((res)=>{\n                //console.log(JSON.stringify(res))\n               // e.target.reset();\n               // setMessage(\"updated Inventory successfully\")\n                 toast({\n                    message: 'Price updated succesfully',\n                    type: 'is-success',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n                  \n                changeState()\n\n            })\n            .catch((err)=>{\n                //setMessage(\"Error creating Inventory, probable network issues \"+ err )\n               // setError(true)\n                toast({\n                    message: \"Error updating Price, probable network issues or \"+ err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n            }) \n\n      } \n     \n      \n    return (\n        \n        <>\n        <div className=\"card \">\n            <div className=\"card-header\">\n                <p className=\"card-header-title\">\n                    Set Price for {Inventory.name} per {Inventory.baseunit}\n                </p>\n            </div>\n            <div className=\"card-content vscrollable\">\n           \n            <form onSubmit={handleSubmit(onSubmit)}>\n                <div className=\"field\">\n                    <label className=\"label is-small\"> New Selling Price\n                    <p className=\"control has-icons-left has-icons-right\">\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"price\" type=\"text\" placeholder=\"Name\" />\n                        <span className=\"icon is-small is-left\">\n                            <i className=\"fas fa-hospital\"></i>\n                        </span>                    \n                    </p>\n                    </label>\n                    </div>\n                <div className=\"field\">\n                <label className=\"label is-small\">Old Price\n                    <p className=\"control has-icons-left has-icons-right\">\n                    <input className=\"input is-small \" ref={register({ required: true })} disabled name=\"oldprice\" type=\"text\" placeholder=\"Inventory Type\" />\n                    <span className=\"icon is-small is-left\">\n                        <i className=\"fas fa-map-signs\"></i>\n                    </span>\n                    \n                </p>\n                </label>\n                </div>\n           \n           \n           \n            </form>\n            \n            <div className=\"field  is-grouped mt-2\" >\n                <p className=\"control\">\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\n                        Save\n                    </button>\n                </p>\n                <p className=\"control\">\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\n                        Cancel\n                    </button>\n                </p>\n               {/*  <p className=\"control\">\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\n                       Delete\n                    </button>\n                </p> */}\n            </div>\n        </div>\n        </div>\n        </>\n    )\n   \n   \n                \n}   \n\nexport function InventoryReorder(){\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\n    // eslint-disable-next-line \n    const [error, setError] =useState(false)\n    // eslint-disable-next-line \n    const [success, setSuccess] =useState(false)\n    // eslint-disable-next-line \n    const [message,setMessage] = useState(\"\")\n    const [billservice,setBillService] = useState()\n    // eslint-disable-next-line \n    const InventoryServ=client.service('inventory')\n    //const history = useHistory()\n     // eslint-disable-next-line\n    const {user} = useContext(UserContext)\n    const {state,setState} = useContext(ObjectContext)\n    const billServ=client.service('billing')\n\n    const Inventory =state.InventoryModule.selectedInventory // set inventory\n   // console.log(Inventory)\n   \n \n        useEffect(() => {\n            setValue(\"reorder_level\", Inventory.reorder_level,  {\n                shouldValidate: true,\n                shouldDirty: true\n            })\n            setValue(\"oldlevel\", Inventory.reorder_level,  {\n                shouldValidate: true,\n                shouldDirty: true\n            })\n     \n            return () => {\n                \n            }\n        },[])\n\n   const handleCancel=async()=>{\n   \n    const    newInventoryModule={\n        selectedInventory:{},\n        show :'detail'\n      }\n        await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n   ////console.log(state)\n           }\n\n\n        const changeState =()=>{\n            const    newInventoryModule={\n                selectedInventory:{},\n                show :'detail'\n            }\n        setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n\n        }\n\n    const onSubmit = (data,e) =>{\n        e.preventDefault();\n      \n        setSuccess(false)\n          InventoryServ.patch(Inventory._id,{\n              reorder_level:data.reorder_level\n          })\n        .then((res)=>{\n                \n                 toast({\n                    message: 'Reorder level updated succesfully',\n                    type: 'is-success',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n                  \n                changeState()\n\n            })\n            .catch((err)=>{\n             \n                toast({\n                    message: \"Error updating Reorder level, probable network issues or \"+ err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n            }) \n\n      } \n     \n      \n    return (\n        \n        <>\n        <div className=\"card \">\n            <div className=\"card-header\">\n                <p className=\"card-header-title\">\n                    Set ReOrder Level for {Inventory.name} {/* per {Inventory.baseunit} */}\n                </p>\n            </div>\n            <div className=\"card-content vscrollable\">\n           \n            <form onSubmit={handleSubmit(onSubmit)}>\n                <div className=\"field\">\n                    <label className=\"label is-small\"> New Reorder Level\n                    <p className=\"control has-icons-left has-icons-right\">\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"reorder_level\" type=\"text\" placeholder=\"New Reorder Level\" />\n                        <span className=\"icon is-small is-left\">\n                            <i className=\"fas fa-hospital\"></i>\n                        </span>                    \n                    </p>\n                    </label>\n                    </div>\n                <div className=\"field\">\n                <label className=\"label is-small\">Old Reorder Level\n                    <p className=\"control has-icons-left has-icons-right\">\n                    <input className=\"input is-small \" ref={register()}  disabled  name=\"oldlevel\" type=\"text\" placeholder=\"Old Reorder Level\" />\n                    <span className=\"icon is-small is-left\">\n                        <i className=\"fas fa-map-signs\"></i>\n                    </span>\n                    \n                </p>\n                </label>\n                </div>\n           \n           \n           \n            </form>\n            \n            <div className=\"field  is-grouped mt-2\" >\n                <p className=\"control\">\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\n                        Save\n                    </button>\n                </p>\n                <p className=\"control\">\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\n                        Cancel\n                    </button>\n                </p>\n               {/*  <p className=\"control\">\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\n                       Delete\n                    </button>\n                </p> */}\n            </div>\n        </div>\n        </div>\n        </>\n    )\n   \n   \n                \n} \n\nexport function InventoryBatches(){\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\n    // eslint-disable-next-line \n    const [error, setError] =useState(false)\n    // eslint-disable-next-line \n    const [success, setSuccess] =useState(false)\n    // eslint-disable-next-line \n    const [message,setMessage] = useState(\"\")\n    const [billservice,setBillService] = useState()\n    // eslint-disable-next-line \n    const InventoryServ=client.service('inventory')\n    //const history = useHistory()\n     // eslint-disable-next-line\n    const {user} = useContext(UserContext)\n    const {state,setState} = useContext(ObjectContext)\n    const billServ=client.service('billing')\n    const [batchNo,setBatchNo] = useState(\"\")\n    const [quantity,setQuantity] = useState(\"\")\n    const [expirydate,setExpiryDate] = useState(\"\")\n    const [facilities,setFacilities] = useState([])\n    const [productItem,setProductItem] = useState([])\n\n    const Inventory =state.InventoryModule.selectedInventory // set inventory\n   // setProductItem(Inventory.batches)\n   // console.log(Inventory)\n   //\n \n        useEffect(() => {\n           setProductItem(Inventory.batches)\n     \n            return () => {\n                \n            }\n        },[])\n\n        const handleClickProd=async()=>{\n            if(!batchNo||!quantity||!expirydate){\n                toast({\n                    message: 'Kindly enter Batch Number,expiry date and quantity',\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  }) \n                  return\n            }\n            let productItemI={\n                batchNo,\n                expirydate,\n                quantity\n            }\n          //  await setSuccess(false)\n            setProductItem(\n                prevProd=>prevProd.concat(productItemI)\n            )\n            setBatchNo(\"\")\n            setQuantity(\"\")\n            setExpiryDate(\"\")\n           // await setSuccess(true)\n            // setBaseunit(\"\")\n          // console.log(success)\n         //  console.log(productItem)\n        }\n\n   const handleCancel=async()=>{\n   \n    const    newInventoryModule={\n        selectedInventory:{},\n        show :'details'\n      }\n        await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n   ////console.log(state)\n           }\n\n\n        const changeState =()=>{\n            const    newInventoryModule={\n                selectedInventory:{},\n                show :'details'\n            }\n        setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\n\n        }\n\n    const onSubmit = (data,e) =>{\n        e.preventDefault();\n      \n        setSuccess(false)\n          InventoryServ.patch(Inventory._id,{\n              batches:productItem\n          })\n        .then((res)=>{\n                \n                 toast({\n                    message: 'Batch updated succesfully',\n                    type: 'is-success',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n                  \n                changeState()\n\n            })\n            .catch((err)=>{\n             \n                toast({\n                    message: \"Error updating Batch, probable network issues or \"+ err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n            }) \n\n      } \n\n    const handleBatchdel=(obj, i)=>{\n        let confirm=window.confirm(\"Are you sure you want to delete this batch?\")\n        if (confirm){\n           // setProductItem(prev=>prev.filter((obj,index)=>index!==i ))\n            setProductItem(obj=>obj.filter((el,index)=>index!==i))\n        }\n    }\n     \n      \n    return (\n        \n        <>\n        <div className=\"card  card-overflow\">\n            <div className=\"card-header\">\n                <p className=\"card-header-title\">\n                   Batches for {Inventory.name} {/* per {Inventory.baseunit} */}\n                </p>\n            </div>\n            <div className=\"card-content vscrollable\">\n           \n             \n            <div className=\"field is-horizontal\">\n            <div className=\"field-body\">\n                <div className=\"field\">\n                    <p className=\"control \">\n                        <input className=\"input is-small\" /* ref={register({ required: true })} */ name=\"batchNo\" value={batchNo} type=\"text\" onChange={e=>setBatchNo(e.target.value)} placeholder=\"Batch Number\"  />\n                        {/* <span className=\"icon is-small is-left\">\n                        <i className=\"fas fa-envelope\"></i>\n                        </span> has-icons-left */}\n                    </p>\n        \n                </div> \n                <div className=\"field\">\n                    <DatePicker \n                        selected={expirydate} \n                        onChange={date => setExpiryDate(date)} \n                        dateFormat=\"MM/yyyy\"\n                        placeholderText=\"Expiry Date\"\n                    /*  isClearable */\n                        />\n                    \n                </div> \n                <div className=\"field\">\n                    <p className=\"control \">\n                        <input className=\"input is-small\" /* ref={register({ required: true })} */ name=\"quantity\" value={quantity} type=\"text\" onChange={e=>setQuantity(e.target.value)} placeholder=\"Quantity\"  />\n                        {/* <span className=\"icon is-small is-left\">\n                        <i className=\"fas fa-envelope\"></i>\n                        </span> has-icons-left */}\n                    </p>\n                <label >{Inventory.baseunit}</label>\n                </div> \n            \n                <div className=\"field\">\n                <p className=\"control\">\n                        <button className=\"button is-info is-small  is-pulled-right minHt\">\n                        <span className=\"is-small\" onClick={handleClickProd}> +</span>\n                        </button>\n                    </p>\n                </div>\n            </div>\n         </div>\n            <div>\n            <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\n                                    <thead>\n                                        <tr>\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\n                                        <th><abbr title=\"Batch\">Batch</abbr></th>\n                                        <th><abbr title=\"Quantity\">Quantity</abbr></th>\n                                        <th>Expiry Date</th>\n                                        {/*<th><abbr title=\"Document No\">Document No</abbr></th>\n                                        <th><abbr title=\"Total Amount\">Total Amount</abbr></th>\n                                         <th><abbr title=\"Enteredby\">Entered By</abbr></th> */} \n                                        <th><abbr title=\"Actions\">Actions</abbr></th> \n                                        </tr>\n                                    </thead>\n                                    <tfoot>\n                                        \n                                    </tfoot>\n                                    <tbody>\n                                        {productItem.map((ProductEntry, i)=>(\n\n                                            <tr key={i}  style={{backgroundColor:ProductEntry.expiry?\"red\":\"\"}} >\n                                            <th>{i+1}</th>\n                                            <td>{ProductEntry.batchNo}</td>\n                                            <td>{ProductEntry.quantity}</td>\n                                            <th>{ProductEntry.expirydate?<>{format(new Date(ProductEntry.expirydate),\"MM-yyyy\")}</>:\"\"}</th>\n                                            {/*<td>{ProductEntry.documentNo}</td>\n                                            <td>{ProductEntry.totalamount}</td>\n                                             <td>{ProductEntry.enteredby}</td> */}\n                                          <td onClick={()=>handleBatchdel(ProductEntry,i)}><span className=\"showAction\"  >x</span></td>\n                                           \n                                            </tr>\n\n                                        ))}\n                                    </tbody>\n                                    </table>\n            </div> \n            \n            <div className=\"field  is-grouped mt-2\" >\n                <p className=\"control\">\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\n                        Save\n                    </button>\n                </p>\n                <p className=\"control\">\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\n                        Cancel\n                    </button>\n                </p>\n               {/*  <p className=\"control\">\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\n                       Delete\n                    </button>\n                </p> */}\n            </div>\n        </div>\n        </div>\n        </>\n    )\n             \n} \n\nexport  function ProductSearch({getSearchfacility,clear}) {\n    \n    const facilityServ=client.service('products')\n    const [facilities,setFacilities]=useState([])\n     // eslint-disable-next-line\n     const [searchError, setSearchError] =useState(false)\n     // eslint-disable-next-line\n    const [showPanel, setShowPanel] =useState(false)\n     // eslint-disable-next-line\n   const [searchMessage, setSearchMessage] = useState(\"\") \n   // eslint-disable-next-line \n   const [simpa,setSimpa]=useState(\"\")\n   // eslint-disable-next-line \n   const [chosen,setChosen]=useState(false)\n   // eslint-disable-next-line \n   const [count,setCount]=useState(0)\n   const inputEl=useRef(null)\n\n\n   const handleRow= async(obj)=>{\n        await setChosen(true)\n        //alert(\"something is chaning\")\n       getSearchfacility(obj)\n       \n       await setSimpa(obj.facilityName)\n       \n        // setSelectedFacility(obj)\n        setShowPanel(false)\n        await setCount(2)\n        /* const    newfacilityModule={\n            selectedFacility:facility,\n            show :'detail'\n        }\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\n   //console.log(state)\n}\n    const handleBlur=async(e)=>{\n        /*  if (count===2){\n            // console.log(\"stuff was chosen\")\n         } */\n       \n       /*  console.log(\"blur\")\n         setShowPanel(false)\n        console.log(JSON.stringify(simpa))\n        if (simpa===\"\"){\n            console.log(facilities.length)\n            setSimpa(\"abc\")\n            setSimpa(\"\")\n            setFacilities([])\n            inputEl.current.setValue=\"\"\n        }\n        console.log(facilities.length)\n        console.log(inputEl.current) */\n    }\n    const handleSearch=async(val)=>{\n        \n        const field='name' //field variable\n       \n        if (val.length>=3){\n            facilityServ.find({query: {     //service\n                 [field]: {\n                     $regex:val,\n                     $options:'i'\n                    \n                 },\n                 $limit:10,\n                 $sort: {\n                     createdAt: -1\n                   }\n                     }}).then((res)=>{\n              //console.log(\"facility  fetched successfully\") \n                setFacilities(res.data)\n                 setSearchMessage(\" facility  fetched successfully\")\n                 setShowPanel(true)\n             })\n             .catch((err)=>{\n                 console.log(err)\n                 setSearchMessage(\"Error searching facility, probable network issues \"+ err )\n                 setSearchError(true)\n             })\n         }\n        else{\n            //console.log(\"less than 3 \")\n            //console.log(val)\n            setShowPanel(false)\n            await setFacilities([])\n            //console.log(facilities)\n        }\n    }\n    useEffect(() => {\n       if (clear){\n           setSimpa(\"\")\n       }\n        return () => {\n            \n        }\n    }, [clear] )\n    return (\n        <div>\n            <div className=\"field\">\n                <div className=\"control has-icons-left  \">\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`}>\n                        <div className=\"dropdown-trigger\">\n                            <DebounceInput className=\"input is-small \" \n                                type=\"text\" placeholder=\"Search Product\"\n                                value={simpa}\n                                minLength={1}\n                                debounceTimeout={400}\n                                onBlur={(e)=>handleBlur(e)}\n                                onChange={(e)=>handleSearch(e.target.value)}\n                                inputRef={inputEl}\n                                  />\n                            <span className=\"icon is-small is-left\">\n                                <i className=\"fas fa-search\"></i>\n                            </span>\n                        </div>\n                        {searchError&&<div>{searchMessage}</div>}\n                        <div className=\"dropdown-menu\" >\n                            <div className=\"dropdown-content\">\n                            {facilities.map((facility, i)=>(\n                                    \n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\n                                        \n                                        <span>{facility.facilityName}</span>\n                                        \n                                    </div>\n                                    \n                                    ))}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n          \n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}