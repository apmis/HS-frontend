{"ast":null,"code":"import _defineProperty from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _objectSpread from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable */import React,{useState,useContext,useEffect,useRef}from'react';import client from'../../feathers';import{DebounceInput}from'react-debounce-input';import{useForm}from\"react-hook-form\";//import {useHistory} from 'react-router-dom'\nimport{UserContext,ObjectContext}from'../../context';import{toast}from'bulma-toast';//import {ProductCreate} from './Products'\nimport Encounter from'../EncounterMgt/Encounter';import ServiceSearch from'../helpers/ServiceSearch';var random=require('random-string-generator');// eslint-disable-next-line\nvar searchfacility={};export default function AdmissionCreate(){var _state$WardModule$sel;// const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \n//const [error, setError] =useState(false)\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),success=_useState2[0],setSuccess=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];// eslint-disable-next-line\nvar _useState5=useState(),_useState6=_slicedToArray(_useState5,2),facility=_useState6[0],setFacility=_useState6[1];var ProductEntryServ=client.service('productentry');var OrderServ=client.service('order');var LocationServ=client.service('location');var BillCreateServ=client.service('createbilldirect');var AdmissionServ=client.service('admission');//const history = useHistory()\nvar _useContext=useContext(UserContext),user=_useContext.user;//,setUser\n// eslint-disable-next-line\nvar _useState7=useState(),_useState8=_slicedToArray(_useState7,2),currentUser=_useState8[0],setCurrentUser=_useState8[1];var _useState9=useState(\"Bill\"),_useState10=_slicedToArray(_useState9,2),type=_useState10[0],setType=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),documentNo=_useState12[0],setDocumentNo=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),totalamount=_useState14[0],setTotalamount=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),qamount=_useState16[0],setQAmount=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),productId=_useState18[0],setProductId=_useState18[1];var _useState19=useState(\"\"),_useState20=_slicedToArray(_useState19,2),source=_useState20[0],setSource=_useState20[1];var _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),date=_useState22[0],setDate=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),name=_useState24[0],setName=_useState24[1];var _useState25=useState(\"\"),_useState26=_slicedToArray(_useState25,2),inventoryId=_useState26[0],setInventoryId=_useState26[1];var _useState27=useState(\"\"),_useState28=_slicedToArray(_useState27,2),baseunit=_useState28[0],setBaseunit=_useState28[1];var _useState29=useState(1),_useState30=_slicedToArray(_useState29,2),quantity=_useState30[0],setQuantity=_useState30[1];var _useState31=useState(\"\"),_useState32=_slicedToArray(_useState31,2),sellingprice=_useState32[0],setSellingPrice=_useState32[1];var _useState33=useState(0),_useState34=_slicedToArray(_useState33,2),costprice=_useState34[0],setCostprice=_useState34[1];var _useState35=useState(\"\"),_useState36=_slicedToArray(_useState35,2),invquantity=_useState36[0],setInvQuantity=_useState36[1];var _useState37=useState(0),_useState38=_slicedToArray(_useState37,2),calcamount=_useState38[0],setCalcAmount=_useState38[1];var _useState39=useState([]),_useState40=_slicedToArray(_useState39,2),productItem=_useState40[0],setProductItem=_useState40[1];var _useState41=useState(\"\"),_useState42=_slicedToArray(_useState41,2),billingId=_useState42[0],setBilllingId=_useState42[1];var _useState43=useState(true),_useState44=_slicedToArray(_useState43,2),changeAmount=_useState44[0],setChangeAmount=_useState44[1];var _useState45=useState(\"\"),_useState46=_slicedToArray(_useState45,2),paymentmode=_useState46[0],setPaymentMode=_useState46[1];var _useState47=useState([]),_useState48=_slicedToArray(_useState47,2),paymentOptions=_useState48[0],setPaymentOptions=_useState48[1];var _useState49=useState(\"\"),_useState50=_slicedToArray(_useState49,2),billMode=_useState50[0],setBillMode=_useState50[1];var _useState51=useState(false),_useState52=_slicedToArray(_useState51,2),productModal=_useState52[0],setProductModal=_useState52[1];var _useState53=useState(\"\"),_useState54=_slicedToArray(_useState53,2),obj=_useState54[0],setObj=_useState54[1];var _useState55=useState(\"\"),_useState56=_slicedToArray(_useState55,2),objService=_useState56[0],setObjService=_useState56[1];var _useState57=useState(\"\"),_useState58=_slicedToArray(_useState57,2),patient=_useState58[0],setPatient=_useState58[1];var _useState59=useState(\"\"),_useState60=_slicedToArray(_useState59,2),contracts=_useState60[0],setContracts=_useState60[1];var _useState61=useState(\"\"),_useState62=_slicedToArray(_useState61,2),category=_useState62[0],setCategory=_useState62[1];var _useState63=useState(),_useState64=_slicedToArray(_useState63,2),chosenBed=_useState64[0],setChosenBed=_useState64[1];var _useState65=useState(),_useState66=_slicedToArray(_useState65,2),bedObject=_useState66[0],setBedObject=_useState66[1];var _useContext2=useContext(ObjectContext),state=_useContext2.state,setState=_useContext2.setState;var inputEl=useRef(0);var calcamount1;var hidestatus;var medication=state.AdmissionModule.selectedAdmission;var physicalbeds=(_state$WardModule$sel=state.WardModule.selectedWard)===null||_state$WardModule$sel===void 0?void 0:_state$WardModule$sel.sublocations;//console.log(medication)\nvar showDocumentation=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(value){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setProductModal(true);case 1:case\"end\":return _context.stop();}}},_callee);}));return function showDocumentation(_x){return _ref.apply(this,arguments);};}();var handlecloseModal=function handlecloseModal(){setProductModal(false);// handleSearch(val)\n};var handleChangeMode=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(value){var billm;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return setPaymentMode(value);case 2:// console.log(paymentOptions)\nbillm=paymentOptions.filter(function(el){return el.name===value;});_context2.next=5;return setBillMode(billm[0]);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function handleChangeMode(_x2){return _ref2.apply(this,arguments);};}();var handleRow=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(ProductEntry){var newProductEntryModule;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0://console.log(\"b4\",state)\n//console.log(\"handlerow\",ProductEntry)\n//await setMedication(ProductEntry)\nnewProductEntryModule={selectedMedication:ProductEntry,show:'detail'};_context3.next=3;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{medicationModule:newProductEntryModule});});case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function handleRow(_x3){return _ref3.apply(this,arguments);};}();var _useState67=useState({productitems:[],date:date,documentNo:documentNo,type:type,totalamount:totalamount,source:source}),_useState68=_slicedToArray(_useState67,2),productEntry=_useState68[0],setProductEntry=_useState68[1];var productItemI={productId:productId,name:name,quantity:quantity,sellingprice:sellingprice,amount:calcamount,//||qamount\nbaseunit:baseunit,costprice:costprice,category:\"Prescription\",//category===\"Inventory\"?\"Prescription\":category,\nbillingId:billingId,billMode:billMode};var checkPrice=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(contracts,billMode){var contract,_contract,_contract2,_contract3;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!(billMode.type===\"HMO Cover\")){_context4.next=22;break;}if(!(billMode.detail.plan===\"NHIS\")){_context4.next=13;break;}//find contract for NHIS\ncontract=contracts.filter(function(el){return el.source_org_name===\"NHIS\";});if(!contract.length){_context4.next=8;break;}_context4.next=6;return setSellingPrice(contract[0].price);case 6:_context4.next=11;break;case 8:toast({message:'Please NHIS does not have cover/price for this service. Either set service price for NHIS, try another service or bill using cash',type:'is-danger',dismissible:true,pauseOnHover:true});_context4.next=11;return setSellingPrice(0);case 11:_context4.next=22;break;case 13:_contract=contracts.filter(function(el){return el.source_org===billMode.detail.organizationId;});if(!_contract.length){_context4.next=19;break;}_context4.next=17;return setSellingPrice(_contract[0].price);case 17:_context4.next=22;break;case 19:toast({message:'Please HMO does not have cover/price for this service. Either set service price for HMO , try another drug, bill using cash or adjust amount ',type:'is-danger',dismissible:true,pauseOnHover:true});_context4.next=22;return setSellingPrice(0);case 22:if(!(billMode.type===\"Company Cover\")){_context4.next=32;break;}//paymentmode\n_contract2=contracts.filter(function(el){return el.source_org===billMode.detail.organizationId;});if(!_contract2.length){_context4.next=29;break;}_context4.next=27;return setSellingPrice(_contract2[0].price);case 27:_context4.next=32;break;case 29:toast({message:'Please company does not have cover/price for this service. Either set service price for Company or try another drug or bill using cash',type:'is-danger',dismissible:true,pauseOnHover:true});_context4.next=32;return setSellingPrice(0);case 32:if(!(billMode.type===\"Cash\"||billMode.type===\"Family Cover\")){_context4.next=42;break;}//paymentmode\n_contract3=contracts.filter(function(el){return el.source_org===el.dest_org;});if(!_contract3.length){_context4.next=39;break;}_context4.next=37;return setSellingPrice(_contract3[0].price);case 37:_context4.next=42;break;case 39:toast({message:'Please there is no cover/price for this service. Either set service price or try another service. Setting price at zero ',type:'is-danger',dismissible:true,pauseOnHover:true});_context4.next=42;return setSellingPrice(0);case 42:case\"end\":return _context4.stop();}}},_callee4);}));return function checkPrice(_x4,_x5){return _ref4.apply(this,arguments);};}();// consider batchformat{batchno,expirydate,qtty,baseunit}\n//consider baseunoit conversions\nvar getSearchfacility=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(service){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(service){_context5.next=14;break;}//\"clear stuff\"\nsetProductId(\"\");setName(\"\");setBaseunit(\"\");setInventoryId(\"\");setSellingPrice(0);setInvQuantity(\"\");setQAmount(null);setCostprice(\"\");setContracts(\"\");setCategory(\"\");setInventoryId(\"\");setBilllingId(\"\");// setCalcAmount(null)\nreturn _context5.abrupt(\"return\");case 14:setContracts(service.contracts);setProductId(service.productId);setName(service.name);setCategory(service.category);//Lab Order\nsetBaseunit(service.baseunit);setInventoryId(service.inventoryId);setBilllingId(service._id);_context5.next=23;return setObj(service);case 23:case\"end\":return _context5.stop();}}},_callee5);}));return function getSearchfacility(_x6){return _ref5.apply(this,arguments);};}();useEffect(function(){},[obj]);useEffect(function(){setCurrentUser(user);//console.log(currentUser)\nreturn function(){};},[user]);var handleUpdateTotal=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return setTotalamount(function(prevtotal){return Number(prevtotal)+Number(calcamount);});case 2:case\"end\":return _context6.stop();}}},_callee6);}));return function handleUpdateTotal(){return _ref6.apply(this,arguments);};}();var handleChangeType=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(e){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return setType(e.target.value);case 2:case\"end\":return _context7.stop();}}},_callee7);}));return function handleChangeType(_x7){return _ref7.apply(this,arguments);};}();var handleAmount=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return setQAmount(null);case 2:case\"end\":return _context8.stop();}}},_callee8);}));return function handleAmount(){return _ref8.apply(this,arguments);};}();var handleClickProd=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){var billInfo;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:if(!(quantity===0||quantity===\"\"||productId===\"\"||paymentmode===\"\")){_context9.next=3;break;}toast({message:'You need to choose a product and quantity to proceed',type:'is-danger',dismissible:true,pauseOnHover:true});return _context9.abrupt(\"return\");case 3:_context9.next=5;return setSuccess(false);case 5:_context9.next=7;return setProductItem(function(prevProd){return prevProd.concat(productItemI);});case 7:handleUpdateTotal();// generate billing info\nbillInfo={orderInfo:{orderId:medication._id,orderObj:medication},serviceInfo:{price:productItemI.sellingprice,quantity:productItemI.quantity,productId:productItemI.productId,name:productItemI.name,baseunit:productItemI.baseunit,amount:productItemI.amount,billingId:productItemI.billingId,createdby:user._id},paymentInfo:{amountDue:productItemI.amount,paidup:0,balance:productItemI.amount,paymentDetails:[]},participantInfo:{billingFacility:medication.destination,billingFacilityName:medication.destination_name,locationId:state.StoreModule.selectedStore._id,//selected location,\nclientId:medication.clientId,client:medication.client,paymentmode:billMode},createdBy:user.id,billing_status:\"Unpaid\"};//update order\nOrderServ.patch(medication._id,{order_status:\"Billed\",//Billed\nbillInfo:billInfo}).then(function(resp){// medication=resp\n// console.log(resp)\nhandleRow(resp);//update dispense\n}).catch(function(err){console.log(err);});//update status(billed) + action()\n//?attached chosen product to medication\n//dispense helper?\nsetName(\"\");setBaseunit(\"\");setQuantity(\"\");setInventoryId(\"\");setSellingPrice(\"\");setInvQuantity(\"\");handleAmount();// setCalcAmount(null)\n_context9.next=19;return setSuccess(true);case 19:getSearchfacility(false);setObj(\"\");/* console.log(success)\n        console.log(qamount)\n        console.log(productItem) */setChangeAmount(true);case 22:case\"end\":return _context9.stop();}}},_callee9);}));return function handleClickProd(){return _ref9.apply(this,arguments);};}();var handleQtty=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(e){return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:/*  if (invquantity<e.target.value){\n             toast({\n                 message: 'You can not sell more quantity than exist in inventory ' ,\n                 type: 'is-danger',\n                 dismissible: true,\n                 pauseOnHover: true,\n               })\n             return\n         } */setQuantity(e.target.value);if(e.target.vlue===\"\"){setQuantity(1);}/*  calcamount1=quantity*sellingprice\n         await setCalcAmount(calcamount1) */ //console.log(calcamount)\ncase 2:case\"end\":return _context10.stop();}}},_callee10);}));return function handleQtty(_x8){return _ref10.apply(this,arguments);};}();useEffect(function(){setProductEntry({date:date,documentNo:documentNo,type:type,totalamount:totalamount,source:source});setCalcAmount(quantity*sellingprice);return function(){};},[date]);var resetform=function resetform(){setType(\"Sales\");setDocumentNo(\"\");setTotalamount(\"\");setProductId(\"\");setSource(\"\");setDate(\"\");setName(\"\");setBaseunit();setCostprice();setProductItem([]);};var handleAdmit=/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(e){var note,document,data;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0://handle admit\n//alert(\"something\")\n//update order\n//create admission resource\n//?create bill?\nnote={Note:\"Patient Admitted to \"+state.employeeLocation.locationName+\" \"+state.employeeLocation.locationType+\" at \"+Date().toLocaleString(),Instruction:medication.instruction};//console.log(note)\ndocument={};// data.createdby=user._id\n// console.log(data);\nif(user.currentEmployee){document.facility=user.currentEmployee.facilityDetail._id;document.facilityname=user.currentEmployee.facilityDetail.facilityName;// or from facility dropdown\n}document.documentdetail=note;console.log(document.documentdetail);document.documentname=\"Admission\";//state.DocumentClassModule.selectedDocumentClass.name\n// document.documentClassId=state.DocumentClassModule.selectedDocumentClass._id\ndocument.location=state.employeeLocation.locationName+\" \"+state.employeeLocation.locationType;document.locationId=state.employeeLocation.locationId;document.client=medication.client._id;document.clientname=medication.client.firstname+\" \"+medication.client.middlename+\" \"+medication.client.lastname;document.clientobj=medication.client;document.createdBy=user._id;document.createdByname=user.firstname+\" \"+user.lastname;document.status=\"completed\";data={//  encounter_id:{type: Schema.Types.ObjectId,},\n//  hospitalization_id:{type: Schema.Types.ObjectId,},\n//order\norder:medication,order_id:medication._id,//location: ward/bed\nward_name:state.WardModule.selectedWard.typeName,ward_id:state.WardModule.selectedWard._id,bed:bedObject.typeName,bed_id:bedObject._id,facility:user.currentEmployee.facilityDetail._id,//billing:perpertuity\n/* bill:{type:Schema.Types.Mixed},\n                bill_id:{type: Schema.Types.ObjectId,}, */ //status\nstatus:\"occupied\",//client\nclient:medication.client,client_id:medication.clientId,//careteam\nadmissionhx:[],careteam:[],start_time:new Date(),//end_time:\"\",\ncreatedby:user._id,documentation:document};e.preventDefault();setMessage(\"\");//  setError(false)\nsetSuccess(false);// data.createdby=user._id\nconsole.log(data);/*   if (user.currentEmployee){\n                 data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\n                  } */ // data.locationType=\"Front Desk\"\nAdmissionServ.create(data).then(/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(res){var newProductEntryModule;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0://console.log(JSON.stringify(res))\n// e.target.reset();\n/*  setMessage(\"Created Clinic successfully\") */setSuccess(true);toast({message:'Admission successfull',type:'is-success',dismissible:true,pauseOnHover:true});setSuccess(false);setChosenBed();setBedObject();newProductEntryModule={selectedAdmission:{},show:''};_context11.next=8;return setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{AdmissionModule:newProductEntryModule});});case 8:case\"end\":return _context11.stop();}}},_callee11);}));return function(_x10){return _ref12.apply(this,arguments);};}()).catch(function(err){toast({message:'Error creating Admission '+err,type:'is-danger',dismissible:true,pauseOnHover:true});});case 20:case\"end\":return _context12.stop();}}},_callee12);}));return function handleAdmit(_x9){return _ref11.apply(this,arguments);};}();var handleBed=function handleBed(e){//console.log(JSON.parse(e.target.value))\nsetChosenBed(e.target.value);var simpa=physicalbeds.find(function(obj){return obj._id===e.target.value;});setBedObject(simpa);};var onSubmit=/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(e){return _regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:e.preventDefault();setMessage(\"\");//setError(false)\nsetSuccess(false);_context13.next=5;return setProductEntry({date:date,documentNo:documentNo,type:type,totalamount:totalamount,source:source});case 5:productEntry.productitems=productItem;productEntry.createdby=user._id;productEntry.transactioncategory=\"debit\";if(!user.currentEmployee){_context13.next=12;break;}productEntry.facility=user.currentEmployee.facilityDetail._id;// or from facility dropdown\n_context13.next=14;break;case 12:toast({message:'You can not remove inventory from any organization',type:'is-danger',dismissible:true,pauseOnHover:true});return _context13.abrupt(\"return\");case 14:if(!state.StoreModule.selectedStore._id){_context13.next=18;break;}productEntry.storeId=state.StoreModule.selectedStore._id;_context13.next=20;break;case 18:toast({message:'You need to select a store before removing inventory',type:'is-danger',dismissible:true,pauseOnHover:true});return _context13.abrupt(\"return\");case 20:case\"end\":return _context13.stop();}}},_callee13);}));return function onSubmit(_x11){return _ref13.apply(this,arguments);};}();var handleChangeAmount=function handleChangeAmount(){setChangeAmount(function(rev){return!rev;});};var newclient=/*#__PURE__*/function(){var _ref14=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee14(){return _regeneratorRuntime.wrap(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return setProductItem([]);case 2:case\"end\":return _context14.stop();}}},_callee14);}));return function newclient(){return _ref14.apply(this,arguments);};}();useEffect(function(){setPatient(medication.client);var oldname=medication.clientname;// console.log(\"oldname\",oldname)\nsetSource(medication.clientname);var newname=source;// console.log(\"newname\",newname)\nif(oldname!==newname){//newclient\n//recalculate bedspace: subtract occupied from physical space\nsetProductItem([]);setTotalamount(0);}return function(){};},[medication]);useEffect(function(){//setPatient(medication.client)\nsetProductItem([]);setTotalamount(0);var paymentoptions=[];// const info = client.paymentinfo\nvar billme;var obj;patient&&patient.paymentinfo.forEach(function(pay,i){if(pay.active){switch(pay.paymentmode){case'Cash':// code block\nobj=createObj(pay,\"Cash\",\"Cash\",\"Cash\");paymentoptions.push(obj);setPaymentMode(\"Cash\");billme=obj;// console.log(\"billme\",billme)\nbreak;case'Family':// code block\nobj=createObj(pay,\"Family Cover\",\"familyCover\",\"Family Cover\");paymentoptions.push(obj);setPaymentMode(\"Family Cover\");billme=obj;// console.log(\"billme\",billme)\nbreak;case'Company':// code block\nvar _name=\"Company: \"+pay.organizationName+\"(\"+pay.plan+\")\";obj=createObj(pay,_name,\"CompanyCover\",\"Company Cover\");paymentoptions.push(obj);setPaymentMode(\"Company: \"+pay.organizationName+\"(\"+pay.plan+\")\");billme=obj;// console.log(\"billme\",billme)\nbreak;case'HMO':// code block\nvar sname=\"HMO: \"+pay.organizationName+\"(\"+pay.plan+\")\";obj=createObj(pay,sname,\"HMOCover\",\"HMO Cover\");paymentoptions.push(obj);setPaymentMode(\"HMO: \"+pay.organizationName+\"(\"+pay.plan+\")\");billme=obj;//  console.log(\"billme\",billme)\nbreak;default:// code block\n}}});setPaymentOptions(paymentoptions);setBillMode(billme);//console.log(paymentoptions)\n// console.log(billMode)\nreturn function(){};},[source]);//source\nuseEffect(function(){// const medication =state.medicationModule.selectedMedication\nvar today=new Date().toLocaleString();//console.log(today)\nsetDate(today);var invoiceNo=random(6,'uppernumeric');setDocumentNo(invoiceNo);var ward=state.WardModule.selectedWard;return function(){};},[]);useEffect(function(){// console.log(\"success\", success)\nif(success){setSuccess(false);}},[success]);var createObj=function createObj(pay,name,cover,type){var details={};details=_objectSpread({},pay);details.type=type;return{name:name,value:cover,detail:details,type:type};};useEffect(function(){//update selling price\nif(!!billMode&&!!contracts){// console.log(contracts)\ncheckPrice(contracts,billMode);}return function(){};},[obj]);useEffect(function(){calcamount1=quantity*sellingprice;setCalcAmount(calcamount1);// console.log(calcamount)\nsetChangeAmount(true);return function(){};},[quantity,sellingprice]);useEffect(function(){if(!!billMode&&!!contracts){checkPrice(contracts,billMode);}return function(){};},[billMode]);// console.log(\"simpa\")\nreturn/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card card-overflow\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"card-header-title\",children:\"Admit Patient\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button is-success is-small btnheight mt-2\",onClick:showDocumentation,children:\"Documentation\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content \",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,children:[\" \",/*#__PURE__*/_jsx(\"div\",{className:\"field is-horizontal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"field-body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"control has-icons-left has-icons-right\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\"/* ref={register({ required: true })} */,value:source,name:\"client\",type:\"text\",onChange:function onChange(e){return setSource(e.target.value);},placeholder:\"Client\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-hospital\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:/*#__PURE__*/_jsx(\"div\",{className:\"select is-small \",children:/*#__PURE__*/_jsxs(\"select\",{name:\"paymentmode\",value:paymentmode,onChange:function onChange(e){return handleChangeMode(e.target.value);},className:\"selectadd\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Billing Mode \"}),paymentOptions.map(function(option,i){return/*#__PURE__*/_jsxs(\"option\",{value:option.details,children:[\" \",option.name]},i);})]})})})})]})})]}),/*#__PURE__*/_jsx(\"label\",{className:\"label is-small\",children:\"Admission Ward:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"field is-horizontal\",children:/*#__PURE__*/_jsx(\"div\",{className:\"field-body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"field\",style:{width:\"40%\"},children:[/*#__PURE__*/_jsx(\"p\",{className:\"control has-icons-left\",children:/*#__PURE__*/_jsx(\"input\",{className:\"input is-small\"/* ref={register({ required: true })} */,disabled:true,name:\"order\",value:medication.order,type:\"text\",onChange:function onChange(e){return handleQtty(e);},placeholder:\"Quantity\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"helper is-size-7\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"Instructions: \"})}),/*#__PURE__*/_jsx(\"p\",{children:medication.instruction})]})})}),/*#__PURE__*/_jsx(\"label\",{className:\"label is-small\",children:\"Choose Bed:\"}),!!state.WardModule.selectedWard.sublocations&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"select\",{name:\"bed\",value:chosenBed,onChange:function onChange(e){return handleBed(e);},className:\"selectadd\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Choose Bed \"}),physicalbeds.map(function(locat,i){return/*#__PURE__*/_jsxs(\"option\",{value:locat._id,children:[\" \",locat.typeName]},i);})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"field mt-2 is-grouped\",children:/*#__PURE__*/_jsx(\"p\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-success is-small\"/* disabled={!productItem.length>0} */,onClick:handleAdmit,children:\"Admit\"})})})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal \".concat(productModal?\"is-active\":\"\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-background\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-card  modalbkgrnd\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"modal-card-head  btnheight\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"modal-card-title\",children:\"Documentation\"}),/*#__PURE__*/_jsx(\"button\",{className:\"delete\",\"aria-label\":\"close\",onClick:handlecloseModal})]}),/*#__PURE__*/_jsx(\"section\",{className:\"modal-card-body modalcolor\",children:/*#__PURE__*/_jsx(Encounter,{standalone:\"true\"})})]})]})]});}export function InventorySearch(_ref15){var getSearchfacility=_ref15.getSearchfacility,clear=_ref15.clear;var productServ=client.service('inventory');var _useState69=useState([]),_useState70=_slicedToArray(_useState69,2),facilities=_useState70[0],setFacilities=_useState70[1];// eslint-disable-next-line\nvar _useState71=useState(false),_useState72=_slicedToArray(_useState71,2),searchError=_useState72[0],setSearchError=_useState72[1];// eslint-disable-next-line\nvar _useState73=useState(false),_useState74=_slicedToArray(_useState73,2),showPanel=_useState74[0],setShowPanel=_useState74[1];// eslint-disable-next-line\nvar _useState75=useState(\"\"),_useState76=_slicedToArray(_useState75,2),searchMessage=_useState76[0],setSearchMessage=_useState76[1];// eslint-disable-next-line \nvar _useState77=useState(\"\"),_useState78=_slicedToArray(_useState77,2),simpa=_useState78[0],setSimpa=_useState78[1];// eslint-disable-next-line \nvar _useState79=useState(false),_useState80=_slicedToArray(_useState79,2),chosen=_useState80[0],setChosen=_useState80[1];// eslint-disable-next-line \nvar _useState81=useState(0),_useState82=_slicedToArray(_useState81,2),count=_useState82[0],setCount=_useState82[1];var inputEl=useRef(null);var _useState83=useState(\"\"),_useState84=_slicedToArray(_useState83,2),val=_useState84[0],setVal=_useState84[1];var _useContext3=useContext(UserContext),user=_useContext3.user;var _useContext4=useContext(ObjectContext),state=_useContext4.state;var _useState85=useState(false),_useState86=_slicedToArray(_useState85,2),productModal=_useState86[0],setProductModal=_useState86[1];var handleRow=/*#__PURE__*/function(){var _ref16=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee15(obj){return _regeneratorRuntime.wrap(function _callee15$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:_context15.next=2;return setChosen(true);case 2://alert(\"something is chaning\")\ngetSearchfacility(obj);_context15.next=5;return setSimpa(obj.name);case 5:// setSelectedFacility(obj)\nsetShowPanel(false);_context15.next=8;return setCount(2);case 8:case\"end\":return _context15.stop();}}},_callee15);}));return function handleRow(_x12){return _ref16.apply(this,arguments);};}();var handleBlur=/*#__PURE__*/function(){var _ref17=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee16(e){return _regeneratorRuntime.wrap(function _callee16$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:case\"end\":return _context16.stop();}}},_callee16);}));return function handleBlur(_x13){return _ref17.apply(this,arguments);};}();var handleSearch=/*#__PURE__*/function(){var _ref18=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee17(value){var field,_query;return _regeneratorRuntime.wrap(function _callee17$(_context17){while(1){switch(_context17.prev=_context17.next){case 0:setVal(value);if(!(value===\"\")){_context17.next=5;break;}setShowPanel(false);getSearchfacility(false);return _context17.abrupt(\"return\");case 5:field='name';//field variable\nif(!(value.length>=3)){_context17.next=10;break;}productServ.find({query:(_query={},_defineProperty(_query,field,{$regex:value,$options:'i'}),_defineProperty(_query,\"facility\",user.currentEmployee.facilityDetail._id),_defineProperty(_query,\"storeId\",state.StoreModule.selectedStore._id),_defineProperty(_query,\"$limit\",10),_defineProperty(_query,\"$sort\",{createdAt:-1}),_query)}).then(function(res){//  console.log(\"product  fetched successfully\") \n//  console.log(res.data) \nsetFacilities(res.data);setSearchMessage(\" product  fetched successfully\");setShowPanel(true);}).catch(function(err){toast({message:'Error creating ProductEntry '+err,type:'is-danger',dismissible:true,pauseOnHover:true});});_context17.next=13;break;case 10:// console.log(\"less than 3 \")\n// console.log(val)\nsetShowPanel(false);_context17.next=13;return setFacilities([]);case 13:case\"end\":return _context17.stop();}}},_callee17);}));return function handleSearch(_x14){return _ref18.apply(this,arguments);};}();var handleAddproduct=function handleAddproduct(){setProductModal(true);};var handlecloseModal=function handlecloseModal(){setProductModal(false);handleSearch(val);};useEffect(function(){if(clear){//  console.log(\"success has changed\",clear)\nsetSimpa(\"\");}return function(){};},[clear]);return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"div\",{className:\"control has-icons-left  \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown \".concat(showPanel?\"is-active\":\"\"),style:{width:\"100%\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-trigger\",style:{width:\"100%\"},children:[/*#__PURE__*/_jsx(DebounceInput,{className:\"input is-small  is-expanded\",type:\"text\",placeholder:\"Search Product\",value:simpa,minLength:3,debounceTimeout:400,onBlur:function onBlur(e){return handleBlur(e);},onChange:function onChange(e){return handleSearch(e.target.value);},inputRef:inputEl}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-menu expanded\",style:{width:\"100%\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-content\",children:[facilities.length>0?\"\":/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-item\"/* onClick={handleAddproduct} */,children:[\" \",/*#__PURE__*/_jsxs(\"span\",{children:[\" \",val,\" is not in your inventory\"]}),\" \"]}),facilities.map(function(facility,i){return/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-item\",onClick:function onClick(){return handleRow(facility);},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"span\",{children:facility.name})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"strong\",{children:facility.quantity})}),/*#__PURE__*/_jsxs(\"span\",{children:[facility.baseunit,\"(s) remaining\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"padleft\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Price:\"}),\" N\",facility.sellingprice]})]})]},facility._id);})]})})]})})})});}","map":{"version":3,"sources":["/home/mfybaby/Documents/HealthStack2/HS-frontend/src/components/Ward/AdmissionCreate.js"],"names":["React","useState","useContext","useEffect","useRef","client","DebounceInput","useForm","UserContext","ObjectContext","toast","Encounter","ServiceSearch","random","require","searchfacility","AdmissionCreate","success","setSuccess","message","setMessage","facility","setFacility","ProductEntryServ","service","OrderServ","LocationServ","BillCreateServ","AdmissionServ","user","currentUser","setCurrentUser","type","setType","documentNo","setDocumentNo","totalamount","setTotalamount","qamount","setQAmount","productId","setProductId","source","setSource","date","setDate","name","setName","inventoryId","setInventoryId","baseunit","setBaseunit","quantity","setQuantity","sellingprice","setSellingPrice","costprice","setCostprice","invquantity","setInvQuantity","calcamount","setCalcAmount","productItem","setProductItem","billingId","setBilllingId","changeAmount","setChangeAmount","paymentmode","setPaymentMode","paymentOptions","setPaymentOptions","billMode","setBillMode","productModal","setProductModal","obj","setObj","objService","setObjService","patient","setPatient","contracts","setContracts","category","setCategory","chosenBed","setChosenBed","bedObject","setBedObject","state","setState","inputEl","calcamount1","hidestatus","medication","AdmissionModule","selectedAdmission","physicalbeds","WardModule","selectedWard","sublocations","showDocumentation","value","handlecloseModal","handleChangeMode","billm","filter","el","handleRow","ProductEntry","newProductEntryModule","selectedMedication","show","prevstate","medicationModule","productitems","productEntry","setProductEntry","productItemI","amount","checkPrice","detail","plan","contract","source_org_name","length","price","dismissible","pauseOnHover","source_org","organizationId","dest_org","getSearchfacility","_id","handleUpdateTotal","prevtotal","Number","handleChangeType","e","target","handleAmount","handleClickProd","prevProd","concat","billInfo","orderInfo","orderId","orderObj","serviceInfo","createdby","paymentInfo","amountDue","paidup","balance","paymentDetails","participantInfo","billingFacility","destination","billingFacilityName","destination_name","locationId","StoreModule","selectedStore","clientId","createdBy","id","billing_status","patch","order_status","then","resp","catch","err","console","log","handleQtty","vlue","resetform","handleAdmit","note","Note","employeeLocation","locationName","locationType","Date","toLocaleString","Instruction","instruction","document","currentEmployee","facilityDetail","facilityname","facilityName","documentdetail","documentname","location","clientname","firstname","middlename","lastname","clientobj","createdByname","status","data","order","order_id","ward_name","typeName","ward_id","bed","bed_id","client_id","admissionhx","careteam","start_time","documentation","preventDefault","create","res","handleBed","simpa","find","onSubmit","transactioncategory","storeId","handleChangeAmount","rev","newclient","oldname","newname","paymentoptions","billme","paymentinfo","forEach","pay","i","active","createObj","push","organizationName","sname","today","invoiceNo","ward","cover","details","map","option","width","locat","InventorySearch","clear","productServ","facilities","setFacilities","searchError","setSearchError","showPanel","setShowPanel","searchMessage","setSearchMessage","setSimpa","chosen","setChosen","count","setCount","val","setVal","handleBlur","handleSearch","field","query","$regex","$options","createdAt","handleAddproduct"],"mappings":"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","sourcesContent":["/* eslint-disable */\nimport React, {useState,useContext, useEffect,useRef} from 'react'\nimport client from '../../feathers'\nimport {DebounceInput} from 'react-debounce-input';\nimport { useForm } from \"react-hook-form\";\n//import {useHistory} from 'react-router-dom'\nimport {UserContext,ObjectContext} from '../../context'\nimport {toast} from 'bulma-toast'\n//import {ProductCreate} from './Products'\nimport Encounter from '../EncounterMgt/Encounter';\nimport  ServiceSearch  from '../helpers/ServiceSearch';\nvar random = require('random-string-generator');\n// eslint-disable-next-line\nconst searchfacility={};\n\nexport default function AdmissionCreate(){\n    // const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \n     //const [error, setError] =useState(false)\n     const [success, setSuccess] =useState(false)\n     const [message,setMessage] = useState(\"\")\n     // eslint-disable-next-line\n     const [facility,setFacility] = useState()\n     const ProductEntryServ=client.service('productentry')\n     const OrderServ=client.service('order')\n     const LocationServ=client.service('location')\n     const BillCreateServ=client.service('createbilldirect')\n     const AdmissionServ=client.service('admission')\n     //const history = useHistory()\n     const {user} = useContext(UserContext) //,setUser\n     // eslint-disable-next-line\n     const [currentUser,setCurrentUser] = useState()\n     const [type,setType] = useState(\"Bill\")\n     const [documentNo,setDocumentNo] = useState(\"\")\n     const [totalamount,setTotalamount] = useState(0)\n     const [qamount,setQAmount] = useState(null)\n     const [productId,setProductId] = useState(\"\")\n     const [source,setSource] = useState(\"\")\n     const [date,setDate] = useState(\"\")\n     const [name,setName] = useState(\"\")\n     const [inventoryId,setInventoryId] = useState(\"\")\n     const [baseunit,setBaseunit] = useState(\"\")\n     const [quantity,setQuantity] = useState(1)\n     const [sellingprice,setSellingPrice] = useState(\"\")\n     const [costprice,setCostprice] = useState(0)\n     const [invquantity,setInvQuantity] = useState(\"\")\n     const [calcamount,setCalcAmount] = useState(0)\n     const [productItem,setProductItem] = useState([])\n      const [billingId,setBilllingId]=useState(\"\")  \n      const [changeAmount, setChangeAmount] = useState(true)\n      const [paymentmode, setPaymentMode] = useState(\"\")\n      const [paymentOptions, setPaymentOptions]=useState([])\n      const [billMode, setBillMode]=useState(\"\")\n      const [productModal, setProductModal]=useState(false)\n      const [obj, setObj]=useState(\"\")\n      const [objService, setObjService]=useState(\"\")\n      const [patient, setPatient]=useState(\"\")\n      const [contracts, setContracts]=useState(\"\")\n      const [category, setCategory]=useState(\"\")\n      const [chosenBed, setChosenBed]=useState()\n      const [bedObject, setBedObject]=useState()\n\n     const {state,setState}=useContext(ObjectContext)\n     const inputEl = useRef(0);\n     let calcamount1\n     let hidestatus\n  \n\n    \n  let medication =state.AdmissionModule.selectedAdmission\n  let physicalbeds=state.WardModule.selectedWard?.sublocations\n   //console.log(medication)\n\n  const showDocumentation = async (value)=>{\n    setProductModal(true)\n  }\n  const handlecloseModal =()=>{\n    setProductModal(false)\n   // handleSearch(val)\n    }\n\n\n    const handleChangeMode= async(value)=>{\n       // console.log(value)\n       await setPaymentMode(value)\n       // console.log(paymentOptions)\n       let billm= paymentOptions.filter(el=>el.name===value)\n       await setBillMode(billm[0])\n        //console.log(billm)\n        // at startup\n        // check payment mode options from patient financial info\n        // load that to select options\n        // default to HMO-->company-->family-->cash\n        //when chosen\n        //append payment mode to order\n        //check service contract for pricing info\n        // calculate pricing \n        // pricing\n\n\n    }\n\n    const handleRow= async(ProductEntry)=>{\n    //console.log(\"b4\",state)\n\n    //console.log(\"handlerow\",ProductEntry)\n\n    //await setMedication(ProductEntry)\n\n            const    newProductEntryModule={\n                selectedMedication:ProductEntry,\n                show :'detail'\n            }\n            await setState((prevstate)=>({...prevstate, medicationModule:newProductEntryModule}))\n   //console.log(state)\n  // ProductEntry.show=!ProductEntry.show\n\n        } \n \n     const [productEntry,setProductEntry]=useState({\n         productitems:[],\n         date,\n         documentNo,\n         type,\n         totalamount,\n         source,\n \n     })\n  \n     const productItemI={\n         productId,\n         name,\n         quantity,\n         sellingprice,\n         amount:calcamount, //||qamount\n         baseunit,\n         costprice,\n         category:\"Prescription\",  //category===\"Inventory\"?\"Prescription\":category,\n         billingId,\n         billMode\n \n     }\n\n     const checkPrice= async(contracts,billMode)=>{\n         \n\n        if( billMode.type===\"HMO Cover\"){ //paymentmode\n         if (billMode.detail.plan===\"NHIS\"){\n             //find contract for NHIS\n             let contract=contracts.filter(el=>el.source_org_name===\"NHIS\")\n             if (contract.length){\n                // console.log(contract[0].price)\n               await  setSellingPrice(contract[0].price)     \n          }else{\n             toast({\n                 message: 'Please NHIS does not have cover/price for this service. Either set service price for NHIS, try another service or bill using cash',\n                 type: 'is-danger',\n                 dismissible: true,\n                 pauseOnHover: true,\n               })\n              await setSellingPrice(0)\n          }\n\n         }else{\n\n         let contract=contracts.filter(el=>el.source_org===billMode.detail.organizationId)\n         if (contract.length){\n           // console.log(contract[0].price)\n            await setSellingPrice(contract[0].price)\n            \n          }else{\n         toast({\n             message: 'Please HMO does not have cover/price for this service. Either set service price for HMO , try another drug, bill using cash or adjust amount ',\n             type: 'is-danger',\n             dismissible: true,\n             pauseOnHover: true,\n           })\n           await setSellingPrice(0)\n      }\n     \n     }\n     }\n     if( billMode.type===\"Company Cover\"){ //paymentmode\n         let contract=contracts.filter(el=>el.source_org===billMode.detail.organizationId)\n         if (contract.length){\n        // console.log(contract[0].price)\n       await   setSellingPrice(contract[0].price)\n         \n        \n        }else{\n\n         toast({\n             message: 'Please company does not have cover/price for this service. Either set service price for Company or try another drug or bill using cash',\n             type: 'is-danger',\n             dismissible: true,\n             pauseOnHover: true,\n           })\n         await  setSellingPrice(0)   \n      }\n\n  }\n  if( billMode.type===\"Cash\" || billMode.type===\"Family Cover\"){ //paymentmode\n     let contract=contracts.filter(el=>el.source_org===el.dest_org)\n     if (contract.length){\n    // console.log(contract[0].price)\n     await setSellingPrice(contract[0].price)\n    \n    \n         }else{\n\n     toast({\n         message: 'Please there is no cover/price for this service. Either set service price or try another service. Setting price at zero ',\n         type: 'is-danger',\n         dismissible: true,\n         pauseOnHover: true,\n       })\n       await setSellingPrice(0)   \n  }\n\n  }\n\n    }\n     // consider batchformat{batchno,expirydate,qtty,baseunit}\n     //consider baseunoit conversions\n     const getSearchfacility=async (service)=>{\n        // console.log(obj)\n       \n        if (!service){\n            //\"clear stuff\"\n            setProductId(\"\")\n            setName(\"\")\n            setBaseunit(\"\")\n            setInventoryId(\"\")\n            setSellingPrice(0)\n            setInvQuantity(\"\")\n            setQAmount(null)\n            setCostprice(\"\")\n            setContracts(\"\")\n            setCategory(\"\")\n            setInventoryId(\"\")\n            setBilllingId(\"\")\n           // setCalcAmount(null)\n            return\n        }\n \n        setContracts(service.contracts)\n         setProductId(service.productId)\n         setName(service.name)\n         setCategory(service.category) //Lab Order\n         setBaseunit(service.baseunit)\n         setInventoryId(service.inventoryId)\n         setBilllingId(service._id)\n         await setObj(service)\n\n       \n    }\n     useEffect(() => {\n      \n     }, [obj])\n\n     useEffect(() => {\n         setCurrentUser(user)\n         //console.log(currentUser)\n         return () => {\n         \n         }\n     }, [user])\n \n     const handleUpdateTotal=async ()=>{\n        await setTotalamount(prevtotal=>Number(prevtotal) + Number(calcamount))\n     }\n \n     const handleChangeType=async (e)=>{\n         //console.log(e.target.value)\n         await setType(e.target.value)\n     }\n \n     const handleAmount= async()=>{\n         await setQAmount(null)\n        // alert(\"Iam chaning qamount\")\n     }\n\n     const handleClickProd=async()=>{\n       /*   console.log(\"amount: \",productItemI.amount)\n         console.log(\"qamount: \",qamount)\n         console.log(\"calcamount: \",calcamount) */\n        if ( quantity===0||quantity===\"\"|| productId===\"\"||paymentmode===\"\" ){\n            toast({\n                message: 'You need to choose a product and quantity to proceed',\n                type: 'is-danger',\n                dismissible: true,\n                pauseOnHover: true,\n              }) \n              return \n        }\n\n         await setSuccess(false)\n         await setProductItem(\n             prevProd=>prevProd.concat(productItemI)\n         )\n        handleUpdateTotal()\n            // generate billing info\n            const billInfo={\n                orderInfo:{\n                    orderId:medication._id,\n                    orderObj:medication,\n                  },\n                  serviceInfo:{            \n                    price: productItemI.sellingprice,\n                    quantity: productItemI.quantity,\n                    productId: productItemI.productId,\n                    name: productItemI.name,\n                    baseunit: productItemI.baseunit,\n                    amount:productItemI.amount,\n                    billingId:productItemI.billingId,\n                    createdby:user._id,\n                  },\n                  paymentInfo:{\n                    amountDue:productItemI.amount,\n                    paidup:0,\n                    balance:productItemI.amount,\n                    paymentDetails:[]\n              \n                  },\n                  participantInfo:{\n                    billingFacility:medication.destination,\n                    billingFacilityName:medication.destination_name,\n                    locationId:state.StoreModule.selectedStore._id, //selected location,\n                    clientId:medication.clientId,\n                    client:medication.client,\n                    paymentmode:billMode\n                  },\n                  createdBy:user.id,\n                  billing_status:\"Unpaid\"\n                }\n\n        //update order\n        \n        OrderServ.patch(medication._id,{\n            order_status:\"Billed\", //Billed\n            billInfo,\n        }).then((resp)=>{\n           // medication=resp\n           // console.log(resp)\n             handleRow(resp) \n            //update dispense\n\n        })\n        .catch((err)=>{\n            console.log(err)\n        })\n        \n        //update status(billed) + action()\n        //?attached chosen product to medication\n        //dispense helper?\n         setName(\"\")\n         setBaseunit(\"\")\n         setQuantity(\"\")\n         setInventoryId(\"\")\n         setSellingPrice(\"\")\n         setInvQuantity(\"\")\n             handleAmount()\n        // setCalcAmount(null)\n        await setSuccess(true)\n        getSearchfacility(false)\n        setObj(\"\")\n        /* console.log(success)\n        console.log(qamount)\n        console.log(productItem) */\n        setChangeAmount(true)\n       \n     }\n  \n \n     const handleQtty=async(e)=>{\n        /*  if (invquantity<e.target.value){\n             toast({\n                 message: 'You can not sell more quantity than exist in inventory ' ,\n                 type: 'is-danger',\n                 dismissible: true,\n                 pauseOnHover: true,\n               })\n             return\n         } */\n         setQuantity(e.target.value)\n         if (e.target.vlue===\"\"){\n            setQuantity(1)\n         }\n        /*  calcamount1=quantity*sellingprice\n         await setCalcAmount(calcamount1) */\n         //console.log(calcamount)\n     }\n \n     useEffect( () => {\n          setProductEntry({\n             \n             date,\n             documentNo,\n             type,\n             totalamount,\n             source,\n         })\n        setCalcAmount(quantity*sellingprice) \n         return () => {\n             \n         }\n     },[date])\n \n     const resetform=()=>{\n      setType(\"Sales\")\n     setDocumentNo(\"\")\n     setTotalamount(\"\")\n     setProductId(\"\")\n     setSource(\"\")\n     setDate(\"\")\n     setName(\"\")\n     setBaseunit()\n     setCostprice()\n     setProductItem([])\n     }\n\n\n     const handleAdmit= async(e)=>{ //handle admit\n\n    //alert(\"something\")\n    //update order\n    //create admission resource\n    //?create bill?\n\n    const note={\n       Note:\"Patient Admitted to \" + state.employeeLocation.locationName + \" \" + state.employeeLocation.locationType + \" at \" +  Date().toLocaleString(),\n       Instruction: medication.instruction\n    }\n\n    //console.log(note)\n    let document={}\n    // data.createdby=user._id\n    // console.log(data);\n        if (user.currentEmployee){\n        document.facility=user.currentEmployee.facilityDetail._id \n        document.facilityname=user.currentEmployee.facilityDetail.facilityName // or from facility dropdown\n        }\n        document.documentdetail=note\n        console.log(document.documentdetail)\n        document.documentname=\"Admission\" //state.DocumentClassModule.selectedDocumentClass.name\n        // document.documentClassId=state.DocumentClassModule.selectedDocumentClass._id\n        document.location=state.employeeLocation.locationName+\" \"+state.employeeLocation.locationType\n        document.locationId=state.employeeLocation.locationId\n        document.client=medication.client._id\n        document.clientname=medication.client.firstname+ \" \"+ medication.client.middlename+\" \"+ medication.client.lastname\n        document.clientobj=medication.client\n        document.createdBy=user._id\n        document.createdByname=user.firstname+ \" \"+user.lastname\n        document.status=\"completed\"\n\n\n    const    data={\n              //  encounter_id:{type: Schema.Types.ObjectId,},\n              //  hospitalization_id:{type: Schema.Types.ObjectId,},\n                //order\n                order:medication,\n                order_id:medication._id,\n\n                //location: ward/bed\n                ward_name:state.WardModule.selectedWard.typeName,\n                ward_id:state.WardModule.selectedWard._id,\n                bed:bedObject.typeName,\n                bed_id:bedObject._id,\n                facility:user.currentEmployee.facilityDetail._id,\n                //billing:perpertuity\n                /* bill:{type:Schema.Types.Mixed},\n                bill_id:{type: Schema.Types.ObjectId,}, */\n                //status\n                status:\"occupied\",\n                //client\n                client:medication.client,\n                client_id:medication.clientId,\n                //careteam\n                admissionhx:[],\n                careteam:[],\n                start_time: new Date(),\n                //end_time:\"\",\n                createdby:user._id,\n                documentation:document\n                }\n\n                e.preventDefault();\n                setMessage(\"\")\n              //  setError(false)\n                setSuccess(false)\n                 // data.createdby=user._id\n                  console.log(data);\n                /*   if (user.currentEmployee){\n                 data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\n                  } */\n                 // data.locationType=\"Front Desk\"\n                  AdmissionServ.create(data)\n                .then(async (res)=>{\n                        //console.log(JSON.stringify(res))\n                       // e.target.reset();\n                       /*  setMessage(\"Created Clinic successfully\") */\n                        setSuccess(true)\n                        toast({\n                            message: 'Admission successfull',\n                            type: 'is-success',\n                            dismissible: true,\n                            pauseOnHover: true,\n                          })\n                          setSuccess(false)\n                          setChosenBed()                        \n                          setBedObject()\n                          const    newProductEntryModule={\n                            selectedAdmission:{},\n                            show :''\n                        }\n                      await setState((prevstate)=>({...prevstate, AdmissionModule:newProductEntryModule}))\n                    })\n                    .catch((err)=>{\n                        toast({\n                            message: 'Error creating Admission ' + err,\n                            type: 'is-danger',\n                            dismissible: true,\n                            pauseOnHover: true,\n                          })\n                    }) \n    }\n \n\n    const handleBed=(e)=>{\n        //console.log(JSON.parse(e.target.value))\n       setChosenBed(e.target.value)\n        let simpa= physicalbeds.find(obj=>obj._id===e.target.value)\n        setBedObject(simpa)\n\n    }\n\n     const onSubmit = async(e) =>{\n         e.preventDefault();\n         setMessage(\"\")\n         //setError(false)\n         setSuccess(false)\n         await setProductEntry({\n             \n             date,\n             documentNo,\n             type,\n             totalamount,\n             source,\n         })\n         productEntry.productitems=productItem\n         productEntry.createdby=user._id\n         productEntry.transactioncategory=\"debit\"\n           if (user.currentEmployee){\n          productEntry.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\n           }else{\n             toast({\n                 message: 'You can not remove inventory from any organization',\n                 type: 'is-danger',\n                 dismissible: true,\n                 pauseOnHover: true,\n               }) \n               return\n           }\n           \n           if (state.StoreModule.selectedStore._id){\n             productEntry.storeId=state.StoreModule.selectedStore._id\n           }else{\n             toast({\n                 message: 'You need to select a store before removing inventory',\n                 type: 'is-danger',\n                 dismissible: true,\n                 pauseOnHover: true,\n               }) \n               return\n           }\n           \n \n       } \n \n  \n    const handleChangeAmount=()=>{\n        setChangeAmount((rev)=>(!rev))\n        \n    }\n\n    const newclient=async ()=>{\n        await  setProductItem([])\n    }\n\n    useEffect(() => {\n        setPatient(medication.client)\n        const oldname=medication.clientname\n       // console.log(\"oldname\",oldname)\n        setSource(medication.clientname)\n\n        const newname=source\n       // console.log(\"newname\",newname)\n        if (oldname!==newname){\n            //newclient\n\n            //recalculate bedspace: subtract occupied from physical space\n\n        \n        setProductItem([])\n        setTotalamount(0)\n\n        }\n       \n\n\n        return () => {\n           \n        }\n    }, [medication])\n\n    useEffect(() => {\n        //setPatient(medication.client)\n        setProductItem([])\n        setTotalamount(0)\n        const paymentoptions= []\n       // const info = client.paymentinfo\n        let billme\n       let obj\n       patient &&  patient.paymentinfo.forEach((pay,i)=>{ \n           if (pay.active){\n       \n            switch(pay.paymentmode) {\n                case 'Cash':\n                  // code block\n                  obj=createObj(pay,\"Cash\",\"Cash\",\"Cash\" )\n                \n                  paymentoptions.push(obj)\n                  setPaymentMode(\"Cash\")\n                  billme=obj\n                 // console.log(\"billme\",billme)\n                  break;\n                case 'Family':\n                  // code block\n                  obj=createObj(pay,\"Family Cover\",\"familyCover\", \"Family Cover\")\n                  paymentoptions.push(obj)\n                  setPaymentMode(\"Family Cover\")\n                  billme=obj\n                 // console.log(\"billme\",billme)\n                  break;\n                case 'Company':\n                  // code block\n                  let name=\"Company: \" + pay.organizationName + \"(\" + pay.plan+\")\"\n\n                  obj=createObj(pay,name,\"CompanyCover\", \"Company Cover\" )\n                      paymentoptions.push(obj)\n                      setPaymentMode(\"Company: \" + pay.organizationName + \"(\" + pay.plan+\")\")\n                     billme=obj\n                    // console.log(\"billme\",billme)\n                  break;\n                case 'HMO':\n                  // code block\n                 let  sname=\"HMO: \" + pay.organizationName + \"(\" + pay.plan+\")\"\n\n                  obj=createObj(pay,sname,\"HMOCover\", \"HMO Cover\" )\n                      paymentoptions.push(obj)\n                      setPaymentMode(\"HMO: \" + pay.organizationName + \"(\" + pay.plan+\")\")\n                     billme=obj\n                   //  console.log(\"billme\",billme)\n                  break;\n                default:\n                  // code block\n              }\n            }\n            })\n                    \n          \n        setPaymentOptions(paymentoptions)\n        setBillMode(billme)\n       //console.log(paymentoptions)\n       // console.log(billMode)\n        return () => {\n           \n        }\n    }, [source]) //source\n\n\n     useEffect(() => {\n       // const medication =state.medicationModule.selectedMedication\n         const today=new Date().toLocaleString()\n         //console.log(today)\n         setDate(today)\n         const invoiceNo=random(6,'uppernumeric')\n         setDocumentNo(invoiceNo)\n         const ward= state.WardModule.selectedWard\n         return () => {\n             \n         }\n     }, [])\n\n     useEffect(() => {\n        // console.log(\"success\", success)\n         if (success){\n             setSuccess(false)\n         }\n       \n      }, [success])\n\n      const createObj= (pay,name,cover,type)=>{\n        let details={}\n          details= {...pay}\n          details.type=type\n  \n      return {\n              name,\n              value:cover,\n              detail:details,\n              type,\n          }\n  \n      }\n\n      useEffect(() => {\n        \n        //update selling price\n        if (!!billMode && !!contracts){\n           // console.log(contracts)\n            checkPrice(contracts,billMode)\n        }\n       \n        return () => {\n           \n        }\n    }, [obj])\n\n     useEffect(() => {\n        calcamount1=quantity*sellingprice\n         setCalcAmount(calcamount1)\n        // console.log(calcamount)\n         setChangeAmount(true)\n        return () => {\n            \n        }\n    }, [quantity,sellingprice])\n\n    useEffect(() => {\n       \n        if (!!billMode && !!contracts){\n            \n            checkPrice(contracts,billMode)\n        }\n        \n        return () => {\n            \n        }\n    }, [billMode])\n\n// console.log(\"simpa\")\n     return (\n         <>\n             <div className=\"card card-overflow\">\n             <div className=\"card-header\">\n                 <p className=\"card-header-title\">\n                     Admit Patient\n                 </p>\n                 <button className=\"button is-success is-small btnheight mt-2\" onClick={showDocumentation}>Documentation</button>\n             </div>\n             <div className=\"card-content \">\n    \n             <form onSubmit={onSubmit}> {/* handleSubmit(onSubmit) */}\n             <div className=\"field is-horizontal\">\n             <div className=\"field-body\">\n            {/*  <div className=\"field\">    \n                 <div className=\"control\">\n                     <div className=\"select is-small\">\n                         <select name=\"type\" value={type} onChange={handleChangeType} className=\"selectadd\">\n                            <option value=\"\">Choose Type </option>\n                             <option value=\"Dispense\">Dispense</option>\n                             <option value=\"Bill\">Bill </option> */}\n                             {/* <option value=\"Dispense\">Dispense</option>\n                             <option value=\"Audit\">Audit</option> */}\n                 {/*         </select>\n                     </div>\n                 </div>\n             </div>\n */}\n             <div className=\"field\">\n                     <p className=\"control has-icons-left has-icons-right\">\n                         <input className=\"input is-small\" /* ref={register({ required: true })} */ value={source} name=\"client\" type=\"text\" onChange={e=>setSource(e.target.value)} placeholder=\"Client\" />\n                         <span className=\"icon is-small is-left\">\n                             <i className=\"fas fa-hospital\"></i>\n                         </span>                    \n                     </p>\n                 </div>\n                 <div className=\"field\">    \n                 <div className=\"control\">\n                     <div className=\"select is-small \">\n                         <select name=\"paymentmode\" value={paymentmode} onChange={(e)=>handleChangeMode(e.target.value)} className=\"selectadd\" >\n                         <option value=\"\">Billing Mode </option>\n                           {paymentOptions.map((option,i)=>(\n                               <option key={i} value={option.details}> {option.name}</option>\n                           ))}\n                           \n                            \n                            {/*  <option value=\"Cash\">Cash</option>\n                             <option value=\"Family\">Family </option>\n                            <option value=\"Company Cover\">Company Cover</option>\n                             <option value=\"HMO\">HMO</option> */}\n                         </select>\n                     </div>\n                 </div>\n             </div>\n            \n             </div>\n             </div> \n                \n                 </form>   \n                \n            \n          {/* array of ProductEntry items */}\n         \n         <label className=\"label is-small\">Admission Ward:</label>\n         <div className=\"field is-horizontal\">\n             <div className=\"field-body\">\n             <div className=\"field\" style={{width:\"40%\"}}>\n                 <p className=\"control has-icons-left\" >\n                     <input className=\"input is-small\"  /* ref={register({ required: true })} */ disabled  name=\"order\" value={medication.order} type=\"text\" onChange={ e=> handleQtty(e)} placeholder=\"Quantity\"  />\n                   \n                    {/*  <span className=\"helper is-size-7\"><strong>Instruction: </strong>{medication.instruction}</span> */}\n                    \n                 </p>\n                 <span className=\"helper is-size-7\"><strong>Instructions: </strong></span>\n                 <p>\n                 {medication.instruction}\n                 </p>\n\n             </div> \n            \n             </div>\n             </div>\n             <label className=\"label is-small\">Choose Bed:</label>\n                 {!!state.WardModule.selectedWard.sublocations &&<div>\n               \n\n                        <select name=\"bed\" value={chosenBed} onChange={(e)=>handleBed(e)} className=\"selectadd\" >         \n                         <option value=\"\">Choose Bed </option>\n                           {physicalbeds.map((locat,i)=>(\n                               <option key={i} value={locat._id}> {locat.typeName}</option>\n                           ))}\n\n                         </select>\n                     </div>}\n\n\n        \n             \n         <div>\n             \n             \n                 <div className=\"field mt-2 is-grouped\">\n                 <p className=\"control\">\n                     <button className=\"button is-success is-small\" /* disabled={!productItem.length>0} */ onClick={handleAdmit}>\n                       Admit\n                     </button>\n                 </p>\n                {/*  <p className=\"control\">\n                     <button className=\"button is-warning is-small\" disabled={!productItem.length>0} onClick={onSubmit} >\n                         Clear\n                     </button>\n                 </p> */}\n                 </div>\n                 </div>\n            \n             \n             \n             \n             </div>\n             </div>\n             <div className={`modal ${productModal?\"is-active\":\"\"}` }>\n                                    <div className=\"modal-background\"></div>\n                                    <div className=\"modal-card  modalbkgrnd\">\n                                        <header className=\"modal-card-head  btnheight\">\n                                        <p className=\"modal-card-title\">Documentation</p>\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={handlecloseModal}></button>\n                                        </header>\n                                        <section className=\"modal-card-body modalcolor\">\n                                      \n                                         <Encounter standalone=\"true\" />\n                                        </section> \n                                        {/* <footer className=\"modal-card-foot\">\n                                        <button className=\"button is-success\">Save changes</button>\n                                        <button className=\"button\">Cancel</button>\n                                        </footer>  */}\n                                   </div>\n                                </div>      \n         </>\n     )\n    \n }\n\n export  function InventorySearch({getSearchfacility,clear}) {\n    \n    const productServ=client.service('inventory')\n    const [facilities,setFacilities]=useState([])\n     // eslint-disable-next-line\n     const [searchError, setSearchError] =useState(false)\n     // eslint-disable-next-line\n    const [showPanel, setShowPanel] =useState(false)\n     // eslint-disable-next-line\n   const [searchMessage, setSearchMessage] = useState(\"\") \n   // eslint-disable-next-line \n   const [simpa,setSimpa]=useState(\"\")\n   // eslint-disable-next-line \n   const [chosen,setChosen]=useState(false)\n   // eslint-disable-next-line \n   const [count,setCount]=useState(0)\n   const inputEl=useRef(null)\n   const [val,setVal]=useState(\"\")\n   const {user} = useContext(UserContext) \n   const {state}=useContext(ObjectContext)\n    const [productModal,setProductModal]=useState(false)\n\n   const handleRow= async(obj)=>{\n        await setChosen(true)\n        //alert(\"something is chaning\")\n       getSearchfacility(obj)\n       \n       await setSimpa(obj.name)\n       \n        // setSelectedFacility(obj)\n        setShowPanel(false)\n        await setCount(2)\n        /* const    newfacilityModule={\n            selectedFacility:facility,\n            show :'detail'\n        }\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\n   //console.log(state)\n    }\n    const handleBlur=async(e)=>{\n        /*  if (count===2){\n             console.log(\"stuff was chosen\")\n         }\n        */\n       /*  console.log(\"blur\")\n         setShowPanel(false)\n        console.log(JSON.stringify(simpa))\n        if (simpa===\"\"){\n            console.log(facilities.length)\n            setSimpa(\"abc\")\n            setSimpa(\"\")\n            setFacilities([])\n            inputEl.current.setValue=\"\"\n        }\n        console.log(facilities.length)\n        console.log(inputEl.current) */\n    }\n    const handleSearch=async(value)=>{\n        setVal(value)\n        if (value===\"\"){\n            setShowPanel(false)\n            getSearchfacility(false)\n            return\n        }\n        const field='name' //field variable\n\n       \n        if (value.length>=3 ){\n            productServ.find({query: {     //service\n                 [field]: {\n                     $regex:value,\n                     $options:'i'\n                    \n                 },\n                 facility: user.currentEmployee.facilityDetail._id,\n                 storeId: state.StoreModule.selectedStore._id,\n                 $limit:10,\n                 $sort: {\n                     createdAt: -1\n                   }\n                     }}).then((res)=>{\n            //  console.log(\"product  fetched successfully\") \n            //  console.log(res.data) \n                setFacilities(res.data)\n                 setSearchMessage(\" product  fetched successfully\")\n                 setShowPanel(true)\n             })\n             .catch((err)=>{\n                toast({\n                    message: 'Error creating ProductEntry ' + err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n             })\n         }\n        else{\n           // console.log(\"less than 3 \")\n           // console.log(val)\n            setShowPanel(false)\n            await setFacilities([])\n           // console.log(facilities)\n        }\n    }\n\n    const handleAddproduct =()=>{\n        setProductModal(true) \n    }\n    const handlecloseModal =()=>{\n        setProductModal(false)\n        handleSearch(val)\n    }\n    useEffect(() => {\n       if (clear){\n         //  console.log(\"success has changed\",clear)\n           setSimpa(\"\")\n       }\n        return () => {\n            \n        }\n    }, [clear] )\n    return (\n        <div>\n            <div className=\"field\">\n                <div className=\"control has-icons-left  \">\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`} style={{width:\"100%\"}}>\n                        <div className=\"dropdown-trigger\" style={{width:\"100%\"}}>\n                            <DebounceInput className=\"input is-small  is-expanded\" \n                                type=\"text\" placeholder=\"Search Product\"\n                                value={simpa}\n                                minLength={3}\n                                debounceTimeout={400}\n                                onBlur={(e)=>handleBlur(e)}\n                                onChange={(e)=>handleSearch(e.target.value)}\n                                inputRef={inputEl}\n                                  />\n                            <span className=\"icon is-small is-left\">\n                                <i className=\"fas fa-search\"></i>\n                            </span>\n                        </div>\n                        {/* {searchError&&<div>{searchMessage}</div>} */}\n                        <div className=\"dropdown-menu expanded\" style={{width:\"100%\"}}>\n                            <div className=\"dropdown-content\">\n                          { facilities.length>0?\"\":<div className=\"dropdown-item\" /* onClick={handleAddproduct} */> <span> {val} is not in your inventory</span> </div>}\n\n                              {facilities.map((facility, i)=>(\n                                    \n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\n                                        \n                                        <div><span>{facility.name}</span></div>\n                                        <div><span><strong>{facility.quantity}</strong></span>\n                                        <span>{facility.baseunit}(s) remaining</span>\n                                        <span className=\"padleft\"><strong>Price:</strong> N{facility.sellingprice}</span></div>\n                                        \n                                    </div>\n                                    \n                                    ))}\n                                    \n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}