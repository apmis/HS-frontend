{"ast":null,"code":"import _defineProperty from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable */import React,{useState,useContext,useEffect,useRef}from'react';import client from'../../feathers';import{DebounceInput}from'react-debounce-input';import{useForm}from\"react-hook-form\";//import {useHistory} from 'react-router-dom'\nimport{UserContext,ObjectContext}from'../../context';import{toast}from'bulma-toast';import{ClientCreate,ClientDetail,ClientList}from'../ClientMgt/Patient';import EncounterMain from'./EncounterMain';import EncounterRight from'./EncounterRight';import PatientProfile from'../ClientMgt/PatientProfile';var random=require('random-string-generator');// eslint-disable-next-line\nvar searchfacility={};export default function Encounter(_ref){var standalone=_ref.standalone;var _useContext=useContext(ObjectContext),state=_useContext.state,setState=_useContext.setState;//,setState\n// eslint-disable-next-line\n//const [selectedProductEntry,setSelectedProductEntry]=useState()\n//const [showState,setShowState]=useState() //create|modify|detail\n//const {state,setState}=useContext(ObjectContext) //,setState\n// eslint-disable-next-line\nvar _useState=useState(),_useState2=_slicedToArray(_useState,2),selectedClient=_useState2[0],setSelectedClient=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showModal=_useState4[0],setShowModal=_useState4[1];//let { path, url } = useRouteMatch();\nuseEffect(function(){console.log(\"starting up Encounter module\");console.log(state.ClientModule.selectedClient);var newDocumentClassModule={selectedDocumentClass:{},//state.DocumentClassModule.selectedDocumentClass.name\nshow:'detail'};setState(function(prevstate){return _objectSpread(_objectSpread({},prevstate),{},{DocumentClassModule:newDocumentClassModule});});if(Object.keys(state.ClientModule.selectedClient).length===0&&state.ClientModule.selectedClient.constructor===Object){handleChangeClient();}return function(){};},[]);useEffect(function(){setSelectedClient(state.ClientModule.selectedClient);},[state.ClientModule]);var handleChangeClient=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return setShowModal(true);case 2:console.log(showModal);case 3:case\"end\":return _context.stop();}}},_callee);}));return function handleChangeClient(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"section\",{className:\"section remPadTop\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"columns \",children:[!standalone&&/*#__PURE__*/_jsx(\"div\",{className:\"column is-2 \",children:/*#__PURE__*/_jsx(PatientProfile,{})}),!standalone&&/*#__PURE__*/_jsx(\"div\",{className:state.DocumentClassModule.show==='detail'?\"column is-6\":\"column is-6 \",children:/*#__PURE__*/_jsx(EncounterMain,{client:selectedClient})}),standalone&&/*#__PURE__*/_jsx(\"div\",{className:state.DocumentClassModule.show==='detail'?\"column is-8\":\"column is-12 \",children:/*#__PURE__*/_jsx(EncounterMain,{client:selectedClient,nopresc:standalone})}),/*#__PURE__*/_jsx(\"div\",{className:\"column is-4 \",children:state.DocumentClassModule.show==='detail'&&/*#__PURE__*/_jsx(EncounterRight,{client:selectedClient})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal \".concat(showModal?\"is-active\":\"\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-background\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-card\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"modal-card-head btnheight\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"modal-card-title\",children:\"Choose Client\"}),/*#__PURE__*/_jsx(\"button\",{className:\"delete\",\"aria-label\":\"close\",onClick:function onClick(){return setShowModal(false);}})]}),/*#__PURE__*/_jsx(\"section\",{className:\"modal-card-body \",children:/*#__PURE__*/_jsx(ClientList,{standalone:\"true\"})})]})]})]});}export function InventorySearch(_ref3){var getSearchfacility=_ref3.getSearchfacility,clear=_ref3.clear;var productServ=client.service('inventory');var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),facilities=_useState6[0],setFacilities=_useState6[1];// eslint-disable-next-line\nvar _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),searchError=_useState8[0],setSearchError=_useState8[1];// eslint-disable-next-line\nvar _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),showPanel=_useState10[0],setShowPanel=_useState10[1];// eslint-disable-next-line\nvar _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),searchMessage=_useState12[0],setSearchMessage=_useState12[1];// eslint-disable-next-line \nvar _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),simpa=_useState14[0],setSimpa=_useState14[1];// eslint-disable-next-line \nvar _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),chosen=_useState16[0],setChosen=_useState16[1];// eslint-disable-next-line \nvar _useState17=useState(0),_useState18=_slicedToArray(_useState17,2),count=_useState18[0],setCount=_useState18[1];var inputEl=useRef(null);var _useState19=useState(\"\"),_useState20=_slicedToArray(_useState19,2),val=_useState20[0],setVal=_useState20[1];var _useContext2=useContext(UserContext),user=_useContext2.user;var _useContext3=useContext(ObjectContext),state=_useContext3.state;var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),productModal=_useState22[0],setProductModal=_useState22[1];var handleRow=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(obj){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return setChosen(true);case 2://alert(\"something is chaning\")\ngetSearchfacility(obj);_context2.next=5;return setSimpa(obj.name);case 5:// setSelectedFacility(obj)\nsetShowPanel(false);_context2.next=8;return setCount(2);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function handleRow(_x){return _ref4.apply(this,arguments);};}();var handleBlur=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(count===2){console.log(\"stuff was chosen\");}/*  console.log(\"blur\")\n         setShowPanel(false)\n        console.log(JSON.stringify(simpa))\n        if (simpa===\"\"){\n            console.log(facilities.length)\n            setSimpa(\"abc\")\n            setSimpa(\"\")\n            setFacilities([])\n            inputEl.current.setValue=\"\"\n        }\n        console.log(facilities.length)\n        console.log(inputEl.current) */case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function handleBlur(_x2){return _ref5.apply(this,arguments);};}();var handleSearch=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(value){var field,_query;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setVal(value);if(!(value===\"\")){_context4.next=5;break;}setShowPanel(false);getSearchfacility(false);return _context4.abrupt(\"return\");case 5:field='name';//field variable\nif(!(value.length>=3)){_context4.next=10;break;}productServ.find({query:(_query={},_defineProperty(_query,field,{$regex:value,$options:'i'}),_defineProperty(_query,\"facility\",user.currentEmployee.facilityDetail._id),_defineProperty(_query,\"storeId\",state.StoreModule.selectedStore._id),_defineProperty(_query,\"$limit\",10),_defineProperty(_query,\"$sort\",{createdAt:-1}),_query)}).then(function(res){console.log(\"product  fetched successfully\");console.log(res.data);setFacilities(res.data);setSearchMessage(\" product  fetched successfully\");setShowPanel(true);}).catch(function(err){toast({message:'Error creating ProductEntry '+err,type:'is-danger',dismissible:true,pauseOnHover:true});});_context4.next=16;break;case 10:console.log(\"less than 3 \");console.log(val);setShowPanel(false);_context4.next=15;return setFacilities([]);case 15:console.log(facilities);case 16:case\"end\":return _context4.stop();}}},_callee4);}));return function handleSearch(_x3){return _ref6.apply(this,arguments);};}();var handleAddproduct=function handleAddproduct(){setProductModal(true);};var handlecloseModal=function handlecloseModal(){setProductModal(false);handleSearch(val);};useEffect(function(){if(clear){console.log(\"success has changed\",clear);setSimpa(\"\");}return function(){};},[clear]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"div\",{className:\"control has-icons-left  \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown \".concat(showPanel?\"is-active\":\"\"),style:{width:\"100%\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-trigger\",style:{width:\"100%\"},children:[/*#__PURE__*/_jsx(DebounceInput,{className:\"input is-small  is-expanded\",type:\"text\",placeholder:\"Search Product\",value:simpa,minLength:3,debounceTimeout:400,onBlur:function onBlur(e){return handleBlur(e);},onChange:function onChange(e){return handleSearch(e.target.value);},inputRef:inputEl}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-left\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-menu expanded\",style:{width:\"100%\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-content\",children:[facilities.length>0?\"\":/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-item\"/* onClick={handleAddproduct} */,children:[\" \",/*#__PURE__*/_jsxs(\"span\",{children:[\" \",val,\" is not in your inventory\"]}),\" \"]}),facilities.map(function(facility,i){return/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-item\",onClick:function onClick(){return handleRow(facility);},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"span\",{children:facility.name})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"strong\",{children:facility.quantity})}),/*#__PURE__*/_jsxs(\"span\",{children:[facility.baseunit,\"(s) remaining\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"padleft\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Price:\"}),\" N\",facility.sellingprice]})]})]},facility._id);})]})})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal \".concat(productModal?\"is-active\":\"\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-background\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-card\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"modal-card-head\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"modal-card-title\",children:\"Choose Store\"}),/*#__PURE__*/_jsx(\"button\",{className:\"delete\",\"aria-label\":\"close\",onClick:handlecloseModal})]}),/*#__PURE__*/_jsx(\"section\",{className:\"modal-card-body\",children:/*#__PURE__*/_jsx(ClientCreate,{})})]})]})]});}","map":{"version":3,"sources":["/home/mfybaby/Documents/HealthStack2/HS-frontend/src/components/EncounterMgt/Encounter.js"],"names":["React","useState","useContext","useEffect","useRef","client","DebounceInput","useForm","UserContext","ObjectContext","toast","ClientCreate","ClientDetail","ClientList","EncounterMain","EncounterRight","PatientProfile","random","require","searchfacility","Encounter","standalone","state","setState","selectedClient","setSelectedClient","showModal","setShowModal","console","log","ClientModule","newDocumentClassModule","selectedDocumentClass","show","prevstate","DocumentClassModule","Object","keys","length","constructor","handleChangeClient","InventorySearch","getSearchfacility","clear","productServ","service","facilities","setFacilities","searchError","setSearchError","showPanel","setShowPanel","searchMessage","setSearchMessage","simpa","setSimpa","chosen","setChosen","count","setCount","inputEl","val","setVal","user","productModal","setProductModal","handleRow","obj","name","handleBlur","e","handleSearch","value","field","find","query","$regex","$options","currentEmployee","facilityDetail","_id","StoreModule","selectedStore","createdAt","then","res","data","catch","err","message","type","dismissible","pauseOnHover","handleAddproduct","handlecloseModal","width","target","map","facility","i","quantity","baseunit","sellingprice"],"mappings":"y5BAAA,oBACA,MAAOA,CAAAA,KAAP,EAAeC,QAAf,CAAwBC,UAAxB,CAAoCC,SAApC,CAA8CC,MAA9C,KAA2D,OAA3D,CACA,MAAOC,CAAAA,MAAP,KAAmB,gBAAnB,CACA,OAAQC,aAAR,KAA4B,sBAA5B,CACA,OAASC,OAAT,KAAwB,iBAAxB,CACA;AACA,OAAQC,WAAR,CAAoBC,aAApB,KAAwC,eAAxC,CACA,OAAQC,KAAR,KAAoB,aAApB,CACA,OAAQC,YAAR,CAAsBC,YAAtB,CAAoCC,UAApC,KAAqD,sBAArD,CAEA,MAAOC,CAAAA,aAAP,KAA0B,iBAA1B,CACA,MAAOC,CAAAA,cAAP,KAA2B,kBAA3B,CACA,MAAOC,CAAAA,cAAP,KAA2B,6BAA3B,CACA,GAAIC,CAAAA,MAAM,CAAGC,OAAO,CAAC,yBAAD,CAApB,CACA;AACA,GAAMC,CAAAA,cAAc,CAAC,EAArB,CAGA,cAAe,SAASC,CAAAA,SAAT,MAAiC,IAAbC,CAAAA,UAAa,MAAbA,UAAa,iBACpBnB,UAAU,CAACO,aAAD,CADU,CACrCa,KADqC,aACrCA,KADqC,CAC9BC,QAD8B,aAC9BA,QAD8B,CACM;AAClD;AACA;AACA;AACA;AACA;AAN4C,cAOHtB,QAAQ,EAPL,wCAOrCuB,cAPqC,eAOtBC,iBAPsB,8BAQbxB,QAAQ,CAAC,KAAD,CARK,yCAQrCyB,SARqC,eAQ3BC,YAR2B,eAU5C;AAEAxB,SAAS,CAAC,UAAM,CAEZyB,OAAO,CAACC,GAAR,CAAY,8BAAZ,EACAD,OAAO,CAACC,GAAR,CAAYP,KAAK,CAACQ,YAAN,CAAmBN,cAA/B,EACA,GAASO,CAAAA,sBAAsB,CAAC,CAC5BC,qBAAqB,CAAC,EADM,CAE5B;AACAC,IAAI,CAAE,QAHsB,CAAhC,CAKAV,QAAQ,CAAC,SAACW,SAAD,wCAAkBA,SAAlB,MAA6BC,mBAAmB,CAACJ,sBAAjD,IAAD,CAAR,CAEA,GAAIK,MAAM,CAACC,IAAP,CAAYf,KAAK,CAACQ,YAAN,CAAmBN,cAA/B,EAA+Cc,MAA/C,GAA0D,CAA1D,EAA+DhB,KAAK,CAACQ,YAAN,CAAmBN,cAAnB,CAAkCe,WAAlC,GAAkDH,MAArH,CAA4H,CACxHI,kBAAkB,GAEjB,CACJ,MAAO,WAAM,CACT,CADJ,CAEA,CAjBI,CAiBF,EAjBE,CAAT,CAmBArC,SAAS,CAAC,UAAI,CACbsB,iBAAiB,CAACH,KAAK,CAACQ,YAAN,CAAmBN,cAApB,CAAjB,CAEA,CAHQ,CAGP,CAACF,KAAK,CAACQ,YAAP,CAHO,CAAT,CAKA,GAAMU,CAAAA,kBAAkB,2FAAE,yJAChBb,CAAAA,YAAY,CAAC,IAAD,CADI,QAEtBC,OAAO,CAACC,GAAR,CAAaH,SAAb,EAFsB,sDAAF,kBAAlBc,CAAAA,kBAAkB,2CAAxB,CASA,mBACI,iBAAS,SAAS,CAAE,mBAApB,wBAII,aAAK,SAAS,CAAC,UAAf,WACC,CAACnB,UAAD,eAAe,YAAK,SAAS,CAAC,cAAf,uBACT,KAAC,cAAD,IADS,EADhB,CAKC,CAACA,UAAD,eAAmB,YAAK,SAAS,CAAIC,KAAK,CAACa,mBAAN,CAA0BF,IAA1B,GAAkC,QAAnC,CAA6C,aAA7C,CAA2D,cAA5E,uBACb,KAAC,aAAD,EAAe,MAAM,CAAET,cAAvB,EADa,EALpB,CAQKH,UAAU,eAAQ,YAAK,SAAS,CAAIC,KAAK,CAACa,mBAAN,CAA0BF,IAA1B,GAAkC,QAAnC,CAA6C,aAA7C,CAA2D,eAA5E,uBAChB,KAAC,aAAD,EAAe,MAAM,CAAET,cAAvB,CAAuC,OAAO,CAAEH,UAAhD,EADgB,EARvB,cAWE,YAAK,SAAS,CAAC,cAAf,UACIC,KAAK,CAACa,mBAAN,CAA0BF,IAA1B,GAAkC,QAAnC,eAA+C,KAAC,cAAD,EAAiB,MAAM,CAAET,cAAzB,EADlD,EAXF,GAJJ,cAoBI,aAAK,SAAS,iBAAWE,SAAS,CAAC,WAAD,CAAa,EAAjC,CAAd,wBACwB,YAAK,SAAS,CAAC,kBAAf,EADxB,cAEwB,aAAK,SAAS,CAAC,YAAf,wBACI,gBAAQ,SAAS,CAAC,2BAAlB,wBACA,UAAG,SAAS,CAAC,kBAAb,2BADA,cAEA,eAAQ,SAAS,CAAC,QAAlB,CAA2B,aAAW,OAAtC,CAA+C,OAAO,CAAE,yBAAIC,CAAAA,YAAY,CAAC,KAAD,CAAhB,EAAxD,EAFA,GADJ,cAKI,gBAAS,SAAS,CAAC,kBAAnB,uBACA,KAAC,UAAD,EAAY,UAAU,CAAC,MAAvB,EADA,EALJ,GAFxB,GApBJ,GADJ,CAyCH,CAOD,MAAQ,SAASc,CAAAA,eAAT,OAAoD,IAA1BC,CAAAA,iBAA0B,OAA1BA,iBAA0B,CAARC,KAAQ,OAARA,KAAQ,CAExD,GAAMC,CAAAA,WAAW,CAACvC,MAAM,CAACwC,OAAP,CAAe,WAAf,CAAlB,CAFwD,eAGvB5C,QAAQ,CAAC,EAAD,CAHe,yCAGjD6C,UAHiD,eAGtCC,aAHsC,eAIvD;AAJuD,eAKlB9C,QAAQ,CAAC,KAAD,CALU,yCAKhD+C,WALgD,eAKnCC,cALmC,eAMvD;AANuD,eAOvBhD,QAAQ,CAAC,KAAD,CAPe,0CAOjDiD,SAPiD,gBAOtCC,YAPsC,gBAQvD;AARuD,gBASflD,QAAQ,CAAC,EAAD,CATO,2CASlDmD,aATkD,gBASnCC,gBATmC,gBAUzD;AAVyD,gBAWlCpD,QAAQ,CAAC,EAAD,CAX0B,2CAWlDqD,KAXkD,gBAW5CC,QAX4C,gBAYzD;AAZyD,gBAahCtD,QAAQ,CAAC,KAAD,CAbwB,2CAalDuD,MAbkD,gBAa3CC,SAb2C,gBAczD;AAdyD,gBAelCxD,QAAQ,CAAC,CAAD,CAf0B,2CAelDyD,KAfkD,gBAe5CC,QAf4C,gBAgBzD,GAAMC,CAAAA,OAAO,CAACxD,MAAM,CAAC,IAAD,CAApB,CAhByD,gBAiBtCH,QAAQ,CAAC,EAAD,CAjB8B,2CAiBlD4D,GAjBkD,gBAiB9CC,MAjB8C,iCAkB1C5D,UAAU,CAACM,WAAD,CAlBgC,CAkBlDuD,IAlBkD,cAkBlDA,IAlBkD,kBAmB3C7D,UAAU,CAACO,aAAD,CAnBiC,CAmBlDa,KAnBkD,cAmBlDA,KAnBkD,iBAoBnBrB,QAAQ,CAAC,KAAD,CApBW,2CAoBjD+D,YApBiD,gBAoBpCC,eApBoC,gBAsBzD,GAAMC,CAAAA,SAAS,2FAAE,kBAAMC,GAAN,6IACNV,CAAAA,SAAS,CAAC,IAAD,CADH,QAEZ;AACDf,iBAAiB,CAACyB,GAAD,CAAjB,CAHa,uBAKPZ,CAAAA,QAAQ,CAACY,GAAG,CAACC,IAAL,CALD,QAOZ;AACAjB,YAAY,CAAC,KAAD,CAAZ,CARY,uBASNQ,CAAAA,QAAQ,CAAC,CAAD,CATF,yDAAF,kBAATO,CAAAA,SAAS,6CAAf,CAiBC,GAAMG,CAAAA,UAAU,2FAAC,kBAAMC,CAAN,sHACZ,GAAIZ,KAAK,GAAG,CAAZ,CAAc,CACV9B,OAAO,CAACC,GAAR,CAAY,kBAAZ,EACH,CAEH;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAhBqB,wDAAD,kBAAVwC,CAAAA,UAAU,8CAAhB,CAkBA,GAAME,CAAAA,YAAY,2FAAC,kBAAMC,KAAN,uIACfV,MAAM,CAACU,KAAD,CAAN,CADe,KAEXA,KAAK,GAAG,EAFG,2BAGXrB,YAAY,CAAC,KAAD,CAAZ,CACAT,iBAAiB,CAAC,KAAD,CAAjB,CAJW,yCAOT+B,KAPS,CAOH,MAPG,CAOI;AAPJ,KAUXD,KAAK,CAAClC,MAAN,EAAc,CAVH,4BAWXM,WAAW,CAAC8B,IAAZ,CAAiB,CAACC,KAAK,mCACjBF,KADiB,CACT,CACLG,MAAM,CAACJ,KADF,CAELK,QAAQ,CAAC,GAFJ,CADS,oCAMRd,IAAI,CAACe,eAAL,CAAqBC,cAArB,CAAoCC,GAN5B,mCAOT1D,KAAK,CAAC2D,WAAN,CAAkBC,aAAlB,CAAgCF,GAPvB,kCAQX,EARW,iCASX,CACHG,SAAS,CAAE,CAAC,CADT,CATW,SAAN,CAAjB,EAYaC,IAZb,CAYkB,SAACC,GAAD,CAAO,CACvBzD,OAAO,CAACC,GAAR,CAAY,+BAAZ,EACAD,OAAO,CAACC,GAAR,CAAYwD,GAAG,CAACC,IAAhB,EACEvC,aAAa,CAACsC,GAAG,CAACC,IAAL,CAAb,CACCjC,gBAAgB,CAAC,gCAAD,CAAhB,CACAF,YAAY,CAAC,IAAD,CAAZ,CACH,CAlBF,EAmBEoC,KAnBF,CAmBQ,SAACC,GAAD,CAAO,CACX9E,KAAK,CAAC,CACF+E,OAAO,CAAE,+BAAiCD,GADxC,CAEFE,IAAI,CAAE,WAFJ,CAGFC,WAAW,CAAE,IAHX,CAIFC,YAAY,CAAE,IAJZ,CAAD,CAAL,CAMF,CA1BF,EAXW,gCAwCXhE,OAAO,CAACC,GAAR,CAAY,cAAZ,EACAD,OAAO,CAACC,GAAR,CAAYgC,GAAZ,EACAV,YAAY,CAAC,KAAD,CAAZ,CA1CW,wBA2CLJ,CAAAA,aAAa,CAAC,EAAD,CA3CR,SA4CXnB,OAAO,CAACC,GAAR,CAAYiB,UAAZ,EA5CW,yDAAD,kBAAZyB,CAAAA,YAAY,8CAAlB,CAgDA,GAAMsB,CAAAA,gBAAgB,CAAE,QAAlBA,CAAAA,gBAAkB,EAAI,CACxB5B,eAAe,CAAC,IAAD,CAAf,CACH,CAFD,CAGA,GAAM6B,CAAAA,gBAAgB,CAAE,QAAlBA,CAAAA,gBAAkB,EAAI,CACxB7B,eAAe,CAAC,KAAD,CAAf,CACAM,YAAY,CAACV,GAAD,CAAZ,CACH,CAHD,CAIA1D,SAAS,CAAC,UAAM,CACb,GAAIwC,KAAJ,CAAU,CACNf,OAAO,CAACC,GAAR,CAAY,qBAAZ,CAAkCc,KAAlC,EACAY,QAAQ,CAAC,EAAD,CAAR,CACH,CACA,MAAO,WAAM,CAEZ,CAFD,CAGH,CARQ,CAQN,CAACZ,KAAD,CARM,CAAT,CASA,mBACI,oCACI,YAAK,SAAS,CAAC,OAAf,uBACI,YAAK,SAAS,CAAC,0BAAf,uBACI,aAAK,SAAS,oBAAcO,SAAS,CAAC,WAAD,CAAa,EAApC,CAAd,CAAwD,KAAK,CAAE,CAAC6C,KAAK,CAAC,MAAP,CAA/D,wBACI,aAAK,SAAS,CAAC,kBAAf,CAAkC,KAAK,CAAE,CAACA,KAAK,CAAC,MAAP,CAAzC,wBACI,KAAC,aAAD,EAAe,SAAS,CAAC,6BAAzB,CACI,IAAI,CAAC,MADT,CACgB,WAAW,CAAC,gBAD5B,CAEI,KAAK,CAAEzC,KAFX,CAGI,SAAS,CAAE,CAHf,CAII,eAAe,CAAE,GAJrB,CAKI,MAAM,CAAE,gBAACgB,CAAD,QAAKD,CAAAA,UAAU,CAACC,CAAD,CAAf,EALZ,CAMI,QAAQ,CAAE,kBAACA,CAAD,QAAKC,CAAAA,YAAY,CAACD,CAAC,CAAC0B,MAAF,CAASxB,KAAV,CAAjB,EANd,CAOI,QAAQ,CAAEZ,OAPd,EADJ,cAUI,aAAM,SAAS,CAAC,uBAAhB,uBACI,UAAG,SAAS,CAAC,eAAb,EADJ,EAVJ,GADJ,cAgBI,YAAK,SAAS,CAAC,wBAAf,CAAwC,KAAK,CAAE,CAACmC,KAAK,CAAC,MAAP,CAA/C,uBACI,aAAK,SAAS,CAAC,kBAAf,WACAjD,UAAU,CAACR,MAAX,CAAkB,CAAlB,CAAoB,EAApB,cAAuB,aAAK,SAAS,CAAC,eAAgB,gCAA/B,4BAAiE,4BAAQuB,GAAR,+BAAjE,OADvB,CAGGf,UAAU,CAACmD,GAAX,CAAe,SAACC,QAAD,CAAWC,CAAX,qBAEV,aAAK,SAAS,CAAC,eAAf,CAAkD,OAAO,CAAE,yBAAIjC,CAAAA,SAAS,CAACgC,QAAD,CAAb,EAA3D,wBAEI,kCAAK,sBAAOA,QAAQ,CAAC9B,IAAhB,EAAL,EAFJ,cAGI,oCAAK,mCAAM,wBAAS8B,QAAQ,CAACE,QAAlB,EAAN,EAAL,cACA,wBAAOF,QAAQ,CAACG,QAAhB,mBADA,cAEA,cAAM,SAAS,CAAC,SAAhB,wBAA0B,kCAA1B,MAAoDH,QAAQ,CAACI,YAA7D,GAFA,GAHJ,GAAoCJ,QAAQ,CAAClB,GAA7C,CAFU,EAAf,CAHH,GADJ,EAhBJ,GADJ,EADJ,EADJ,cAyCI,aAAK,SAAS,iBAAWhB,YAAY,CAAC,WAAD,CAAa,EAApC,CAAd,wBACwB,YAAK,SAAS,CAAC,kBAAf,EADxB,cAEwB,aAAK,SAAS,CAAC,YAAf,wBACI,gBAAQ,SAAS,CAAC,iBAAlB,wBACA,UAAG,SAAS,CAAC,kBAAb,0BADA,cAEA,eAAQ,SAAS,CAAC,QAAlB,CAA2B,aAAW,OAAtC,CAA+C,OAAO,CAAE8B,gBAAxD,EAFA,GADJ,cAKI,gBAAS,SAAS,CAAC,iBAAnB,uBAEA,KAAC,YAAD,IAFA,EALJ,GAFxB,GAzCJ,GADJ,CA6DH","sourcesContent":["/* eslint-disable */\nimport React, {useState,useContext, useEffect,useRef} from 'react'\nimport client from '../../feathers'\nimport {DebounceInput} from 'react-debounce-input';\nimport { useForm } from \"react-hook-form\";\n//import {useHistory} from 'react-router-dom'\nimport {UserContext,ObjectContext} from '../../context'\nimport {toast} from 'bulma-toast'\nimport {ClientCreate, ClientDetail, ClientList} from '../ClientMgt/Patient'\n\nimport EncounterMain from './EncounterMain';\nimport EncounterRight from './EncounterRight';\nimport PatientProfile from '../ClientMgt/PatientProfile';\nvar random = require('random-string-generator');\n// eslint-disable-next-line\nconst searchfacility={};\n\n\nexport default function Encounter({standalone}) {\n    const {state, setState}=useContext(ObjectContext) //,setState\n    // eslint-disable-next-line\n    //const [selectedProductEntry,setSelectedProductEntry]=useState()\n    //const [showState,setShowState]=useState() //create|modify|detail\n    //const {state,setState}=useContext(ObjectContext) //,setState\n    // eslint-disable-next-line\n    const [selectedClient,setSelectedClient]=useState()\n    const [showModal,setShowModal]=useState(false)\n\n    //let { path, url } = useRouteMatch();\n    \n    useEffect(() => {\n       \n        console.log(\"starting up Encounter module\")\n        console.log(state.ClientModule.selectedClient)\n        const    newDocumentClassModule={\n            selectedDocumentClass:{},\n            //state.DocumentClassModule.selectedDocumentClass.name\n            show :'detail'\n        }\n        setState((prevstate)=>({...prevstate, DocumentClassModule:newDocumentClassModule}))\n\n        if (Object.keys(state.ClientModule.selectedClient).length === 0 && state.ClientModule.selectedClient.constructor === Object){\n            handleChangeClient()\n\n            }\n         return () => {       \n            }\n        }, [])\n   \n    useEffect(()=>{\n     setSelectedClient(state.ClientModule.selectedClient)\n\n    },[state.ClientModule])\n\n    const handleChangeClient= async()=>{\n        await setShowModal(true)                                                                                                                                                        \n        console.log( showModal)\n    }\n\n\n\n\n    \n    return(\n        <section className= \"section remPadTop\">\n           {/*  <div className=\"level\">\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">ProductEntry  Module</span></div> //10\n            </div> */}\n            <div className=\"columns \">\n            {!standalone && <div className=\"column is-2 \">\n                   <PatientProfile  />\n                    </div>}\n\n            {!standalone &&     <div className= {(state.DocumentClassModule.show ==='detail')?\"column is-6\":\"column is-6 \"}>\n                   <EncounterMain client={selectedClient}/>\n                </div>}\n                {standalone &&     <div className= {(state.DocumentClassModule.show ==='detail')?\"column is-8\":\"column is-12 \"}>\n                   <EncounterMain client={selectedClient} nopresc={standalone}/>\n                </div>}\n              <div className=\"column is-4 \" >\n                {(state.DocumentClassModule.show ==='detail')&& <EncounterRight  client={selectedClient}/>}\n               {/*  <DocumentClassCreate /> */}\n                </div>\n            </div>\n            <div className={`modal ${showModal?\"is-active\":\"\"}` }>\n                                    <div className=\"modal-background\"></div>\n                                    <div className=\"modal-card\">\n                                        <header className=\"modal-card-head btnheight\">\n                                        <p className=\"modal-card-title\">Choose Client</p>\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={()=>setShowModal(false)}></button>\n                                        </header>\n                                        <section className=\"modal-card-body \">\n                                        <ClientList standalone=\"true\" />\n                                        </section>\n                                        {/* <footer className=\"modal-card-foot\">\n                                        <button className=\"button is-success\">Save changes</button>\n                                        <button className=\"button\">Cancel</button>\n                                        </footer> */}\n                                    </div>\n                                </div>                                    \n            </section>\n       \n    )\n    \n}\n\n\n   \n                \n  \n\nexport  function InventorySearch({getSearchfacility,clear}) {\n    \n    const productServ=client.service('inventory')\n    const [facilities,setFacilities]=useState([])\n     // eslint-disable-next-line\n     const [searchError, setSearchError] =useState(false)\n     // eslint-disable-next-line\n    const [showPanel, setShowPanel] =useState(false)\n     // eslint-disable-next-line\n   const [searchMessage, setSearchMessage] = useState(\"\") \n   // eslint-disable-next-line \n   const [simpa,setSimpa]=useState(\"\")\n   // eslint-disable-next-line \n   const [chosen,setChosen]=useState(false)\n   // eslint-disable-next-line \n   const [count,setCount]=useState(0)\n   const inputEl=useRef(null)\n   const [val,setVal]=useState(\"\")\n   const {user} = useContext(UserContext) \n   const {state}=useContext(ObjectContext)\n    const [productModal,setProductModal]=useState(false)\n\n   const handleRow= async(obj)=>{\n        await setChosen(true)\n        //alert(\"something is chaning\")\n       getSearchfacility(obj)\n       \n       await setSimpa(obj.name)\n       \n        // setSelectedFacility(obj)\n        setShowPanel(false)\n        await setCount(2)\n        /* const    newfacilityModule={\n            selectedFacility:facility,\n            show :'detail'\n        }\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\n   //console.log(state)\n    }\n    const handleBlur=async(e)=>{\n         if (count===2){\n             console.log(\"stuff was chosen\")\n         }\n       \n       /*  console.log(\"blur\")\n         setShowPanel(false)\n        console.log(JSON.stringify(simpa))\n        if (simpa===\"\"){\n            console.log(facilities.length)\n            setSimpa(\"abc\")\n            setSimpa(\"\")\n            setFacilities([])\n            inputEl.current.setValue=\"\"\n        }\n        console.log(facilities.length)\n        console.log(inputEl.current) */\n    }\n    const handleSearch=async(value)=>{\n        setVal(value)\n        if (value===\"\"){\n            setShowPanel(false)\n            getSearchfacility(false)\n            return\n        }\n        const field='name' //field variable\n\n       \n        if (value.length>=3 ){\n            productServ.find({query: {     //service\n                 [field]: {\n                     $regex:value,\n                     $options:'i'\n                    \n                 },\n                 facility: user.currentEmployee.facilityDetail._id,\n                 storeId: state.StoreModule.selectedStore._id,\n                 $limit:10,\n                 $sort: {\n                     createdAt: -1\n                   }\n                     }}).then((res)=>{\n              console.log(\"product  fetched successfully\") \n              console.log(res.data) \n                setFacilities(res.data)\n                 setSearchMessage(\" product  fetched successfully\")\n                 setShowPanel(true)\n             })\n             .catch((err)=>{\n                toast({\n                    message: 'Error creating ProductEntry ' + err,\n                    type: 'is-danger',\n                    dismissible: true,\n                    pauseOnHover: true,\n                  })\n             })\n         }\n        else{\n            console.log(\"less than 3 \")\n            console.log(val)\n            setShowPanel(false)\n            await setFacilities([])\n            console.log(facilities)\n        }\n    }\n\n    const handleAddproduct =()=>{\n        setProductModal(true) \n    }\n    const handlecloseModal =()=>{\n        setProductModal(false)\n        handleSearch(val)\n    }\n    useEffect(() => {\n       if (clear){\n           console.log(\"success has changed\",clear)\n           setSimpa(\"\")\n       }\n        return () => {\n            \n        }\n    }, [clear] )\n    return (\n        <div>\n            <div className=\"field\">\n                <div className=\"control has-icons-left  \">\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`} style={{width:\"100%\"}}>\n                        <div className=\"dropdown-trigger\" style={{width:\"100%\"}}>\n                            <DebounceInput className=\"input is-small  is-expanded\" \n                                type=\"text\" placeholder=\"Search Product\"\n                                value={simpa}\n                                minLength={3}\n                                debounceTimeout={400}\n                                onBlur={(e)=>handleBlur(e)}\n                                onChange={(e)=>handleSearch(e.target.value)}\n                                inputRef={inputEl}\n                                  />\n                            <span className=\"icon is-small is-left\">\n                                <i className=\"fas fa-search\"></i>\n                            </span>\n                        </div>\n                        {/* {searchError&&<div>{searchMessage}</div>} */}\n                        <div className=\"dropdown-menu expanded\" style={{width:\"100%\"}}>\n                            <div className=\"dropdown-content\">\n                          { facilities.length>0?\"\":<div className=\"dropdown-item\" /* onClick={handleAddproduct} */> <span> {val} is not in your inventory</span> </div>}\n\n                              {facilities.map((facility, i)=>(\n                                    \n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\n                                        \n                                        <div><span>{facility.name}</span></div>\n                                        <div><span><strong>{facility.quantity}</strong></span>\n                                        <span>{facility.baseunit}(s) remaining</span>\n                                        <span className=\"padleft\"><strong>Price:</strong> N{facility.sellingprice}</span></div>\n                                        \n                                    </div>\n                                    \n                                    ))}\n                                    \n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div className={`modal ${productModal?\"is-active\":\"\"}` }>\n                                    <div className=\"modal-background\"></div>\n                                    <div className=\"modal-card\">\n                                        <header className=\"modal-card-head\">\n                                        <p className=\"modal-card-title\">Choose Store</p>\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={handlecloseModal}></button>\n                                        </header>\n                                        <section className=\"modal-card-body\">\n                                        {/* <StoreList standalone=\"true\" /> */}\n                                        <ClientCreate />\n                                        </section>\n                                        {/* <footer className=\"modal-card-foot\">\n                                        <button className=\"button is-success\">Save changes</button>\n                                        <button className=\"button\">Cancel</button>\n                                        </footer> */}\n                                    </div>\n                                </div>       \n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}