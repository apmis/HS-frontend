{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _objectSpread from \"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _asyncToGenerator from \"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/mfybaby/Documents/HealthStack2/HS-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/home/mfybaby/Documents/HealthStack2/HS-frontend/src/components/ManagedCare/OrgClientList.js\",\n    _s = $RefreshSig$();\n\n/* eslint-disable */\nimport React, { useState, useContext, useEffect } from 'react';\nimport client from '../../feathers';\nimport { DebounceInput } from 'react-debounce-input';\nimport { useForm } from \"react-hook-form\";\nimport { toast } from 'bulma-toast'; //import {useHistory} from 'react-router-dom'\n\nimport { UserContext, ObjectContext } from '../../context';\nimport { FacilitySearch } from '../helpers/FacilitySearch';\nexport function OrgList() {\n  _s();\n\n  var _this = this;\n\n  // const { register, handleSubmit, watch, errors } = useForm();\n  // eslint-disable-next-line\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      error = _useState2[0],\n      setError = _useState2[1]; // eslint-disable-next-line\n\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      success = _useState4[0],\n      setSuccess = _useState4[1]; // eslint-disable-next-line\n\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      message = _useState6[0],\n      setMessage = _useState6[1];\n\n  var facilityServ = client.service('facility');\n  var orgServ = client.service('organizationclient'); //const history = useHistory()\n  // const {user,setUser} = useContext(UserContext)\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      facilities = _useState8[0],\n      setFacilities = _useState8[1]; // eslint-disable-next-line\n\n\n  var _useState9 = useState(),\n      _useState10 = _slicedToArray(_useState9, 2),\n      selectedFacility = _useState10[0],\n      setSelectedFacility = _useState10[1]; //\n  // eslint-disable-next-line\n\n\n  var _useContext = useContext(ObjectContext),\n      state = _useContext.state,\n      setState = _useContext.setState;\n\n  var _useContext2 = useContext(UserContext),\n      user = _useContext2.user;\n\n  var handleCreateNew = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var newfacilityModule;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              newfacilityModule = {\n                selectedFacility: {},\n                show: 'create'\n              };\n              _context.next = 3;\n              return setState(function (prevstate) {\n                return _objectSpread(_objectSpread({}, prevstate), {}, {\n                  facilityModule: newfacilityModule\n                });\n              });\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleCreateNew() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleRow = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(facility) {\n      var newfacilityModule;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return setSelectedFacility(facility.organizationDetail);\n\n            case 2:\n              newfacilityModule = {\n                selectedFacility: facility.organizationDetail,\n                show: 'detail'\n              };\n              _context2.next = 5;\n              return setState(function (prevstate) {\n                return _objectSpread(_objectSpread({}, prevstate), {}, {\n                  facilityModule: newfacilityModule\n                });\n              });\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleRow(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleSearch = function handleSearch(val) {\n    var field = 'facilityName';\n    console.log(val);\n\n    if (val.length > 0) {\n      orgServ.find({\n        query: {\n          /* [field]: {\n              $regex:val,\n              $options:'i'\n             \n          }, */\n          $search: val,\n          $limit: 10,\n          $sort: {\n            createdAt: -1\n          }\n        }\n      }).then(function (res) {\n        console.log(res);\n        setFacilities(res.data);\n        setMessage(\" Organization  fetched successfully\");\n        setSuccess(true);\n      }).catch(function (err) {\n        console.log(err);\n        setMessage(\"Error creating facility, probable network issues \" + err);\n        setError(true);\n      });\n    } else {\n      getFacilities();\n    }\n  };\n  /*  if (val.length>2){\n       console.log(\"in\")\n      \n   }\n  }\n  */\n\n\n  var getFacilities = function getFacilities() {\n    orgServ.find({\n      query: {\n        facility: user.currentEmployee.facilityDetail._id,\n        $limit: 100,\n        $sort: {\n          createdAt: -1\n        }\n      }\n    }).then(function (res) {\n      console.log(res);\n      setFacilities(res.data);\n      setMessage(\" Organization  fetched successfully\");\n      setSuccess(true);\n    }).catch(function (err) {\n      setMessage(\"Error creating facility, probable network issues \" + err);\n      setError(true);\n    });\n  };\n\n  useEffect(function () {\n    getFacilities();\n    orgServ.on('created', function (obj) {\n      return getFacilities();\n    });\n    orgServ.on('updated', function (obj) {\n      return getFacilities();\n    });\n    orgServ.on('patched', function (obj) {\n      return getFacilities();\n    });\n    orgServ.on('removed', function (obj) {\n      return getFacilities();\n    });\n    return function () {};\n  }, []); //todo: pagination and vertical scroll bar\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [\"   \", /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"level\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"level-left\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"level-item\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"field\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"control has-icons-left  \",\n              children: [/*#__PURE__*/_jsxDEV(DebounceInput, {\n                className: \"input is-small \",\n                type: \"text\",\n                placeholder: \"Search Facilities\",\n                minLength: 3,\n                debounceTimeout: 400,\n                onChange: function onChange(e) {\n                  return handleSearch(e.target.value);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 141,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"icon is-small is-left\",\n                children: /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-search\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 147,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 140,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"level-item\",\n        children: [\" \", /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"is-size-6 has-text-weight-medium\",\n          children: \"List of Contracted Organizations \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 50\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 17\n    }, this), !!facilities[1] && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"table-container pullup \",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: /*#__PURE__*/_jsxDEV(\"abbr\", {\n                title: \"S/No\",\n                children: \"S/No\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 45\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 165,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Organization Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: /*#__PURE__*/_jsxDEV(\"abbr\", {\n                title: \"Type\",\n                children: \"Type\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 171,\n                columnNumber: 45\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: /*#__PURE__*/_jsxDEV(\"abbr\", {\n                title: \"Category\",\n                children: \"Category\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 172,\n                columnNumber: 45\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 164,\n            columnNumber: 41\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 37\n        }, this), /*#__PURE__*/_jsxDEV(\"tfoot\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 37\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: facilities.map(function (facility, i) {\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              onClick: function onClick() {\n                return handleRow(facility);\n              },\n              className: facility.organizationDetail._id === ((selectedFacility === null || selectedFacility === void 0 ? void 0 : selectedFacility._id) || null) ? \"is-selected\" : \"\",\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: i + 1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 183,\n                columnNumber: 45\n              }, _this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: facility.organizationDetail.facilityName\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 184,\n                columnNumber: 45\n              }, _this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: facility.organizationDetail.facilityType\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 189,\n                columnNumber: 45\n              }, _this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: facility.organizationDetail.facilityCategory\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 190,\n                columnNumber: 45\n              }, _this)]\n            }, facility.organizationDetail._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 45\n            }, _this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 37\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 33\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 36\n    }, this)]\n  }, void 0, true);\n}\n\n_s(OrgList, \"5qEvdM1PmwN0fKTNudR36DOUy3E=\");\n\n_c = OrgList;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrgList\");","map":{"version":3,"sources":["/home/mfybaby/Documents/HealthStack2/HS-frontend/src/components/ManagedCare/OrgClientList.js"],"names":["React","useState","useContext","useEffect","client","DebounceInput","useForm","toast","UserContext","ObjectContext","FacilitySearch","OrgList","error","setError","success","setSuccess","message","setMessage","facilityServ","service","orgServ","facilities","setFacilities","selectedFacility","setSelectedFacility","state","setState","user","handleCreateNew","newfacilityModule","show","prevstate","facilityModule","handleRow","facility","organizationDetail","handleSearch","val","field","console","log","length","find","query","$search","$limit","$sort","createdAt","then","res","data","catch","err","getFacilities","currentEmployee","facilityDetail","_id","on","obj","e","target","value","map","i","facilityName","facilityType","facilityCategory"],"mappings":"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","sourcesContent":["/* eslint-disable */\nimport React, {useState,useContext, useEffect} from 'react'\nimport client from '../../feathers'\nimport {DebounceInput} from 'react-debounce-input';\nimport { useForm } from \"react-hook-form\";\nimport {toast} from 'bulma-toast'\n//import {useHistory} from 'react-router-dom'\nimport {UserContext,ObjectContext} from '../../context'\nimport {FacilitySearch} from '../helpers/FacilitySearch'\n\n\n\n\nexport function OrgList(){\n   // const { register, handleSubmit, watch, errors } = useForm();\n    // eslint-disable-next-line\n    const [error, setError] =useState(false)\n     // eslint-disable-next-line\n    const [success, setSuccess] =useState(false)\n     // eslint-disable-next-line\n   const [message, setMessage] = useState(\"\") \n    const facilityServ=client.service('facility')\n    const orgServ=client.service('organizationclient')\n    //const history = useHistory()\n   // const {user,setUser} = useContext(UserContext)\n    const [facilities,setFacilities]=useState([])\n     // eslint-disable-next-line\n   const [selectedFacility, setSelectedFacility]=useState() //\n    // eslint-disable-next-line\n    const {state,setState}=useContext(ObjectContext)\n    const {user} = useContext(UserContext)\n\n   \n\n    const handleCreateNew = async()=>{\n        const    newfacilityModule={\n            selectedFacility:{},\n            show :'create'\n            }\n       await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule}))\n       //console.log(state)\n        \n\n    }\n    const handleRow= async(facility)=>{\n        //console.log(\"b4\",state)\n\n        //console.log(\"handlerow\",facility)\n\n        await setSelectedFacility(facility.organizationDetail)\n\n        const    newfacilityModule={\n            selectedFacility:facility.organizationDetail,\n            show :'detail'\n        }\n       await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule}))\n       //console.log(state)\n\n    }\n\n   const handleSearch=(val)=>{\n       const field='facilityName'\n       console.log(val)\n       if (val.length >0){\n       orgServ.find({query: {\n                /* [field]: {\n                    $regex:val,\n                    $options:'i'\n                   \n                }, */\n                $search:val,\n                $limit:10,\n                $sort: {\n                    createdAt: -1\n                  }\n                    }}).then((res)=>{\n                console.log(res)\n               setFacilities(res.data)\n                setMessage(\" Organization  fetched successfully\")\n                setSuccess(true) \n            })\n            .catch((err)=>{\n                console.log(err)\n                setMessage(\"Error creating facility, probable network issues \"+ err )\n                setError(true)\n            })\n        }else{\n            getFacilities() \n        }\n        }\n\n           /*  if (val.length>2){\n                console.log(\"in\")\n               \n            }\n\n        }\n     */\n        const getFacilities=()=>{\n            orgServ.find({query: {\n                facility:user.currentEmployee.facilityDetail._id,\n                $limit:100,\n                $sort: {\n                    createdAt: -1\n                  }\n                    }})\n            .then((res)=>{\n                console.log(res)\n                    setFacilities(res.data)\n                    setMessage(\" Organization  fetched successfully\")\n                    setSuccess(true)\n                })\n                .catch((err)=>{\n                    setMessage(\"Error creating facility, probable network issues \"+ err )\n                    setError(true)\n                })\n\n        }\n\n    useEffect(() => {\n        getFacilities()\n\n        orgServ.on('created', (obj)=>getFacilities())\n        orgServ.on('updated', (obj)=>getFacilities())\n        orgServ.on('patched', (obj)=>getFacilities())\n        orgServ.on('removed', (obj)=>getFacilities())\n        return () => {\n           \n        }\n    },[])\n\n    //todo: pagination and vertical scroll bar\n\n    return(\n            <>   {/* <OrganizationCreate /> */}\n                <div className=\"level\">\n                    <div className=\"level-left\">\n                        <div className=\"level-item\">\n                            <div className=\"field\">\n                                <p className=\"control has-icons-left  \">\n                                    <DebounceInput className=\"input is-small \" \n                                        type=\"text\" placeholder=\"Search Facilities\"\n                                        minLength={3}\n                                        debounceTimeout={400}\n                                        onChange={(e)=>handleSearch(e.target.value)} />\n                                    <span className=\"icon is-small is-left\">\n                                        <i className=\"fas fa-search\"></i>\n                                    </span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Contracted Organizations </span></div>\n                   {/*  <div className=\"level-right\">\n                        <div className=\"level-item\"> \n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\n                        </div>\n                    </div> */}\n\n                </div>\n               {!!facilities[1] && <div className=\"table-container pullup \">\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\n                                    <thead>\n                                        <tr>\n                                        <th><abbr title=\"S/No\">S/No</abbr></th>\n                                        <th>Organization Name</th>\n                                       {/*  <th><abbr title=\"Address\"> Address</abbr></th>\n                                        <th><abbr title=\"City\">City</abbr></th>\n                                        <th><abbr title=\"Phone\">Phone</abbr></th>\n                                        <th><abbr title=\"Email\">Email</abbr></th> */}\n                                        <th><abbr title=\"Type\">Type</abbr></th>\n                                        <th><abbr title=\"Category\">Category</abbr></th>\n                                        {/* <th><abbr title=\"Actions\">Actions</abbr></th> */}\n                                        </tr>\n                                    </thead>\n                                    <tfoot>\n                                        \n                                    </tfoot>\n                                    <tbody>\n                                        {facilities.map((facility, i)=>(\n\n                                            <tr key={facility.organizationDetail._id} onClick={()=>handleRow(facility)} className={facility.organizationDetail._id===(selectedFacility?._id||null)?\"is-selected\":\"\"}>\n                                            <th>{i+1}</th>\n                                            <th>{facility.organizationDetail.facilityName}</th>\n                                           {/*  <td>{facility.organizationDetail.facilityAddress}</td>\n                                            <td>{facility.organizationDetail.facilityCity}</td>\n                                            <td>{facility.organizationDetail.facilityContactPhone}</td>\n                                            <td>{facility.organizationDetail.facilityEmail}</td>*/}\n                                            <td>{facility.organizationDetail.facilityType}</td>\n                                            <td>{facility.organizationDetail.facilityCategory}</td> \n                                           \n                                           {/*  <td><span   className=\"showAction\"  >...</span></td> */}\n                                           \n                                            </tr>\n\n                                        ))}\n                                    </tbody>\n                                    </table>\n                                    \n                </div>   }            \n            </>\n              \n    )\n}\n\n"]},"metadata":{},"sourceType":"module"}