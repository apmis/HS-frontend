[{"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\Payment.js":"1","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\PaymentCreate.js":"2","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\index.js":"3","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\context.js":"4","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\feathers.js":"5","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Home.js":"6","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Login.js":"7","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\SignUp.js":"8","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\InventoryModule.js":"9","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\ClinicModule.js":"10","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\CareTeam.js":"11","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\Workspace.js":"12","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\Department.js":"13","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\FacilityHome.js":"14","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\InventorySetup.js":"15","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\Employee.js":"16","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\InventoryStore.js":"17","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\FinanceStore.js":"18","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\ProductEntry.js":"19","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\ProductExit.js":"20","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Clinic\\ClinicStore.js":"21","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Clinic\\Clinic.js":"22","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\ClientBill.js":"23","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\BillDispenseCreate.js":"24","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\EncounterMgt\\EncounterMain.js":"25","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\helpers\\FacilityPopup.js":"26","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\BillPrescriptionCreate.js":"27","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\Dispensary.js":"28","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\ProductExit.js":"29","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\App.js":"30","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\LandingPage.js":"31","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Clinic\\ClinicReport.js":"32","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\DeptUnits.js":"33","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\ClientMgt\\Patient.js":"34","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\ProductEntry.js":"35","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\FinanceHome.js":"36","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\BillPrescription.js":"37","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\EncounterMgt\\DocumentClass.js":"38","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\EncounterMgt\\Prescription.js":"39","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\DispenseExit.js":"40","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\FacilityModule.js":"41","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\Facility.js":"42","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\Location.js":"43","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\FinanceSetup.js":"44","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\Products.js":"45","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Clinic\\ClinicHome.js":"46","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Clinic\\Appointments.js":"47","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\FinanceModule.js":"48","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\Store.js":"49","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\Store.js":"50","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\BillPrescription.js":"51","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\Roaster.js":"52","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\InventoryReport.js":"53","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\FinanceReport.js":"54","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\EncounterMgt\\EncounterRight.js":"55","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\ClientPrescription.js":"56","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\Accessibility.js":"57","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\ClientMgt\\PatientProfile.js":"58"},{"size":22024,"mtime":1614782351397,"results":"59","hashOfConfig":"60"},{"size":45232,"mtime":1614782754078,"results":"61","hashOfConfig":"60"},{"size":500,"mtime":1606167681327,"results":"62","hashOfConfig":"60"},{"size":958,"mtime":1611095384833,"results":"63","hashOfConfig":"60"},{"size":638,"mtime":1614768129215,"results":"64","hashOfConfig":"60"},{"size":8388,"mtime":1614165644970,"results":"65","hashOfConfig":"60"},{"size":3070,"mtime":1611089651447,"results":"66","hashOfConfig":"60"},{"size":9542,"mtime":1610481859369,"results":"67","hashOfConfig":"60"},{"size":8649,"mtime":1614767651339,"results":"68","hashOfConfig":"60"},{"size":7992,"mtime":1614759140359,"results":"69","hashOfConfig":"60"},{"size":144,"mtime":1610340849334,"results":"70","hashOfConfig":"60"},{"size":146,"mtime":1610340786924,"results":"71","hashOfConfig":"60"},{"size":148,"mtime":1610340754492,"results":"72","hashOfConfig":"60"},{"size":597,"mtime":1612953434041,"results":"73","hashOfConfig":"60"},{"size":9318,"mtime":1610307391617,"results":"74","hashOfConfig":"60"},{"size":40586,"mtime":1611144169606,"results":"75","hashOfConfig":"60"},{"size":38911,"mtime":1614766106761,"results":"76","hashOfConfig":"60"},{"size":38844,"mtime":1614165763658,"results":"77","hashOfConfig":"60"},{"size":52276,"mtime":1614163882289,"results":"78","hashOfConfig":"60"},{"size":57661,"mtime":1614163882292,"results":"79","hashOfConfig":"60"},{"size":38856,"mtime":1612264335426,"results":"80","hashOfConfig":"60"},{"size":40695,"mtime":1614055518190,"results":"81","hashOfConfig":"60"},{"size":11247,"mtime":1614782373808,"results":"82","hashOfConfig":"60"},{"size":26832,"mtime":1614161732800,"results":"83","hashOfConfig":"60"},{"size":19349,"mtime":1614777905395,"results":"84","hashOfConfig":"60"},{"size":15112,"mtime":1613312865451,"results":"85","hashOfConfig":"60"},{"size":38779,"mtime":1614613902735,"results":"86","hashOfConfig":"60"},{"size":22625,"mtime":1614782342774,"results":"87","hashOfConfig":"60"},{"size":57958,"mtime":1614692889255,"results":"88","hashOfConfig":"60"},{"size":3846,"mtime":1614260288819,"results":"89","hashOfConfig":"60"},{"size":602,"mtime":1610166221216,"results":"90","hashOfConfig":"60"},{"size":8924,"mtime":1612264316226,"results":"91","hashOfConfig":"60"},{"size":153,"mtime":1610341642391,"results":"92","hashOfConfig":"60"},{"size":76419,"mtime":1614765110959,"results":"93","hashOfConfig":"60"},{"size":52276,"mtime":1611792286916,"results":"94","hashOfConfig":"60"},{"size":1292,"mtime":1614692318437,"results":"95","hashOfConfig":"60"},{"size":19914,"mtime":1614782388714,"results":"96","hashOfConfig":"60"},{"size":37609,"mtime":1612483185115,"results":"97","hashOfConfig":"60"},{"size":50640,"mtime":1614782395743,"results":"98","hashOfConfig":"60"},{"size":60143,"mtime":1614693038875,"results":"99","hashOfConfig":"60"},{"size":6746,"mtime":1614766424318,"results":"100","hashOfConfig":"60"},{"size":29287,"mtime":1610499792755,"results":"101","hashOfConfig":"60"},{"size":40707,"mtime":1613142325364,"results":"102","hashOfConfig":"60"},{"size":9318,"mtime":1614165749514,"results":"103","hashOfConfig":"60"},{"size":40739,"mtime":1614163882309,"results":"104","hashOfConfig":"60"},{"size":1452,"mtime":1612953370729,"results":"105","hashOfConfig":"60"},{"size":73610,"mtime":1612987406080,"results":"106","hashOfConfig":"60"},{"size":8653,"mtime":1614767844625,"results":"107","hashOfConfig":"60"},{"size":51100,"mtime":1614767771116,"results":"108","hashOfConfig":"60"},{"size":51075,"mtime":1614767616856,"results":"109","hashOfConfig":"60"},{"size":19950,"mtime":1614782365751,"results":"110","hashOfConfig":"60"},{"size":142,"mtime":1610340882234,"results":"111","hashOfConfig":"60"},{"size":8924,"mtime":1610239695153,"results":"112","hashOfConfig":"60"},{"size":8924,"mtime":1614165722165,"results":"113","hashOfConfig":"60"},{"size":37766,"mtime":1612638457628,"results":"114","hashOfConfig":"60"},{"size":11247,"mtime":1614782116546,"results":"115","hashOfConfig":"60"},{"size":153,"mtime":1610345735519,"results":"116","hashOfConfig":"60"},{"size":10097,"mtime":1614243367742,"results":"117","hashOfConfig":"60"},{"filePath":"118","messages":"119","errorCount":0,"warningCount":24,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},"vuhkqw",{"filePath":"120","messages":"121","errorCount":0,"warningCount":28,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"122","messages":"123","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"124"},{"filePath":"125","messages":"126","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"124"},{"filePath":"127","messages":"128","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"129","usedDeprecatedRules":"130"},{"filePath":"131","messages":"132","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"133","usedDeprecatedRules":"124"},{"filePath":"134","messages":"135","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"136","usedDeprecatedRules":"130"},{"filePath":"137","messages":"138","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"139","usedDeprecatedRules":"140"},{"filePath":"141","messages":"142","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"143","usedDeprecatedRules":"124"},{"filePath":"144","messages":"145","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"146","usedDeprecatedRules":"124"},{"filePath":"147","messages":"148","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"149","messages":"150","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"124"},{"filePath":"151","messages":"152","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"153","messages":"154","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"124"},{"filePath":"155","messages":"156","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"124"},{"filePath":"157","messages":"158","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"159","messages":"160","errorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"161","usedDeprecatedRules":"124"},{"filePath":"162","messages":"163","errorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"164","usedDeprecatedRules":"140"},{"filePath":"165","messages":"166","errorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"167","usedDeprecatedRules":"124"},{"filePath":"168","messages":"169","errorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"170","usedDeprecatedRules":"124"},{"filePath":"171","messages":"172","errorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"173","usedDeprecatedRules":"140"},{"filePath":"174","messages":"175","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"176","usedDeprecatedRules":"124"},{"filePath":"177","messages":"178","errorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"179","messages":"180","errorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"181","messages":"182","errorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"183"},{"filePath":"184","messages":"185","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"186"},{"filePath":"187","messages":"188","errorCount":0,"warningCount":17,"fixableErrorCount":0,"fixableWarningCount":0,"source":"189","usedDeprecatedRules":"190"},{"filePath":"191","messages":"192","errorCount":0,"warningCount":24,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"193","messages":"194","errorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"195","usedDeprecatedRules":"124"},{"filePath":"196","messages":"197","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"198","messages":"199","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"200","messages":"201","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"124"},{"filePath":"202","messages":"203","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"124"},{"filePath":"204","messages":"205","errorCount":0,"warningCount":17,"fixableErrorCount":0,"fixableWarningCount":0,"source":"206","usedDeprecatedRules":"124"},{"filePath":"207","messages":"208","errorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"209","messages":"210","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"211","usedDeprecatedRules":"130"},{"filePath":"212","messages":"213","errorCount":0,"warningCount":18,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"214","messages":"215","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"216","messages":"217","errorCount":0,"warningCount":21,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"218","messages":"219","errorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"220","usedDeprecatedRules":"130"},{"filePath":"221","messages":"222","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"223","messages":"224","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"225","messages":"226","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"227","messages":"228","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"130"},{"filePath":"229","messages":"230","errorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"231","usedDeprecatedRules":"124"},{"filePath":"232","messages":"233","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"234","usedDeprecatedRules":"124"},{"filePath":"235","messages":"236","errorCount":0,"warningCount":34,"fixableErrorCount":0,"fixableWarningCount":0,"source":"237","usedDeprecatedRules":"124"},{"filePath":"238","messages":"239","errorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"240","usedDeprecatedRules":"124"},{"filePath":"241","messages":"242","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"243","usedDeprecatedRules":"130"},{"filePath":"244","messages":"245","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"246","usedDeprecatedRules":"124"},{"filePath":"247","messages":"248","errorCount":0,"warningCount":18,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"249","messages":"250","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"124"},{"filePath":"251","messages":"252","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"124"},{"filePath":"253","messages":"254","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"124"},{"filePath":"255","messages":"256","errorCount":0,"warningCount":20,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"257","messages":"258","errorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"259","messages":"260","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"261","messages":"262","errorCount":0,"warningCount":26,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\Payment.js",["263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\PaymentCreate.js",["287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\index.js",[],["315","316"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\context.js",[],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\feathers.js",["317","318"],"import io from 'socket.io-client'\r\nimport feathers from '@feathersjs/feathers'\r\nimport socketio from '@feathersjs/socketio-client'\r\nimport authentication from '@feathersjs/authentication-client'\r\n\r\nconst herok= 'https://healthstack-backend.herokuapp.com'\r\nconst url= 'http://localhost:3035'\r\nconst API = process.env.NODE_ENV !== 'production' ?  url :'https://healthstack-backend.herokuapp.com' ;\r\nconst socket=io(url, {\r\n    transports: ['websocket'],\r\n    forceNew: true\r\n  })\r\nconst client=feathers()\r\nclient.configure(socketio(socket))\r\nclient.configure(authentication({\r\n    storage:window.localStorage\r\n}))\r\n\r\nexport default client\r\n",["319","320"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Home.js",["321","322","323","324","325"],"import React, {useContext, useEffect, useState} from 'react'\r\nimport {Route, Switch,  useRouteMatch, Link, NavLink, useHistory} from 'react-router-dom'\r\nimport FacilityModule from './FacilityModule'\r\nimport InventoryModule from './InventoryModule'\r\nimport ClinicModule from './ClinicModule'\r\nimport FinanceModule from './FinanceModule'\r\n/* import NavBar from './NavBar' */\r\nimport LandingPage from './LandingPage'\r\nimport {UserContext} from '../context'\r\nimport client from '../feathers'\r\n\r\nexport default function Home() {\r\n    let { path, url } = useRouteMatch();\r\n    const {user,setUser} = useContext(UserContext)\r\n\r\n    \r\n    //console.log(path)\r\n\r\n    return (\r\n        <div>\r\n            <NavBar url={url}/>\r\n                     \r\n            <Switch>\r\n            <Route path={path} exact>\r\n                    <LandingPage />\r\n                </Route>\r\n                <Route path={`${path}/inventory`} >\r\n                    <InventoryModule />\r\n                </Route>\r\n                <Route path={`${path}/facility`} >\r\n                    <FacilityModule />\r\n                </Route>\r\n                <Route path={`${path}/clinic`} >\r\n                    <ClinicModule />\r\n                </Route>\r\n                <Route path={`${path}/finance`} >\r\n                    <FinanceModule />\r\n                </Route>\r\n            </Switch>\r\n        </div>\r\n    )\r\n} \r\n\r\nfunction NavBar({url}){\r\n    const [fullname, setFullname]=useState(\"\")\r\n    const [userFacility, setUserFacility]=useState()\r\n    const {user,setUser} = useContext(UserContext)\r\n    const history =useHistory()\r\n    \r\n    const reAuth =  async() =>{\r\n        try{\r\n            const resp = await client.reAuthenticate();\r\n            //console.log(resp)\r\n            await setUser(resp.user)\r\n            /* console.log(\"lastname:\",  user.lastname)\r\n            console.log(\"reauth tried\")\r\n            */\r\n           console.log(user)\r\n            return\r\n            }\r\n        catch(error){\r\n            console.log(error)\r\n           history.push(\"/\")\r\n        }  \r\n    }\r\n\r\n    /* useEffect(() => {\r\n        const localUser= JSON.parse(localStorage.getItem(\"user\"))\r\n        setUser(localUser)\r\n        console.log(user)\r\n        return () => {\r\n           \r\n        }\r\n    }, []) */\r\n\r\n\r\n    useEffect( () => {\r\n        if(!user){\r\n           console.log(\"No user\")\r\n            reAuth()\r\n          \r\n            //history.push(\"/\")    \r\n             return\r\n        }\r\n\r\n        async function getFullname(){\r\n            const zed= user.firstname+\" \"+user.lastname\r\n         const resp =   await setFullname(zed)\r\n        // console.log(zed)\r\n         if (user.employeeData.length){\r\n            user.currentEmployee= user.employeeData[0] //choose the first facilty\r\n            const fac=  user.currentEmployee.facilityDetail.facilityName\r\n           // await set\r\n           await setUserFacility(fac)\r\n         }else{\r\n            user.currentEmployee= null\r\n           \r\n         }\r\n        \r\n         await setUser(user)\r\n         localStorage.setItem(\"user\",JSON.stringify(user))\r\n         \r\n         \r\n         \r\n        }\r\n        getFullname()\r\n        console.log(user)\r\n       /*  console.log(user.lastname)\r\n      console.log(user) */\r\n        return () => {\r\n            \r\n        }\r\n    },[] )\r\n\r\n    const handleFacilityClick=()=>{ //need to implement changing facility\r\n        const availableFacilities=[]\r\n        if (Array.isArray(user.employeeData)&& user.employeeData.length){\r\n            user.employeeData.map((emp)=>{\r\n             return   availableFacilities.push(emp.facilityDetail)\r\n            })\r\n        }\r\n        console.log(availableFacilities)\r\n    }\r\n    if (!user) return 'Loading...'\r\n    return(\r\n        <div>\r\n           <nav className=\"navbar is-small minHt has-background-info\" role=\"navigation\" aria-label=\"main navigation\">\r\n                <div className=\"navbar-brand minHt\">\r\n                    <div className=\"navbar-item is-size-5 minHt\" onClick={handleFacilityClick}> <strong>{userFacility ||\"\"} </strong> </div>\r\n                    {/* <div className=\"navbar-item\" href=\"https://bulma.io\">\r\n                    <img src=\"https://bulma.io/images/bulma-logo.png\" width=\"112\" height=\"28\" />\r\n                    </div> */}\r\n\r\n                    <div role=\"button\" className=\"navbar-burger\" aria-label=\"menu\" aria-expanded=\"false\" data-target=\"navbarBasicExample\">\r\n                    <div className=\"navbar-item\">\r\n                        <NavLink to={`${url}`}>Landing Page</NavLink> \r\n                    </div>\r\n                    <div className=\"navbar-item\">\r\n                        <NavLink to={`${url}/clinic`}>Clinic</NavLink>\r\n                    </div>\r\n                    <div className=\"navbar-item\">\r\n                        <NavLink to={`${url}/inventory`}>Inventory</NavLink>\r\n                    </div>\r\n                    <div className=\"navbar-item\">\r\n                        <NavLink to={`${url}/facility`}>Admin</NavLink>\r\n                    </div>\r\n                    <div className=\"navbar-item\">\r\n                        <NavLink to={`${url}/finance`}>Finance</NavLink>\r\n                    </div>\r\n                    <div className=\"navbar-item\">\r\n                        Front Desk\r\n                    </div>\r\n                    <hr className=\"navbar-divider\" />\r\n                    <div className=\"navbar-item\">\r\n                        Sign Out\r\n                    </div>\r\n                    \r\n                  {/*   <span aria-hidden=\"true\"></span>\r\n                    <span aria-hidden=\"true\"></span>\r\n                    <span aria-hidden=\"true\"></span> */}\r\n                    </div>\r\n                </div>\r\n\r\n                <div id=\"navbarBasicExample\" className=\"navbar-menu minHt\">\r\n                    <div className=\"navbar-start\">\r\n                    {/* <div className=\"navbar-item\">\r\n                        Home\r\n                    </div>\r\n\r\n                    <div className=\"navbar-item\">\r\n                        Documentation\r\n                    </div> */}\r\n\r\n                    \r\n                    </div>\r\n\r\n                    <div className=\"navbar-end\">\r\n                    <div className=\"navbar-item has-dropdown is-hoverable\">\r\n                        <div className=\"navbar-link\">\r\n                        \r\n                            <div className=\"button is-info is-inverted minHt\">\r\n                                <span className=\"icon\">\r\n                                <i className=\"fa fa-user-md\"></i>\r\n                                </span>\r\n                                <span>{fullname}</span>\r\n                                \r\n                                {/* <span>{user.firstname}</span> */}\r\n                            </div>\r\n                           \r\n                        </div>\r\n\r\n                            <div className=\"navbar-dropdown bckcolor\">\r\n                                <div className=\"navbar-item\">\r\n                                    <NavLink to={`${url}`}>Landing Page</NavLink> \r\n                                </div>\r\n                                <div className=\"navbar-item\">\r\n                                    <NavLink to={`${url}/clinic`}>Clinic</NavLink>\r\n                                </div>\r\n                                <div className=\"navbar-item\">\r\n                                    <NavLink to={`${url}/inventory`}>Inventory</NavLink>\r\n                                </div>\r\n                                <div className=\"navbar-item\">\r\n                                    <NavLink to={`${url}/facility`}>Admin</NavLink>\r\n                                </div>\r\n                                <div className=\"navbar-item\">\r\n                                    <NavLink to={`${url}/finance`}>Finance</NavLink>\r\n                                </div>\r\n                                <div className=\"navbar-item\">\r\n                                    Front Desk\r\n                                </div>\r\n                                <hr className=\"navbar-divider\" />\r\n                                <div className=\"navbar-item\">\r\n                                   Sign Out\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </nav>\r\n        </div>\r\n    )\r\n}\r\n \r\n  ","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Login.js",["326","327","328"],"import React, {useState,useContext} from 'react'\r\nimport client from '../feathers'\r\nimport { useForm } from \"react-hook-form\";\r\nimport {useHistory} from 'react-router-dom'\r\nimport {UserContext} from '../context'\r\n\r\nexport default function Login() {\r\n    const { register, handleSubmit, watch, errors } = useForm();\r\n    const [error, setError] =useState(true)\r\n    const [errorMessage,setErrorMessage] = useState(\"\")\r\n    const userServ=client.service('/users')\r\n    const history = useHistory()\r\n    const {user,setUser} = useContext(UserContext)\r\n\r\n   \r\nconst onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        setErrorMessage(\"\")\r\n        setError(false)\r\n           const  email=data.email\r\n           const password=data.password\r\n         \r\n          \r\n          client.authenticate({\r\n            strategy:'local',\r\n            email,\r\n            password\r\n        }).then(async (res)=>{\r\n                console.log(JSON.stringify(res.user))\r\n                e.target.reset();\r\n               await setUser(res.user)\r\n               console.log(user)\r\n               localStorage.setItem(\"user\",JSON.stringify(res.user))\r\n               history.push(\"/app\")\r\n\r\n            })\r\n            .catch((err)=>{\r\n                setErrorMessage(\"Error loggin in User, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n\r\n      } \r\n\r\n    return (\r\n        <section className=\"section\">\r\n        <div className=\"container\">\r\n        <div className=\"columns is-centered\">\r\n        <div className=\"column is-4 \">\r\n        <div className=\"card v-centered\">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Health Stack\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content\">\r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n           <div className=\"field\">\r\n            <p className=\"control has-icons-left has-icons-right\">\r\n                <input className=\"input\" ref={register({ required: true })}  name=\"email\" type=\"email\" placeholder=\"Email\" />\r\n                  <span className=\"icon is-small is-left\">\r\n                     <i className=\"fas fa-envelope\"></i>\r\n                </span>\r\n                \r\n            </p>\r\n        </div>\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n                <input className=\"input\" ref={register({ required: true })} name=\"password\" type=\"password\" placeholder=\"Password\"/>\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"fas fa-lock\"></i>\r\n                </span>\r\n            </p>\r\n        </div>\r\n        <div className=\"field\">\r\n            <p className=\"control\">\r\n                <button className=\"button is-success is-small\">\r\n                    Login\r\n                </button>\r\n            </p>\r\n        </div>\r\n        { error && <div className=\"message\"> {errorMessage}</div>}\r\n        </form>\r\n    </div>\r\n    </div>\r\n    </div>\r\n    </div>\r\n    </div>\r\n    </section>\r\n    )\r\n}\r\n","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\SignUp.js",["329","330"],"import React, {useState} from 'react'\r\nimport client from '../feathers'\r\nimport { useForm } from \"react-hook-form\";\r\nimport {useHistory} from 'react-router-dom'\r\n\r\nexport default function SignUp() {\r\n    const { register, handleSubmit, watch, errors } = useForm();\r\n    const [error, setError] =useState(true)\r\n    const [errorMessage,setErrorMessage] = useState(\"\")\r\n    const userServ=client.service('/users')\r\n    const history = useHistory()\r\n\r\n   \r\n      const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        setErrorMessage(\"\")\r\n        setError(false)\r\n          if (data.password !==data.password2){\r\n              setErrorMessage(\"Passwords not identical\")\r\n              setError(true)\r\n              return\r\n          }\r\n        \r\n          delete data.password2\r\n          console.log(data);\r\n          userServ.create(data)\r\n            .then((res)=>{\r\n                console.log(JSON.stringify(res))\r\n                alert(\"User Created Successfully\")\r\n                e.target.reset();\r\n                history.push(\"/\")\r\n\r\n            })\r\n            .catch((err)=>{\r\n                setErrorMessage(\"Error with creating User, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        \r\n        \r\n\r\n\r\n      } \r\n\r\n    return (\r\n        <section className=\"section\">\r\n            <div className=\"container signupcenter\">\r\n                <div className=\"columns\">\r\n                    <div className=\"column is-4 is-offset-4\">\r\n                        <div className=\"card \">\r\n                            <header className=\"card-header\"> \r\n                                <p className=\"card-header-title\">HealthStack: Sign Up</p>\r\n                            </header>\r\n                        <div className=\"card-content\">\r\n                            <form onSubmit={handleSubmit(onSubmit)}>\r\n                            <div className=\"field is-small\">\r\n                                <label className=\"label is-small\">First Name\r\n                                    <div className=\"control \">\r\n                                        <input className=\"input is-small\"  ref={register({ required: true })}  type=\"text\" placeholder=\"Enter Full Name\" name=\"firstname\"/>\r\n                                    </div>\r\n                                </label>\r\n                            </div>\r\n                            <div className=\"field is-small\">\r\n                                <label className=\"label is-small\">Last Name\r\n                                    <div className=\"control \">\r\n                                        <input className=\"input is-small\"  ref={register({ required: true })}  type=\"text\" placeholder=\"Enter Full Name\" name=\"lastname\"/>\r\n                                    </div>\r\n                                </label>\r\n                            </div>\r\n                            <div className=\"field is-small\">\r\n                                <label className=\"label is-small  \">Phone Number\r\n                                    <div className=\"control \">\r\n                                        <input className=\"input is-small\" ref={register({ required: true })} type=\"text\" placeholder=\"Enter Phone Number\" name=\"phone\"/>\r\n                                    </div>\r\n                                </label>\r\n                            </div>\r\n                            <div className=\"field is-small\">\r\n                                <label className=\"label is-small  \">Email\r\n                                    <div className=\"control \">\r\n                                        <input className=\"input is-small\" ref={register({ required: true })} type=\"text\" placeholder=\"Enter email\" name=\"email\"/>\r\n                                    </div>\r\n                                </label>\r\n                            </div>\r\n                            \r\n                            <div className=\"field is-small\">\r\n                                <label className=\"label is-small  \">Password\r\n                                    <div className=\"control \">\r\n                                        <input className=\"input is-small\" ref={register({ required: true })} type=\"password\" placeholder=\"Password\" name=\"password\"/>\r\n                                    </div>\r\n                                </label>\r\n                            </div>\r\n                            <div className=\"field is-small\">\r\n                                <label className=\"label is-small  \">Repeat Password\r\n                                    <div className=\"control \">\r\n                                        <input className=\"input is-small\" ref={register({ required: true })} type=\"password\" placeholder=\"Password\" name=\"password2\"/>\r\n                                    </div>\r\n                                </label>\r\n                            </div>\r\n                    \r\n                        {/* <div className=\"field\">\r\n                            <label className=\"label is-small\">Username\r\n                            <div className=\"control has-icons-left has-icons-right\">\r\n                                <input className=\"input is-success  is-small\" type=\"text\" placeholder=\"Text input\" value={\"bulma\"} />\r\n                                <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-user\"></i>\r\n                                </span>\r\n                                <span className=\"icon is-small is-right\">\r\n                                <i className=\"fas fa-check\"></i>\r\n                                </span>\r\n                            </div>\r\n                            </label>\r\n                            <p className=\"help is-success\">This username is available</p>\r\n                        </div>\r\n\r\n                        <div className=\"field\">\r\n                            <label className=\"label is-small\">Email</label>\r\n                            <div className=\"control has-icons-left has-icons-right\">\r\n                                <input className=\"input is-danger is-small\" type=\"email\" placeholder=\"Email input\" value=\"hello@\" />\r\n                                <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-envelope\"></i>\r\n                                </span>\r\n                                <span className=\"icon is-small is-right\">\r\n                                <i className=\"fas fa-exclamation-triangle\"></i>\r\n                                </span>\r\n                            </div>\r\n                            <p className=\"help is-danger\">This email is invalid</p>\r\n                        </div>\r\n\r\n                        <div className=\"field\">\r\n                        <label className=\"label is-small\">Subject</label>\r\n                        <div className=\"control is-small\">\r\n                            <div className=\"select\">\r\n                            <select>\r\n                                <option>Select dropdown</option>\r\n                                <option>With options</option>\r\n                            </select>\r\n                            </div>\r\n                        </div>\r\n                        </div> */}\r\n\r\n                    {/*  <div className=\"field\">\r\n                            <label className=\"label\">Message</label>\r\n                            <div className=\"control\">\r\n                                <textarea className=\"textarea is-small\" placeholder=\"Textarea\"></textarea>\r\n                            </div>\r\n                        </div> */}\r\n\r\n                    {/*  <div className=\"field\">\r\n                            <div className=\"control is-small\">\r\n                                <label className=\"checkbox\">\r\n                                <input type=\"checkbox\"/>\r\n                                I agree to the <a href=\"./terms\">terms and conditions</a>\r\n                                </label>\r\n                            </div>\r\n                        </div> */}\r\n\r\n                    {/*  <div className=\"field\">\r\n                            <div className=\"control\">\r\n                                <label className=\"radio is-small\">\r\n                                <input type=\"radio\" name=\"question\"/>\r\n                                Yes\r\n                                </label>\r\n                                <label className=\"radio is-small\">\r\n                                <input type=\"radio\" name=\"question\" />\r\n                                No\r\n                                </label>\r\n                            </div>\r\n                        </div> */}\r\n\r\n                        <div className=\"field is-grouped\">\r\n                            <div className=\"control\">\r\n                                <button type=\"submit\" className=\"button is-link is-small\">Submit</button>\r\n                            </div>\r\n                           {/*  <div className=\"control\">\r\n                                <button className=\"button is-link is-light is-small\" >Cancel</button>\r\n                            </div> */}\r\n                        </div>\r\n                        { error && \r\n                        <div className=\"message\"> {errorMessage}                            \r\n                        </div>\r\n                        }\r\n                        </form>\r\n\r\n                        </div>\r\n                        </div>\r\n                        </div>\r\n                \r\n                </div>\r\n            </div>\r\n        </section>\r\n    )\r\n}\r\n",["331","332"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\InventoryModule.js",["333","334","335","336","337"],"import React,{useState,useContext,useEffect} from 'react'\r\nimport {Route, Switch,  useRouteMatch, Link, NavLink} from 'react-router-dom'\r\nimport InventoryReport from './inventory/InventoryReport'\r\nimport InventorySetup from './inventory/InventorySetup'\r\nimport InventoryStore from './inventory/InventoryStore'\r\nimport InventoryHome from './inventory/InventoryHome'\r\nimport ProductEntry from './inventory/ProductEntry'\r\nimport ProductExit from './inventory/ProductExit'\r\nimport Dispense from './inventory/Dispensary'\r\nimport Products from './inventory/Products'\r\nimport Store, { StoreList, StoreListStandalone } from './inventory/Store'\r\nimport {UserContext,ObjectContext} from '../context'\r\nimport BillPrescription from './inventory/BillPrescription'\r\n\r\nexport default function InventoryModule() {\r\n    const {state,setState}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedStore,setSelectedStore]=useState()\r\n    const [showModal,setShowModal]=useState(false)\r\n\r\n    let { path, url } = useRouteMatch();\r\n    \r\n    useEffect(() => {\r\n       \r\n        console.log(\"starting up inventory module\")\r\n        if (!selectedStore){\r\n            handleChangeStore()\r\n\r\n            }\r\n         return () => {       \r\n            }\r\n        }, [])\r\n   \r\n    useEffect(()=>{\r\n     setSelectedStore(state.StoreModule.selectedStore)\r\n\r\n    },[state.StoreModule])\r\n\r\n    const handleChangeStore= async()=>{\r\n        await setShowModal(true)                                                                                                                                                        \r\n        console.log( showModal)\r\n    }\r\n\r\n    return (\r\n            <section className=\"section has-background-info remPad\">\r\n               \r\n               {/*  <div className=\"\"> */}\r\n                    <nav className=\"navbar minHt z10 has-background-info\">\r\n                        <div className=\"container minHt \">\r\n                            <div className=\"navbar-brand minHt\">\r\n                                <div className=\"navbar-item \">\r\n                                    <span className=\"is-size-6 has-text-weight-medium\">\r\n                                        Health Stack::Inventory::{selectedStore?selectedStore.name:\"\"}</span>\r\n                                        <button className=\"button is-small is-info\" onClick={()=>handleChangeStore()}>Change Store</button> \r\n                                </div>\r\n                                \r\n                            {/* <div className=\"navbar-item\">\r\n                                <img src=\"https://bulma.io/images/bulma-type-white.png\" alt=\"Logo\" />\r\n                            </div> */}\r\n                                <span className=\"navbar-burger\" data-target=\"navbarMenuHeroB\">\r\n                                    <span></span>\r\n                                    <span></span>\r\n                                    <span></span>\r\n                                </span>\r\n                            </div>\r\n                            <div id=\"navbarMenuHeroB\" className=\"navbar-menu\">\r\n                                <div className=\"navbar-end\">\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}`}>Home Page</NavLink> \r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/inv-stores`}>Stores</NavLink>\r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/inv-dispense`}>Dispensary</NavLink>\r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/inv-bill`}>Bill Prescription</NavLink>\r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/inv-inventory`}>Store Inventory</NavLink>\r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/inv-entry`}>Product Entry</NavLink>\r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/inv-exit`}>POS</NavLink>\r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/inv-products`}>Products</NavLink>\r\n                                    </div>\r\n                                   {/*  <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/inv-reports`}>Reports</NavLink>\r\n                                    </div> */}\r\n                                {/* <span className=\"navbar-item\">\r\n                                <div className=\"button is-info is-inverted\">\r\n                                    <span className=\"icon\">\r\n                                    <i className=\"fab fa-github\"></i>\r\n                                    </span>\r\n                                    <span>Download</span>\r\n                                </div>\r\n                                </span> */}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </nav>\r\n                    \r\n               {/*  </div> */}\r\n                \r\n                {/* <div className=\"section\"> */}\r\n                {/* <div className=\"container mvUp \" > */}\r\n                       \r\n                    <Switch>\r\n                        <Route path={path} exact>\r\n                            <InventoryHome />\r\n                        </Route>\r\n                        <Route path={`${path}/inv-dispense`} exact >\r\n                            <Dispense />\r\n                        </Route>\r\n                        <Route path={`${path}/inv-bill`} exact >\r\n                            <BillPrescription />\r\n                        </Route>\r\n                        <Route path={`${path}/inv-admin`} exact >\r\n                            <InventorySetup />\r\n                        </Route>\r\n                        <Route path={`${path}/inv-inventory`} exact>\r\n                            <InventoryStore />\r\n                        </Route>\r\n                        <Route path={`${path}/inv-entry`} exact>\r\n                            <ProductEntry />\r\n                        </Route>\r\n                        <Route path={`${path}/inv-exit`} exact>\r\n                            <ProductExit/>\r\n                        </Route>\r\n                        <Route path={`${path}/inv-products`} exact>\r\n                            <Products />\r\n                        </Route>\r\n                        <Route path={`${path}/inv-reports`} exact>\r\n                            <InventoryReport />\r\n                        </Route>\r\n                        <Route path={`${path}/inv-stores`} exact>\r\n                            <Store />\r\n                        </Route>\r\n\r\n                    </Switch>\r\n                  \r\n\r\n                    <div className={`modal ${showModal?\"is-active\":\"\"}` }>\r\n                                    <div className=\"modal-background\"></div>\r\n                                    <div className=\"modal-card\">\r\n                                        <header className=\"modal-card-head\">\r\n                                        <p className=\"modal-card-title\">Choose Store</p>\r\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={()=>setShowModal(false)}></button>\r\n                                        </header>\r\n                                        <section className=\"modal-card-body\">\r\n                                        <StoreListStandalone standalone=\"true\" closeModal={()=>setShowModal(false)} />\r\n                                        </section>\r\n                                        {/* <footer className=\"modal-card-foot\">\r\n                                        <button className=\"button is-success\">Save changes</button>\r\n                                        <button className=\"button\">Cancel</button>\r\n                                        </footer> */}\r\n                                    </div>\r\n                                </div>        \r\n            </section>\r\n    )\r\n}\r\n","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\ClinicModule.js",["338","339","340","341"],"import React,{useState,useContext,useEffect} from 'react'\r\nimport {Route, Switch,  useRouteMatch, Link, NavLink} from 'react-router-dom'\r\nimport ClinicReport from './Clinic/ClinicReport'\r\nimport ClinicSetup from './Clinic/ClinicSetup'\r\nimport ClinicStore from './Clinic/ClinicStore'\r\nimport ClinicHome from './Clinic/ClinicHome'\r\nimport Appointments from './Clinic/Appointments'\r\nimport Encounter from './EncounterMgt/Encounter'\r\nimport Patients from './ClientMgt/Patient'\r\nimport Clinic, { ClinicList } from './Clinic/Clinic'\r\nimport {UserContext,ObjectContext} from '../context'\r\n\r\nexport default function ClinicModule() {\r\n    const {state,setState}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedClinic,setSelectedClinic]=useState()\r\n    const [showModal,setShowModal]=useState(false)\r\n\r\n    let { path, url } = useRouteMatch();\r\n    \r\n    useEffect(() => {\r\n       \r\n        console.log(\"starting up Clinic module\")\r\n        if (!selectedClinic){\r\n            handleChangeClinic()\r\n\r\n            }\r\n         return () => {       \r\n            }\r\n        }, [])\r\n   \r\n    useEffect(()=>{\r\n     setSelectedClinic(state.ClinicModule.selectedClinic)\r\n\r\n    },[state.ClinicModule])\r\n\r\n    const handleChangeClinic= async()=>{\r\n        await setShowModal(true)                                                                                                                                                        \r\n       // console.log( showModal)\r\n    }\r\n\r\n    return (\r\n            <section className=\"section has-background-info remPad\">\r\n               \r\n               {/*  <div className=\"\"> */}\r\n                    <nav className=\"navbar minHt z10 has-background-info\">\r\n                        <div className=\"container minHt\">\r\n                            <div className=\"navbar-brand  minHt\">\r\n                                <div className=\"navbar-item \">\r\n                                    <span className=\"is-size-6 has-text-weight-medium\">\r\n                                        Health Stack::Clinic::{selectedClinic?selectedClinic.name:\"\"}</span>\r\n                                        <button className=\"button is-small is-info minHt\" onClick={()=>handleChangeClinic()}>Change Clinic</button> \r\n                                </div>\r\n                                \r\n                            {/* <div className=\"navbar-item\">\r\n                                <img src=\"https://bulma.io/images/bulma-type-white.png\" alt=\"Logo\" />\r\n                            </div> */}\r\n                                <span className=\"navbar-burger\" data-target=\"navbarMenuHeroB\">\r\n                                    <span></span>\r\n                                    <span></span>\r\n                                    <span></span>\r\n                                </span>\r\n                            </div>\r\n                            <div id=\"navbarMenuHeroB\" className=\"navbar-menu\">\r\n                                <div className=\"navbar-end\">\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}`}>Home Page</NavLink> \r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/clinics`}>Clinics</NavLink>\r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/clinicsetup`}> Clinic Admin</NavLink>\r\n                                    </div>\r\n                                     <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/appointments`}>Appointments</NavLink>\r\n                                    </div>\r\n                                  {/*   <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/clinicstore`}>Checked In Clients</NavLink>\r\n                                    </div>  */}\r\n                                    {/* <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/encounter`}>Attend to Client</NavLink>\r\n                                    </div> */}\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/patients`}>Clients</NavLink>\r\n                                    </div>\r\n                                    {/* <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/clinicreports`}>Reports</NavLink>\r\n                                    </div> */}\r\n                                {/* <span className=\"navbar-item\">\r\n                                <div className=\"button is-info is-inverted\">\r\n                                    <span className=\"icon\">\r\n                                    <i className=\"fab fa-github\"></i>\r\n                                    </span>\r\n                                    <span>Download</span>\r\n                                </div>\r\n                                </span> */}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </nav>\r\n                    \r\n               {/*  </div> */}\r\n                \r\n                {/* <div className=\"section\"> */}\r\n                {/* <div className=\"container mvUp \" > */}\r\n                       \r\n                    <Switch>\r\n                        <Route path={path} exact>\r\n                            <ClinicHome />\r\n                        </Route>\r\n                        <Route path={`${path}/clinicsetup`} exact >\r\n                            <ClinicSetup />\r\n                        </Route>\r\n                        <Route path={`${path}/appointments`} exact>\r\n                            <Appointments/>\r\n                        </Route>\r\n                        <Route path={`${path}/clinicstore`} exact>\r\n                            <ClinicStore />\r\n                        </Route>\r\n                        <Route path={`${path}/encounter`} exact>\r\n                            <Encounter/>\r\n                        </Route>\r\n                        <Route path={`${path}/patients`} exact>\r\n                            <Patients />\r\n                        </Route>\r\n                        <Route path={`${path}/clinicreports`} exact>\r\n                            <ClinicReport />\r\n                        </Route>\r\n                        <Route path={`${path}/clinics`} exact>\r\n                            <Clinic />\r\n                        </Route>\r\n\r\n                    </Switch>\r\n                  \r\n\r\n                    <div className={`modal ${showModal?\"is-active\":\"\"}` }>\r\n                                    <div className=\"modal-background\"></div>\r\n                                    <div className=\"modal-card\">\r\n                                        <header className=\"modal-card-head\">\r\n                                        <p className=\"modal-card-title\">Choose Clinic</p>\r\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={()=>setShowModal(false)}></button>\r\n                                        </header>\r\n                                        <section className=\"modal-card-body\">\r\n                                        <ClinicList standalone=\"true\"  closeModal={()=>setShowModal(false)}/>\r\n                                        </section>\r\n                                        {/* <footer className=\"modal-card-foot\">\r\n                                        <button className=\"button is-success\">Save changes</button>\r\n                                        <button className=\"button\">Cancel</button>\r\n                                        </footer> */}\r\n                                    </div>\r\n                                </div>        \r\n            </section>\r\n    )\r\n}\r\n","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\CareTeam.js",[],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\Workspace.js",[],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\Department.js",[],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\FacilityHome.js",[],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\InventorySetup.js",[],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\Employee.js",["342","343"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\InventoryStore.js",["344","345","346","347","348","349","350","351"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\n// eslint-disable-next-line\r\nconst searchfacility={};\r\n\r\n\r\nexport default function Inventory() {\r\n    const {state}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedInventory,setSelectedInventory]=useState()\r\n    //const [showState,setShowState]=useState() //create|modify|detail\r\n    \r\n    return(\r\n        <section className= \"section remPadTop\">\r\n           {/*  <div className=\"level\">\r\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Inventory  Module</span></div>\r\n            </div> */}\r\n            <div className=\"columns \">\r\n            <div className=\"column is-8 \">\r\n                <InventoryList />\r\n                </div>\r\n            <div className=\"column is-4 \">\r\n                {(state.InventoryModule.show ==='create')&&<InventoryCreate />}\r\n                {(state.InventoryModule.show ==='detail')&&<InventoryDetail  />}\r\n                {(state.InventoryModule.show ==='modify')&&<InventoryModify Inventory={selectedInventory} />}\r\n               \r\n            </div>\r\n\r\n            </div>                            \r\n            </section>\r\n       \r\n    )\r\n    \r\n}\r\n\r\nexport function InventoryCreate(){\r\n    const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \r\n    const [error, setError] =useState(false)\r\n    const [success, setSuccess] =useState(false)\r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line\r\n    const [facility,setFacility] = useState()\r\n    const InventoryServ=client.service('inventory')\r\n    //const history = useHistory()\r\n    const {user} = useContext(UserContext) //,setUser\r\n    // eslint-disable-next-line\r\n    const [currentUser,setCurrentUser] = useState()\r\n\r\n\r\n\r\n    const getSearchfacility=(obj)=>{\r\n        \r\n        setValue(\"facility\", obj._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })\r\n    }\r\n    \r\n    useEffect(() => {\r\n        setCurrentUser(user)\r\n        //console.log(currentUser)\r\n        return () => {\r\n        \r\n        }\r\n    }, [user])\r\n\r\n  //check user for facility or get list of facility  \r\n    useEffect(()=>{\r\n        //setFacility(user.activeInventory.FacilityId)//\r\n      if (!user.stacker){\r\n          console.log(currentUser)\r\n        setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        }) \r\n      }\r\n    })\r\n\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        setMessage(\"\")\r\n        setError(false)\r\n        setSuccess(false)\r\n         // data.createdby=user._id\r\n          console.log(data);\r\n          if (user.currentEmployee){\r\n         data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\r\n          }\r\n        InventoryServ.create(data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                e.target.reset();\r\n               /*  setMessage(\"Created Inventory successfully\") */\r\n                setSuccess(true)\r\n                toast({\r\n                    message: 'Inventory created succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  setSuccess(false)\r\n            })\r\n            .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating Inventory ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n\r\n    return (\r\n        <>\r\n            <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Create Inventory: Product Entry- Initialization, Purchase Invoice, Audit\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n   \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n            <div className=\"field\">    \r\n                <div class=\"control\">\r\n                    <div class=\"select is-small\">\r\n                        <select>\r\n                            <option>Purchase Invoice </option>\r\n                            <option>Initialization</option>\r\n                            <option>Audit</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\"> {/* Audit/initialization/Purchase Invoice */}\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"type\" type=\"text\" placeholder=\"Type of Product Entry\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\" fas fa-user-md \"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input is-small\" ref={register({ required: true })}  name=\"supplier\" type=\"text\" placeholder=\"Supplier\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                </div>\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })}  name=\"date\" type=\"text\" placeholder=\"Date\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n            </div>\r\n            \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"totalamount\" type=\"text\" placeholder=\" Total Amount\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n           \r\n         {/* array of inventory items */}\r\n         <p className=\"control\">\r\n                    <button className=\"button is-info is-small  is-pulled-right\">\r\n                      <span className=\"is-small\"> +</span>\r\n                    </button>\r\n                </p>\r\n           <div className=\"field\"  /* style={ !user.stacker?{display:\"none\"}:{}} */ >\r\n                <ProductSearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                    <input className=\"input is-small\" ref={register ({ required: true }) } /* add array no */ name=\"productId\" type=\"text\" placeholder=\"Product Id\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas  fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n           \r\n               <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"quantity\" type=\"text\" placeholder=\"Quantity\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                <label className=\"label is-small\">Base Unit</label>\r\n            </div> \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"costprice\" type=\"text\" placeholder=\"Cost Price\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> \r\n           {/*  <div className=\"field\">\r\n                <div className=\"control has-icons-left\">\r\n                    <div className=\"dropdown \">\r\n                        <div className=\"dropdown-trigger\">\r\n                            <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital-symbol\"></i>\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"dropdown-menu\">\r\n                            <div className=\"dropdown-content\">\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa\r\n                                </div>\r\n                                <div className=\"dropdown-item is-active\">\r\n                                    simpa 2\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 3\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 4\r\n                                </div>\r\n                            </div>\r\n                        </div>   \r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Department Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"password\" type=\"text\" placeholder=\"password\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n            <div className=\"field\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\">\r\n                        Create\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            \r\n            </form>\r\n            </div>\r\n            </div>\r\n        </>\r\n    )\r\n   \r\n}\r\n\r\nexport function InventoryList(){\r\n   // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const InventoryServ=client.service('inventory')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedInventory, setSelectedInventory]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n    // eslint-disable-next-line\r\n    const {user,setUser}=useContext(UserContext)\r\n\r\n\r\n\r\n    const handleCreateNew = async()=>{\r\n        const    newInventoryModule={\r\n            selectedInventory:{},\r\n            show :'create'\r\n            }\r\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n       //console.log(state)\r\n    }\r\n\r\n    const handleRow= async(Inventory)=>{\r\n        //console.log(\"b4\",state)\r\n\r\n        //console.log(\"handlerow\",Inventory)\r\n\r\n        await setSelectedInventory(Inventory)\r\n\r\n        const    newInventoryModule={\r\n            selectedInventory:Inventory,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n       //console.log(state)\r\n\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='name'\r\n       console.log(val)\r\n       InventoryServ.find({query: {\r\n                [field]: {\r\n                    $regex:val,\r\n                    $options:'i'\r\n                   \r\n                },\r\n               facility:user.currentEmployee.facilityDetail._id || \"\",\r\n                $limit:10,\r\n                $sort: {\r\n                    createdAt: -1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" Inventory  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error fetching Inventory, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n   \r\n        const getFacilities= async()=>{\r\n            if (user.currentEmployee){\r\n            \r\n        const findInventory= await InventoryServ.find(\r\n                {query: {\r\n                    facility:user.currentEmployee.facilityDetail._id,\r\n                    storeId:state.StoreModule.selectedStore._id,\r\n                    $limit:20,\r\n                    $sort: {\r\n                        createdAt: -1\r\n                    }\r\n                    }})\r\n\r\n         await setFacilities(findInventory.data)\r\n                }\r\n                else {\r\n                    if (user.stacker){\r\n                        const findInventory= await InventoryServ.find(\r\n                            {query: {\r\n                                \r\n                                $limit:20,\r\n                                $sort: {\r\n                                    createdAt: -1\r\n                                }\r\n                                }})\r\n            \r\n                    await setFacilities(findInventory.data)\r\n\r\n                    }\r\n                }\r\n          /*   .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" Inventory  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating Inventory, probable network issues \"+ err )\r\n                    setError(true)\r\n                }) */\r\n            }\r\n            \r\n            useEffect(() => {\r\n                setTimeout(() => {\r\n                    console.log(\"happy birthday\")\r\n                    //getFacilities(user)\r\n                }, 200);\r\n\r\n                return () => {\r\n                    \r\n\r\n                }\r\n            },[])\r\n\r\n            useEffect(() => {\r\n               \r\n                if (user){\r\n                    getFacilities()\r\n                }else{\r\n                    /* const localUser= localStorage.getItem(\"user\")\r\n                    const user1=JSON.parse(localUser)\r\n                    console.log(localUser)\r\n                    console.log(user1)\r\n                    fetchUser(user1)\r\n                    console.log(user)\r\n                    getFacilities(user) */\r\n                }\r\n                InventoryServ.on('created', (obj)=>getFacilities())\r\n                InventoryServ.on('updated', (obj)=>getFacilities())\r\n                InventoryServ.on('patched', (obj)=>getFacilities())\r\n                InventoryServ.on('removed', (obj)=>getFacilities())\r\n                return () => {\r\n                \r\n                }\r\n            },[])\r\n        \r\n        useEffect(() => {\r\n            getFacilities()\r\n            return () => {\r\n               \r\n            }\r\n        }, [state.StoreModule.selectedStore])\r\n\r\n    //todo: pagination and vertical scroll bar\r\n\r\n    return(\r\n        <>\r\n           {user?( <>  \r\n                <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search Inventory\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Inventory </span></div>\r\n                    <div className=\"level-right\">\r\n                        <div className=\"level-item\"> \r\n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <div className=\"table-container pullup \">\r\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\r\n                                    <thead>\r\n                                        <tr>\r\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                        {/* <th><abbr title=\"Category\">Category</abbr></th> */}\r\n                                        <th>Product</th>\r\n                                        <th><abbr title=\"Quantity\">Quantity</abbr></th>\r\n                                        <th><abbr title=\"Base Unit\">Base Unit</abbr></th>\r\n                                        <th><abbr title=\"Stock Value\">Stock Value</abbr></th>\r\n                                         <th><abbr title=\"Cost Price\">Cost Price</abbr></th>\r\n                                        <th><abbr title=\"Selling Price\">Selling Price</abbr></th>\r\n                                        <th><abbr title=\"Re-Order Level\">Re-Order Level</abbr></th>\r\n                                        <th><abbr title=\"Expiry\">Expiry</abbr></th> \r\n                                        <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tfoot>\r\n                                        \r\n                                    </tfoot>\r\n                                    <tbody>\r\n                                        {facilities.map((Inventory, i)=>(\r\n\r\n                                            <tr key={Inventory._id} onClick={()=>handleRow(Inventory)} className={Inventory._id===(selectedInventory?._id||null)?\"is-selected\":\"\"} >\r\n                                            <th>{i+1}</th>\r\n                                            {/* <td>{Inventory.productDetail.category}</td> */}\r\n                                            <th>{Inventory.name}</th>\r\n                                            <td>{Inventory.quantity}</td>\r\n                                            <td>{Inventory.baseunit}</td>\r\n                                            <td>{Inventory.stockvalue}</td>\r\n                                            <td>{Inventory.costprice}</td>\r\n                                            <td>{Inventory.sellingprice}</td>\r\n                                            <td>{Inventory.reorder_level}</td> \r\n                                            <td>{Inventory.expiry}</td>\r\n                                            <td><span   className=\"showAction\"  >...</span></td>\r\n                                           \r\n                                            </tr>\r\n\r\n                                        ))}\r\n                                    </tbody>\r\n                                    </table>\r\n                                    \r\n                </div>              \r\n            </>):<div>loading</div>}\r\n            </>\r\n              \r\n    )\r\n    }\r\n\r\n\r\nexport function InventoryDetail(){\r\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\r\n     // eslint-disable-next-line\r\n    const [error, setError] =useState(false) //, \r\n    //const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [message, setMessage] = useState(\"\") //,\r\n    //const InventoryServ=client.service('/Inventory')\r\n    //const history = useHistory()\r\n    //const {user,setUser} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n    const {user} = useContext(UserContext) //,setUser\r\n    \r\n   \r\n\r\n   const Inventory =state.InventoryModule.selectedInventory \r\n   console.log(\"selected\",Inventory)\r\n\r\n   \r\n  const getFacilities= async()=>{\r\n     const findProductEntry= await client.service('productentry').find(\r\n        {query: {\r\n            'productitems.productId':Inventory.productId,\r\n            facility:user.currentEmployee.facilityDetail._id,\r\n            storeId:state.StoreModule.selectedStore._id,\r\n            $limit:20,\r\n            $sort: {\r\n                createdAt: -1\r\n            }\r\n            }})\r\n\r\n        console.log(findProductEntry)\r\n       }\r\n    \r\n       useEffect(() => {\r\n        getFacilities()\r\n           return () => {\r\n               \r\n           }\r\n       }, [Inventory])\r\n /* await setFacilities(findProductEntry.data)\r\n        }\r\n        else {\r\n            if (user.stacker){ */\r\n                /* toast({\r\n                    message: 'You do not qualify to view this',\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  }) \r\n                  return */\r\n               /*  const findProductEntry= await ProductEntryServ.find(\r\n                    {query: {\r\n                        \r\n                        $limit:20,\r\n                        $sort: {\r\n                            createdAt: -1\r\n                        }\r\n                        }})\r\n    \r\n            await setFacilities(findProductEntry.data)\r\n\r\n            }\r\n        }  */\r\n  /*   .then((res)=>{\r\n        console.log(res)\r\n            setFacilities(res.data)\r\n            setMessage(\" ProductEntry  fetched successfully\")\r\n            setSuccess(true)\r\n        })\r\n        .catch((err)=>{\r\n            setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\r\n            setError(true)\r\n        }) */\r\n    \r\n    \r\n\r\n\r\n\r\n    const handleEdit= async()=>{\r\n        const    newInventoryModule={\r\n            selectedInventory:Inventory,\r\n            show :'modify'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n       //console.log(state)\r\n       \r\n    }\r\n \r\n    return (\r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Inventory Details\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n                <table> \r\n                <tbody>         \r\n                <tr>\r\n                    <td>\r\n                \r\n                    <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Product Name: \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"><strong> {Inventory.name} </strong></span>\r\n                        </td>\r\n                    </tr>\r\n                   {/*  <tr>\r\n                    <td>\r\n                <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>Inventory Type:\r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft\"   name=\"InventoryType\">{Inventory.InventoryType} </span> \r\n                    </td>\r\n                </tr> */}\r\n\r\n            </tbody> \r\n            </table> \r\n           \r\n            <div className=\"field mt-2 is-grouped\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\r\n                        Set Price\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\"  /*  onClick={handleSetPrice} */>\r\n                        Audit\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-info is-small\" /* onClick={handleEdit} */>\r\n                        Transaction History\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" /* onClick={handleEdit} */>\r\n                        Reorder Level\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            { error && <div className=\"message\"> {message}</div>}\r\n           \r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n}\r\n\r\nexport function InventoryModify(){\r\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\r\n    // eslint-disable-next-line \r\n    const [error, setError] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [success, setSuccess] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [message,setMessage] = useState(\"\")\r\n    const [billservice,setBillService] = useState()\r\n    // eslint-disable-next-line \r\n    const InventoryServ=client.service('inventory')\r\n    //const history = useHistory()\r\n     // eslint-disable-next-line\r\n    const {user} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n    const billServ=client.service('billing')\r\n\r\n    const Inventory =state.InventoryModule.selectedInventory // set inventory\r\n    const handleSetPrice = async()=>{\r\n    \r\n        const service = await  billServ.get(Inventory.billingId) // get the service\r\n            const contractSel= service.contracts.filter(element=>(element.source_org===Inventory.facility && element.dest_org===Inventory.facility))\r\n            \r\n            setValue(\"price\", contractSel[0].price,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"oldprice\", contractSel[0].price,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            await setBillService(service)\r\n            console.log(contractSel,service)\r\n    }\r\n \r\n        useEffect(() => {\r\n            handleSetPrice()\r\n     \r\n            return () => {\r\n                \r\n            }\r\n        },[])\r\n\r\n   const handleCancel=async()=>{\r\n   \r\n    const    newInventoryModule={\r\n        selectedInventory:{},\r\n        show :'detail'\r\n      }\r\n        await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n   //console.log(state)\r\n           }\r\n\r\n\r\n        const changeState =()=>{\r\n            const    newInventoryModule={\r\n                selectedInventory:{},\r\n                show :'detail'\r\n            }\r\n        setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n\r\n        }\r\n\r\n\r\n    const handleDelete=async()=>{\r\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\r\n        \r\n        const dleteId=Inventory._id\r\n        if (conf){\r\n             \r\n        InventoryServ.remove(dleteId)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                reset();\r\n               /*  setMessage(\"Deleted Inventory successfully\")\r\n                setSuccess(true)\r\n                changeState()\r\n               setTimeout(() => {\r\n                setSuccess(false)\r\n                }, 200); */\r\n                toast({\r\n                    message: 'Inventory deleted succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                changeState()\r\n            })\r\n            .catch((err)=>{\r\n               // setMessage(\"Error deleting Inventory, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error deleting Inventory, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n        }\r\n    }\r\n        \r\n\r\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n          })) */\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        \r\n        setSuccess(false)\r\n        console.log(data)\r\n       // data.facility=Inventory.facility\r\n          //console.log(data);\r\n          const contractSel= billservice.contracts.filter(element=>(element.source_org===Inventory.facility && element.dest_org===Inventory.facility))\r\n          contractSel[0].price=data.price \r\n          billServ.patch(billservice._id,billservice)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n               // e.target.reset();\r\n               // setMessage(\"updated Inventory successfully\")\r\n                 toast({\r\n                    message: 'Price updated succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  \r\n                changeState()\r\n\r\n            })\r\n            .catch((err)=>{\r\n                //setMessage(\"Error creating Inventory, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error updating Price, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            }) \r\n\r\n      } \r\n     \r\n      \r\n    return (\r\n        \r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Set Price for {Inventory.name} per {Inventory.baseunit}\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <div className=\"field\">\r\n                    <label className=\"label is-small\"> New Selling Price\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"price\" type=\"text\" placeholder=\"Name\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                    </label>\r\n                    </div>\r\n                <div className=\"field\">\r\n                <label className=\"label is-small\">Old Price\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small \" ref={register({ required: true })} disabled name=\"oldprice\" type=\"text\" placeholder=\"Inventory Type\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n                </label>\r\n                </div>\r\n           \r\n           \r\n           \r\n            </form>\r\n            \r\n            <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n               {/*  <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p> */}\r\n            </div>\r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n                \r\n}   \r\n\r\nexport  function ProductSearch({getSearchfacility,clear}) {\r\n    \r\n    const facilityServ=client.service('products')\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n     const [searchError, setSearchError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [showPanel, setShowPanel] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [searchMessage, setSearchMessage] = useState(\"\") \r\n   // eslint-disable-next-line \r\n   const [simpa,setSimpa]=useState(\"\")\r\n   // eslint-disable-next-line \r\n   const [chosen,setChosen]=useState(false)\r\n   // eslint-disable-next-line \r\n   const [count,setCount]=useState(0)\r\n   const inputEl=useRef(null)\r\n\r\n\r\n   const handleRow= async(obj)=>{\r\n        await setChosen(true)\r\n        //alert(\"something is chaning\")\r\n       getSearchfacility(obj)\r\n       \r\n       await setSimpa(obj.facilityName)\r\n       \r\n        // setSelectedFacility(obj)\r\n        setShowPanel(false)\r\n        await setCount(2)\r\n        /* const    newfacilityModule={\r\n            selectedFacility:facility,\r\n            show :'detail'\r\n        }\r\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\r\n   //console.log(state)\r\n}\r\n    const handleBlur=async(e)=>{\r\n         if (count===2){\r\n             console.log(\"stuff was chosen\")\r\n         }\r\n       \r\n       /*  console.log(\"blur\")\r\n         setShowPanel(false)\r\n        console.log(JSON.stringify(simpa))\r\n        if (simpa===\"\"){\r\n            console.log(facilities.length)\r\n            setSimpa(\"abc\")\r\n            setSimpa(\"\")\r\n            setFacilities([])\r\n            inputEl.current.setValue=\"\"\r\n        }\r\n        console.log(facilities.length)\r\n        console.log(inputEl.current) */\r\n    }\r\n    const handleSearch=async(val)=>{\r\n        \r\n        const field='name' //field variable\r\n       \r\n        if (val.length>=3){\r\n            facilityServ.find({query: {     //service\r\n                 [field]: {\r\n                     $regex:val,\r\n                     $options:'i'\r\n                    \r\n                 },\r\n                 $limit:10,\r\n                 $sort: {\r\n                     createdAt: -1\r\n                   }\r\n                     }}).then((res)=>{\r\n              console.log(\"facility  fetched successfully\") \r\n                setFacilities(res.data)\r\n                 setSearchMessage(\" facility  fetched successfully\")\r\n                 setShowPanel(true)\r\n             })\r\n             .catch((err)=>{\r\n                 console.log(err)\r\n                 setSearchMessage(\"Error searching facility, probable network issues \"+ err )\r\n                 setSearchError(true)\r\n             })\r\n         }\r\n        else{\r\n            console.log(\"less than 3 \")\r\n            console.log(val)\r\n            setShowPanel(false)\r\n            await setFacilities([])\r\n            console.log(facilities)\r\n        }\r\n    }\r\n    useEffect(() => {\r\n       if (clear){\r\n           setSimpa(\"\")\r\n       }\r\n        return () => {\r\n            \r\n        }\r\n    }, [clear] )\r\n    return (\r\n        <div>\r\n            <div className=\"field\">\r\n                <div className=\"control has-icons-left  \">\r\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`}>\r\n                        <div className=\"dropdown-trigger\">\r\n                            <DebounceInput className=\"input is-small \" \r\n                                type=\"text\" placeholder=\"Search Product\"\r\n                                value={simpa}\r\n                                minLength={1}\r\n                                debounceTimeout={400}\r\n                                onBlur={(e)=>handleBlur(e)}\r\n                                onChange={(e)=>handleSearch(e.target.value)}\r\n                                inputRef={inputEl}\r\n                                  />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-search\"></i>\r\n                            </span>\r\n                        </div>\r\n                        {searchError&&<div>{searchMessage}</div>}\r\n                        <div className=\"dropdown-menu\" >\r\n                            <div className=\"dropdown-content\">\r\n                            {facilities.map((facility, i)=>(\r\n                                    \r\n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\r\n                                        \r\n                                        <span>{facility.facilityName}</span>\r\n                                        \r\n                                    </div>\r\n                                    \r\n                                    ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n          \r\n        </div>\r\n    )\r\n}","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\FinanceStore.js",["352","353","354","355","356","357","358","359"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\n// eslint-disable-next-line\r\nconst searchfacility={};\r\n\r\n\r\nexport default function Inventory() {\r\n    const {state}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedInventory,setSelectedInventory]=useState()\r\n    //const [showState,setShowState]=useState() //create|modify|detail\r\n    \r\n    return(\r\n        <section className= \"section remPadTop\">\r\n           {/*  <div className=\"level\">\r\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Inventory  Module</span></div>\r\n            </div> */}\r\n            <div className=\"columns \">\r\n            <div className=\"column is-8 \">\r\n                <InventoryList />\r\n                </div>\r\n            <div className=\"column is-4 \">\r\n                {(state.InventoryModule.show ==='create')&&<InventoryCreate />}\r\n                {(state.InventoryModule.show ==='detail')&&<InventoryDetail  />}\r\n                {(state.InventoryModule.show ==='modify')&&<InventoryModify Inventory={selectedInventory} />}\r\n               \r\n            </div>\r\n\r\n            </div>                            \r\n            </section>\r\n       \r\n    )\r\n    \r\n}\r\n\r\nexport function InventoryCreate(){\r\n    const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \r\n    const [error, setError] =useState(false)\r\n    const [success, setSuccess] =useState(false)\r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line\r\n    const [facility,setFacility] = useState()\r\n    const InventoryServ=client.service('inventory')\r\n    //const history = useHistory()\r\n    const {user} = useContext(UserContext) //,setUser\r\n    // eslint-disable-next-line\r\n    const [currentUser,setCurrentUser] = useState()\r\n\r\n\r\n\r\n    const getSearchfacility=(obj)=>{\r\n        \r\n        setValue(\"facility\", obj._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })\r\n    }\r\n    \r\n    useEffect(() => {\r\n        setCurrentUser(user)\r\n        //console.log(currentUser)\r\n        return () => {\r\n        \r\n        }\r\n    }, [user])\r\n\r\n  //check user for facility or get list of facility  \r\n    useEffect(()=>{\r\n        //setFacility(user.activeInventory.FacilityId)//\r\n      if (!user.stacker){\r\n          console.log(currentUser)\r\n        setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        }) \r\n      }\r\n    })\r\n\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        setMessage(\"\")\r\n        setError(false)\r\n        setSuccess(false)\r\n         // data.createdby=user._id\r\n          console.log(data);\r\n          if (user.currentEmployee){\r\n         data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\r\n          }\r\n        InventoryServ.create(data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                e.target.reset();\r\n               /*  setMessage(\"Created Inventory successfully\") */\r\n                setSuccess(true)\r\n                toast({\r\n                    message: 'Inventory created succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  setSuccess(false)\r\n            })\r\n            .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating Inventory ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n\r\n    return (\r\n        <>\r\n            <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Create Inventory: Product Entry- Initialization, Purchase Invoice, Audit\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n   \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n            <div className=\"field\">    \r\n                <div class=\"control\">\r\n                    <div class=\"select is-small\">\r\n                        <select>\r\n                            <option>Purchase Invoice </option>\r\n                            <option>Initialization</option>\r\n                            <option>Audit</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\"> {/* Audit/initialization/Purchase Invoice */}\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"type\" type=\"text\" placeholder=\"Type of Product Entry\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\" fas fa-user-md \"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input is-small\" ref={register({ required: true })}  name=\"supplier\" type=\"text\" placeholder=\"Supplier\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                </div>\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })}  name=\"date\" type=\"text\" placeholder=\"Date\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n            </div>\r\n            \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"totalamount\" type=\"text\" placeholder=\" Total Amount\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n           \r\n         {/* array of inventory items */}\r\n         <p className=\"control\">\r\n                    <button className=\"button is-info is-small  is-pulled-right\">\r\n                      <span className=\"is-small\"> +</span>\r\n                    </button>\r\n                </p>\r\n           <div className=\"field\"  /* style={ !user.stacker?{display:\"none\"}:{}} */ >\r\n                <ProductSearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                    <input className=\"input is-small\" ref={register ({ required: true }) } /* add array no */ name=\"productId\" type=\"text\" placeholder=\"Product Id\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas  fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n           \r\n               <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"quantity\" type=\"text\" placeholder=\"Quantity\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                <label className=\"label is-small\">Base Unit</label>\r\n            </div> \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"costprice\" type=\"text\" placeholder=\"Cost Price\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> \r\n           {/*  <div className=\"field\">\r\n                <div className=\"control has-icons-left\">\r\n                    <div className=\"dropdown \">\r\n                        <div className=\"dropdown-trigger\">\r\n                            <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital-symbol\"></i>\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"dropdown-menu\">\r\n                            <div className=\"dropdown-content\">\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa\r\n                                </div>\r\n                                <div className=\"dropdown-item is-active\">\r\n                                    simpa 2\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 3\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 4\r\n                                </div>\r\n                            </div>\r\n                        </div>   \r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Department Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"password\" type=\"text\" placeholder=\"password\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n            <div className=\"field\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\">\r\n                        Create\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            \r\n            </form>\r\n            </div>\r\n            </div>\r\n        </>\r\n    )\r\n   \r\n}\r\n\r\nexport function InventoryList(){\r\n   // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const InventoryServ=client.service('inventory')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedInventory, setSelectedInventory]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n    // eslint-disable-next-line\r\n    const {user,setUser}=useContext(UserContext)\r\n\r\n\r\n\r\n    const handleCreateNew = async()=>{\r\n        const    newInventoryModule={\r\n            selectedInventory:{},\r\n            show :'create'\r\n            }\r\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n       //console.log(state)\r\n    }\r\n\r\n    const handleRow= async(Inventory)=>{\r\n        //console.log(\"b4\",state)\r\n\r\n        //console.log(\"handlerow\",Inventory)\r\n\r\n        await setSelectedInventory(Inventory)\r\n\r\n        const    newInventoryModule={\r\n            selectedInventory:Inventory,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n       //console.log(state)\r\n\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='name'\r\n       console.log(val)\r\n       InventoryServ.find({query: {\r\n                [field]: {\r\n                    $regex:val,\r\n                    $options:'i'\r\n                   \r\n                },\r\n               facility:user.currentEmployee.facilityDetail._id || \"\",\r\n                $limit:10,\r\n                $sort: {\r\n                    createdAt: -1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" Inventory  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error fetching Inventory, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n   \r\n        const getFacilities= async()=>{\r\n            if (user.currentEmployee){\r\n            \r\n        const findInventory= await InventoryServ.find(\r\n                {query: {\r\n                    facility:user.currentEmployee.facilityDetail._id,\r\n                    storeId:state.StoreModule.selectedStore._id,\r\n                    $limit:20,\r\n                    $sort: {\r\n                        createdAt: -1\r\n                    }\r\n                    }})\r\n\r\n         await setFacilities(findInventory.data)\r\n                }\r\n                else {\r\n                    if (user.stacker){\r\n                        const findInventory= await InventoryServ.find(\r\n                            {query: {\r\n                                \r\n                                $limit:20,\r\n                                $sort: {\r\n                                    createdAt: -1\r\n                                }\r\n                                }})\r\n            \r\n                    await setFacilities(findInventory.data)\r\n\r\n                    }\r\n                }\r\n          /*   .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" Inventory  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating Inventory, probable network issues \"+ err )\r\n                    setError(true)\r\n                }) */\r\n            }\r\n            \r\n            useEffect(() => {\r\n                setTimeout(() => {\r\n                    console.log(\"happy birthday\")\r\n                    //getFacilities(user)\r\n                }, 200);\r\n\r\n                return () => {\r\n                    \r\n\r\n                }\r\n            },[])\r\n\r\n            useEffect(() => {\r\n               \r\n                if (user){\r\n                    getFacilities()\r\n                }else{\r\n                    /* const localUser= localStorage.getItem(\"user\")\r\n                    const user1=JSON.parse(localUser)\r\n                    console.log(localUser)\r\n                    console.log(user1)\r\n                    fetchUser(user1)\r\n                    console.log(user)\r\n                    getFacilities(user) */\r\n                }\r\n                InventoryServ.on('created', (obj)=>getFacilities())\r\n                InventoryServ.on('updated', (obj)=>getFacilities())\r\n                InventoryServ.on('patched', (obj)=>getFacilities())\r\n                InventoryServ.on('removed', (obj)=>getFacilities())\r\n                return () => {\r\n                \r\n                }\r\n            },[])\r\n        \r\n        useEffect(() => {\r\n            getFacilities()\r\n            return () => {\r\n               \r\n            }\r\n        }, [state.StoreModule.selectedStore])\r\n\r\n    //todo: pagination and vertical scroll bar\r\n\r\n    return(\r\n        <>\r\n           {user?( <>  \r\n                <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search Inventory\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Inventories </span></div>\r\n                    <div className=\"level-right\">\r\n                        <div className=\"level-item\"> \r\n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <div className=\"table-container pullup \">\r\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\r\n                                    <thead>\r\n                                        <tr>\r\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                        {/* <th><abbr title=\"Category\">Category</abbr></th> */}\r\n                                        <th>Product</th>\r\n                                        <th><abbr title=\"Quantity\">Quantity</abbr></th>\r\n                                        <th><abbr title=\"Base Unit\">Base Unit</abbr></th>\r\n                                        <th><abbr title=\"Stock Value\">Stock Value</abbr></th>\r\n                                         <th><abbr title=\"Cost Price\">Cost Price</abbr></th>\r\n                                        <th><abbr title=\"Selling Price\">Selling Price</abbr></th>\r\n                                        <th><abbr title=\"Re-Order Level\">Re-Order Level</abbr></th>\r\n                                        <th><abbr title=\"Expiry\">Expiry</abbr></th> \r\n                                        <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tfoot>\r\n                                        \r\n                                    </tfoot>\r\n                                    <tbody>\r\n                                        {facilities.map((Inventory, i)=>(\r\n\r\n                                            <tr key={Inventory._id} onClick={()=>handleRow(Inventory)}>\r\n                                            <th>{i+1}</th>\r\n                                            {/* <td>{Inventory.productDetail.category}</td> */}\r\n                                            <th>{Inventory.name}</th>\r\n                                            <td>{Inventory.quantity}</td>\r\n                                            <td>{Inventory.baseunit}</td>\r\n                                            <td>{Inventory.stockvalue}</td>\r\n                                            <td>{Inventory.costprice}</td>\r\n                                            <td>{Inventory.sellingprice}</td>\r\n                                            <td>{Inventory.reorder_level}</td> \r\n                                            <td>{Inventory.expiry}</td>\r\n                                            <td><span   className=\"showAction\"  >...</span></td>\r\n                                           \r\n                                            </tr>\r\n\r\n                                        ))}\r\n                                    </tbody>\r\n                                    </table>\r\n                                    \r\n                </div>              \r\n            </>):<div>loading</div>}\r\n            </>\r\n              \r\n    )\r\n    }\r\n\r\n\r\nexport function InventoryDetail(){\r\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\r\n     // eslint-disable-next-line\r\n    const [error, setError] =useState(false) //, \r\n    //const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [message, setMessage] = useState(\"\") //,\r\n    //const InventoryServ=client.service('/Inventory')\r\n    //const history = useHistory()\r\n    //const {user,setUser} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n    const {user} = useContext(UserContext) //,setUser\r\n    \r\n   \r\n\r\n   const Inventory =state.InventoryModule.selectedInventory \r\n   console.log(\"selected\",Inventory)\r\n\r\n   \r\n  const getFacilities= async()=>{\r\n     const findProductEntry= await client.service('productentry').find(\r\n        {query: {\r\n            'productitems.productId':Inventory.productId,\r\n            facility:user.currentEmployee.facilityDetail._id,\r\n            storeId:state.StoreModule.selectedStore._id,\r\n            $limit:20,\r\n            $sort: {\r\n                createdAt: -1\r\n            }\r\n            }})\r\n\r\n        console.log(findProductEntry)\r\n       }\r\n    \r\n       useEffect(() => {\r\n        getFacilities()\r\n           return () => {\r\n               \r\n           }\r\n       }, [Inventory])\r\n /* await setFacilities(findProductEntry.data)\r\n        }\r\n        else {\r\n            if (user.stacker){ */\r\n                /* toast({\r\n                    message: 'You do not qualify to view this',\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  }) \r\n                  return */\r\n               /*  const findProductEntry= await ProductEntryServ.find(\r\n                    {query: {\r\n                        \r\n                        $limit:20,\r\n                        $sort: {\r\n                            createdAt: -1\r\n                        }\r\n                        }})\r\n    \r\n            await setFacilities(findProductEntry.data)\r\n\r\n            }\r\n        }  */\r\n  /*   .then((res)=>{\r\n        console.log(res)\r\n            setFacilities(res.data)\r\n            setMessage(\" ProductEntry  fetched successfully\")\r\n            setSuccess(true)\r\n        })\r\n        .catch((err)=>{\r\n            setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\r\n            setError(true)\r\n        }) */\r\n    \r\n    \r\n\r\n\r\n\r\n    const handleEdit= async()=>{\r\n        const    newInventoryModule={\r\n            selectedInventory:Inventory,\r\n            show :'modify'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n       //console.log(state)\r\n       \r\n    }\r\n \r\n    return (\r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Inventory Details\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n                <table> \r\n                <tbody>         \r\n                <tr>\r\n                    <td>\r\n                \r\n                    <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Product Name: \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"><strong> {Inventory.name} </strong></span>\r\n                        </td>\r\n                    </tr>\r\n                   {/*  <tr>\r\n                    <td>\r\n                <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>Inventory Type:\r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft\"   name=\"InventoryType\">{Inventory.InventoryType} </span> \r\n                    </td>\r\n                </tr> */}\r\n\r\n            </tbody> \r\n            </table> \r\n           \r\n            <div className=\"field mt-2 is-grouped\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\r\n                        Set Price\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\"  /*  onClick={handleSetPrice} */>\r\n                        Audit\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-info is-small\" /* onClick={handleEdit} */>\r\n                        Transaction History\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" /* onClick={handleEdit} */>\r\n                        Reorder Level\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            { error && <div className=\"message\"> {message}</div>}\r\n           \r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n}\r\n\r\nexport function InventoryModify(){\r\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\r\n    // eslint-disable-next-line \r\n    const [error, setError] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [success, setSuccess] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [message,setMessage] = useState(\"\")\r\n    const [billservice,setBillService] = useState()\r\n    // eslint-disable-next-line \r\n    const InventoryServ=client.service('inventory')\r\n    //const history = useHistory()\r\n     // eslint-disable-next-line\r\n    const {user} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n    const billServ=client.service('billing')\r\n\r\n    const Inventory =state.InventoryModule.selectedInventory // set inventory\r\n    const handleSetPrice = async()=>{\r\n    \r\n        const service = await  billServ.get(Inventory.billingId) // get the service\r\n            const contractSel= service.contracts.filter(element=>(element.source_org===Inventory.facility && element.dest_org===Inventory.facility))\r\n            \r\n            setValue(\"price\", contractSel[0].price,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"oldprice\", contractSel[0].price,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            await setBillService(service)\r\n            console.log(contractSel,service)\r\n    }\r\n \r\n        useEffect(() => {\r\n            handleSetPrice()\r\n     \r\n            return () => {\r\n                \r\n            }\r\n        },[])\r\n\r\n   const handleCancel=async()=>{\r\n   \r\n    const    newInventoryModule={\r\n        selectedInventory:{},\r\n        show :'detail'\r\n      }\r\n        await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n   //console.log(state)\r\n           }\r\n\r\n\r\n        const changeState =()=>{\r\n            const    newInventoryModule={\r\n                selectedInventory:{},\r\n                show :'detail'\r\n            }\r\n        setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n\r\n        }\r\n\r\n\r\n    const handleDelete=async()=>{\r\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\r\n        \r\n        const dleteId=Inventory._id\r\n        if (conf){\r\n             \r\n        InventoryServ.remove(dleteId)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                reset();\r\n               /*  setMessage(\"Deleted Inventory successfully\")\r\n                setSuccess(true)\r\n                changeState()\r\n               setTimeout(() => {\r\n                setSuccess(false)\r\n                }, 200); */\r\n                toast({\r\n                    message: 'Inventory deleted succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                changeState()\r\n            })\r\n            .catch((err)=>{\r\n               // setMessage(\"Error deleting Inventory, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error deleting Inventory, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n        }\r\n    }\r\n        \r\n\r\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n          })) */\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        \r\n        setSuccess(false)\r\n        console.log(data)\r\n       // data.facility=Inventory.facility\r\n          //console.log(data);\r\n          const contractSel= billservice.contracts.filter(element=>(element.source_org===Inventory.facility && element.dest_org===Inventory.facility))\r\n          contractSel[0].price=data.price \r\n          billServ.patch(billservice._id,billservice)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n               // e.target.reset();\r\n               // setMessage(\"updated Inventory successfully\")\r\n                 toast({\r\n                    message: 'Price updated succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  \r\n                changeState()\r\n\r\n            })\r\n            .catch((err)=>{\r\n                //setMessage(\"Error creating Inventory, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error updating Price, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            }) \r\n\r\n      } \r\n     \r\n      \r\n    return (\r\n        \r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Set Price for {Inventory.name} per {Inventory.baseunit}\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <div className=\"field\">\r\n                    <label className=\"label is-small\"> New Selling Price\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"price\" type=\"text\" placeholder=\"Name\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                    </label>\r\n                    </div>\r\n                <div className=\"field\">\r\n                <label className=\"label is-small\">Old Price\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small \" ref={register({ required: true })} disabled name=\"oldprice\" type=\"text\" placeholder=\"Inventory Type\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n                </label>\r\n                </div>\r\n           \r\n           \r\n           \r\n            </form>\r\n            \r\n            <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n               {/*  <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p> */}\r\n            </div>\r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n                \r\n}   \r\n\r\nexport  function ProductSearch({getSearchfacility,clear}) {\r\n    \r\n    const facilityServ=client.service('products')\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n     const [searchError, setSearchError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [showPanel, setShowPanel] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [searchMessage, setSearchMessage] = useState(\"\") \r\n   // eslint-disable-next-line \r\n   const [simpa,setSimpa]=useState(\"\")\r\n   // eslint-disable-next-line \r\n   const [chosen,setChosen]=useState(false)\r\n   // eslint-disable-next-line \r\n   const [count,setCount]=useState(0)\r\n   const inputEl=useRef(null)\r\n\r\n\r\n   const handleRow= async(obj)=>{\r\n        await setChosen(true)\r\n        //alert(\"something is chaning\")\r\n       getSearchfacility(obj)\r\n       \r\n       await setSimpa(obj.facilityName)\r\n       \r\n        // setSelectedFacility(obj)\r\n        setShowPanel(false)\r\n        await setCount(2)\r\n        /* const    newfacilityModule={\r\n            selectedFacility:facility,\r\n            show :'detail'\r\n        }\r\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\r\n   //console.log(state)\r\n}\r\n    const handleBlur=async(e)=>{\r\n         if (count===2){\r\n             console.log(\"stuff was chosen\")\r\n         }\r\n       \r\n       /*  console.log(\"blur\")\r\n         setShowPanel(false)\r\n        console.log(JSON.stringify(simpa))\r\n        if (simpa===\"\"){\r\n            console.log(facilities.length)\r\n            setSimpa(\"abc\")\r\n            setSimpa(\"\")\r\n            setFacilities([])\r\n            inputEl.current.setValue=\"\"\r\n        }\r\n        console.log(facilities.length)\r\n        console.log(inputEl.current) */\r\n    }\r\n    const handleSearch=async(val)=>{\r\n        \r\n        const field='name' //field variable\r\n       \r\n        if (val.length>=3){\r\n            facilityServ.find({query: {     //service\r\n                 [field]: {\r\n                     $regex:val,\r\n                     $options:'i'\r\n                    \r\n                 },\r\n                 $limit:10,\r\n                 $sort: {\r\n                     createdAt: -1\r\n                   }\r\n                     }}).then((res)=>{\r\n              console.log(\"facility  fetched successfully\") \r\n                setFacilities(res.data)\r\n                 setSearchMessage(\" facility  fetched successfully\")\r\n                 setShowPanel(true)\r\n             })\r\n             .catch((err)=>{\r\n                 console.log(err)\r\n                 setSearchMessage(\"Error searching facility, probable network issues \"+ err )\r\n                 setSearchError(true)\r\n             })\r\n         }\r\n        else{\r\n            console.log(\"less than 3 \")\r\n            console.log(val)\r\n            setShowPanel(false)\r\n            await setFacilities([])\r\n            console.log(facilities)\r\n        }\r\n    }\r\n    useEffect(() => {\r\n       if (clear){\r\n           setSimpa(\"\")\r\n       }\r\n        return () => {\r\n            \r\n        }\r\n    }, [clear] )\r\n    return (\r\n        <div>\r\n            <div className=\"field\">\r\n                <div className=\"control has-icons-left  \">\r\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`}>\r\n                        <div className=\"dropdown-trigger\">\r\n                            <DebounceInput className=\"input is-small \" \r\n                                type=\"text\" placeholder=\"Search Product\"\r\n                                value={simpa}\r\n                                minLength={1}\r\n                                debounceTimeout={400}\r\n                                onBlur={(e)=>handleBlur(e)}\r\n                                onChange={(e)=>handleSearch(e.target.value)}\r\n                                inputRef={inputEl}\r\n                                  />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-search\"></i>\r\n                            </span>\r\n                        </div>\r\n                        {searchError&&<div>{searchMessage}</div>}\r\n                        <div className=\"dropdown-menu\" >\r\n                            <div className=\"dropdown-content\">\r\n                            {facilities.map((facility, i)=>(\r\n                                    \r\n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\r\n                                        \r\n                                        <span>{facility.facilityName}</span>\r\n                                        \r\n                                    </div>\r\n                                    \r\n                                    ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n          \r\n        </div>\r\n    )\r\n}","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\ProductEntry.js",["360","361","362","363","364","365","366"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\nimport {ProductCreate} from './Products'\r\n// eslint-disable-next-line\r\nconst searchfacility={};\r\n\r\n\r\nexport default function ProductEntry() {\r\n    const {state}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedProductEntry,setSelectedProductEntry]=useState()\r\n    //const [showState,setShowState]=useState() //create|modify|detail\r\n    \r\n    return(\r\n        <section className= \"section remPadTop\">\r\n           {/*  <div className=\"level\">\r\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">ProductEntry  Module</span></div>\r\n            </div> */}\r\n            <div className=\"columns \">\r\n            <div className=\"column is-6 \">\r\n                <ProductEntryList />\r\n                </div>\r\n            <div className=\"column is-6 \">\r\n                {(state.ProductEntryModule.show ==='create')&&<ProductEntryCreate />}\r\n                {(state.ProductEntryModule.show ==='detail')&&<ProductEntryDetail  />}\r\n                {(state.ProductEntryModule.show ==='modify')&&<ProductEntryModify ProductEntry={selectedProductEntry} />}\r\n               \r\n            </div>\r\n\r\n            </div>                            \r\n            </section>\r\n       \r\n    )\r\n    \r\n}\r\n\r\nexport function ProductEntryCreate(){\r\n   // const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \r\n    const [error, setError] =useState(false)\r\n    const [success, setSuccess] =useState(false)\r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line\r\n    const [facility,setFacility] = useState()\r\n    const ProductEntryServ=client.service('productentry')\r\n    //const history = useHistory()\r\n    const {user} = useContext(UserContext) //,setUser\r\n    // eslint-disable-next-line\r\n    const [currentUser,setCurrentUser] = useState()\r\n    const [type,setType] = useState(\"Purchase Invoice\")\r\n    const [documentNo,setDocumentNo] = useState(\"\")\r\n    const [totalamount,setTotalamount] = useState(\"\")\r\n    const [productId,setProductId] = useState(\"\")\r\n    const [source,setSource] = useState(\"\")\r\n    const [date,setDate] = useState(\"\")\r\n    const [name,setName] = useState(\"\")\r\n    const [baseunit,setBaseunit] = useState(\"\")\r\n    const [quantity,setQuantity] = useState()\r\n    const [costprice,setCostprice] = useState()\r\n    const [productItem,setProductItem] = useState([])\r\n    const {state}=useContext(ObjectContext)\r\n    \r\n    const [productEntry,setProductEntry]=useState({\r\n        productitems:[],\r\n        date,\r\n        documentNo,\r\n        type,\r\n        totalamount,\r\n        source,\r\n\r\n    })\r\n \r\n    const productItemI={\r\n        productId,\r\n        name,\r\n        quantity,\r\n        costprice,\r\n        amount:quantity*costprice,\r\n        baseunit\r\n\r\n    }\r\n    // consider batchformat{batchno,expirydate,qtty,baseunit}\r\n    //consider baseunoit conversions\r\n    const getSearchfacility=(obj)=>{\r\n\r\n        setProductId(obj._id)\r\n        setName(obj.name)\r\n        setBaseunit(obj.baseunit)\r\n        \r\n       /*  setValue(\"facility\", obj._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        }) */\r\n    }\r\n    \r\n    useEffect(() => {\r\n        setCurrentUser(user)\r\n        //console.log(currentUser)\r\n        return () => {\r\n        \r\n        }\r\n    }, [user])\r\n\r\n    const handleChangeType=async (e)=>{\r\n        await setType(e.target.value)\r\n    }\r\n    const handleClickProd=async()=>{\r\n        await setSuccess(false)\r\n        setProductItem(\r\n            prevProd=>prevProd.concat(productItemI)\r\n        )\r\n        setName(\"\")\r\n        setBaseunit(\"\")\r\n        setQuantity(\"\")\r\n        setCostprice(\"\")\r\n       await setSuccess(true)\r\n       console.log(success)\r\n       console.log(productItem)\r\n    }\r\n  //check user for facility or get list of facility  \r\n   /*  useEffect(()=>{\r\n        //setFacility(user.activeProductEntry.FacilityId)//\r\n      if (!user.stacker){\r\n          console.log(currentUser)\r\n           /* setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })  \r\n\r\n      }\r\n    }) */\r\n\r\n    const resetform=()=>{\r\n     setType(\"Purchase Invoice\")\r\n    setDocumentNo(\"\")\r\n    setTotalamount(\"\")\r\n    setProductId(\"\")\r\n    setSource(\"\")\r\n    setDate(\"\")\r\n    setName(\"\")\r\n    setBaseunit()\r\n    setCostprice()\r\n    setProductItem([])\r\n    }\r\n\r\n    const onSubmit = async(e) =>{\r\n        e.preventDefault();\r\n        setMessage(\"\")\r\n        setError(false)\r\n        setSuccess(false)\r\n        await setProductEntry({\r\n            \r\n            date,\r\n            documentNo,\r\n            type,\r\n            totalamount,\r\n            source,\r\n        })\r\n        productEntry.productitems=productItem\r\n        productEntry.createdby=user._id\r\n        productEntry.transactioncategory=\"credit\"\r\n\r\n          console.log(\"b4 facility\",productEntry);\r\n          if (user.currentEmployee){\r\n         productEntry.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\r\n          }else{\r\n            toast({\r\n                message: 'You can not add inventory to any organization',\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              }) \r\n              return\r\n          }\r\n          if (state.StoreModule.selectedStore._id){\r\n            productEntry.storeId=state.StoreModule.selectedStore._id\r\n          }else{\r\n            toast({\r\n                message: 'You need to select a store before adding inventory',\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              }) \r\n              return\r\n\r\n          }\r\n          console.log(\"b4 create\",productEntry);\r\n        ProductEntryServ.create(productEntry)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                resetform()\r\n               /*  setMessage(\"Created ProductEntry successfully\") */\r\n                setSuccess(true)\r\n                toast({\r\n                    message: 'ProductEntry created succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  setSuccess(false)\r\n                  setProductItem([])\r\n            })\r\n            .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating ProductEntry ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n\r\n    \r\n\r\n    return (\r\n        <>\r\n            <div className=\"card card-overflow\">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Create ProductEntry: Product Entry- Initialization, Purchase Invoice, Audit\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content \">\r\n   \r\n            <form onSubmit={onSubmit}> {/* handleSubmit(onSubmit) */}\r\n            <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n            <div className=\"field\">    \r\n                <div className=\"control\">\r\n                    <div className=\"select is-small\">\r\n                        <select name=\"type\" value={type} onChange={handleChangeType}>\r\n                           <option value=\"\">Choose Type </option>\r\n                            <option value=\"Purchase Invoice\">Purchase Invoice </option>\r\n                            <option value=\"Initialization\">Initialization</option>\r\n                            <option value=\"Audit\">Audit</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input is-small\" /* ref={register({ required: true })} */ value={source} name=\"supplier\" type=\"text\" onChange={e=>setSource(e.target.value)} placeholder=\"Supplier\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                </div>\r\n           \r\n            </div>\r\n            </div> {/* horizontal end */}\r\n           {/*  <div className=\"field\">\r\n                <p className=\"control has-icons-left\"> // Audit/initialization/Purchase Invoice \r\n                    <input className=\"input is-small\"  ref={register({ required: true })} name=\"type\" type=\"text\" placeholder=\"Type of Product Entry\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\" fas fa-user-md \"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n               <div className=\"field is-horizontal\">\r\n               <div className=\"field-body\">\r\n               <div className=\"field\">\r\n                <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small\"  /* ref={register({ required: true })} */ value={date}  name=\"date\" type=\"text\" onChange={e=>setDate(e.target.value)} placeholder=\"Date\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" /* ref={register} */ name=\"documentNo\" value={documentNo} type=\"text\" onChange={e=>setDocumentNo(e.target.value)} placeholder=\" Invoice Number\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" /* ref={register({ required: true })} */ value={totalamount} name=\"totalamount\" type=\"text\" onChange={async e=> await setTotalamount(e.target.value)} placeholder=\" Total Amount\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-coins\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n\r\n                </div> \r\n                </div> \r\n               \r\n                </form>   \r\n               \r\n           \r\n         {/* array of ProductEntry items */}\r\n        \r\n        <label className=\"label is-small\">Add Product Items:</label>\r\n         <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n            <div className=\"field is-expanded\"  /* style={ !user.stacker?{display:\"none\"}:{}} */ >\r\n                    <ProductSearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                    <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                        <input className=\"input is-small\" /* ref={register ({ required: true }) }  *//* add array no */  value={productId} name=\"productId\" type=\"text\" onChange={e=>setProductId(e.target.value)} placeholder=\"Product Id\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas  fa-map-marker-alt\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>\r\n                <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" /* ref={register({ required: true })} */ name=\"quantity\" value={quantity} type=\"text\" onChange={e=>setQuantity(e.target.value)} placeholder=\"Quantity\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n        <label >{baseunit}</label>\r\n            </div> \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" /* ref={register({ required: true })} */ name=\"costprice\" value={costprice} type=\"text\" onChange={e=>setCostprice(e.target.value)} placeholder=\"Cost Price\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-dollar-sign\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> \r\n            <div className=\"field\">\r\n            <p className=\"control\">\r\n                    <button className=\"button is-info is-small  is-pulled-right\">\r\n                      <span className=\"is-small\" onClick={handleClickProd}> +</span>\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            </div>\r\n         </div>\r\n            \r\n       {(productItem.length>0) && <div>\r\n            <label>Product Items:</label>\r\n         <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\r\n                <thead>\r\n                    <tr>\r\n                    <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                    <th><abbr title=\"Type\">Name</abbr></th>\r\n                    <th><abbr title=\"Type\">Quanitity</abbr></th>\r\n                    <th><abbr title=\"Document No\">Unit</abbr></th>\r\n                    <th><abbr title=\"Cost Price\">Cost Price</abbr></th>\r\n                    <th><abbr title=\"Cost Price\">Amount</abbr></th>\r\n                    <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                    </tr>\r\n                </thead>\r\n                <tfoot>\r\n                    \r\n                </tfoot>\r\n                <tbody>\r\n                   { productItem.map((ProductEntry, i)=>(\r\n\r\n                        <tr key={i}>\r\n                        <th>{i+1}</th>\r\n                        <td>{ProductEntry.name}</td>\r\n                        <th>{ProductEntry.quantity}</th>\r\n                        <td>{ProductEntry.baseunit}</td>\r\n                        <td>{ProductEntry.costprice}</td>\r\n                        <td>{ProductEntry.amount}</td>\r\n                        <td><span className=\"showAction\"  >x</span></td>\r\n                        \r\n                        </tr>\r\n\r\n                    ))}\r\n                </tbody>\r\n                </table>\r\n                <div className=\"field mt-2\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" disabled={!productItem.length>0} onClick={onSubmit}>\r\n                        Create\r\n                    </button>\r\n                </p>\r\n                </div>\r\n                </div>\r\n           \r\n            }\r\n            \r\n            \r\n            </div>\r\n            </div>\r\n        </>\r\n    )\r\n   \r\n}\r\n\r\nexport function ProductEntryList(){\r\n   // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const ProductEntryServ=client.service('productentry')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedProductEntry, setSelectedProductEntry]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n    // eslint-disable-next-line\r\n    const {user,setUser}=useContext(UserContext)\r\n\r\n\r\n\r\n    const handleCreateNew = async()=>{\r\n        const    newProductEntryModule={\r\n            selectedProductEntry:{},\r\n            show :'create'\r\n            }\r\n       await setState((prevstate)=>({...prevstate, ProductEntryModule:newProductEntryModule}))\r\n       //console.log(state)\r\n        \r\n\r\n    }\r\n    const handleRow= async(ProductEntry)=>{\r\n        //console.log(\"b4\",state)\r\n\r\n        //console.log(\"handlerow\",ProductEntry)\r\n\r\n        await setSelectedProductEntry(ProductEntry)\r\n\r\n        const    newProductEntryModule={\r\n            selectedProductEntry:ProductEntry,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ProductEntryModule:newProductEntryModule}))\r\n       //console.log(state)\r\n\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='name'\r\n       console.log(val)\r\n       ProductEntryServ.find({query: {\r\n                [field]: {\r\n                    $regex:val,\r\n                    $options:'i'\r\n                   \r\n                },\r\n                storeId:state.StoreModule.selectedStore._id,\r\n               facility:user.currentEmployee.facilityDetail._id || \"\",\r\n                $limit:10,\r\n                $sort: {\r\n                    createdAt: -1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" ProductEntry  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error fetching ProductEntry, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n   \r\n        const getFacilities= async()=>{\r\n            if (user.currentEmployee){\r\n            \r\n        const findProductEntry= await ProductEntryServ.find(\r\n                {query: {\r\n                    facility:user.currentEmployee.facilityDetail._id,\r\n                    storeId:state.StoreModule.selectedStore._id,\r\n                    $limit:20,\r\n                    $sort: {\r\n                        createdAt: -1\r\n                    }\r\n                    }})\r\n\r\n         await setFacilities(findProductEntry.data)\r\n                }\r\n                else {\r\n                    if (user.stacker){\r\n                        /* toast({\r\n                            message: 'You do not qualify to view this',\r\n                            type: 'is-danger',\r\n                            dismissible: true,\r\n                            pauseOnHover: true,\r\n                          }) \r\n                          return */\r\n                        const findProductEntry= await ProductEntryServ.find(\r\n                            {query: {\r\n                                \r\n                                $limit:20,\r\n                                $sort: {\r\n                                    createdAt: -1\r\n                                }\r\n                                }})\r\n            \r\n                    await setFacilities(findProductEntry.data)\r\n\r\n                    }\r\n                }\r\n          /*   .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" ProductEntry  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\r\n                    setError(true)\r\n                }) */\r\n            }\r\n            \r\n            useEffect(() => {\r\n                setTimeout(() => {\r\n                    console.log(\"happy birthday\")\r\n                    //getFacilities(user)\r\n                }, 200);\r\n\r\n                return () => {\r\n                    \r\n\r\n                }\r\n            },[])\r\n\r\n            useEffect(() => {\r\n               \r\n                if (!state.StoreModule.selectedStore){\r\n                    toast({\r\n                        message: 'kindly select a store',\r\n                        type: 'is-danger',\r\n                        dismissible: true,\r\n                        pauseOnHover: true,\r\n                      }) \r\n                      return\r\n                    getFacilities()\r\n\r\n                }else{\r\n                    /* const localUser= localStorage.getItem(\"user\")\r\n                    const user1=JSON.parse(localUser)\r\n                    console.log(localUser)\r\n                    console.log(user1)\r\n                    fetchUser(user1)\r\n                    console.log(user)\r\n                    getFacilities(user) */\r\n                }\r\n                ProductEntryServ.on('created', (obj)=>getFacilities())\r\n                ProductEntryServ.on('updated', (obj)=>getFacilities())\r\n                ProductEntryServ.on('patched', (obj)=>getFacilities())\r\n                ProductEntryServ.on('removed', (obj)=>getFacilities())\r\n                return () => {\r\n                \r\n                }\r\n            },[])\r\n\r\n            useEffect(() => {\r\n                getFacilities()\r\n                console.log(\"store changed\")\r\n                return () => {\r\n                   \r\n                }\r\n            }, [state.StoreModule.selectedStore])\r\n    //todo: pagination and vertical scroll bar\r\n\r\n    return(\r\n        <>\r\n           {state.StoreModule.selectedStore?( <>  \r\n                <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search ProductEntry\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Product Additions to Inventory </span></div>\r\n                    <div className=\"level-right\">\r\n                        <div className=\"level-item\"> \r\n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <div className=\"table-container pullup \">\r\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\r\n                                    <thead>\r\n                                        <tr>\r\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                        <th><abbr title=\"Date\">Date</abbr></th>\r\n                                        <th><abbr title=\"Type\">Type</abbr></th>\r\n                                        <th>Source</th>\r\n                                        <th><abbr title=\"Document No\">Document No</abbr></th>\r\n                                        <th><abbr title=\"Total Amount\">Total Amount</abbr></th>\r\n                                        <th><abbr title=\"Enteredby\">Entered By</abbr></th>\r\n                                        <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tfoot>\r\n                                        \r\n                                    </tfoot>\r\n                                    <tbody>\r\n                                        {facilities.map((ProductEntry, i)=>(\r\n\r\n                                            <tr key={ProductEntry._id} onClick={()=>handleRow(ProductEntry)}>\r\n                                            <th>{i+1}</th>\r\n                                            <td>{ProductEntry.date}</td>\r\n                                            <th>{ProductEntry.type}</th>\r\n                                            <td>{ProductEntry.source}</td>\r\n                                            <td>{ProductEntry.documentNo}</td>\r\n                                            <td>{ProductEntry.totalamount}</td>\r\n                                            <td>{ProductEntry.enteredby}</td>\r\n                                            <td><span className=\"showAction\"  >...</span></td>\r\n                                           \r\n                                            </tr>\r\n\r\n                                        ))}\r\n                                    </tbody>\r\n                                    </table>\r\n                                    \r\n                </div>              \r\n            </>):<div>loading... Choose a Store</div>}\r\n            </>\r\n              \r\n    )\r\n    }\r\n\r\n\r\nexport function ProductEntryDetail(){\r\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\r\n     // eslint-disable-next-line\r\n    const [error, setError] =useState(false) //, \r\n    //const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [message, setMessage] = useState(\"\") //,\r\n    //const ProductEntryServ=client.service('/ProductEntry')\r\n    //const history = useHistory()\r\n    //const {user,setUser} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n   \r\n\r\n   const ProductEntry =state.ProductEntryModule.selectedProductEntry \r\n\r\n    const handleEdit= async()=>{\r\n        const    newProductEntryModule={\r\n            selectedProductEntry:ProductEntry,\r\n            show :'modify'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ProductEntryModule:newProductEntryModule}))\r\n       //console.log(state)\r\n       \r\n    }\r\n \r\n    return (\r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    ProductEntry Details\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n                <table> \r\n                <tbody>         \r\n                <tr>\r\n                    <td>\r\n                      <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Type\r\n                        </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {ProductEntry.type} </span>\r\n                    </td>\r\n                    <td>\r\n\r\n                    </td>\r\n                    <td>\r\n                        <label className=\"label is-small padleft\"><span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-map-signs\"></i>\r\n                        </span>Supplier:\r\n                        </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"ProductEntryType\">{ProductEntry.source} </span> \r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\r\n                        <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Date:\r\n                        </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {ProductEntry.date} </span>\r\n                    </td>\r\n                    <td>\r\n                                \r\n                    </td>\r\n                    <td>\r\n                        <label className=\"label is-small padleft\"><span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-map-signs\"></i>\r\n                        </span>Invoice No:\r\n                        </label>\r\n                    </td>\r\n                    \r\n                    <td>\r\n                         <span className=\"is-size-7 padleft\"   name=\"ProductEntryType\">{ProductEntry.documentNo} </span> \r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\r\n                \r\n                        <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-hospital\"></i>\r\n                    </span>            \r\n                        Total Amount:\r\n                    </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {ProductEntry.totalamount} </span>\r\n                    </td>\r\n                </tr>\r\n\r\n                </tbody> \r\n            </table> \r\n            <label className=\"label is-size-7 mt-2\">Product Items:</label>\r\n         <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\r\n                <thead>\r\n                    <tr>\r\n                    <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                    <th><abbr title=\"Type\">Name</abbr></th>\r\n                    <th><abbr title=\"Type\">Quanitity</abbr></th>\r\n                    <th><abbr title=\"Document No\">Unit</abbr></th>\r\n                    <th><abbr title=\"Cost Price\">Cost Price</abbr></th>\r\n                    <th><abbr title=\"Cost Price\">Amount</abbr></th>\r\n                   \r\n                    </tr>\r\n                </thead>\r\n                <tfoot>\r\n                    \r\n                </tfoot>\r\n                <tbody>\r\n                   { ProductEntry.productitems.map((ProductEntry, i)=>(\r\n\r\n                        <tr key={i}>\r\n                        <th>{i+1}</th>\r\n                        <td>{ProductEntry.name}</td>\r\n                        <th>{ProductEntry.quantity}</th>\r\n                        <td>{ProductEntry.baseunit}</td>\r\n                        <td>{ProductEntry.costprice}</td>\r\n                        <td>{ProductEntry.amount}</td>\r\n                        \r\n                        \r\n                        </tr>\r\n\r\n                    ))}\r\n                </tbody>\r\n                </table>\r\n                  {/*   <tr>\r\n                    <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>Profession: \r\n                \r\n                    \r\n                    </label>\r\n                    </td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"ProductEntryCity\">{ProductEntry.profession}</span> \r\n                </td>\r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>Phone:           \r\n                    \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft \"  name=\"ProductEntryContactPhone\" >{ProductEntry.phone}</span>\r\n                        </td>\r\n                  </tr>\r\n                    <tr><td>\r\n            \r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>Email:                     \r\n                    \r\n                         </label></td><td>\r\n                         <span className=\"is-size-7 padleft \"  name=\"ProductEntryEmail\" >{ProductEntry.email}</span>\r\n                         </td>\r\n             \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i></span>Department:\r\n                    \r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft \"  name=\"ProductEntryOwner\">{ProductEntry.department}</span>\r\n                    </td>\r\n               \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>Departmental Unit:              \r\n                    \r\n                </label></td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"ProductEntryType\">{ProductEntry.deptunit}</span>\r\n                </td>\r\n              \r\n                </tr> */}\r\n                    \r\n          {/*   <div className=\"field\">\r\n             <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>Category:              \r\n                    <span className=\"is-size-7 padleft \"  name= \"ProductEntryCategory\">{ProductEntry.ProductEntryCategory}</span>\r\n                </label>\r\n                 </div> */}\r\n\r\n            \r\n           \r\n           {/*  <div className=\"field mt-2\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\r\n                        Edit\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            { error && <div className=\"message\"> {message}</div>} */}\r\n           \r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n}\r\n\r\nexport function ProductEntryModify(){\r\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\r\n    // eslint-disable-next-line \r\n    const [error, setError] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [success, setSuccess] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line \r\n    const ProductEntryServ=client.service('productentry')\r\n    //const history = useHistory()\r\n     // eslint-disable-next-line\r\n    const {user} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n    const ProductEntry =state.ProductEntryModule.selectedProductEntry \r\n\r\n        useEffect(() => {\r\n            setValue(\"name\", ProductEntry.name,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"ProductEntryType\", ProductEntry.ProductEntryType,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n           /*  setValue(\"profession\", ProductEntry.profession,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"phone\", ProductEntry.phone,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"email\", ProductEntry.email,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"department\", ProductEntry.department,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"deptunit\", ProductEntry.deptunit,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n          /*   setValue(\"ProductEntryCategory\", ProductEntry.ProductEntryCategory,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n            \r\n            return () => {\r\n                \r\n            }\r\n        })\r\n\r\n   const handleCancel=async()=>{\r\n    const    newProductEntryModule={\r\n        selectedProductEntry:{},\r\n        show :'create'\r\n      }\r\n   await setState((prevstate)=>({...prevstate, ProductEntryModule:newProductEntryModule}))\r\n   //console.log(state)\r\n           }\r\n\r\n\r\n        const changeState =()=>{\r\n        const    newProductEntryModule={\r\n            selectedProductEntry:{},\r\n            show :'create'\r\n        }\r\n        setState((prevstate)=>({...prevstate, ProductEntryModule:newProductEntryModule}))\r\n\r\n        }\r\n    const handleDelete=async()=>{\r\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\r\n        \r\n        const dleteId=ProductEntry._id\r\n        if (conf){\r\n             \r\n        ProductEntryServ.remove(dleteId)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                reset();\r\n               /*  setMessage(\"Deleted ProductEntry successfully\")\r\n                setSuccess(true)\r\n                changeState()\r\n               setTimeout(() => {\r\n                setSuccess(false)\r\n                }, 200); */\r\n                toast({\r\n                    message: 'ProductEntry deleted succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                changeState()\r\n            })\r\n            .catch((err)=>{\r\n               // setMessage(\"Error deleting ProductEntry, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error deleting ProductEntry, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n        }\r\n    }\r\n        \r\n\r\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n          })) */\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        \r\n        setSuccess(false)\r\n        console.log(data)\r\n        data.facility=ProductEntry.facility\r\n          //console.log(data);\r\n          \r\n        ProductEntryServ.patch(ProductEntry._id,data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n               // e.target.reset();\r\n               // setMessage(\"updated ProductEntry successfully\")\r\n                 toast({\r\n                    message: 'ProductEntry updated succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  \r\n                changeState()\r\n\r\n            })\r\n            .catch((err)=>{\r\n                //setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error updating ProductEntry, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n     \r\n      \r\n    return (\r\n        \r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    ProductEntry Details-Modify\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <div className=\"field\">\r\n                    <label className=\"label is-small\"> Name\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"name\" type=\"text\" placeholder=\"Name\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                    </label>\r\n                    </div>\r\n                <div className=\"field\">\r\n                <label className=\"label is-small\">ProductEntry Type\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small \" ref={register({ required: true })} disabled name=\"ProductEntryType\" type=\"text\" placeholder=\"ProductEntry Type\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n                </label>\r\n                </div>\r\n            {/* <div className=\"field\">\r\n            <label className=\"label is-small\">Profession\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"profession\" type=\"text\" placeholder=\"Profession\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Phone\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"phone\" type=\"text\" placeholder=\"Phone No\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                 </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Email\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"email\" type=\"email\" placeholder=\"ProductEntry Email\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Department\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                {errors.department && <span>This field is required</span>}\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Departmental Unit\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Departmental Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div> */}\r\n           {/*  <div className=\"field\">\r\n            <label className=\"label is-small\">Category\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"ProductEntryCategory\" type=\"text\" placeholder=\"ProductEntry Category\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n            </div> */}\r\n           \r\n           \r\n            </form>\r\n            \r\n            <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p>\r\n            </div>\r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n                \r\n}   \r\n\r\nexport  function ProductSearch({getSearchfacility,clear}) {\r\n    \r\n    const productServ=client.service('products')\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n     const [searchError, setSearchError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [showPanel, setShowPanel] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [searchMessage, setSearchMessage] = useState(\"\") \r\n   // eslint-disable-next-line \r\n   const [simpa,setSimpa]=useState(\"\")\r\n   // eslint-disable-next-line \r\n   const [chosen,setChosen]=useState(false)\r\n   // eslint-disable-next-line \r\n   const [count,setCount]=useState(0)\r\n   const inputEl=useRef(null)\r\n   const [val,setVal]=useState(\"\")\r\n    const [productModal,setProductModal]=useState(false)\r\n\r\n   const handleRow= async(obj)=>{\r\n        await setChosen(true)\r\n        //alert(\"something is chaning\")\r\n       getSearchfacility(obj)\r\n       \r\n       await setSimpa(obj.name)\r\n       \r\n        // setSelectedFacility(obj)\r\n        setShowPanel(false)\r\n        await setCount(2)\r\n        /* const    newfacilityModule={\r\n            selectedFacility:facility,\r\n            show :'detail'\r\n        }\r\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\r\n   //console.log(state)\r\n}\r\n    const handleBlur=async(e)=>{\r\n         if (count===2){\r\n             console.log(\"stuff was chosen\")\r\n         }\r\n       \r\n       /*  console.log(\"blur\")\r\n         setShowPanel(false)\r\n        console.log(JSON.stringify(simpa))\r\n        if (simpa===\"\"){\r\n            console.log(facilities.length)\r\n            setSimpa(\"abc\")\r\n            setSimpa(\"\")\r\n            setFacilities([])\r\n            inputEl.current.setValue=\"\"\r\n        }\r\n        console.log(facilities.length)\r\n        console.log(inputEl.current) */\r\n    }\r\n    const handleSearch=async(value)=>{\r\n        setVal(value)\r\n        if (value===\"\"){\r\n            setShowPanel(false)\r\n            return\r\n        }\r\n        const field='name' //field variable\r\n\r\n       \r\n        if (value.length>=3 ){\r\n            productServ.find({query: {     //service\r\n                 [field]: {\r\n                     $regex:value,\r\n                     $options:'i'\r\n                    \r\n                 },\r\n                 $limit:10,\r\n                 $sort: {\r\n                     createdAt: -1\r\n                   }\r\n                     }}).then((res)=>{\r\n              console.log(\"product  fetched successfully\") \r\n              console.log(res.data) \r\n                setFacilities(res.data)\r\n                 setSearchMessage(\" product  fetched successfully\")\r\n                 setShowPanel(true)\r\n             })\r\n             .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating ProductEntry ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n             })\r\n         }\r\n        else{\r\n            console.log(\"less than 3 \")\r\n            console.log(val)\r\n            setShowPanel(false)\r\n            await setFacilities([])\r\n            console.log(facilities)\r\n        }\r\n    }\r\n\r\n    const handleAddproduct =()=>{\r\n        setProductModal(true) \r\n    }\r\n    const handlecloseModal =()=>{\r\n        setProductModal(false)\r\n        handleSearch(val)\r\n    }\r\n    useEffect(() => {\r\n       if (clear){\r\n           console.log(\"success has changed\",clear)\r\n           setSimpa(\"\")\r\n       }\r\n        return () => {\r\n            \r\n        }\r\n    }, [clear] )\r\n    return (\r\n        <div>\r\n            <div className=\"field\">\r\n                <div className=\"control has-icons-left  \">\r\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`}>\r\n                        <div className=\"dropdown-trigger\">\r\n                            <DebounceInput className=\"input is-small \" \r\n                                type=\"text\" placeholder=\"Search Product\"\r\n                                value={simpa}\r\n                                minLength={3}\r\n                                debounceTimeout={400}\r\n                                onBlur={(e)=>handleBlur(e)}\r\n                                onChange={(e)=>handleSearch(e.target.value)}\r\n                                inputRef={inputEl}\r\n                                  />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-search\"></i>\r\n                            </span>\r\n                        </div>\r\n                        {/* {searchError&&<div>{searchMessage}</div>} */}\r\n                        <div className=\"dropdown-menu\" >\r\n                            <div className=\"dropdown-content\">\r\n                          { facilities.length>0?\"\":<div className=\"dropdown-item\" onClick={handleAddproduct}> <span>Add {val} to product list</span> </div>}\r\n\r\n                              {facilities.map((facility, i)=>(\r\n                                    \r\n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\r\n                                        \r\n                                        <span>{facility.name}</span>\r\n                                        \r\n                                    </div>\r\n                                    \r\n                                    ))}\r\n                                    \r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className={`modal ${productModal?\"is-active\":\"\"}` }>\r\n                                    <div className=\"modal-background\"></div>\r\n                                    <div className=\"modal-card\">\r\n                                        <header className=\"modal-card-head\">\r\n                                        <p className=\"modal-card-title\">Choose Store</p>\r\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={handlecloseModal}></button>\r\n                                        </header>\r\n                                        <section className=\"modal-card-body\">\r\n                                        {/* <StoreList standalone=\"true\" /> */}\r\n                                        <ProductCreate />\r\n                                        </section>\r\n                                        {/* <footer className=\"modal-card-foot\">\r\n                                        <button className=\"button is-success\">Save changes</button>\r\n                                        <button className=\"button\">Cancel</button>\r\n                                        </footer> */}\r\n                                    </div>\r\n                                </div>       \r\n        </div>\r\n    )\r\n}","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\ProductExit.js",["367","368","369","370","371","372","373","374","375","376","377","378","379"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\nimport {ProductCreate} from './Products'\r\nvar random = require('random-string-generator');\r\n// eslint-disable-next-line\r\nconst searchfacility={};\r\n\r\n\r\nexport default function ProductEntry() {\r\n    const {state}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedProductEntry,setSelectedProductEntry]=useState()\r\n    //const [showState,setShowState]=useState() //create|modify|detail\r\n    \r\n    return(\r\n        <section className= \"section remPadTop\">\r\n           {/*  <div className=\"level\">\r\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">ProductEntry  Module</span></div>\r\n            </div> */}\r\n            <div className=\"columns \">\r\n            <div className=\"column is-6 \">\r\n                <ProductExitList />\r\n                </div>\r\n            <div className=\"column is-6 \">\r\n                {(state.ProductExitModule.show ==='create')&&<ProductExitCreate />}\r\n                {(state.ProductExitModule.show ==='detail')&&<ProductExitDetail  />}\r\n                {(state.ProductExitModule.show ==='modify')&&<ProductExitModify ProductEntry={selectedProductEntry} />}\r\n               \r\n            </div>\r\n\r\n            </div>                            \r\n            </section>\r\n       \r\n    )\r\n    \r\n}\r\n\r\nexport function ProductExitCreate(){\r\n   // const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \r\n    const [error, setError] =useState(false)\r\n    const [success, setSuccess] =useState(false)\r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line\r\n    const [facility,setFacility] = useState()\r\n    const ProductEntryServ=client.service('productentry')\r\n    //const history = useHistory()\r\n    const {user} = useContext(UserContext) //,setUser\r\n    // eslint-disable-next-line\r\n    const [currentUser,setCurrentUser] = useState()\r\n    const [type,setType] = useState(\"Sales\")\r\n    const [documentNo,setDocumentNo] = useState(\"\")\r\n    const [totalamount,setTotalamount] = useState(0)\r\n    const [qamount,setQAmount] = useState(null)\r\n    const [productId,setProductId] = useState(\"\")\r\n    const [source,setSource] = useState(\"\")\r\n    const [date,setDate] = useState(\"\")\r\n    const [name,setName] = useState(\"\")\r\n    const [inventoryId,setInventoryId] = useState(\"\")\r\n    const [baseunit,setBaseunit] = useState(\"\")\r\n    const [quantity,setQuantity] = useState(\"\")\r\n    const [sellingprice,setSellingPrice] = useState(\"\")\r\n    const [costprice,setCostprice] = useState(0)\r\n    const [invquantity,setInvQuantity] = useState(\"\")\r\n    const [calcamount,setCalcAmount] = useState(0)\r\n    const [productItem,setProductItem] = useState([])\r\n    const [billingId,setBilllingId]=useState(\"\")  \r\n    const [changeAmount, setChangeAmount] = useState(true)\r\n    const {state}=useContext(ObjectContext)\r\n    const inputEl = useRef(0);\r\n    let calcamount1\r\n    let hidestatus\r\n    const [productEntry,setProductEntry]=useState({\r\n        productitems:[],\r\n        date,\r\n        documentNo,\r\n        type,\r\n        totalamount,\r\n        source,\r\n\r\n    })\r\n \r\n    const productItemI={\r\n        productId,\r\n        name,\r\n        quantity,\r\n        sellingprice,\r\n        amount:calcamount, //qamount||\r\n        baseunit,\r\n        costprice,\r\n        billingId\r\n\r\n    }\r\n    // consider batchformat{batchno,expirydate,qtty,baseunit}\r\n    //consider baseunoit conversions\r\n    const getSearchfacility=(obj)=>{\r\n\r\n        setProductId(obj.productId)\r\n        setName(obj.name)\r\n        setBaseunit(obj.baseunit)\r\n        setInventoryId(obj.inventoryId)\r\n        setSellingPrice(obj.sellingprice)\r\n        setInvQuantity(obj.quantity)\r\n        setCostprice(obj.costprice)\r\n        setBilllingId(obj.billingId)\r\n        if (!obj){\r\n            //\"clear stuff\"\r\n            setProductId(\"\")\r\n            setName(\"\")\r\n            setBaseunit(\"\")\r\n            setInventoryId(\"\")\r\n            setSellingPrice(\"\")\r\n            setInvQuantity(\"\")\r\n            setQAmount(null)\r\n            setCostprice(\"\")\r\n           // setCalcAmount(null)\r\n\r\n        }\r\n        \r\n       /*  setValue(\"facility\", obj._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        }) */\r\n    }\r\n    \r\n    useEffect(() => {\r\n        setCurrentUser(user)\r\n        //console.log(currentUser)\r\n        return () => {\r\n        \r\n        }\r\n    }, [user])\r\n\r\n    const handleUpdateTotal=()=>{\r\n\r\n        \r\n        setTotalamount(prevtotal=>Number(prevtotal) + Number(calcamount))\r\n    }\r\n\r\n    const handleChangeType=async (e)=>{\r\n        await setType(e.target.value)\r\n    }\r\n\r\n    const handleAmount= async()=>{\r\n        await setQAmount(null)\r\n       // alert(\"Iam chaning qamount\")\r\n    }\r\n    const handleClickProd=async()=>{\r\n        console.log(\"amount: \",productItemI.amount)\r\n        console.log(\"qamount: \",qamount)\r\n        console.log(\"calcamount: \",calcamount)\r\n\r\n        if ( quantity===0||quantity===\"\"|| productId===\"\"){\r\n            toast({\r\n                message: 'You need to choose a product and quantity to proceed',\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              }) \r\n              return \r\n        }\r\n\r\n        await setSuccess(false)\r\n        await setProductItem(\r\n            prevProd=>prevProd.concat(productItemI)\r\n        )\r\n       handleUpdateTotal()\r\n        setName(\"\")\r\n        setBaseunit(\"\")\r\n        setQuantity(\"\")\r\n        setInventoryId(\"\")\r\n        setSellingPrice(\"\")\r\n        setInvQuantity(\"\")\r\n            handleAmount()\r\n       // setCalcAmount(null)\r\n       await setSuccess(true)\r\n      /*  console.log(success)\r\n       console.log(qamount)\r\n       console.log(productItem) */\r\n       setChangeAmount(true)\r\n    }\r\n  //check user for facility or get list of facility  \r\n   /*  useEffect(()=>{\r\n        //setFacility(user.activeProductEntry.FacilityId)//\r\n      if (!user.stacker){\r\n          console.log(currentUser)\r\n           /* setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })  \r\n\r\n      }\r\n    }) */\r\n\r\n    const handleQtty=async(e)=>{\r\n        if (invquantity<e.target.value){\r\n            toast({\r\n                message: 'You can not sell more quantity than exist in inventory ' ,\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              })\r\n            return\r\n        }\r\n        setQuantity(e.target.value)\r\n        calcamount1=quantity*sellingprice\r\n        await setCalcAmount(calcamount1)\r\n        console.log(calcamount)\r\n\r\n       \r\n\r\n    }\r\n\r\n    useEffect( () => {\r\n         setProductEntry({\r\n            \r\n            date,\r\n            documentNo,\r\n            type,\r\n            totalamount,\r\n            source,\r\n        })\r\n       setCalcAmount(quantity*sellingprice) \r\n        return () => {\r\n            \r\n        }\r\n    },[date])\r\n\r\n    const resetform=()=>{\r\n     setType(\"Sales\")\r\n    setDocumentNo(\"\")\r\n    setTotalamount(\"\")\r\n    setProductId(\"\")\r\n    setSource(\"\")\r\n    setDate(\"\")\r\n    setName(\"\")\r\n    setBaseunit()\r\n    setCostprice()\r\n    setProductItem([])\r\n    }\r\n\r\n    const onSubmit = async(e) =>{\r\n        e.preventDefault();\r\n        setMessage(\"\")\r\n        setError(false)\r\n        setSuccess(false)\r\n        await setProductEntry({\r\n            \r\n            date,\r\n            documentNo,\r\n            type,\r\n            totalamount,\r\n            source,\r\n        })\r\n        productEntry.productitems=productItem\r\n        productEntry.createdby=user._id\r\n        productEntry.transactioncategory=\"debit\"\r\n       \r\n          console.log(\"b4 facility\",productEntry);\r\n          if (user.currentEmployee){\r\n         productEntry.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\r\n          }else{\r\n            toast({\r\n                message: 'You can not remove inventory from any organization',\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              }) \r\n              return\r\n          }\r\n          if (state.StoreModule.selectedStore._id){\r\n            productEntry.storeId=state.StoreModule.selectedStore._id\r\n          }else{\r\n            toast({\r\n                message: 'You need to select a store before removing inventory',\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              }) \r\n              return\r\n\r\n          }\r\n          console.log(\"b4 create\",productEntry);\r\n        ProductEntryServ.create(productEntry)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                resetform()\r\n               /*  setMessage(\"Created ProductEntry successfully\") */\r\n                setSuccess(true)\r\n                toast({\r\n                    message: 'ProductExit created succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  setSuccess(false)\r\n                  setProductItem([])\r\n                  const today=new Date().toLocaleString()\r\n      \r\n                  setDate(today)\r\n                  const invoiceNo=random(6,'uppernumeric')\r\n                setDocumentNo(invoiceNo)\r\n                setType(\"Sales\")\r\n            })\r\n            .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating ProductExit ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n\r\n      const handleChangeAmount=()=>{\r\n        setChangeAmount((rev)=>(!rev))\r\n        \r\n    }\r\n   // console.log(\"i am rendering\")\r\n\r\n    useEffect(() => {\r\n        const today=new Date().toLocaleString()\r\n        console.log(today)\r\n        setDate(today)\r\n        const invoiceNo=random(6,'uppernumeric')\r\n        setDocumentNo(invoiceNo)\r\n        return () => {\r\n            \r\n        }\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        calcamount1=quantity*sellingprice\r\n         setCalcAmount(calcamount1)\r\n         console.log(calcamount)\r\n         setChangeAmount(true)\r\n        return () => {\r\n            \r\n        }\r\n    }, [quantity])\r\n\r\n    return (\r\n        <>\r\n            <div className=\"card card-overflow\">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Create Product Exit: Product Exit- Sales, Dispense, Audit, Transfer out\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content \">\r\n   \r\n            <form onSubmit={onSubmit}> {/* handleSubmit(onSubmit) */}\r\n            <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n            <div className=\"field\">    \r\n                <div className=\"control\">\r\n                    <div className=\"select is-small\">\r\n                        <select name=\"type\" value={type} onChange={handleChangeType} className=\"selectadd\">\r\n                           <option value=\"\">Choose Type </option>\r\n                            <option value=\"Sales\">Sales </option>\r\n                            <option value=\"In-house\">In-House </option>\r\n                            <option value=\"Dispense\">Dispense</option>\r\n                            <option value=\"Audit\">Audit</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input is-small\" /* ref={register({ required: true })} */ value={source} name=\"client\" type=\"text\" onChange={e=>setSource(e.target.value)} placeholder=\"Client\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                </div>\r\n           \r\n            </div>\r\n            </div> {/* horizontal end */}\r\n           {/*  <div className=\"field\">\r\n                <p className=\"control has-icons-left\"> // Audit/initialization/Purchase Invoice \r\n                    <input className=\"input is-small\"  ref={register({ required: true })} name=\"type\" type=\"text\" placeholder=\"Type of Product Entry\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\" fas fa-user-md \"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n               <div className=\"field is-horizontal\">\r\n               <div className=\"field-body\">\r\n               <div className=\"field\">\r\n                <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small\"  /* ref={register({ required: true })} */ value={date}  name=\"date\" type=\"text\" onChange={e=>setDate(e.target.value)} placeholder=\"Date\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" /* ref={register} */ name=\"documentNo\" value={documentNo} type=\"text\" onChange={e=>setDocumentNo(e.target.value)} placeholder=\" Invoice Number\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" /* ref={register({ required: true })} */ value={totalamount} name=\"totalamount\" type=\"text\" onChange={e=>setTotalamount(e.target.value)} placeholder=\" Total Amount\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-coins\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n\r\n                </div> \r\n                </div> \r\n               \r\n                </form>   \r\n               \r\n           \r\n         {/* array of ProductEntry items */}\r\n        \r\n        <label className=\"label is-small\">Add Product Items:</label>\r\n         <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n            <div className=\"field is-expanded\"  /* style={ !user.stacker?{display:\"none\"}:{}} */ >\r\n                    <InventorySearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                    <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                        <input className=\"input is-small\" /* ref={register ({ required: true }) }  *//* add array no */  value={productId} name=\"productId\" type=\"text\" onChange={e=>setProductId(e.target.value)} placeholder=\"Product Id\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas  fa-map-marker-alt\"></i>\r\n                        </span>\r\n                    </p>\r\n                 {sellingprice &&   \"N\"}{sellingprice} {sellingprice &&   \"per\"}  {baseunit} {invquantity} {sellingprice &&   \"remaining\"} \r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\" >\r\n                <div className=\"field\" style={{width:\"40%\"}}>\r\n                <p className=\"control has-icons-left\" >\r\n                    <input className=\"input is-small\"  /* ref={register({ required: true })} */ name=\"quantity\" value={quantity} type=\"text\" onChange={ e=> handleQtty(e)} placeholder=\"Quantity\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hashtag\"></i>\r\n                    </span>\r\n                   \r\n                </p>\r\n        <label >{baseunit}</label>\r\n            </div> \r\n            <div className=\"field\">\r\n            <label>Amount:</label>{/* <p>{quantity*sellingprice}</p> */}\r\n            </div>\r\n            <div className=\"field\" style={{width:\"40%\"}}>\r\n                <p className=\"control has-icons-left \" /* style={{display:\"none\"}} */>\r\n                    <input className=\"input is-small\" name=\"qamount\" disabled={changeAmount} value={calcamount} type=\"text\"  onChange={async e=> await setCalcAmount(e.target.value)}  placeholder=\"Amount\"   />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-dollar-sign\"></i>\r\n                    </span>\r\n                </p>\r\n                <button className=\"button is-small is-success btnheight\" onClick={handleChangeAmount}>Adjust</button>\r\n            </div> \r\n            <div className=\"field\">\r\n            <p className=\"control\">\r\n                    <button className=\"button is-info is-small  is-pulled-right\">\r\n                      <span className=\"is-small\" onClick={handleClickProd}> +</span>\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            </div>\r\n         </div>\r\n            \r\n       {(productItem.length>0) && <div>\r\n            <label>Product Items:</label>\r\n         <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\r\n                <thead>\r\n                    <tr>\r\n                    <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                    <th><abbr title=\"Type\">Name</abbr></th>\r\n                    <th><abbr title=\"Type\">Quanitity</abbr></th>\r\n                    <th><abbr title=\"Document No\">Unit</abbr></th>\r\n                    <th><abbr title=\"Cost Price\">Selling Price</abbr></th>\r\n                    <th><abbr title=\"Cost Price\">Amount</abbr></th>\r\n                    <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                    </tr>\r\n                </thead>\r\n                <tfoot>\r\n                    \r\n                </tfoot>\r\n                <tbody>\r\n                   { productItem.map((ProductEntry, i)=>(\r\n\r\n                        <tr key={i}>\r\n                        <th>{i+1}</th>\r\n                        <td>{ProductEntry.name}</td>\r\n                        <th>{ProductEntry.quantity}</th>\r\n                        <td>{ProductEntry.baseunit}</td>\r\n                        <td>{ProductEntry.sellingprice}</td>\r\n                        <td>{ProductEntry.amount}</td>\r\n                        <td><span className=\"showAction\"  >x</span></td>\r\n                        \r\n                        </tr>\r\n\r\n                    ))}\r\n                </tbody>\r\n                </table>\r\n                <div className=\"field mt-2 is-grouped\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" disabled={!productItem.length>0} onClick={onSubmit}>\r\n                        Sell\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" disabled={!productItem.length>0} /* onClick={onSubmit} */>\r\n                        Clear\r\n                    </button>\r\n                </p>\r\n                </div>\r\n                </div>\r\n           \r\n            }\r\n            \r\n            \r\n            </div>\r\n            </div>\r\n        </>\r\n    )\r\n   \r\n}\r\n\r\nexport function ProductExitList(){\r\n   // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const ProductEntryServ=client.service('productentry')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedProductEntry, setSelectedProductEntry]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n    // eslint-disable-next-line\r\n    const {user,setUser}=useContext(UserContext)\r\n\r\n\r\n\r\n    const handleCreateNew = async()=>{\r\n        const    newProductExitModule={\r\n            selectedProductEntry:{},\r\n            show :'create'\r\n            }\r\n       await setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n       //console.log(state)\r\n        \r\n\r\n    }\r\n    const handleRow= async(ProductEntry)=>{\r\n        //console.log(\"b4\",state)\r\n\r\n        //console.log(\"handlerow\",ProductEntry)\r\n\r\n        await setSelectedProductEntry(ProductEntry)\r\n\r\n        const    newProductExitModule={\r\n            selectedProductEntry:ProductEntry,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n       //console.log(state)\r\n\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='name'\r\n       console.log(val)\r\n       ProductEntryServ.find({query: {\r\n                [field]: {\r\n                    $regex:val,\r\n                    $options:'i'\r\n                   \r\n                },\r\n                transactioncategory:\"debit\",\r\n                storeId:state.StoreModule.selectedStore._id,\r\n               facility:user.currentEmployee.facilityDetail._id || \"\",\r\n                $limit:10,\r\n                $sort: {\r\n                    createdAt: -1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" ProductEntry  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error fetching ProductEntry, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n   \r\n        const getFacilities= async()=>{\r\n            if (user.currentEmployee){\r\n            \r\n        const findProductEntry= await ProductEntryServ.find(\r\n                {query: {\r\n                    transactioncategory:\"debit\",\r\n                    facility:user.currentEmployee.facilityDetail._id,\r\n                    storeId:state.StoreModule.selectedStore._id,\r\n                    $limit:20,\r\n                    $sort: {\r\n                        createdAt: -1\r\n                    }\r\n                    }})\r\n\r\n         await setFacilities(findProductEntry.data)\r\n                }\r\n                else {\r\n                    if (user.stacker){\r\n                        /* toast({\r\n                            message: 'You do not qualify to view this',\r\n                            type: 'is-danger',\r\n                            dismissible: true,\r\n                            pauseOnHover: true,\r\n                          }) \r\n                          return */\r\n                        const findProductEntry= await ProductEntryServ.find(\r\n                            {query: {\r\n                                transactioncategory:\"debit\",\r\n                                $limit:20,\r\n                                $sort: {\r\n                                    createdAt: -1\r\n                                }\r\n                                }})\r\n            \r\n                    await setFacilities(findProductEntry.data)\r\n\r\n                    }\r\n                }\r\n          /*   .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" ProductEntry  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\r\n                    setError(true)\r\n                }) */\r\n            }\r\n            \r\n         /*    useEffect(() => {\r\n                setTimeout(() => {\r\n                    console.log(\"happy birthday\")\r\n                    //getFacilities(user)\r\n                }, 200);\r\n\r\n                return () => {\r\n                    \r\n\r\n                }\r\n            },[]) */\r\n\r\n            useEffect(() => {\r\n               \r\n                if (!state.StoreModule.selectedStore){\r\n                    toast({\r\n                        message: 'kindly select a store',\r\n                        type: 'is-danger',\r\n                        dismissible: true,\r\n                        pauseOnHover: true,\r\n                      }) \r\n                      return\r\n                    getFacilities()\r\n\r\n                }else{\r\n                    /* const localUser= localStorage.getItem(\"user\")\r\n                    const user1=JSON.parse(localUser)\r\n                    console.log(localUser)\r\n                    console.log(user1)\r\n                    fetchUser(user1)\r\n                    console.log(user)\r\n                    getFacilities(user) */\r\n                }\r\n                ProductEntryServ.on('created', (obj)=>getFacilities())\r\n                ProductEntryServ.on('updated', (obj)=>getFacilities())\r\n                ProductEntryServ.on('patched', (obj)=>getFacilities())\r\n                ProductEntryServ.on('removed', (obj)=>getFacilities())\r\n                return () => {\r\n                \r\n                }\r\n            },[])\r\n\r\n            useEffect(() => {\r\n                getFacilities()\r\n                console.log(\"store changed\")\r\n                return () => {\r\n                   \r\n                }\r\n            }, [state.StoreModule.selectedStore])\r\n    //todo: pagination and vertical scroll bar\r\n\r\n    return(\r\n        <>\r\n           {state.StoreModule.selectedStore?( <>  \r\n                <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search ProductEntry\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Product Exits </span></div>\r\n                    <div className=\"level-right\">\r\n                        <div className=\"level-item\"> \r\n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <div className=\"table-container pullup \">\r\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\r\n                                    <thead>\r\n                                        <tr>\r\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                        <th><abbr title=\"Date\">Date</abbr></th>\r\n                                        <th><abbr title=\"Type\">Type</abbr></th>\r\n                                        <th>Client</th>\r\n                                        <th><abbr title=\"Document No\">Document No</abbr></th>\r\n                                        <th><abbr title=\"Total Amount\">Total Amount</abbr></th>\r\n                                        <th><abbr title=\"Enteredby\">Entered By</abbr></th>\r\n                                        <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tfoot>\r\n                                        \r\n                                    </tfoot>\r\n                                    <tbody>\r\n                                        {facilities.map((ProductEntry, i)=>(\r\n\r\n                                            <tr key={ProductEntry._id} onClick={()=>handleRow(ProductEntry)}>\r\n                                            <th>{i+1}</th>\r\n                                            <td>{ProductEntry.date}</td>\r\n                                            <th>{ProductEntry.type}</th>\r\n                                            <td>{ProductEntry.source}</td>\r\n                                            <td>{ProductEntry.documentNo}</td>\r\n                                            <td>{ProductEntry.totalamount}</td>\r\n                                            <td>{ProductEntry.enteredby}</td>\r\n                                            <td><span className=\"showAction\"  >...</span></td>\r\n                                           \r\n                                            </tr>\r\n\r\n                                        ))}\r\n                                    </tbody>\r\n                                    </table>\r\n                                    \r\n                </div>              \r\n            </>):<div>loading... Choose a Store</div>}\r\n            </>\r\n              \r\n    )\r\n    }\r\n\r\n\r\nexport function ProductExitDetail(){\r\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\r\n     // eslint-disable-next-line\r\n    const [error, setError] =useState(false) //, \r\n    //const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [message, setMessage] = useState(\"\") //,\r\n    //const ProductEntryServ=client.service('/ProductEntry')\r\n    //const history = useHistory()\r\n    //const {user,setUser} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n   \r\n\r\n   const ProductEntry =state.ProductExitModule.selectedProductEntry \r\n\r\n    const handleEdit= async()=>{\r\n        const    newProductExitModule={\r\n            selectedProductEntry:ProductEntry,\r\n            show :'modify'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n       //console.log(state)\r\n       \r\n    }\r\n \r\n    return (\r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    ProductEntry Details\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n                <table> \r\n                <tbody>         \r\n                <tr>\r\n                    <td>\r\n                      <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Type\r\n                        </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {ProductEntry.type} </span>\r\n                    </td>\r\n                    <td>\r\n\r\n                    </td>\r\n                    <td>\r\n                        <label className=\"label is-small padleft\"><span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-map-signs\"></i>\r\n                        </span>Supplier:\r\n                        </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"ProductEntryType\">{ProductEntry.source} </span> \r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\r\n                        <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Date:\r\n                        </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {ProductEntry.date} </span>\r\n                    </td>\r\n                    <td>\r\n                                \r\n                    </td>\r\n                    <td>\r\n                        <label className=\"label is-small padleft\"><span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-map-signs\"></i>\r\n                        </span>Invoice No:\r\n                        </label>\r\n                    </td>\r\n                    \r\n                    <td>\r\n                         <span className=\"is-size-7 padleft\"   name=\"ProductEntryType\">{ProductEntry.documentNo} </span> \r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\r\n                \r\n                        <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-hospital\"></i>\r\n                    </span>            \r\n                        Total Amount:\r\n                    </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {ProductEntry.totalamount} </span>\r\n                    </td>\r\n                </tr>\r\n\r\n                </tbody> \r\n            </table> \r\n            <label className=\"label is-size-7 mt-2\">Product Items:</label>\r\n         <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\r\n                <thead>\r\n                    <tr>\r\n                    <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                    <th><abbr title=\"Type\">Name</abbr></th>\r\n                    <th><abbr title=\"Type\">Quanitity</abbr></th>\r\n                    <th><abbr title=\"Document No\">Unit</abbr></th>\r\n                    <th><abbr title=\"Selling Price\">Selling Price</abbr></th>\r\n                    <th><abbr title=\"Amount\">Amount</abbr></th>\r\n                   \r\n                    </tr>\r\n                </thead>\r\n                <tfoot>\r\n                    \r\n                </tfoot>\r\n                <tbody>\r\n                   { ProductEntry.productitems.map((ProductEntry, i)=>(\r\n\r\n                        <tr key={i}>\r\n                        <th>{i+1}</th>\r\n                        <td>{ProductEntry.name}</td>\r\n                        <th>{ProductEntry.quantity}</th>\r\n                        <td>{ProductEntry.baseunit}</td>\r\n                        <td>{ProductEntry.sellingprice}</td>\r\n                        <td>{ProductEntry.amount}</td>\r\n                        \r\n                        \r\n                        </tr>\r\n\r\n                    ))}\r\n                </tbody>\r\n                </table>\r\n                  {/*   <tr>\r\n                    <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>Profession: \r\n                \r\n                    \r\n                    </label>\r\n                    </td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"ProductEntryCity\">{ProductEntry.profession}</span> \r\n                </td>\r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>Phone:           \r\n                    \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft \"  name=\"ProductEntryContactPhone\" >{ProductEntry.phone}</span>\r\n                        </td>\r\n                  </tr>\r\n                    <tr><td>\r\n            \r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>Email:                     \r\n                    \r\n                         </label></td><td>\r\n                         <span className=\"is-size-7 padleft \"  name=\"ProductEntryEmail\" >{ProductEntry.email}</span>\r\n                         </td>\r\n             \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i></span>Department:\r\n                    \r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft \"  name=\"ProductEntryOwner\">{ProductEntry.department}</span>\r\n                    </td>\r\n               \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>Departmental Unit:              \r\n                    \r\n                </label></td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"ProductEntryType\">{ProductEntry.deptunit}</span>\r\n                </td>\r\n              \r\n                </tr> */}\r\n                    \r\n          {/*   <div className=\"field\">\r\n             <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>Category:              \r\n                    <span className=\"is-size-7 padleft \"  name= \"ProductEntryCategory\">{ProductEntry.ProductEntryCategory}</span>\r\n                </label>\r\n                 </div> */}\r\n\r\n            \r\n           \r\n           {/*  <div className=\"field mt-2\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\r\n                        Edit\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            { error && <div className=\"message\"> {message}</div>} */}\r\n           \r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n}\r\n\r\nexport function ProductExitModify(){\r\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\r\n    // eslint-disable-next-line \r\n    const [error, setError] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [success, setSuccess] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line \r\n    const ProductEntryServ=client.service('productentry')\r\n    //const history = useHistory()\r\n     // eslint-disable-next-line\r\n    const {user} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n    const ProductEntry =state.ProductExitModule.selectedProductEntry \r\n\r\n        useEffect(() => {\r\n            setValue(\"name\", ProductEntry.name,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"ProductEntryType\", ProductEntry.ProductEntryType,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n           /*  setValue(\"profession\", ProductEntry.profession,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"phone\", ProductEntry.phone,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"email\", ProductEntry.email,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"department\", ProductEntry.department,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"deptunit\", ProductEntry.deptunit,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n          /*   setValue(\"ProductEntryCategory\", ProductEntry.ProductEntryCategory,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n            \r\n            return () => {\r\n                \r\n            }\r\n        })\r\n\r\n   const handleCancel=async()=>{\r\n    const    newProductExitModule={\r\n        selectedProductEntry:{},\r\n        show :'create'\r\n      }\r\n   await setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n   //console.log(state)\r\n           }\r\n\r\n\r\n        const changeState =()=>{\r\n        const    newProductExitModule={\r\n            selectedProductEntry:{},\r\n            show :'create'\r\n        }\r\n        setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n\r\n        }\r\n    const handleDelete=async()=>{\r\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\r\n        \r\n        const dleteId=ProductEntry._id\r\n        if (conf){\r\n             \r\n        ProductEntryServ.remove(dleteId)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                reset();\r\n               /*  setMessage(\"Deleted ProductEntry successfully\")\r\n                setSuccess(true)\r\n                changeState()\r\n               setTimeout(() => {\r\n                setSuccess(false)\r\n                }, 200); */\r\n                toast({\r\n                    message: 'ProductEntry deleted succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                changeState()\r\n            })\r\n            .catch((err)=>{\r\n               // setMessage(\"Error deleting ProductEntry, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error deleting ProductEntry, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n        }\r\n    }\r\n        \r\n\r\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n          })) */\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        \r\n        setSuccess(false)\r\n        console.log(data)\r\n        data.facility=ProductEntry.facility\r\n          //console.log(data);\r\n          \r\n        ProductEntryServ.patch(ProductEntry._id,data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n               // e.target.reset();\r\n               // setMessage(\"updated ProductEntry successfully\")\r\n                 toast({\r\n                    message: 'ProductEntry updated succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  \r\n                changeState()\r\n\r\n            })\r\n            .catch((err)=>{\r\n                //setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error updating ProductEntry, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n     \r\n      \r\n    return (\r\n        \r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    ProductEntry Details-Modify\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <div className=\"field\">\r\n                    <label className=\"label is-small\"> Name\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"name\" type=\"text\" placeholder=\"Name\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                    </label>\r\n                    </div>\r\n                <div className=\"field\">\r\n                <label className=\"label is-small\">ProductEntry Type\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small \" ref={register({ required: true })} disabled name=\"ProductEntryType\" type=\"text\" placeholder=\"ProductEntry Type\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n                </label>\r\n                </div>\r\n            {/* <div className=\"field\">\r\n            <label className=\"label is-small\">Profession\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"profession\" type=\"text\" placeholder=\"Profession\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Phone\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"phone\" type=\"text\" placeholder=\"Phone No\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                 </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Email\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"email\" type=\"email\" placeholder=\"ProductEntry Email\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Department\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                {errors.department && <span>This field is required</span>}\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Departmental Unit\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Departmental Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div> */}\r\n           {/*  <div className=\"field\">\r\n            <label className=\"label is-small\">Category\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"ProductEntryCategory\" type=\"text\" placeholder=\"ProductEntry Category\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n            </div> */}\r\n           \r\n           \r\n            </form>\r\n            \r\n            <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p>\r\n            </div>\r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n                \r\n}   \r\n\r\nexport  function InventorySearch({getSearchfacility,clear}) {\r\n    \r\n    const productServ=client.service('inventory')\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n     const [searchError, setSearchError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [showPanel, setShowPanel] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [searchMessage, setSearchMessage] = useState(\"\") \r\n   // eslint-disable-next-line \r\n   const [simpa,setSimpa]=useState(\"\")\r\n   // eslint-disable-next-line \r\n   const [chosen,setChosen]=useState(false)\r\n   // eslint-disable-next-line \r\n   const [count,setCount]=useState(0)\r\n   const inputEl=useRef(null)\r\n   const [val,setVal]=useState(\"\")\r\n   const {user} = useContext(UserContext) \r\n   const {state}=useContext(ObjectContext)\r\n    const [productModal,setProductModal]=useState(false)\r\n\r\n   const handleRow= async(obj)=>{\r\n        await setChosen(true)\r\n        //alert(\"something is chaning\")\r\n       getSearchfacility(obj)\r\n       \r\n       await setSimpa(obj.name)\r\n       \r\n        // setSelectedFacility(obj)\r\n        setShowPanel(false)\r\n        await setCount(2)\r\n        /* const    newfacilityModule={\r\n            selectedFacility:facility,\r\n            show :'detail'\r\n        }\r\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\r\n   //console.log(state)\r\n    }\r\n    const handleBlur=async(e)=>{\r\n         if (count===2){\r\n             console.log(\"stuff was chosen\")\r\n         }\r\n       \r\n       /*  console.log(\"blur\")\r\n         setShowPanel(false)\r\n        console.log(JSON.stringify(simpa))\r\n        if (simpa===\"\"){\r\n            console.log(facilities.length)\r\n            setSimpa(\"abc\")\r\n            setSimpa(\"\")\r\n            setFacilities([])\r\n            inputEl.current.setValue=\"\"\r\n        }\r\n        console.log(facilities.length)\r\n        console.log(inputEl.current) */\r\n    }\r\n    const handleSearch=async(value)=>{\r\n        setVal(value)\r\n        if (value===\"\"){\r\n            setShowPanel(false)\r\n            getSearchfacility(false)\r\n            return\r\n        }\r\n        const field='name' //field variable\r\n\r\n       \r\n        if (value.length>=3 ){\r\n            productServ.find({query: {     //service\r\n                 [field]: {\r\n                     $regex:value,\r\n                     $options:'i'\r\n                    \r\n                 },\r\n                 facility: user.currentEmployee.facilityDetail._id,\r\n                 storeId: state.StoreModule.selectedStore._id,\r\n                 $limit:10,\r\n                 $sort: {\r\n                     createdAt: -1\r\n                   }\r\n                     }}).then((res)=>{\r\n              console.log(\"product  fetched successfully\") \r\n              console.log(res.data) \r\n                setFacilities(res.data)\r\n                 setSearchMessage(\" product  fetched successfully\")\r\n                 setShowPanel(true)\r\n             })\r\n             .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating ProductEntry ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n             })\r\n         }\r\n        else{\r\n            console.log(\"less than 3 \")\r\n            console.log(val)\r\n            setShowPanel(false)\r\n            await setFacilities([])\r\n            console.log(facilities)\r\n        }\r\n    }\r\n\r\n    const handleAddproduct =()=>{\r\n        setProductModal(true) \r\n    }\r\n    const handlecloseModal =()=>{\r\n        setProductModal(false)\r\n        handleSearch(val)\r\n    }\r\n    useEffect(() => {\r\n       if (clear){\r\n           console.log(\"success has changed\",clear)\r\n           setSimpa(\"\")\r\n       }\r\n        return () => {\r\n            \r\n        }\r\n    }, [clear] )\r\n    return (\r\n        <div>\r\n            <div className=\"field\">\r\n                <div className=\"control has-icons-left  \">\r\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`} style={{width:\"100%\"}}>\r\n                        <div className=\"dropdown-trigger\" style={{width:\"100%\"}}>\r\n                            <DebounceInput className=\"input is-small  is-expanded\" \r\n                                type=\"text\" placeholder=\"Search Product\"\r\n                                value={simpa}\r\n                                minLength={3}\r\n                                debounceTimeout={400}\r\n                                onBlur={(e)=>handleBlur(e)}\r\n                                onChange={(e)=>handleSearch(e.target.value)}\r\n                                inputRef={inputEl}\r\n                                  />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-search\"></i>\r\n                            </span>\r\n                        </div>\r\n                        {/* {searchError&&<div>{searchMessage}</div>} */}\r\n                        <div className=\"dropdown-menu expanded\" style={{width:\"100%\"}}>\r\n                            <div className=\"dropdown-content\">\r\n                          { facilities.length>0?\"\":<div className=\"dropdown-item\" /* onClick={handleAddproduct} */> <span> {val} is not in your inventory</span> </div>}\r\n\r\n                              {facilities.map((facility, i)=>(\r\n                                    \r\n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\r\n                                        \r\n                                        <div><span>{facility.name}</span></div>\r\n                                        <div><span><strong>{facility.quantity}</strong></span>\r\n                                        <span>{facility.baseunit}(s) remaining</span>\r\n                                        <span className=\"padleft\"><strong>Price:</strong> N{facility.sellingprice}</span></div>\r\n                                        \r\n                                    </div>\r\n                                    \r\n                                    ))}\r\n                                    \r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className={`modal ${productModal?\"is-active\":\"\"}` }>\r\n                                    <div className=\"modal-background\"></div>\r\n                                    <div className=\"modal-card\">\r\n                                        <header className=\"modal-card-head\">\r\n                                        <p className=\"modal-card-title\">Choose Store</p>\r\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={handlecloseModal}></button>\r\n                                        </header>\r\n                                        <section className=\"modal-card-body\">\r\n                                        {/* <StoreList standalone=\"true\" /> */}\r\n                                        <ProductCreate />\r\n                                        </section>\r\n                                        {/* <footer className=\"modal-card-foot\">\r\n                                        <button className=\"button is-success\">Save changes</button>\r\n                                        <button className=\"button\">Cancel</button>\r\n                                        </footer> */}\r\n                                    </div>\r\n                                </div>       \r\n        </div>\r\n    )\r\n}","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Clinic\\ClinicStore.js",["380","381","382","383","384","385","386","387"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\n// eslint-disable-next-line\r\nconst searchfacility={};\r\n\r\n\r\nexport default function Inventory() {\r\n    const {state}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedInventory,setSelectedInventory]=useState()\r\n    //const [showState,setShowState]=useState() //create|modify|detail\r\n    \r\n    return(\r\n        <section className= \"section remPadTop\">\r\n           {/*  <div className=\"level\">\r\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Inventory  Module</span></div>\r\n            </div> */}\r\n            <div className=\"columns \">\r\n            <div className=\"column is-8 \">\r\n                <InventoryList />\r\n                </div>\r\n            <div className=\"column is-4 \">\r\n                {(state.InventoryModule.show ==='create')&&<InventoryCreate />}\r\n                {(state.InventoryModule.show ==='detail')&&<InventoryDetail  />}\r\n                {(state.InventoryModule.show ==='modify')&&<InventoryModify Inventory={selectedInventory} />}\r\n               \r\n            </div>\r\n\r\n            </div>                            \r\n            </section>\r\n       \r\n    )\r\n    \r\n}\r\n\r\nexport function InventoryCreate(){\r\n    const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \r\n    const [error, setError] =useState(false)\r\n    const [success, setSuccess] =useState(false)\r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line\r\n    const [facility,setFacility] = useState()\r\n    const InventoryServ=client.service('inventory')\r\n    //const history = useHistory()\r\n    const {user} = useContext(UserContext) //,setUser\r\n    // eslint-disable-next-line\r\n    const [currentUser,setCurrentUser] = useState()\r\n\r\n\r\n\r\n    const getSearchfacility=(obj)=>{\r\n        \r\n        setValue(\"facility\", obj._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })\r\n    }\r\n    \r\n    useEffect(() => {\r\n        setCurrentUser(user)\r\n        //console.log(currentUser)\r\n        return () => {\r\n        \r\n        }\r\n    }, [user])\r\n\r\n  //check user for facility or get list of facility  \r\n    useEffect(()=>{\r\n        //setFacility(user.activeInventory.FacilityId)//\r\n      if (!user.stacker){\r\n          console.log(currentUser)\r\n        setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        }) \r\n      }\r\n    })\r\n\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        setMessage(\"\")\r\n        setError(false)\r\n        setSuccess(false)\r\n         // data.createdby=user._id\r\n          console.log(data);\r\n          if (user.currentEmployee){\r\n         data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\r\n          }\r\n        InventoryServ.create(data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                e.target.reset();\r\n               /*  setMessage(\"Created Inventory successfully\") */\r\n                setSuccess(true)\r\n                toast({\r\n                    message: 'Inventory created succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  setSuccess(false)\r\n            })\r\n            .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating Inventory ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n\r\n    return (\r\n        <>\r\n            <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Create Inventory: Product Entry- Initialization, Purchase Invoice, Audit\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n   \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n            <div className=\"field\">    \r\n                <div class=\"control\">\r\n                    <div class=\"select is-small\">\r\n                        <select>\r\n                            <option>Purchase Invoice </option>\r\n                            <option>Initialization</option>\r\n                            <option>Audit</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\"> {/* Audit/initialization/Purchase Invoice */}\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"type\" type=\"text\" placeholder=\"Type of Product Entry\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\" fas fa-user-md \"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input is-small\" ref={register({ required: true })}  name=\"supplier\" type=\"text\" placeholder=\"Supplier\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                </div>\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })}  name=\"date\" type=\"text\" placeholder=\"Date\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n            </div>\r\n            \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"totalamount\" type=\"text\" placeholder=\" Total Amount\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n           \r\n         {/* array of inventory items */}\r\n         <p className=\"control\">\r\n                    <button className=\"button is-info is-small  is-pulled-right\">\r\n                      <span className=\"is-small\"> +</span>\r\n                    </button>\r\n                </p>\r\n           <div className=\"field\"  /* style={ !user.stacker?{display:\"none\"}:{}} */ >\r\n                <ProductSearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                    <input className=\"input is-small\" ref={register ({ required: true }) } /* add array no */ name=\"productId\" type=\"text\" placeholder=\"Product Id\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas  fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n           \r\n               <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"quantity\" type=\"text\" placeholder=\"Quantity\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                <label className=\"label is-small\">Base Unit</label>\r\n            </div> \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"costprice\" type=\"text\" placeholder=\"Cost Price\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> \r\n           {/*  <div className=\"field\">\r\n                <div className=\"control has-icons-left\">\r\n                    <div className=\"dropdown \">\r\n                        <div className=\"dropdown-trigger\">\r\n                            <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital-symbol\"></i>\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"dropdown-menu\">\r\n                            <div className=\"dropdown-content\">\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa\r\n                                </div>\r\n                                <div className=\"dropdown-item is-active\">\r\n                                    simpa 2\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 3\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 4\r\n                                </div>\r\n                            </div>\r\n                        </div>   \r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Department Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"password\" type=\"text\" placeholder=\"password\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n            <div className=\"field\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\">\r\n                        Create\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            \r\n            </form>\r\n            </div>\r\n            </div>\r\n        </>\r\n    )\r\n   \r\n}\r\n\r\nexport function InventoryList(){\r\n   // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const InventoryServ=client.service('inventory')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedInventory, setSelectedInventory]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n    // eslint-disable-next-line\r\n    const {user,setUser}=useContext(UserContext)\r\n\r\n\r\n\r\n    const handleCreateNew = async()=>{\r\n        const    newInventoryModule={\r\n            selectedInventory:{},\r\n            show :'create'\r\n            }\r\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n       //console.log(state)\r\n    }\r\n\r\n    const handleRow= async(Inventory)=>{\r\n        //console.log(\"b4\",state)\r\n\r\n        //console.log(\"handlerow\",Inventory)\r\n\r\n        await setSelectedInventory(Inventory)\r\n\r\n        const    newInventoryModule={\r\n            selectedInventory:Inventory,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n       //console.log(state)\r\n\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='name'\r\n       console.log(val)\r\n       InventoryServ.find({query: {\r\n                [field]: {\r\n                    $regex:val,\r\n                    $options:'i'\r\n                   \r\n                },\r\n               facility:user.currentEmployee.facilityDetail._id || \"\",\r\n                $limit:10,\r\n                $sort: {\r\n                    createdAt: -1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" Inventory  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error fetching Inventory, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n   \r\n        const getFacilities= async()=>{\r\n            if (user.currentEmployee){\r\n            \r\n        const findInventory= await InventoryServ.find(\r\n                {query: {\r\n                    facility:user.currentEmployee.facilityDetail._id,\r\n                    storeId:state.StoreModule.selectedStore._id,\r\n                    $limit:20,\r\n                    $sort: {\r\n                        createdAt: -1\r\n                    }\r\n                    }})\r\n\r\n         await setFacilities(findInventory.data)\r\n                }\r\n                else {\r\n                    if (user.stacker){\r\n                        const findInventory= await InventoryServ.find(\r\n                            {query: {\r\n                                \r\n                                $limit:20,\r\n                                $sort: {\r\n                                    createdAt: -1\r\n                                }\r\n                                }})\r\n            \r\n                    await setFacilities(findInventory.data)\r\n\r\n                    }\r\n                }\r\n          /*   .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" Inventory  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating Inventory, probable network issues \"+ err )\r\n                    setError(true)\r\n                }) */\r\n            }\r\n            \r\n            useEffect(() => {\r\n                setTimeout(() => {\r\n                    console.log(\"happy birthday\")\r\n                    //getFacilities(user)\r\n                }, 200);\r\n\r\n                return () => {\r\n                    \r\n\r\n                }\r\n            },[])\r\n\r\n            useEffect(() => {\r\n               \r\n                if (user){\r\n                    getFacilities()\r\n                }else{\r\n                    /* const localUser= localStorage.getItem(\"user\")\r\n                    const user1=JSON.parse(localUser)\r\n                    console.log(localUser)\r\n                    console.log(user1)\r\n                    fetchUser(user1)\r\n                    console.log(user)\r\n                    getFacilities(user) */\r\n                }\r\n                InventoryServ.on('created', (obj)=>getFacilities())\r\n                InventoryServ.on('updated', (obj)=>getFacilities())\r\n                InventoryServ.on('patched', (obj)=>getFacilities())\r\n                InventoryServ.on('removed', (obj)=>getFacilities())\r\n                return () => {\r\n                \r\n                }\r\n            },[])\r\n        \r\n        useEffect(() => {\r\n            getFacilities()\r\n            return () => {\r\n               \r\n            }\r\n        }, [state.StoreModule.selectedStore])\r\n\r\n    //todo: pagination and vertical scroll bar\r\n\r\n    return(\r\n        <>\r\n           {user?( <>  \r\n                <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search Inventory\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Inventories </span></div>\r\n                    <div className=\"level-right\">\r\n                        <div className=\"level-item\"> \r\n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <div className=\"table-container pullup \">\r\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\r\n                                    <thead>\r\n                                        <tr>\r\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                        {/* <th><abbr title=\"Category\">Category</abbr></th> */}\r\n                                        <th>Product</th>\r\n                                        <th><abbr title=\"Quantity\">Quantity</abbr></th>\r\n                                        <th><abbr title=\"Base Unit\">Base Unit</abbr></th>\r\n                                        <th><abbr title=\"Stock Value\">Stock Value</abbr></th>\r\n                                         <th><abbr title=\"Cost Price\">Cost Price</abbr></th>\r\n                                        <th><abbr title=\"Selling Price\">Selling Price</abbr></th>\r\n                                        <th><abbr title=\"Re-Order Level\">Re-Order Level</abbr></th>\r\n                                        <th><abbr title=\"Expiry\">Expiry</abbr></th> \r\n                                        <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tfoot>\r\n                                        \r\n                                    </tfoot>\r\n                                    <tbody>\r\n                                        {facilities.map((Inventory, i)=>(\r\n\r\n                                            <tr key={Inventory._id} onClick={()=>handleRow(Inventory)}>\r\n                                            <th>{i+1}</th>\r\n                                            {/* <td>{Inventory.productDetail.category}</td> */}\r\n                                            <th>{Inventory.name}</th>\r\n                                            <td>{Inventory.quantity}</td>\r\n                                            <td>{Inventory.baseunit}</td>\r\n                                            <td>{Inventory.stockvalue}</td>\r\n                                            <td>{Inventory.costprice}</td>\r\n                                            <td>{Inventory.sellingprice}</td>\r\n                                            <td>{Inventory.reorder_level}</td> \r\n                                            <td>{Inventory.expiry}</td>\r\n                                            <td><span   className=\"showAction\"  >...</span></td>\r\n                                           \r\n                                            </tr>\r\n\r\n                                        ))}\r\n                                    </tbody>\r\n                                    </table>\r\n                                    \r\n                </div>              \r\n            </>):<div>loading</div>}\r\n            </>\r\n              \r\n    )\r\n    }\r\n\r\n\r\nexport function InventoryDetail(){\r\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\r\n     // eslint-disable-next-line\r\n    const [error, setError] =useState(false) //, \r\n    //const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [message, setMessage] = useState(\"\") //,\r\n    //const InventoryServ=client.service('/Inventory')\r\n    //const history = useHistory()\r\n    //const {user,setUser} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n    const {user} = useContext(UserContext) //,setUser\r\n    \r\n   \r\n\r\n   const Inventory =state.InventoryModule.selectedInventory \r\n   console.log(\"selected\",Inventory)\r\n\r\n   \r\n  const getFacilities= async()=>{\r\n    \r\n    \r\n     const findProductEntry= await client.service('productentry').find(\r\n        {query: {\r\n            'productitems.productId':Inventory.productId,\r\n            facility:user.currentEmployee.facilityDetail._id,\r\n            storeId:state.StoreModule.selectedStore._id,\r\n            $limit:20,\r\n            $sort: {\r\n                createdAt: -1\r\n            }\r\n            }})\r\n\r\n        console.log(findProductEntry)\r\n       }\r\n    \r\n       useEffect(() => {\r\n        getFacilities()\r\n           return () => {\r\n               \r\n           }\r\n       }, [Inventory])\r\n /* await setFacilities(findProductEntry.data)\r\n        }\r\n        else {\r\n            if (user.stacker){ */\r\n                /* toast({\r\n                    message: 'You do not qualify to view this',\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  }) \r\n                  return */\r\n               /*  const findProductEntry= await ProductEntryServ.find(\r\n                    {query: {\r\n                        \r\n                        $limit:20,\r\n                        $sort: {\r\n                            createdAt: -1\r\n                        }\r\n                        }})\r\n    \r\n            await setFacilities(findProductEntry.data)\r\n\r\n            }\r\n        }  */\r\n  /*   .then((res)=>{\r\n        console.log(res)\r\n            setFacilities(res.data)\r\n            setMessage(\" ProductEntry  fetched successfully\")\r\n            setSuccess(true)\r\n        })\r\n        .catch((err)=>{\r\n            setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\r\n            setError(true)\r\n        }) */\r\n    \r\n    \r\n\r\n\r\n\r\n    const handleEdit= async()=>{\r\n        const    newInventoryModule={\r\n            selectedInventory:Inventory,\r\n            show :'modify'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n       //console.log(state)\r\n       \r\n    }\r\n \r\n    return (\r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Inventory Details\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n                <table> \r\n                <tbody>         \r\n                <tr>\r\n                    <td>\r\n                \r\n                    <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Product Name: \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"><strong> {Inventory.name} </strong></span>\r\n                        </td>\r\n                    </tr>\r\n                   {/*  <tr>\r\n                    <td>\r\n                <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>Inventory Type:\r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft\"   name=\"InventoryType\">{Inventory.InventoryType} </span> \r\n                    </td>\r\n                </tr> */}\r\n\r\n            </tbody> \r\n            </table> \r\n           \r\n            <div className=\"field mt-2 is-grouped\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\r\n                        Set Price\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\"  /*  onClick={handleSetPrice} */>\r\n                        Audit\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-info is-small\" /* onClick={handleEdit} */>\r\n                        Transaction History\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" /* onClick={handleEdit} */>\r\n                        Reorder Level\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            { error && <div className=\"message\"> {message}</div>}\r\n           \r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n}\r\n\r\nexport function InventoryModify(){\r\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\r\n    // eslint-disable-next-line \r\n    const [error, setError] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [success, setSuccess] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [message,setMessage] = useState(\"\")\r\n    const [billservice,setBillService] = useState()\r\n    // eslint-disable-next-line \r\n    const InventoryServ=client.service('inventory')\r\n    //const history = useHistory()\r\n     // eslint-disable-next-line\r\n    const {user} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n    const billServ=client.service('billing')\r\n\r\n    const Inventory =state.InventoryModule.selectedInventory // set inventory\r\n    const handleSetPrice = async()=>{\r\n    \r\n        const service = await  billServ.get(Inventory.billingId) // get the service\r\n            const contractSel= service.contracts.filter(element=>(element.source_org===Inventory.facility && element.dest_org===Inventory.facility))\r\n            \r\n            setValue(\"price\", contractSel[0].price,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"oldprice\", contractSel[0].price,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            await setBillService(service)\r\n            console.log(contractSel,service)\r\n    }\r\n \r\n        useEffect(() => {\r\n            handleSetPrice()\r\n     \r\n            return () => {\r\n                \r\n            }\r\n        },[])\r\n\r\n   const handleCancel=async()=>{\r\n   \r\n    const    newInventoryModule={\r\n        selectedInventory:{},\r\n        show :'detail'\r\n      }\r\n        await setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n   //console.log(state)\r\n           }\r\n\r\n\r\n        const changeState =()=>{\r\n            const    newInventoryModule={\r\n                selectedInventory:{},\r\n                show :'detail'\r\n            }\r\n        setState((prevstate)=>({...prevstate, InventoryModule:newInventoryModule}))\r\n\r\n        }\r\n\r\n\r\n    const handleDelete=async()=>{\r\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\r\n        \r\n        const dleteId=Inventory._id\r\n        if (conf){\r\n             \r\n        InventoryServ.remove(dleteId)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                reset();\r\n               /*  setMessage(\"Deleted Inventory successfully\")\r\n                setSuccess(true)\r\n                changeState()\r\n               setTimeout(() => {\r\n                setSuccess(false)\r\n                }, 200); */\r\n                toast({\r\n                    message: 'Inventory deleted succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                changeState()\r\n            })\r\n            .catch((err)=>{\r\n               // setMessage(\"Error deleting Inventory, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error deleting Inventory, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n        }\r\n    }\r\n        \r\n\r\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n          })) */\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        \r\n        setSuccess(false)\r\n        console.log(data)\r\n       // data.facility=Inventory.facility\r\n          //console.log(data);\r\n          const contractSel= billservice.contracts.filter(element=>(element.source_org===Inventory.facility && element.dest_org===Inventory.facility))\r\n          contractSel[0].price=data.price \r\n          billServ.patch(billservice._id,billservice)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n               // e.target.reset();\r\n               // setMessage(\"updated Inventory successfully\")\r\n                 toast({\r\n                    message: 'Price updated succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  \r\n                changeState()\r\n\r\n            })\r\n            .catch((err)=>{\r\n                //setMessage(\"Error creating Inventory, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error updating Price, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            }) \r\n\r\n      } \r\n     \r\n      \r\n    return (\r\n        \r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Set Price for {Inventory.name} per {Inventory.baseunit}\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <div className=\"field\">\r\n                    <label className=\"label is-small\"> New Selling Price\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"price\" type=\"text\" placeholder=\"Name\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                    </label>\r\n                    </div>\r\n                <div className=\"field\">\r\n                <label className=\"label is-small\">Old Price\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small \" ref={register({ required: true })} disabled name=\"oldprice\" type=\"text\" placeholder=\"Inventory Type\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n                </label>\r\n                </div>\r\n           \r\n           \r\n           \r\n            </form>\r\n            \r\n            <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n               {/*  <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p> */}\r\n            </div>\r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n                \r\n}   \r\n\r\nexport  function ProductSearch({getSearchfacility,clear}) {\r\n    \r\n    const facilityServ=client.service('products')\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n     const [searchError, setSearchError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [showPanel, setShowPanel] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [searchMessage, setSearchMessage] = useState(\"\") \r\n   // eslint-disable-next-line \r\n   const [simpa,setSimpa]=useState(\"\")\r\n   // eslint-disable-next-line \r\n   const [chosen,setChosen]=useState(false)\r\n   // eslint-disable-next-line \r\n   const [count,setCount]=useState(0)\r\n   const inputEl=useRef(null)\r\n\r\n\r\n   const handleRow= async(obj)=>{\r\n        await setChosen(true)\r\n        //alert(\"something is chaning\")\r\n       getSearchfacility(obj)\r\n       \r\n       await setSimpa(obj.facilityName)\r\n       \r\n        // setSelectedFacility(obj)\r\n        setShowPanel(false)\r\n        await setCount(2)\r\n        /* const    newfacilityModule={\r\n            selectedFacility:facility,\r\n            show :'detail'\r\n        }\r\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\r\n   //console.log(state)\r\n}\r\n    const handleBlur=async(e)=>{\r\n         if (count===2){\r\n             console.log(\"stuff was chosen\")\r\n         }\r\n       \r\n       /*  console.log(\"blur\")\r\n         setShowPanel(false)\r\n        console.log(JSON.stringify(simpa))\r\n        if (simpa===\"\"){\r\n            console.log(facilities.length)\r\n            setSimpa(\"abc\")\r\n            setSimpa(\"\")\r\n            setFacilities([])\r\n            inputEl.current.setValue=\"\"\r\n        }\r\n        console.log(facilities.length)\r\n        console.log(inputEl.current) */\r\n    }\r\n    const handleSearch=async(val)=>{\r\n        \r\n        const field='name' //field variable\r\n       \r\n        if (val.length>=3){\r\n            facilityServ.find({query: {     //service\r\n                 [field]: {\r\n                     $regex:val,\r\n                     $options:'i'\r\n                    \r\n                 },\r\n                 $limit:10,\r\n                 $sort: {\r\n                     createdAt: -1\r\n                   }\r\n                     }}).then((res)=>{\r\n              console.log(\"facility  fetched successfully\") \r\n                setFacilities(res.data)\r\n                 setSearchMessage(\" facility  fetched successfully\")\r\n                 setShowPanel(true)\r\n             })\r\n             .catch((err)=>{\r\n                 console.log(err)\r\n                 setSearchMessage(\"Error searching facility, probable network issues \"+ err )\r\n                 setSearchError(true)\r\n             })\r\n         }\r\n        else{\r\n            console.log(\"less than 3 \")\r\n            console.log(val)\r\n            setShowPanel(false)\r\n            await setFacilities([])\r\n            console.log(facilities)\r\n        }\r\n    }\r\n    useEffect(() => {\r\n       if (clear){\r\n           setSimpa(\"\")\r\n       }\r\n        return () => {\r\n            \r\n        }\r\n    }, [clear] )\r\n    return (\r\n        <div>\r\n            <div className=\"field\">\r\n                <div className=\"control has-icons-left  \">\r\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`}>\r\n                        <div className=\"dropdown-trigger\">\r\n                            <DebounceInput className=\"input is-small \" \r\n                                type=\"text\" placeholder=\"Search Product\"\r\n                                value={simpa}\r\n                                minLength={1}\r\n                                debounceTimeout={400}\r\n                                onBlur={(e)=>handleBlur(e)}\r\n                                onChange={(e)=>handleSearch(e.target.value)}\r\n                                inputRef={inputEl}\r\n                                  />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-search\"></i>\r\n                            </span>\r\n                        </div>\r\n                        {searchError&&<div>{searchMessage}</div>}\r\n                        <div className=\"dropdown-menu\" >\r\n                            <div className=\"dropdown-content\">\r\n                            {facilities.map((facility, i)=>(\r\n                                    \r\n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\r\n                                        \r\n                                        <span>{facility.facilityName}</span>\r\n                                        \r\n                                    </div>\r\n                                    \r\n                                    ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n          \r\n        </div>\r\n    )\r\n}","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Clinic\\Clinic.js",["388","389","390","391","392"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\n// eslint-disable-next-line\r\nconst searchfacility={};\r\n\r\n\r\nexport default function Clinic() {\r\n    const {state}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedClinic,setSelectedClinic]=useState()\r\n    //const [showState,setShowState]=useState() //create|modify|detail\r\n    \r\n    return(\r\n        <section className= \"section remPadTop\">\r\n           {/*  <div className=\"level\">\r\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Clinic  Module</span></div>\r\n            </div> */}\r\n            <div className=\"columns \">\r\n            <div className=\"column is-8 \">\r\n                <ClinicList />\r\n                </div>\r\n            <div className=\"column is-4 \">\r\n                {(state.ClinicModule.show ==='create')&&<ClinicCreate />}\r\n                {(state.ClinicModule.show ==='detail')&&<ClinicDetail  />}\r\n                {(state.ClinicModule.show ==='modify')&&<ClinicModify Clinic={selectedClinic} />}\r\n               \r\n            </div>\r\n\r\n            </div>                            \r\n            </section>\r\n       \r\n    )\r\n    \r\n}\r\n\r\nexport function ClinicCreate(){\r\n    const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \r\n    const [error, setError] =useState(false)\r\n    const [success, setSuccess] =useState(false)\r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line\r\n    const [facility,setFacility] = useState()\r\n    const ClinicServ=client.service('location')\r\n    //const history = useHistory()\r\n    const {user} = useContext(UserContext) //,setUser\r\n    // eslint-disable-next-line\r\n    const [currentUser,setCurrentUser] = useState()\r\n\r\n\r\n\r\n    const getSearchfacility=(obj)=>{ // buble-up from inputsearch for creating resource\r\n        \r\n        setValue(\"facility\", obj._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })\r\n    }\r\n    \r\n    useEffect(() => {\r\n        setCurrentUser(user)\r\n        //console.log(currentUser)\r\n        return () => {\r\n        \r\n        }\r\n    }, [user])\r\n\r\n  //check user for facility or get list of facility  \r\n    useEffect(()=>{\r\n        //setFacility(user.activeClinic.FacilityId)//\r\n      if (!user.stacker){\r\n          console.log(currentUser)\r\n        setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        }) \r\n      }\r\n    })\r\n\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        setMessage(\"\")\r\n        setError(false)\r\n        setSuccess(false)\r\n         // data.createdby=user._id\r\n          console.log(data);\r\n          if (user.currentEmployee){\r\n         data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\r\n          }\r\n          data.locationType=\"Clinic\"\r\n        ClinicServ.create(data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                e.target.reset();\r\n               /*  setMessage(\"Created Clinic successfully\") */\r\n                setSuccess(true)\r\n                toast({\r\n                    message: 'Clinic created succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  setSuccess(false)\r\n            })\r\n            .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating Clinic ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n\r\n    return (\r\n        <>\r\n            <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Create Clinic\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n   \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n               {/*  <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input is-small\" ref={register({ required: true })}  name=\"ClinicType\" type=\"text\" placeholder=\"Type of Clinic\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                </div> */}\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })}  name=\"name\" type=\"text\" placeholder=\"Name of Clinic\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n            </div>\r\n           {/*  <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"profession\" type=\"text\" placeholder=\"Profession\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\" fas fa-user-md \"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"phone\" type=\"text\" placeholder=\" Phone No\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n           \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                \r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"email\" type=\"email\" placeholder=\"Email\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n           <div className=\"field\"  style={ !user.stacker?{display:\"none\"}:{}} >\r\n                <InputSearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                    <input className=\"input is-small\" ref={register ({ required: true }) } name=\"facility\" type=\"text\" placeholder=\"Facility\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas  fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n           {/*  <div className=\"field\">\r\n                <div className=\"control has-icons-left\">\r\n                    <div className=\"dropdown \">\r\n                        <div className=\"dropdown-trigger\">\r\n                            <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital-symbol\"></i>\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"dropdown-menu\">\r\n                            <div className=\"dropdown-content\">\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa\r\n                                </div>\r\n                                <div className=\"dropdown-item is-active\">\r\n                                    simpa 2\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 3\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 4\r\n                                </div>\r\n                            </div>\r\n                        </div>   \r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Department Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"password\" type=\"text\" placeholder=\"password\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n            <div className=\"field\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\">\r\n                        Create\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            \r\n            </form>\r\n            </div>\r\n            </div>\r\n        </>\r\n    )\r\n   \r\n}\r\n\r\nexport function ClinicList({standalone,closeModal}){\r\n   // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const ClinicServ=client.service('location')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedClinic, setSelectedClinic]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n    // eslint-disable-next-line\r\n    const {user,setUser}=useContext(UserContext)\r\n\r\n\r\n\r\n    const handleCreateNew = async()=>{\r\n        const    newClinicModule={\r\n            selectedClinic:{},\r\n            show :'create'\r\n            }\r\n       await setState((prevstate)=>({...prevstate, ClinicModule:newClinicModule}))\r\n       //console.log(state)\r\n        \r\n\r\n    }\r\n    const handleRow= async(Clinic)=>{\r\n        //console.log(\"b4\",state)\r\n\r\n        //console.log(\"handlerow\",Clinic)\r\n\r\n        await setSelectedClinic(Clinic)\r\n\r\n        const    newClinicModule={\r\n            selectedClinic:Clinic,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ClinicModule:newClinicModule}))\r\n       //console.log(state)\r\n        closeModal()\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='name'\r\n       console.log(val)\r\n       ClinicServ.find({query: {\r\n                [field]: {\r\n                    $regex:val,\r\n                    $options:'i'\r\n                   \r\n                },\r\n               facility:user.currentEmployee.facilityDetail._id || \"\",\r\n                locationType:\"Clinic\",\r\n               $limit:10,\r\n                $sort: {\r\n                    name: 1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" Clinic  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error fetching Clinic, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n   \r\n        const getFacilities= async()=>{\r\n            if (user.currentEmployee){\r\n            \r\n        const findClinic= await ClinicServ.find(\r\n                {query: {\r\n                    locationType:\"Clinic\",\r\n                    facility:user.currentEmployee.facilityDetail._id,\r\n                    $limit:20,\r\n                    $sort: {\r\n                        name: 1\r\n                    }\r\n                    }})\r\n\r\n         await setFacilities(findClinic.data)\r\n                }\r\n                else {\r\n                    if (user.stacker){\r\n                        const findClinic= await ClinicServ.find(\r\n                            {query: {\r\n                                locationType:\"Clinic\",\r\n                                $limit:20,\r\n                                $sort: {\r\n                                    name: 1\r\n                                }\r\n                                }})\r\n            \r\n                    await setFacilities(findClinic.data)\r\n\r\n                    }\r\n                }\r\n          /*   .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" Clinic  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating Clinic, probable network issues \"+ err )\r\n                    setError(true)\r\n                }) */\r\n            }\r\n            \r\n            useEffect(() => {\r\n                setTimeout(() => {\r\n                    console.log(\"happy birthday\")\r\n                    //getFacilities(user)\r\n                }, 200);\r\n\r\n                return () => {\r\n                    \r\n\r\n                }\r\n            },[])\r\n\r\n            useEffect(() => {\r\n               \r\n                if (user){\r\n                    getFacilities()\r\n                }else{\r\n                    /* const localUser= localStorage.getItem(\"user\")\r\n                    const user1=JSON.parse(localUser)\r\n                    console.log(localUser)\r\n                    console.log(user1)\r\n                    fetchUser(user1)\r\n                    console.log(user)\r\n                    getFacilities(user) */\r\n                }\r\n                ClinicServ.on('created', (obj)=>getFacilities())\r\n                ClinicServ.on('updated', (obj)=>getFacilities())\r\n                ClinicServ.on('patched', (obj)=>getFacilities())\r\n                ClinicServ.on('removed', (obj)=>getFacilities())\r\n                return () => {\r\n                \r\n                }\r\n            },[])\r\n\r\n\r\n    //todo: pagination and vertical scroll bar\r\n\r\n    return(\r\n        <>\r\n           {user?( <>  \r\n                <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search Clinics\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Clinics</span></div>\r\n                    <div className=\"level-right\">\r\n                { !standalone &&   <div className=\"level-item\"> \r\n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                        </div>}\r\n                    </div>\r\n\r\n                </div>\r\n                <div className=\"table-container pullup \">\r\n                                <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\r\n                                    <thead>\r\n                                        <tr>\r\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                        <th>Name</th>\r\n                                        {/* <th><abbr title=\"Last Name\">Clinic Type</abbr></th>\r\n                                       <th><abbr title=\"Profession\">Profession</abbr></th>\r\n                                         <th><abbr title=\"Phone\">Phone</abbr></th>\r\n                                        <th><abbr title=\"Email\">Email</abbr></th>\r\n                                        <th><abbr title=\"Department\">Department</abbr></th>\r\n                                        <th><abbr title=\"Departmental Unit\">Departmental Unit</abbr></th> \r\n                                        <th><abbr title=\"Facility\">Facility</abbr></th>*/}\r\n                                       { !standalone &&  <th><abbr title=\"Actions\">Actions</abbr></th>}\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tfoot>\r\n                                        \r\n                                    </tfoot>\r\n                                    <tbody>\r\n                                        {facilities.map((Clinic, i)=>(\r\n\r\n                                            <tr key={Clinic._id} onClick={()=>handleRow(Clinic)}  className={Clinic._id===(selectedClinic?._id||null)?\"is-selected\":\"\"}>\r\n                                            <th>{i+1}</th>\r\n                                            <th>{Clinic.name}</th>\r\n                                            {/*<td>{Clinic.ClinicType}</td>\r\n                                            < td>{Clinic.profession}</td>\r\n                                            <td>{Clinic.phone}</td>\r\n                                            <td>{Clinic.email}</td>\r\n                                            <td>{Clinic.department}</td>\r\n                                            <td>{Clinic.deptunit}</td> \r\n                                            <td>{Clinic.facility}</td>*/}\r\n                                          { !standalone &&   <td><span   className=\"showAction\"  >...</span></td>}\r\n                                           \r\n                                            </tr>\r\n\r\n                                        ))}\r\n                                    </tbody>\r\n                                    </table>\r\n                                    \r\n                </div>              \r\n            </>):<div>loading</div>}\r\n            </>\r\n              \r\n    )\r\n    }\r\n\r\n\r\nexport function ClinicDetail(){\r\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\r\n     // eslint-disable-next-line\r\n    const [error, setError] =useState(false) //, \r\n    //const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [message, setMessage] = useState(\"\") //,\r\n    //const ClinicServ=client.service('/Clinic')\r\n    //const history = useHistory()\r\n    //const {user,setUser} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n   \r\n\r\n   const Clinic =state.ClinicModule.selectedClinic \r\n\r\n    const handleEdit= async()=>{\r\n        const    newClinicModule={\r\n            selectedClinic:Clinic,\r\n            show :'modify'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ClinicModule:newClinicModule}))\r\n       //console.log(state)\r\n       \r\n    }\r\n \r\n    return (\r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Clinic Details\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n                <table> \r\n                <tbody>         \r\n                <tr>\r\n                    <td>\r\n                \r\n                    <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Name: \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {Clinic.name} </span>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                    <td>\r\n                <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>Location Type:\r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft\"   name=\"ClinicType\">{Clinic.locationType} </span> \r\n                    </td>\r\n                </tr>\r\n                  {/*   <tr>\r\n                    <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>Profession: \r\n                \r\n                    \r\n                    </label>\r\n                    </td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"ClinicCity\">{Clinic.profession}</span> \r\n                </td>\r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>Phone:           \r\n                    \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft \"  name=\"ClinicContactPhone\" >{Clinic.phone}</span>\r\n                        </td>\r\n                  </tr>\r\n                    <tr><td>\r\n            \r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>Email:                     \r\n                    \r\n                         </label></td><td>\r\n                         <span className=\"is-size-7 padleft \"  name=\"ClinicEmail\" >{Clinic.email}</span>\r\n                         </td>\r\n             \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i></span>Department:\r\n                    \r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft \"  name=\"ClinicOwner\">{Clinic.department}</span>\r\n                    </td>\r\n               \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>Departmental Unit:              \r\n                    \r\n                </label></td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"ClinicType\">{Clinic.deptunit}</span>\r\n                </td>\r\n              \r\n                </tr> */}\r\n                    \r\n          {/*   <div className=\"field\">\r\n             <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>Category:              \r\n                    <span className=\"is-size-7 padleft \"  name= \"ClinicCategory\">{Clinic.ClinicCategory}</span>\r\n                </label>\r\n                 </div> */}\r\n\r\n            </tbody> \r\n            </table> \r\n           \r\n            <div className=\"field mt-2\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\r\n                        Edit\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            { error && <div className=\"message\"> {message}</div>}\r\n           \r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n}\r\n\r\nexport function ClinicModify(){\r\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\r\n    // eslint-disable-next-line \r\n    const [error, setError] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [success, setSuccess] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line \r\n    const ClinicServ=client.service('location')\r\n    //const history = useHistory()\r\n     // eslint-disable-next-line\r\n    const {user} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n    const Clinic =state.ClinicModule.selectedClinic \r\n\r\n        useEffect(() => {\r\n            setValue(\"name\", Clinic.name,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"locationType\", Clinic.locationType,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n           /*  setValue(\"profession\", Clinic.profession,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"phone\", Clinic.phone,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"email\", Clinic.email,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"department\", Clinic.department,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"deptunit\", Clinic.deptunit,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n          /*   setValue(\"ClinicCategory\", Clinic.ClinicCategory,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n            \r\n            return () => {\r\n                \r\n            }\r\n        })\r\n\r\n   const handleCancel=async()=>{\r\n    const    newClinicModule={\r\n        selectedClinic:{},\r\n        show :'create'\r\n      }\r\n   await setState((prevstate)=>({...prevstate, ClinicModule:newClinicModule}))\r\n   //console.log(state)\r\n           }\r\n\r\n\r\n        const changeState =()=>{\r\n        const    newClinicModule={\r\n            selectedClinic:{},\r\n            show :'create'\r\n        }\r\n        setState((prevstate)=>({...prevstate, ClinicModule:newClinicModule}))\r\n\r\n        }\r\n    const handleDelete=async()=>{\r\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\r\n        \r\n        const dleteId=Clinic._id\r\n        if (conf){\r\n             \r\n        ClinicServ.remove(dleteId)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                reset();\r\n               /*  setMessage(\"Deleted Clinic successfully\")\r\n                setSuccess(true)\r\n                changeState()\r\n               setTimeout(() => {\r\n                setSuccess(false)\r\n                }, 200); */\r\n                toast({\r\n                    message: 'Clinic deleted succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                changeState()\r\n            })\r\n            .catch((err)=>{\r\n               // setMessage(\"Error deleting Clinic, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error deleting Clinic, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n        }\r\n    }\r\n        \r\n\r\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n          })) */\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        \r\n        setSuccess(false)\r\n        console.log(data)\r\n        data.facility=Clinic.facility\r\n          //console.log(data);\r\n          \r\n        ClinicServ.patch(Clinic._id,data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n               // e.target.reset();\r\n               // setMessage(\"updated Clinic successfully\")\r\n                 toast({\r\n                    message: 'Clinic updated succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  \r\n                changeState()\r\n\r\n            })\r\n            .catch((err)=>{\r\n                //setMessage(\"Error creating Clinic, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error updating Clinic, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n     \r\n      \r\n    return (\r\n        \r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Clinic Details-Modify\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <div className=\"field\">\r\n                    <label className=\"label is-small\"> Name\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"name\" type=\"text\" placeholder=\"Name\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                    </label>\r\n                    </div>\r\n                <div className=\"field\">\r\n                <label className=\"label is-small\">Location Type\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small \" ref={register({ required: true })} disabled name=\"ClinicType\" type=\"text\" placeholder=\"Clinic Type\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n                </label>\r\n                </div>\r\n            {/* <div className=\"field\">\r\n            <label className=\"label is-small\">Profession\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"profession\" type=\"text\" placeholder=\"Profession\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Phone\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"phone\" type=\"text\" placeholder=\"Phone No\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                 </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Email\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"email\" type=\"email\" placeholder=\"Clinic Email\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Department\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                {errors.department && <span>This field is required</span>}\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Departmental Unit\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Departmental Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div> */}\r\n           {/*  <div className=\"field\">\r\n            <label className=\"label is-small\">Category\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"ClinicCategory\" type=\"text\" placeholder=\"Clinic Category\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n            </div> */}\r\n           \r\n           \r\n            </form>\r\n            \r\n            <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n                {/* <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p> */}\r\n            </div>\r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n                \r\n}   \r\n\r\nexport  function InputSearch({getSearchfacility,clear}) {\r\n    \r\n    const facilityServ=client.service('facility')\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n     const [searchError, setSearchError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [showPanel, setShowPanel] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [searchMessage, setSearchMessage] = useState(\"\") \r\n   // eslint-disable-next-line \r\n   const [simpa,setSimpa]=useState(\"\")\r\n   // eslint-disable-next-line \r\n   const [chosen,setChosen]=useState(false)\r\n   // eslint-disable-next-line \r\n   const [count,setCount]=useState(0)\r\n   const inputEl=useRef(null)\r\n\r\n\r\n   const handleRow= async(obj)=>{\r\n        await setChosen(true)\r\n        //alert(\"something is chaning\")\r\n       getSearchfacility(obj)\r\n       \r\n       await setSimpa(obj.facilityName)\r\n       \r\n        // setSelectedFacility(obj)\r\n        setShowPanel(false)\r\n        await setCount(2)\r\n        /* const    newfacilityModule={\r\n            selectedFacility:facility,\r\n            show :'detail'\r\n        }\r\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\r\n   //console.log(state)\r\n}\r\n    const handleBlur=async(e)=>{\r\n         if (count===2){\r\n             console.log(\"stuff was chosen\")\r\n         }\r\n       \r\n       /*  console.log(\"blur\")\r\n         setShowPanel(false)\r\n        console.log(JSON.stringify(simpa))\r\n        if (simpa===\"\"){\r\n            console.log(facilities.length)\r\n            setSimpa(\"abc\")\r\n            setSimpa(\"\")\r\n            setFacilities([])\r\n            inputEl.current.setValue=\"\"\r\n        }\r\n        console.log(facilities.length)\r\n        console.log(inputEl.current) */\r\n    }\r\n    const handleSearch=async(val)=>{\r\n        \r\n        const field='facilityName' //field variable\r\n       \r\n        if (val.length>=3){\r\n            facilityServ.find({query: {     //service\r\n                 [field]: {\r\n                     $regex:val,\r\n                     $options:'i'\r\n                    \r\n                 },\r\n                 $limit:10,\r\n                 $sort: {\r\n                     createdAt: -1\r\n                   }\r\n                     }}).then((res)=>{\r\n              console.log(\"facility  fetched successfully\") \r\n                setFacilities(res.data)\r\n                 setSearchMessage(\" facility  fetched successfully\")\r\n                 setShowPanel(true)\r\n             })\r\n             .catch((err)=>{\r\n                 console.log(err)\r\n                 setSearchMessage(\"Error searching facility, probable network issues \"+ err )\r\n                 setSearchError(true)\r\n             })\r\n         }\r\n        else{\r\n            console.log(\"less than 3 \")\r\n            console.log(val)\r\n            setShowPanel(false)\r\n            await setFacilities([])\r\n            console.log(facilities)\r\n        }\r\n    }\r\n    useEffect(() => {\r\n       if (clear){\r\n           setSimpa(\"\")\r\n       }\r\n        return () => {\r\n            \r\n        }\r\n    }, [clear] )\r\n    return (\r\n        <div>\r\n            <div className=\"field\">\r\n                <div className=\"control has-icons-left  \">\r\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`}>\r\n                        <div className=\"dropdown-trigger\">\r\n                            <DebounceInput className=\"input is-small \" \r\n                                type=\"text\" placeholder=\"Search Facilities\"\r\n                                value={simpa}\r\n                                minLength={1}\r\n                                debounceTimeout={400}\r\n                                onBlur={(e)=>handleBlur(e)}\r\n                                onChange={(e)=>handleSearch(e.target.value)}\r\n                                inputRef={inputEl}\r\n                                  />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-search\"></i>\r\n                            </span>\r\n                        </div>\r\n                        {searchError&&<div>{searchMessage}</div>}\r\n                        <div className=\"dropdown-menu\" >\r\n                            <div className=\"dropdown-content\">\r\n                            {facilities.map((facility, i)=>(\r\n                                    \r\n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\r\n                                        \r\n                                        <span>{facility.facilityName}</span>\r\n                                        \r\n                                    </div>\r\n                                    \r\n                                    ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n          \r\n        </div>\r\n    )\r\n}","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\ClientBill.js",["393","394","395","396","397","398","399","400","401","402","403","404","405"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\BillDispenseCreate.js",["406","407","408","409","410","411","412","413","414"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\EncounterMgt\\EncounterMain.js",["415","416","417","418","419","420","421","422"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\nimport {DocumentClassList} from './DocumentClass'\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\nimport {format, formatDistanceToNowStrict } from 'date-fns'\r\nimport  VideoConference  from '../utils/VideoConference';\r\nimport  Prescription, { PrescriptionCreate } from './Prescription';\r\n\r\nexport default function EncounterMain({nopresc}) {\r\n // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const ClinicServ=client.service('clinicaldocument')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedClinic, setSelectedClinic]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n    // eslint-disable-next-line\r\n    const {user,setUser}=useContext(UserContext)\r\n    const [showModal,setShowModal]=useState(false)\r\n    const [showPrescriptionModal,setShowPrescriptionModal]=useState(false)\r\n    // tracking on which page we currently are\r\n    const [page, setPage] = useState(0);\r\n    // add loader refrence \r\n    const loader = useRef(null);\r\n    \r\n    const standalone=false\r\n    \r\n\r\n    const handleNewDocument= async()=>{\r\n        await setShowModal(true)                                                                                                                                                        \r\n        console.log( showModal)\r\n    }\r\n    const handleNewPrescription= async()=>{\r\n        await setShowPrescriptionModal(true)                                                                                                                                                        \r\n        console.log( showPrescriptionModal)\r\n    }\r\n\r\n\r\n    const handleCreateNew = async()=>{\r\n        const    newClinicModule={\r\n            selectedClinic:{},\r\n            show :'create'\r\n            }\r\n       await setState((prevstate)=>({...prevstate, ClinicModule:newClinicModule}))\r\n       //console.log(state)\r\n        \r\n\r\n    }\r\n    const handleRow= async(Clinic)=>{\r\n        //console.log(\"b4\",state)\r\n\r\n        //console.log(\"handlerow\",Clinic)\r\n\r\n        await setSelectedClinic(Clinic)\r\n\r\n        const    newClinicModule={\r\n            selectedClinic:Clinic,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ClinicModule:newClinicModule}))\r\n       //console.log(state)\r\n       Clinic.show=!Clinic.show\r\n\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='documentname'\r\n       console.log(val)\r\n       ClinicServ.find({query: {\r\n                [field]: {\r\n                    $regex:val,\r\n                    $options:'i'\r\n                   \r\n                },\r\n              // facility:user.currentEmployee.facilityDetail._id || \"\",\r\n               // locationType:\"Clinic\",\r\n               client:state.ClientModule.selectedClient._id,\r\n               $limit:10,\r\n                $sort: {\r\n                    name: 1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" Clinic  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error fetching Clinic, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n   \r\n    const getFacilities= async(page=0)=>{\r\n            /* const limit=20\r\n            alert(page) */\r\n            if (user.currentEmployee){\r\n            \r\n        const findClinic= await ClinicServ.find(\r\n                {query: {\r\n                    //locationType:\"Clinic\",\r\n                    //facility:user.currentEmployee.facilityDetail._id,\r\n                    client:state.ClientModule.selectedClient._id,\r\n                    $limit:20,\r\n                   /*  $skip:page*limit, */\r\n                    $sort: {\r\n                        createdAt: -1\r\n                    }\r\n                    }})\r\n            const total= findClinic.total\r\n            const ulimit=total*page\r\n           /*  if (total>(ulimit)){ //only load if we have not reached the total\r\n                alert(\"skip:\",ulimit )\r\n                console.log(\"skip:\",ulimit ) */\r\n            await setFacilities(findClinic.data)\r\n            console.log(findClinic.data)\r\n           /*  } */\r\n                }\r\n                else {\r\n                    if (user.stacker){\r\n                        const findClinic= await ClinicServ.find(\r\n                            {query: {\r\n                                client:state.ClientModule.selectedClient._id,\r\n                                    $limit:20,\r\n                                    $sort: {\r\n                                        createdAt: -1\r\n                                    }\r\n                                }})\r\n            \r\n                    await setFacilities(findClinic.data)\r\n\r\n                    }\r\n                }\r\n          /*   .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" Clinic  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating Clinic, probable network issues \"+ err )\r\n                    setError(true)\r\n                }) */\r\n            }\r\n            \r\n           /*  useEffect(() => {\r\n                setTimeout(() => {\r\n                    console.log(\"happy birthday\")\r\n                    //getFacilities(user)\r\n                }, 200);\r\n\r\n                return () => {\r\n                    \r\n\r\n                }\r\n            },[]) */\r\n\r\n            useEffect(() => {\r\n                getFacilities()\r\n                if (user){\r\n                    \r\n                }else{\r\n                    /* const localUser= localStorage.getItem(\"user\")\r\n                    const user1=JSON.parse(localUser)\r\n                    console.log(localUser)\r\n                    console.log(user1)\r\n                    fetchUser(user1)\r\n                    console.log(user)\r\n                    getFacilities(user) */\r\n                }\r\n                ClinicServ.on('created', (obj)=>getFacilities(page))\r\n                ClinicServ.on('updated', (obj)=>getFacilities(page))\r\n                ClinicServ.on('patched', (obj)=>getFacilities(page))\r\n                ClinicServ.on('removed', (obj)=>getFacilities(page))\r\n\r\n                /* var options = {\r\n                    root: null,\r\n                    rootMargin: \"20px\",\r\n                    threshold: 1.0\r\n                 }; */\r\n                // initialize IntersectionObserver\r\n                // and attaching to Load More div\r\n                /*  const observer = new IntersectionObserver(handleObserver, options);\r\n                 if (loader.current) {\r\n                    observer.observe(loader.current)\r\n                 } */\r\n                return () => {\r\n                \r\n                }\r\n            },[])\r\n           /*  useEffect(() => {\r\n                // here we simulate adding new posts to List\r\n                getFacilities()\r\n            }, [page]) */\r\n\r\n             // here we handle what happens when user scrolls to Load More div\r\n            // in this case we just update page variable\r\n                /* const handleObserver = (entities) => {\r\n                    const target = entities[0];\r\n                    if (target.isIntersecting) {   \r\n                        setPage((page) => page + 1) //load more \r\n                        \r\n                    }\r\n                } */\r\n\r\n    return (\r\n        <div>\r\n            <VideoConference/>\r\n            <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search documentation\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                   {/*  <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Clinics</span></div> */}\r\n                    <div className=\"level-right\">\r\n                { !standalone &&   <div className=\"level-item\"> \r\n                            <div className=\"level-item\">\r\n                           {!nopresc && <div className=\"button is-danger is-small mr-2\" onClick={handleNewPrescription}>Presciption</div>}\r\n                                <div className=\"button is-success is-small\" onClick={handleNewDocument}>New Document</div>\r\n                                </div>\r\n                        </div>}\r\n                    </div>\r\n\r\n                </div>\r\n                \r\n                <div className=\" pullup \">\r\n                                <div className=\" is-fullwidth vscrollable pr-1\">\r\n                                   \r\n                                        {facilities.map((Clinic, i)=>(\r\n\r\n                                            <div key={Clinic._id}  onClick={()=>handleRow(Clinic)}   className={Clinic._id===(selectedClinic?._id||null)?\"is-selected\":\"\"}>\r\n                                               <div className=\"card mt-1 hovercard\">\r\n                                                    <header className=\"card-header\" onClick={(Clinic)=>Clinic.show=!Clinic.show}>\r\n                                                        <div className=\"card-header-title\">\r\n                                                        <div className=\"docdate\">{formatDistanceToNowStrict(new Date(Clinic.createdAt),{addSuffix: true})} <br/><span>{format(new Date(Clinic.createdAt),'dd-MM-yy')}</span></div> {Clinic.documentname} by {Clinic.createdByname} at {Clinic.location},{Clinic.facilityname} \r\n                                                        <p className=\"right ml-2 mr-0\">{Clinic.status} </p> \r\n                                                        </div>\r\n                                                       {/*  <button className=\"card-header-icon\" aria-label=\"more options\">\r\n                                                        <span className=\"icon\">\r\n                                                            <i className=\"fas fa-angle-down\" aria-hidden=\"true\"></i>\r\n                                                        </span>\r\n                                                        </button> */}\r\n                                                    </header>\r\n                                                  {Clinic.documentname!==\"Prescription\" &&  <div className={Clinic.show?\"card-content p-1\":\"card-content p-1 is-hidden\"}>\r\n                                                        { Object.entries(Clinic.documentdetail).map(([keys,value],i)=>(\r\n                                                            <div className=\"field is-horizontal\"> \r\n                                                                    <div className=\"field-label\"> \r\n                                                                        <label className=\"label is-size-7\" key={i}>\r\n                                                                            {keys}:\r\n                                                                            </label>\r\n                                                                    </div>\r\n                                                                    <div className=\"field-body\"> \r\n                                                                        <div className=\"field\" >\r\n                                                                            {value}   \r\n                                                                        </div>  \r\n                                                                    </div>                                                 \r\n                                                            </div>\r\n                                                            ))\r\n                                                        }\r\n                                                </div>}\r\n                                                {Clinic.documentname===\"Prescription\" &&  \r\n                                                <div className={Clinic.show?\"card-content p-1\":\"card-content p-1 is-hidden\"}>\r\n                                                        \r\n                                                        {(Clinic.documentdetail.length>0) && <div>\r\n                                                            <label>Medications:</label>\r\n                                                        <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable mr-2\">\r\n                                                                <thead>\r\n                                                                    <tr>\r\n                                                                    <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                                                \r\n                                                                    <th><abbr title=\"Type\">Medication</abbr></th>\r\n                                                                    <th><abbr title=\"Destination\">Destination</abbr></th>\r\n                                                                    </tr>\r\n                                                                </thead>\r\n                                                                <tfoot>\r\n                                                                    \r\n                                                                </tfoot>\r\n                                                                <tbody>\r\n                                                                { Clinic.documentdetail.map((ProductEntry, i)=>(\r\n\r\n                                                                        <tr key={i}>\r\n                                                                        <th>{i+1}</th>\r\n                                                                        {/* <td>{ProductEntry.name}</td> */}\r\n                                                                        <td>{ProductEntry.medication}<br/>\r\n                                                                        <span className=\"help is-size-7\">{ProductEntry.instruction}</span></td> \r\n                                                                        <td>{ProductEntry.destination}</td>                                                                     \r\n                                                                        </tr>\r\n\r\n                                                                    ))}\r\n                                                                </tbody>\r\n                                                                </table>\r\n                                                                </div>}                                                   \r\n                                                            </div>}\r\n                                                    </div>                                           \r\n                                            </div>\r\n\r\n                                        ))}\r\n                                      {/* <!-- Add Ref to Load More div --> */}\r\n                                       {/*  <div className=\"loading\" ref={loader}>\r\n                                                <h2>Load More</h2>\r\n                                    </div> */}\r\n                                </div>\r\n                                    \r\n                </div> \r\n                <div className={`modal  ${showModal?\"is-active\":\"\"}` }>\r\n                                    <div className=\"modal-background\"></div>\r\n                                    <div className=\"modal-card \">\r\n                                        <header className=\"modal-card-head\">\r\n                                        <p className=\"modal-card-title\">Choose Document Class</p>\r\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={()=>setShowModal(false)}></button>\r\n                                        </header>\r\n                                        <section className=\"modal-card-body\">\r\n                                        <DocumentClassList standalone=\"true\" />\r\n                                        </section>\r\n                                        {/* <footer className=\"modal-card-foot\">\r\n                                        <button className=\"button is-success\">Save changes</button>\r\n                                        <button className=\"button\">Cancel</button>\r\n                                        </footer> */}\r\n                                    </div>\r\n                                </div>\r\n                                <div className={`modal ${showPrescriptionModal?\"is-active\":\"\"}` }>\r\n                                    <div className=\"modal-background\"></div>\r\n                                    <div className=\"modal-card larger\">\r\n                                        <header className=\"modal-card-head\">\r\n                                        <p className=\"modal-card-title\">Prescription</p>\r\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={()=>setShowPrescriptionModal(false)}></button>\r\n                                        </header>\r\n                                        <section className=\"modal-card-body card-overflow\">\r\n                                        <Prescription standalone=\"true\" />\r\n                                        </section>\r\n                                        {/* <footer className=\"modal-card-foot\">\r\n                                        <button className=\"button is-success\">Save changes</button>\r\n                                        <button className=\"button\">Cancel</button>\r\n                                        </footer> */}\r\n                                    </div>\r\n                                </div>                            \r\n        </div>\r\n    )\r\n}\r\n","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\helpers\\FacilityPopup.js",["423","424"],"import React, {useState,useContext, useEffect} from 'react'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\n\r\n\r\nexport function Facility() {\r\n    const {state}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedFacility,setSelectedFacility]=useState()\r\n    //const [showState,setShowState]=useState() //create|modify|detail\r\n    \r\n    //console.log(\"facility parent\", state)\r\n    \r\n\r\n    return(\r\n        <section className= \"section remPadTop\">\r\n           {/*  <div className=\"level\">\r\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Facility  Module</span></div>\r\n            </div> */}\r\n            <div className=\"columns \">\r\n            <div className=\"column is-8 \">\r\n              {/*   <FacilityList /> */}\r\n                </div>\r\n            <div className=\"column is-4 \">\r\n               {/*  {(state.facilityModule.show ==='create')&&<FacilityCreate />}\r\n                {(state.facilityModule.show ==='detail')&&<FacilityDetail  />}\r\n                {(state.facilityModule.show ==='modify')&&<FacilityModify facility={selectedFacility} />} */}\r\n               \r\n            </div>\r\n\r\n            </div>                            \r\n            </section>\r\n       \r\n    )\r\n    \r\n}\r\n\r\nexport function FacilityCreate(){\r\n    const { register, handleSubmit} = useForm(); //, watch, errors, reset \r\n    const [error, setError] =useState(false)\r\n    const [success, setSuccess] =useState(false)\r\n    const [message,setMessage] = useState(\"\")\r\n    const facilityServ=client.service('/facility')\r\n    //const history = useHistory()\r\n    const {user} = useContext(UserContext) //,setUser\r\n\r\n    \r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        setMessage(\"\")\r\n        setError(false)\r\n        setSuccess(false)\r\n          data.createdby=user._id\r\n          //console.log(data);\r\n          \r\n        facilityServ.create(data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                e.target.reset();\r\n                setMessage(\"Created facility successfully\")\r\n                setSuccess(true)\r\n            })\r\n            .catch((err)=>{\r\n                setMessage(\"Error creating facility, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n\r\n      } \r\n\r\n    return (\r\n        <>\r\n        <section className= \"section remPadTop\">\r\n        <div className=\"columns \">\r\n        <div /* className=\"column is-4 \" */>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Create Facility\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n            { success && <div className=\"message\"> {message}</div>}\r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input is-small\" ref={register({ required: true })}  name=\"facilityName\" type=\"text\" placeholder=\"Name of Facility\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                </div>\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })}  name=\"facilityAddress\" type=\"text\" placeholder=\"Address of Facility\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"facilityCity\" type=\"text\" placeholder=\"City/Town\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"facilityContactPhone\" type=\"text\" placeholder=\"Contact Phone No\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n           \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"facilityEmail\" type=\"email\" placeholder=\"Facility Email\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"facilityOwner\" type=\"text\" placeholder=\"Facility Owner\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"facilityType\" type=\"text\" placeholder=\"Facility Type\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"facilityCategory\" type=\"text\" placeholder=\"Facility Category\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\">\r\n                        Create\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            { error && <div className=\"message\"> {message}</div>}\r\n            </form>\r\n        </div>\r\n        </div>\r\n        </div>\r\n        </div>\r\n        </section>\r\n        </>\r\n    )\r\n   \r\n}\r\n\r\nexport default function FacilityPopup({facilityType,closeModal}){\r\n   // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const facilityServ=client.service('facility')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedFacility, setSelectedFacility]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n\r\n   \r\n\r\n  /*   const handleCreateNew = async()=>{\r\n        const    newfacilityModule={\r\n            selectedFacility:{},\r\n            show :'create'\r\n            }\r\n       await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule}))\r\n       //console.log(state)\r\n        \r\n\r\n    } */\r\n    const handleRow= async(facility)=>{\r\n        //console.log(\"b4\",state)\r\n\r\n        //console.log(\"handlerow\",facility)\r\n\r\n        await setSelectedFacility(facility)\r\n\r\n        const    newfacilityModule={\r\n            selectedDestination:facility,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, DestinationModule:newfacilityModule}))\r\n       //console.log(state)\r\n       closeModal()\r\n\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='facilityName'\r\n       console.log(val)\r\n       facilityServ.find({query: {\r\n                [field]: {\r\n                    $regex:val,\r\n                    $options:'i'\r\n                   \r\n                },\r\n                facilityType,\r\n                $limit:10,\r\n                $sort: {\r\n                    facilityName: 1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" facility  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error creating facility, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n\r\n           /*  if (val.length>2){\r\n                console.log(\"in\")\r\n               \r\n            }\r\n\r\n        }\r\n     */\r\n        const getFacilities=()=>{\r\n            facilityServ.find({query: {\r\n                facilityType,\r\n                $limit:20,\r\n                $sort: {\r\n                    facilityName: 1\r\n                  }\r\n                    }})\r\n            .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" facility  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating facility, probable network issues \"+ err )\r\n                    setError(true)\r\n                })\r\n\r\n        }\r\n\r\n    useEffect(() => {\r\n        getFacilities()\r\n\r\n        facilityServ.on('created', (obj)=>getFacilities())\r\n        facilityServ.on('updated', (obj)=>getFacilities())\r\n        facilityServ.on('patched', (obj)=>getFacilities())\r\n        facilityServ.on('removed', (obj)=>getFacilities())\r\n        return () => {\r\n           \r\n        }\r\n    },[])\r\n\r\n    //todo: pagination and vertical scroll bar\r\n\r\n    return(\r\n            <>  \r\n            <section className= \"section remPadTop\">\r\n            <div /* className=\"columns \" */>\r\n            <div /* className=\"column is-4 \" */>  \r\n                <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search Facilities\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Facilities </span></div>\r\n                    {/* <div className=\"level-right\">\r\n                        <div className=\"level-item\"> \r\n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                        </div>\r\n                    </div> */}\r\n\r\n                </div>\r\n                <div className=\"table-container pullup \">\r\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\r\n                                    <thead>\r\n                                        <tr>\r\n                                        <th><abbr title=\"S/No\">S/No</abbr></th>\r\n                                        <th>Facility Name</th>\r\n                                        <th><abbr title=\"Address\"> Address</abbr></th>\r\n                                        <th><abbr title=\"City\">City</abbr></th>\r\n                                        <th><abbr title=\"Phone\">Phone</abbr></th>\r\n                                        <th><abbr title=\"Email\">Email</abbr></th>\r\n                                        <th><abbr title=\"Type\">Type</abbr></th>\r\n                                        <th><abbr title=\"Category\">Category</abbr></th>\r\n                                        <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tfoot>\r\n                                        \r\n                                    </tfoot>\r\n                                    <tbody>\r\n                                        {facilities.map((facility, i)=>(\r\n\r\n                                            <tr key={facility._id} onClick={()=>handleRow(facility)} className={facility._id===(selectedFacility?._id||null)?\"is-selected\":\"\"}>\r\n                                            <th>{i+1}</th>\r\n                                            <th>{facility.facilityName}</th>\r\n                                            <td>{facility.facilityAddress}</td>\r\n                                            <td>{facility.facilityCity}</td>\r\n                                            <td>{facility.facilityContactPhone}</td>\r\n                                            <td>{facility.facilityEmail}</td>\r\n                                            <td>{facility.facilityType}</td>\r\n                                            <td>{facility.facilityCategory}</td>\r\n                                           \r\n                                            <td><span   className=\"showAction\"  >...</span></td>\r\n                                           \r\n                                            </tr>\r\n\r\n                                        ))}\r\n                                    </tbody>\r\n                                    </table>\r\n                                    \r\n                </div> \r\n                </div> \r\n                </div> \r\n                </section>              \r\n            </>\r\n              \r\n    )\r\n}","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\BillPrescriptionCreate.js",["425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\nimport {ProductCreate} from './Products'\r\nimport Encounter from '../EncounterMgt/Encounter';\r\nvar random = require('random-string-generator');\r\n// eslint-disable-next-line\r\nconst searchfacility={};\r\n\r\nexport default function BillPrescriptionCreate(){\r\n    // const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \r\n     //const [error, setError] =useState(false)\r\n     const [success, setSuccess] =useState(false)\r\n     const [message,setMessage] = useState(\"\")\r\n     // eslint-disable-next-line\r\n     const [facility,setFacility] = useState()\r\n     const ProductEntryServ=client.service('productentry')\r\n     const OrderServ=client.service('order')\r\n     //const history = useHistory()\r\n     const {user} = useContext(UserContext) //,setUser\r\n     // eslint-disable-next-line\r\n     const [currentUser,setCurrentUser] = useState()\r\n     const [type,setType] = useState(\"Bill\")\r\n     const [documentNo,setDocumentNo] = useState(\"\")\r\n     const [totalamount,setTotalamount] = useState(0)\r\n     const [qamount,setQAmount] = useState(null)\r\n     const [productId,setProductId] = useState(\"\")\r\n     const [source,setSource] = useState(\"\")\r\n     const [date,setDate] = useState(\"\")\r\n     const [name,setName] = useState(\"\")\r\n     const [inventoryId,setInventoryId] = useState(\"\")\r\n     const [baseunit,setBaseunit] = useState(\"\")\r\n     const [quantity,setQuantity] = useState(\"\")\r\n     const [sellingprice,setSellingPrice] = useState(\"\")\r\n     const [costprice,setCostprice] = useState(0)\r\n     const [invquantity,setInvQuantity] = useState(\"\")\r\n     const [calcamount,setCalcAmount] = useState(0)\r\n     const [productItem,setProductItem] = useState([])\r\n      const [billingId,setBilllingId]=useState(\"\")  \r\n      const [changeAmount, setChangeAmount] = useState(true)\r\n      const [paymentmode, setPaymentMode] = useState(\"\")\r\n      const [paymentOptions, setPaymentOptions]=useState([])\r\n      const [billMode, setBillMode]=useState(\"\")\r\n      const [productModal, setProductModal]=useState(false)\r\n      const [obj, setObj]=useState(\"\")\r\n     \r\n     const {state,setState}=useContext(ObjectContext)\r\n     const inputEl = useRef(0);\r\n     let calcamount1\r\n     let hidestatus\r\n  \r\n\r\n    \r\n  let medication =state.medicationModule.selectedMedication\r\n\r\n\r\n  const showDocumentation = async (value)=>{\r\n    setProductModal(true)\r\n  }\r\n  const handlecloseModal =()=>{\r\n    setProductModal(false)\r\n   // handleSearch(val)\r\n    }\r\n\r\n\r\n    const handleChangeMode= async(value)=>{\r\n        console.log(value)\r\n       await setPaymentMode(value)\r\n        console.log(paymentOptions)\r\n       let billm= paymentOptions.filter(el=>el.name===value)\r\n       await setBillMode(billm)\r\n        console.log(billm)\r\n        // at startup\r\n        // check payment mode options from patient financial info\r\n        // load that to select options\r\n        // default to HMO-->company-->family-->cash\r\n        //when chosen\r\n        //append payment mode to order\r\n        //check service contract for pricing info\r\n        // calculate pricing \r\n        // pricing\r\n\r\n\r\n    }\r\n\r\n    const handleRow= async(ProductEntry)=>{\r\n    //console.log(\"b4\",state)\r\n\r\n    //console.log(\"handlerow\",ProductEntry)\r\n\r\n    //await setMedication(ProductEntry)\r\n\r\n    const    newProductEntryModule={\r\n        selectedMedication:ProductEntry,\r\n        show :'detail'\r\n    }\r\n  await setState((prevstate)=>({...prevstate, medicationModule:newProductEntryModule}))\r\n   //console.log(state)\r\n  // ProductEntry.show=!ProductEntry.show\r\n\r\n        } \r\n \r\n     const [productEntry,setProductEntry]=useState({\r\n         productitems:[],\r\n         date,\r\n         documentNo,\r\n         type,\r\n         totalamount,\r\n         source,\r\n \r\n     })\r\n  \r\n     const productItemI={\r\n         productId,\r\n         name,\r\n         quantity,\r\n         sellingprice,\r\n         amount:calcamount, //||qamount\r\n         baseunit,\r\n         costprice,\r\n         billingId\r\n \r\n     }\r\n     // consider batchformat{batchno,expirydate,qtty,baseunit}\r\n     //consider baseunoit conversions\r\n     const getSearchfacility=async (obj)=>{\r\n       await setObj(obj)\r\n        if (!obj){\r\n            //\"clear stuff\"\r\n            setProductId(\"\")\r\n            setName(\"\")\r\n            setBaseunit(\"\")\r\n            setInventoryId(\"\")\r\n            setSellingPrice(\"\")\r\n            setInvQuantity(\"\")\r\n            setQAmount(null)\r\n            setCostprice(\"\")\r\n           // setCalcAmount(null)\r\n            return\r\n        }\r\n \r\n         setProductId(obj.productId)\r\n         setName(obj.name)\r\n         setBaseunit(obj.baseunit)\r\n         setInventoryId(obj.inventoryId)\r\n         setSellingPrice(obj.sellingprice) //modify this based on billing mode\r\n         setInvQuantity(obj.quantity)\r\n         setCostprice(obj.costprice)\r\n         setBilllingId(obj.billingId)\r\n\r\n         const contracts=obj.billingDetails.contracts\r\n         //const billingserv=client.service('billing')\r\n        if( billMode.type===\"HMO Cover\"){ //paymentmode\r\n         let contract=contracts.filter(el=>el.source_org===billMode.detail.hmo)\r\n         if (contract.length){\r\n            console.log(contract[0].price)\r\n            setSellingPrice(contract[0].price)\r\n            console.log(sellingprice)\r\n         }else{\r\n            toast({\r\n                message: 'Please HMO does not have cover/price for this drug. Either set drug price for HMO or try another drug or bill using cash',\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              })\r\n              setSellingPrice(0)\r\n         }\r\n        \r\n        \r\n        }\r\n        if( billMode.type===\"Company Cover\"){ //paymentmode\r\n            let contract=contracts.filter(el=>el.source_org===billMode.detail.company)\r\n            if (contract.length){\r\n            console.log(contract[0].price)\r\n            setSellingPrice(contract[0].price)\r\n            console.log(sellingprice)\r\n           \r\n           }else{\r\n\r\n            toast({\r\n                message: 'Please company does not have cover/price for this drug. Either set drug price for Company or try another drug or bill using cash',\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              })\r\n              setSellingPrice(0)   \r\n         }\r\n          \r\n        /*  setValue(\"facility\", obj._id,  {\r\n             shouldValidate: true,\r\n             shouldDirty: true\r\n         }) */\r\n     }\r\n    }\r\n     useEffect(() => {\r\n       /*  console.log(obj)\r\n        console.log(billMode)\r\n        if( paymentmode!==\"Cash\" && obj){\r\n            const contracts=obj.billingDetails.contracts\r\n            let contract=contracts.filter(el=>el.source_org===billMode.detail.hmo)\r\n           console.log(contract[0].price)\r\n           setSellingPrice(contract[0].price)\r\n           console.log(sellingprice)\r\n       }\r\n         return () => {\r\n            \r\n         } */\r\n     }, [obj])\r\n\r\n     useEffect(() => {\r\n         setCurrentUser(user)\r\n         //console.log(currentUser)\r\n         return () => {\r\n         \r\n         }\r\n     }, [user])\r\n \r\n     const handleUpdateTotal=async ()=>{\r\n        await setTotalamount(prevtotal=>Number(prevtotal) + Number(calcamount))\r\n     }\r\n \r\n     const handleChangeType=async (e)=>{\r\n         console.log(e.target.value)\r\n         await setType(e.target.value)\r\n     }\r\n \r\n     const handleAmount= async()=>{\r\n         await setQAmount(null)\r\n        // alert(\"Iam chaning qamount\")\r\n     }\r\n\r\n     const handleClickProd=async()=>{\r\n       /*   console.log(\"amount: \",productItemI.amount)\r\n         console.log(\"qamount: \",qamount)\r\n         console.log(\"calcamount: \",calcamount) */\r\n        if ( quantity===0||quantity===\"\"|| productId===\"\"){\r\n            toast({\r\n                message: 'You need to choose a product and quantity to proceed',\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              }) \r\n              return \r\n        }\r\n\r\n         await setSuccess(false)\r\n         await setProductItem(\r\n             prevProd=>prevProd.concat(productItemI)\r\n         )\r\n        handleUpdateTotal()\r\n            // generate billing info\r\n            const billInfo={\r\n                orderInfo:{\r\n                    orderId:medication._id,\r\n                    orderObj:medication,\r\n                  },\r\n                  serviceInfo:{            \r\n                    price: productItemI.sellingprice,\r\n                    quantity: productItemI.quantity,\r\n                    productId: productItemI.productId,\r\n                    name: productItemI.name,\r\n                    baseunit: productItemI.baseunit,\r\n                    amount:productItemI.amount,\r\n                    billingId:productItemI.billingId,\r\n                    createdby:user._id,\r\n                  },\r\n                  paymentInfo:{\r\n                    amountDue:productItemI.amount,\r\n                    paidup:0,\r\n                    balance:productItemI.amount,\r\n                    paymentDetails:[]\r\n              \r\n                  },\r\n                  participantInfo:{\r\n                    billingFacility:medication.destination,\r\n                    billingFacilityName:medication.destination_name,\r\n                    locationId:state.StoreModule.selectedStore._id, //selected location,\r\n                    clientId:medication.clientId,\r\n                    client:medication.client,\r\n                    paymentmode:billMode\r\n                  },\r\n                  createdBy:user.id,\r\n                  billing_status:\"Unpaid\"\r\n                }\r\n\r\n        //update order\r\n        \r\n        OrderServ.patch(medication._id,{\r\n            order_status:\"Billed\", //Billed\r\n            billInfo,\r\n        }).then((resp)=>{\r\n           // medication=resp\r\n           // console.log(resp)\r\n             handleRow(resp) \r\n            //update dispense\r\n\r\n        })\r\n        .catch((err)=>{\r\n            console.log(err)\r\n        })\r\n        \r\n        //update status(billed) + action()\r\n        //?attached chosen product to medication\r\n        //dispense helper?\r\n         setName(\"\")\r\n         setBaseunit(\"\")\r\n         setQuantity(\"\")\r\n         setInventoryId(\"\")\r\n         setSellingPrice(\"\")\r\n         setInvQuantity(\"\")\r\n             handleAmount()\r\n        // setCalcAmount(null)\r\n        await setSuccess(true)\r\n        /* console.log(success)\r\n        console.log(qamount)\r\n        console.log(productItem) */\r\n        setChangeAmount(true)\r\n     }\r\n   //check user for facility or get list of facility  \r\n    /*  useEffect(()=>{\r\n         //setFacility(user.activeProductEntry.FacilityId)//\r\n       if (!user.stacker){\r\n           console.log(currentUser)\r\n            /* setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\r\n             shouldValidate: true,\r\n             shouldDirty: true\r\n         })  \r\n \r\n       }\r\n     }) */\r\n \r\n     const handleQtty=async(e)=>{\r\n         if (invquantity<e.target.value){\r\n             toast({\r\n                 message: 'You can not sell more quantity than exist in inventory ' ,\r\n                 type: 'is-danger',\r\n                 dismissible: true,\r\n                 pauseOnHover: true,\r\n               })\r\n             return\r\n         }\r\n         setQuantity(e.target.value)\r\n         calcamount1=quantity*sellingprice\r\n         await setCalcAmount(calcamount1)\r\n         console.log(calcamount)\r\n     }\r\n \r\n     useEffect( () => {\r\n          setProductEntry({\r\n             \r\n             date,\r\n             documentNo,\r\n             type,\r\n             totalamount,\r\n             source,\r\n         })\r\n        setCalcAmount(quantity*sellingprice) \r\n         return () => {\r\n             \r\n         }\r\n     },[date])\r\n \r\n     const resetform=()=>{\r\n      setType(\"Sales\")\r\n     setDocumentNo(\"\")\r\n     setTotalamount(\"\")\r\n     setProductId(\"\")\r\n     setSource(\"\")\r\n     setDate(\"\")\r\n     setName(\"\")\r\n     setBaseunit()\r\n     setCostprice()\r\n     setProductItem([])\r\n     }\r\n\r\n\r\n     const handleMedicationDone= async()=>{ //handle selected single order\r\n        //console.log(\"b4\",state)\r\n    \r\n        //console.log(\"handlerow\",ProductEntry)\r\n    \r\n       // await setSelectedMedication(\"\")\r\n    \r\n        const    newProductEntryModule={\r\n            selectedMedication:{},\r\n            show :'create'\r\n        }\r\n      await setState((prevstate)=>({...prevstate, medicationModule:newProductEntryModule}))\r\n       //console.log(state)\r\n      // ProductEntry.show=!ProductEntry.show\r\n    \r\n    }\r\n \r\n     const onSubmit = async(e) =>{\r\n         e.preventDefault();\r\n         setMessage(\"\")\r\n         //setError(false)\r\n         setSuccess(false)\r\n         await setProductEntry({\r\n             \r\n             date,\r\n             documentNo,\r\n             type,\r\n             totalamount,\r\n             source,\r\n         })\r\n         productEntry.productitems=productItem\r\n         productEntry.createdby=user._id\r\n         productEntry.transactioncategory=\"debit\"\r\n        \r\n          // console.log(\"b4 facility\",productEntry);\r\n           if (user.currentEmployee){\r\n          productEntry.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\r\n           }else{\r\n             toast({\r\n                 message: 'You can not remove inventory from any organization',\r\n                 type: 'is-danger',\r\n                 dismissible: true,\r\n                 pauseOnHover: true,\r\n               }) \r\n               return\r\n           }\r\n           \r\n           if (state.StoreModule.selectedStore._id){\r\n             productEntry.storeId=state.StoreModule.selectedStore._id\r\n           }else{\r\n             toast({\r\n                 message: 'You need to select a store before removing inventory',\r\n                 type: 'is-danger',\r\n                 dismissible: true,\r\n                 pauseOnHover: true,\r\n               }) \r\n               return\r\n \r\n           }\r\n           //console.log(\"b4 create\",productEntry);\r\n        // ProductEntryServ.create(productEntry)\r\n         //.then((res)=>{\r\n                 //console.log(JSON.stringify(res))\r\n           //      resetform()\r\n                /*  setMessage(\"Created ProductEntry successfully\") */\r\n             //    setSuccess(true)\r\n               //  toast({\r\n                  /*    message: 'ProductExit created succesfully',\r\n                     type: 'is-success',\r\n                     dismissible: true,\r\n                     pauseOnHover: true,\r\n                   })\r\n                   setSuccess(false)\r\n                   setProductItem([])\r\n                   const today=new Date().toLocaleString()\r\n       \r\n                   setDate(today)\r\n                   const invoiceNo=random(6,'uppernumeric')\r\n                 setDocumentNo(invoiceNo)\r\n                 setType(\"Sales\")\r\n             })\r\n             .catch((err)=>{\r\n                 toast({\r\n                     message: 'Error creating ProductExit ' + err,\r\n                     type: 'is-danger',\r\n                     dismissible: true,\r\n                     pauseOnHover: true,\r\n                   })\r\n             }) */\r\n \r\n       } \r\n \r\n    // console.log(\"i am rendering\")\r\n   /*   useEffect(() => {\r\n         setMedication(state.medicationModule.selectedMedication)\r\n        // console.log(medication)\r\n         return () => {\r\n             \r\n         }\r\n     }, [state])\r\n  */\r\n    const handleChangeAmount=()=>{\r\n        setChangeAmount((rev)=>(!rev))\r\n        \r\n    }\r\n\r\n    const newclient=async ()=>{\r\n        await  setProductItem([])\r\n    }\r\n\r\n    useEffect(() => {\r\n        const oldname=medication.clientname\r\n        console.log(\"oldname\",oldname)\r\n        setSource(medication.clientname)\r\n\r\n        const newname=source\r\n        console.log(\"newname\",newname)\r\n        if (oldname!==newname){\r\n            //newdispense\r\n        \r\n        setProductItem([])\r\n        setTotalamount(0)\r\n\r\n        }\r\n       \r\n\r\n        const paymentoptions= []\r\n        const info = medication.client.paymentinfo\r\n        let billme={}\r\n       \r\n        if( medication.client.paymentinfo.cash===true){\r\n            const details={}\r\n            details.detail=  info.cashDetails\r\n            details.type=\"Cash\"\r\n            const obj={\r\n                name:\"Cash\",\r\n                value:\"Cash\",\r\n                detail:details,\r\n                type:\"Cash\"\r\n            }\r\n            paymentoptions.push(obj)\r\n            setPaymentMode(\"Cash\")\r\n            billme=obj\r\n        }\r\n        if( medication.client.paymentinfo.familyCover===true){\r\n            const details={}\r\n            details.detail=  info.familyDetails\r\n            details.type=\"Family Cover\"\r\n            const obj={\r\n                name:\"Family Cover\",\r\n                value:\"familyCover\",\r\n                detail:details,\r\n                type:\"Family Cover\"\r\n            }\r\n            paymentoptions.push(obj)\r\n            setPaymentMode(\"Family Cover\")\r\n            billme=obj\r\n            \r\n        }\r\n        if( medication.client.paymentinfo.companyCover===true){\r\n            const details={}\r\n            details.type=\"Company Cover\"\r\n            details.detail=  info.companyDetails.filter(el=>el.active===true)\r\n            details.detail.forEach(el=>{\r\n                const obj={\r\n                    name:\"Company: \" +el.companyName +\"(\"+el.companyPlan+\")\",\r\n                    value:\"companyCover\",\r\n                    detail:el,\r\n                    type:\"Company Cover\" \r\n                }\r\n                paymentoptions.push(obj)\r\n                setPaymentMode(\"Company: \" +el.companyName +\"(\"+el.companyPlan+\")\")\r\n               // console.log(\"Company: \" +el.companyName +\"(\"+el.companyPlan+\")\")\r\n               billme=obj\r\n            })\r\n        }\r\n\r\n        if( medication.client.paymentinfo.hmoCover===true){\r\n            \r\n            const details={}\r\n            details.type=\"HMO Cover\"\r\n            details.detail=  info.hmoDetails.filter(el=>el.active===true)\r\n            details.detail.forEach(el=>{\r\n                const obj={\r\n                    name:\"HMO: \" +el.hmoName +\"(\"+el.hmoPlan+\")\",\r\n                    value:\"hmoCover\",\r\n                    detail:el,\r\n                    type:\"HMO Cover\"\r\n                }\r\n                paymentoptions.push(obj)\r\n                setPaymentMode(\"HMO: \" +el.hmoName +\"(\"+el.hmoPlan+\")\")\r\n                //console.log(\"HMO: \" +el.hmoName +\"(\"+el.hmoPlan+\")\")\r\n                billme=obj\r\n            })\r\n         \r\n        }\r\n        setPaymentOptions(paymentoptions)\r\n        setBillMode(billme)\r\n       console.log(paymentoptions)\r\n        console.log(billMode)\r\n        return () => {\r\n           \r\n        }\r\n    }, [medication])\r\n\r\n     useEffect(() => {\r\n       // const medication =state.medicationModule.selectedMedication\r\n         const today=new Date().toLocaleString()\r\n         console.log(today)\r\n         setDate(today)\r\n         const invoiceNo=random(6,'uppernumeric')\r\n         setDocumentNo(invoiceNo)\r\n         return () => {\r\n             \r\n         }\r\n     }, [])\r\n\r\n     useEffect(() => {\r\n        calcamount1=quantity*sellingprice\r\n         setCalcAmount(calcamount1)\r\n         console.log(calcamount)\r\n         setChangeAmount(true)\r\n        return () => {\r\n            \r\n        }\r\n    }, [quantity])\r\n\r\n// console.log(\"simpa\")\r\n     return (\r\n         <>\r\n             <div className=\"card card-overflow\">\r\n             <div className=\"card-header\">\r\n                 <p className=\"card-header-title\">\r\n                     Bill Product\r\n                 </p>\r\n                 <button className=\"button is-success is-small btnheight mt-2\" onClick={showDocumentation}>Documentation</button>\r\n             </div>\r\n             <div className=\"card-content \">\r\n    \r\n             <form onSubmit={onSubmit}> {/* handleSubmit(onSubmit) */}\r\n             <div className=\"field is-horizontal\">\r\n             <div className=\"field-body\">\r\n            {/*  <div className=\"field\">    \r\n                 <div className=\"control\">\r\n                     <div className=\"select is-small\">\r\n                         <select name=\"type\" value={type} onChange={handleChangeType} className=\"selectadd\">\r\n                            <option value=\"\">Choose Type </option>\r\n                             <option value=\"Dispense\">Dispense</option>\r\n                             <option value=\"Bill\">Bill </option> */}\r\n                             {/* <option value=\"Dispense\">Dispense</option>\r\n                             <option value=\"Audit\">Audit</option> */}\r\n                 {/*         </select>\r\n                     </div>\r\n                 </div>\r\n             </div>\r\n */}\r\n             <div className=\"field\">\r\n                     <p className=\"control has-icons-left has-icons-right\">\r\n                         <input className=\"input is-small\" /* ref={register({ required: true })} */ value={source} name=\"client\" type=\"text\" onChange={e=>setSource(e.target.value)} placeholder=\"Client\" />\r\n                         <span className=\"icon is-small is-left\">\r\n                             <i className=\"fas fa-hospital\"></i>\r\n                         </span>                    \r\n                     </p>\r\n                 </div>\r\n                 <div className=\"field\">    \r\n                 <div className=\"control\">\r\n                     <div className=\"select is-small \">\r\n                         <select name=\"paymentmode\" value={paymentmode} onChange={(e)=>handleChangeMode(e.target.value)} className=\"selectadd\" >\r\n                         <option value=\"\">Billing Mode </option>\r\n                           {paymentOptions.map((option,i)=>(\r\n                               <option key={i} value={option.details}> {option.name}</option>\r\n                           ))}\r\n                           \r\n                            \r\n                            {/*  <option value=\"Cash\">Cash</option>\r\n                             <option value=\"Family\">Family </option>\r\n                            <option value=\"Company Cover\">Company Cover</option>\r\n                             <option value=\"HMO\">HMO</option> */}\r\n                         </select>\r\n                     </div>\r\n                 </div>\r\n             </div>\r\n            \r\n             </div>\r\n             </div> {/* horizontal end */}\r\n            {/*  <div className=\"field\">\r\n                 <p className=\"control has-icons-left\"> // Audit/initialization/Purchase Invoice \r\n                     <input className=\"input is-small\"  ref={register({ required: true })} name=\"type\" type=\"text\" placeholder=\"Type of Product Entry\"/>\r\n                     <span className=\"icon is-small is-left\">\r\n                     <i className=\" fas fa-user-md \"></i>\r\n                     </span>\r\n                 </p>\r\n             </div> */}\r\n                <div className=\"field is-horizontal\">\r\n                <div className=\"field-body\">\r\n                <div className=\"field\">\r\n                 <p className=\"control has-icons-left has-icons-right\">\r\n                     <input className=\"input is-small\"  /* ref={register({ required: true })} */ value={date}  name=\"date\" type=\"text\" onChange={e=>setDate(e.target.value)} placeholder=\"Date\" />\r\n                     <span className=\"icon is-small is-left\">\r\n                         <i className=\"fas fa-map-signs\"></i>\r\n                     </span>\r\n                 </p>\r\n             </div>\r\n             <div className=\"field\">\r\n                 <p className=\"control has-icons-left\">\r\n                     <input className=\"input is-small\" /* ref={register} */ name=\"documentNo\" value={documentNo} type=\"text\" onChange={e=>setDocumentNo(e.target.value)} placeholder=\" Invoice Number\"/>\r\n                     <span className=\"icon is-small is-left\">\r\n                     <i className=\"fas fa-phone-alt\"></i>\r\n                     </span>\r\n                 </p>\r\n             </div>\r\n             <div className=\"field\">\r\n                 <p className=\"control has-icons-left\">\r\n                     <input className=\"input is-small\" /* ref={register({ required: true })} */ value={totalamount} name=\"totalamount\" type=\"text\" onChange={e=>setTotalamount(e.target.value)} placeholder=\" Total Amount\"/>\r\n                     <span className=\"icon is-small is-left\">\r\n                     <i className=\"fas fa-coins\"></i>\r\n                     </span>\r\n                 </p>\r\n             </div>\r\n \r\n                 </div> \r\n                 </div> \r\n                \r\n                 </form>   \r\n                \r\n            \r\n          {/* array of ProductEntry items */}\r\n         \r\n         <label className=\"label is-small\">Medication:</label>\r\n         <div className=\"field is-horizontal\">\r\n             <div className=\"field-body\">\r\n             <div className=\"field\" style={{width:\"40%\"}}>\r\n                 <p className=\"control has-icons-left\" >\r\n                     <input className=\"input is-small\"  /* ref={register({ required: true })} */ disabled  name=\"order\" value={medication.order} type=\"text\" onChange={ e=> handleQtty(e)} placeholder=\"Quantity\"  />\r\n                     <span className=\"icon is-small is-left\">\r\n                     <i className=\"fas fa-hashtag\"></i>\r\n                     </span>\r\n                     <span className=\"helper is-size-7\"><strong>Instruction: </strong>{medication.instruction}</span>\r\n                    \r\n                 </p>\r\n                 <span className=\"helper is-size-7\"><strong>Billing Status: </strong>{medication.order_status}</span>\r\n             </div> \r\n            \r\n             </div>\r\n             </div>\r\n             <label className=\"label is-small\">Choose Product Item:</label>\r\n          <div className=\"field is-horizontal\">\r\n             <div className=\"field-body\">\r\n             <div className=\"field is-expanded\"  /* style={ !user.stacker?{display:\"none\"}:{}} */ >\r\n                     <InventorySearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                     <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                         <input className=\"input is-small\" /* ref={register ({ required: true }) }  *//* add array no */  value={productId} name=\"productId\" type=\"text\" onChange={e=>setProductId(e.target.value)} placeholder=\"Product Id\" />\r\n                         <span className=\"icon is-small is-left\">\r\n                         <i className=\"fas  fa-map-marker-alt\"></i>\r\n                         </span>\r\n                     </p>\r\n                  {sellingprice &&   \"N\"}{sellingprice} {sellingprice &&   \"per\"}  {baseunit} {invquantity} {sellingprice &&   \"remaining\"} \r\n                 </div>\r\n             </div>\r\n         </div>\r\n         <div className=\"field is-horizontal\">\r\n             <div className=\"field-body\" >\r\n                 <div className=\"field\" style={{width:\"40%\"}}>\r\n                 <p className=\"control has-icons-left\" >\r\n                     <input className=\"input is-small\"  /* ref={register({ required: true })} */ name=\"quantity\" value={quantity} type=\"text\" onChange={ e=> handleQtty(e)} placeholder=\"Quantity\"  />\r\n                     <span className=\"icon is-small is-left\">\r\n                     <i className=\"fas fa-hashtag\"></i>\r\n                     </span>\r\n                    \r\n                 </p>\r\n         <label >{baseunit}</label>\r\n             </div> \r\n             <div className=\"field\">\r\n             <label>Amount:</label>{/* <p>{quantity*sellingprice}</p> */}\r\n             </div>\r\n             <div className=\"field\" style={{width:\"40%\"}}>\r\n                 <p className=\"control has-icons-left \" /* style={{display:\"none\"}} */>\r\n                     <input className=\"input is-small\"  name=\"qamount\" disabled={changeAmount} value={calcamount} type=\"text\"  onChange={async e=> await setCalcAmount(e.target.value)}  placeholder=\"Amount\"  />\r\n                     <span className=\"icon is-small is-left\">\r\n                     <i className=\"fas fa-dollar-sign\"></i>\r\n                     </span>\r\n                 </p>\r\n                 <button className=\"button is-small is-success btnheight\" onClick={handleChangeAmount}>Adjust</button>\r\n \r\n             </div> \r\n             <div className=\"field\">\r\n             <p className=\"control\">\r\n                     <button className=\"button is-info is-small  is-pulled-right\">\r\n                       <span className=\"is-small\" onClick={handleClickProd}> +</span>\r\n                     </button>\r\n                 </p>\r\n             </div>\r\n             </div>\r\n          </div>\r\n             \r\n        {(productItem.length>0) && <div>\r\n             <label>Product Items:</label>\r\n          <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\r\n                 <thead>\r\n                     <tr>\r\n                     <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                     <th><abbr title=\"Type\">Name</abbr></th>\r\n                     <th><abbr title=\"Type\">Quanitity</abbr></th>\r\n                     <th><abbr title=\"Document No\">Unit</abbr></th>\r\n                     <th><abbr title=\"Cost Price\">Selling Price</abbr></th>\r\n                     <th><abbr title=\"Cost Price\">Amount</abbr></th>\r\n                     <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                     </tr>\r\n                 </thead>\r\n                 <tfoot>\r\n                     \r\n                 </tfoot>\r\n                 <tbody>\r\n                    { productItem.map((ProductEntry, i)=>(\r\n                          <tr key={i}>\r\n                         <th>{i+1}</th>\r\n                         <td>{ProductEntry.name}</td>\r\n                         <th>{ProductEntry.quantity}</th>\r\n                         <td>{ProductEntry.baseunit}</td>\r\n                         <td>{ProductEntry.sellingprice}</td>\r\n                         <td>{ProductEntry.amount}</td>\r\n                         <td><span className=\"showAction\"  >x</span></td>\r\n                         </tr>\r\n                     ))}\r\n                 </tbody>\r\n                 </table>\r\n                 <div className=\"field mt-2 is-grouped\">\r\n                 <p className=\"control\">\r\n                     <button className=\"button is-success is-small\" disabled={!productItem.length>0} onClick={handleMedicationDone}>\r\n                        Done\r\n                     </button>\r\n                 </p>\r\n                {/*  <p className=\"control\">\r\n                     <button className=\"button is-warning is-small\" disabled={!productItem.length>0} onClick={onSubmit} >\r\n                         Clear\r\n                     </button>\r\n                 </p> */}\r\n                 </div>\r\n                 </div>\r\n            \r\n             }\r\n             \r\n             \r\n             </div>\r\n             </div>\r\n             <div className={`modal ${productModal?\"is-active\":\"\"}` }>\r\n                                    <div className=\"modal-background\"></div>\r\n                                    <div className=\"modal-card  modalbkgrnd\">\r\n                                        <header className=\"modal-card-head  btnheight\">\r\n                                        <p className=\"modal-card-title\">Documentation</p>\r\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={handlecloseModal}></button>\r\n                                        </header>\r\n                                        <section className=\"modal-card-body modalcolor\">\r\n                                      \r\n                                         <Encounter standalone=\"true\" />\r\n                                        </section> \r\n                                        {/* <footer className=\"modal-card-foot\">\r\n                                        <button className=\"button is-success\">Save changes</button>\r\n                                        <button className=\"button\">Cancel</button>\r\n                                        </footer>  */}\r\n                                   </div>\r\n                                </div>      \r\n         </>\r\n     )\r\n    \r\n }\r\n\r\n export  function InventorySearch({getSearchfacility,clear}) {\r\n    \r\n    const productServ=client.service('inventory')\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n     const [searchError, setSearchError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [showPanel, setShowPanel] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [searchMessage, setSearchMessage] = useState(\"\") \r\n   // eslint-disable-next-line \r\n   const [simpa,setSimpa]=useState(\"\")\r\n   // eslint-disable-next-line \r\n   const [chosen,setChosen]=useState(false)\r\n   // eslint-disable-next-line \r\n   const [count,setCount]=useState(0)\r\n   const inputEl=useRef(null)\r\n   const [val,setVal]=useState(\"\")\r\n   const {user} = useContext(UserContext) \r\n   const {state}=useContext(ObjectContext)\r\n    const [productModal,setProductModal]=useState(false)\r\n\r\n   const handleRow= async(obj)=>{\r\n        await setChosen(true)\r\n        //alert(\"something is chaning\")\r\n       getSearchfacility(obj)\r\n       \r\n       await setSimpa(obj.name)\r\n       \r\n        // setSelectedFacility(obj)\r\n        setShowPanel(false)\r\n        await setCount(2)\r\n        /* const    newfacilityModule={\r\n            selectedFacility:facility,\r\n            show :'detail'\r\n        }\r\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\r\n   //console.log(state)\r\n    }\r\n    const handleBlur=async(e)=>{\r\n         if (count===2){\r\n             console.log(\"stuff was chosen\")\r\n         }\r\n       \r\n       /*  console.log(\"blur\")\r\n         setShowPanel(false)\r\n        console.log(JSON.stringify(simpa))\r\n        if (simpa===\"\"){\r\n            console.log(facilities.length)\r\n            setSimpa(\"abc\")\r\n            setSimpa(\"\")\r\n            setFacilities([])\r\n            inputEl.current.setValue=\"\"\r\n        }\r\n        console.log(facilities.length)\r\n        console.log(inputEl.current) */\r\n    }\r\n    const handleSearch=async(value)=>{\r\n        setVal(value)\r\n        if (value===\"\"){\r\n            setShowPanel(false)\r\n            getSearchfacility(false)\r\n            return\r\n        }\r\n        const field='name' //field variable\r\n\r\n       \r\n        if (value.length>=3 ){\r\n            productServ.find({query: {     //service\r\n                 [field]: {\r\n                     $regex:value,\r\n                     $options:'i'\r\n                    \r\n                 },\r\n                 facility: user.currentEmployee.facilityDetail._id,\r\n                 storeId: state.StoreModule.selectedStore._id,\r\n                 $limit:10,\r\n                 $sort: {\r\n                     createdAt: -1\r\n                   }\r\n                     }}).then((res)=>{\r\n              console.log(\"product  fetched successfully\") \r\n              console.log(res.data) \r\n                setFacilities(res.data)\r\n                 setSearchMessage(\" product  fetched successfully\")\r\n                 setShowPanel(true)\r\n             })\r\n             .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating ProductEntry ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n             })\r\n         }\r\n        else{\r\n            console.log(\"less than 3 \")\r\n            console.log(val)\r\n            setShowPanel(false)\r\n            await setFacilities([])\r\n            console.log(facilities)\r\n        }\r\n    }\r\n\r\n    const handleAddproduct =()=>{\r\n        setProductModal(true) \r\n    }\r\n    const handlecloseModal =()=>{\r\n        setProductModal(false)\r\n        handleSearch(val)\r\n    }\r\n    useEffect(() => {\r\n       if (clear){\r\n           console.log(\"success has changed\",clear)\r\n           setSimpa(\"\")\r\n       }\r\n        return () => {\r\n            \r\n        }\r\n    }, [clear] )\r\n    return (\r\n        <div>\r\n            <div className=\"field\">\r\n                <div className=\"control has-icons-left  \">\r\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`} style={{width:\"100%\"}}>\r\n                        <div className=\"dropdown-trigger\" style={{width:\"100%\"}}>\r\n                            <DebounceInput className=\"input is-small  is-expanded\" \r\n                                type=\"text\" placeholder=\"Search Product\"\r\n                                value={simpa}\r\n                                minLength={3}\r\n                                debounceTimeout={400}\r\n                                onBlur={(e)=>handleBlur(e)}\r\n                                onChange={(e)=>handleSearch(e.target.value)}\r\n                                inputRef={inputEl}\r\n                                  />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-search\"></i>\r\n                            </span>\r\n                        </div>\r\n                        {/* {searchError&&<div>{searchMessage}</div>} */}\r\n                        <div className=\"dropdown-menu expanded\" style={{width:\"100%\"}}>\r\n                            <div className=\"dropdown-content\">\r\n                          { facilities.length>0?\"\":<div className=\"dropdown-item\" /* onClick={handleAddproduct} */> <span> {val} is not in your inventory</span> </div>}\r\n\r\n                              {facilities.map((facility, i)=>(\r\n                                    \r\n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\r\n                                        \r\n                                        <div><span>{facility.name}</span></div>\r\n                                        <div><span><strong>{facility.quantity}</strong></span>\r\n                                        <span>{facility.baseunit}(s) remaining</span>\r\n                                        <span className=\"padleft\"><strong>Price:</strong> N{facility.sellingprice}</span></div>\r\n                                        \r\n                                    </div>\r\n                                    \r\n                                    ))}\r\n                                    \r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            \r\n        </div>\r\n    )\r\n}",["442","443"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\Dispensary.js",["444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\ProductExit.js",["468","469","470","471","472","473","474","475","476","477","478","479","480"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\nimport {ProductCreate} from './Products'\r\nvar random = require('random-string-generator');\r\n// eslint-disable-next-line\r\nconst searchfacility={};\r\n\r\n\r\nexport default function ProductEntry() {\r\n    const {state}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedProductEntry,setSelectedProductEntry]=useState()\r\n    //const [showState,setShowState]=useState() //create|modify|detail\r\n    \r\n    return(\r\n        <section className= \"section remPadTop\">\r\n           {/*  <div className=\"level\">\r\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">ProductEntry  Module</span></div>\r\n            </div> */}\r\n            <div className=\"columns \">\r\n            <div className=\"column is-6 \">\r\n                <ProductExitList />\r\n                </div>\r\n            <div className=\"column is-6 \">\r\n                {(state.ProductExitModule.show ==='create')&&<ProductExitCreate />}\r\n                {(state.ProductExitModule.show ==='detail')&&<ProductExitDetail  />}\r\n                {(state.ProductExitModule.show ==='modify')&&<ProductExitModify ProductEntry={selectedProductEntry} />}\r\n               \r\n            </div>\r\n\r\n            </div>                            \r\n            </section>\r\n       \r\n    )\r\n    \r\n}\r\n\r\nexport function ProductExitCreate(){\r\n   // const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \r\n    const [error, setError] =useState(false)\r\n    const [success, setSuccess] =useState(false)\r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line\r\n    const [facility,setFacility] = useState()\r\n    const ProductEntryServ=client.service('productentry')\r\n    //const history = useHistory()\r\n    const {user} = useContext(UserContext) //,setUser\r\n    // eslint-disable-next-line\r\n    const [currentUser,setCurrentUser] = useState()\r\n    const [type,setType] = useState(\"Sales\")\r\n    const [documentNo,setDocumentNo] = useState(\"\")\r\n    const [totalamount,setTotalamount] = useState(0)\r\n    const [qamount,setQAmount] = useState(null)\r\n    const [productId,setProductId] = useState(\"\")\r\n    const [source,setSource] = useState(\"\")\r\n    const [date,setDate] = useState(\"\")\r\n    const [name,setName] = useState(\"\")\r\n    const [inventoryId,setInventoryId] = useState(\"\")\r\n    const [baseunit,setBaseunit] = useState(\"\")\r\n    const [quantity,setQuantity] = useState(\"\")\r\n    const [sellingprice,setSellingPrice] = useState(\"\")\r\n    const [costprice,setCostprice] = useState(0)\r\n    const [invquantity,setInvQuantity] = useState(\"\")\r\n    const [calcamount,setCalcAmount] = useState(0)\r\n    const [productItem,setProductItem] = useState([])\r\n    const [billingId,setBilllingId]=useState(\"\")  \r\n    const [changeAmount, setChangeAmount] = useState(true)\r\n    const {state}=useContext(ObjectContext)\r\n    const inputEl = useRef(0);\r\n    let calcamount1\r\n    let hidestatus\r\n\r\n    let medication =state.financeModule.selectedFinance\r\n    console.log(\"medication\", medication)\r\n\r\n    const [productEntry,setProductEntry]=useState({\r\n        productitems:[],\r\n        date,\r\n        documentNo,\r\n        type,\r\n        totalamount,\r\n        source,\r\n\r\n    })\r\n \r\n    const productItemI={\r\n        productId,\r\n        name,\r\n        quantity,\r\n        sellingprice,\r\n        amount:calcamount, //qamount||\r\n        baseunit,\r\n        costprice,\r\n        billingId\r\n\r\n    }\r\n    // consider batchformat{batchno,expirydate,qtty,baseunit}\r\n    //consider baseunoit conversions\r\n    const getSearchfacility=(obj)=>{\r\n\r\n        setProductId(obj.productId)\r\n        setName(obj.name)\r\n        setBaseunit(obj.baseunit)\r\n        setInventoryId(obj.inventoryId)\r\n        setSellingPrice(obj.sellingprice)\r\n        setInvQuantity(obj.quantity)\r\n        setCostprice(obj.costprice)\r\n        setBilllingId(obj.billingId)\r\n        if (!obj){\r\n            //\"clear stuff\"\r\n            setProductId(\"\")\r\n            setName(\"\")\r\n            setBaseunit(\"\")\r\n            setInventoryId(\"\")\r\n            setSellingPrice(\"\")\r\n            setInvQuantity(\"\")\r\n            setQAmount(null)\r\n            setCostprice(\"\")\r\n           // setCalcAmount(null)\r\n\r\n        }\r\n        \r\n       /*  setValue(\"facility\", obj._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        }) */\r\n    }\r\n    \r\n    useEffect(() => {\r\n        setCurrentUser(user)\r\n        //console.log(currentUser)\r\n        return () => {\r\n        \r\n        }\r\n    }, [user])\r\n\r\n    const handleUpdateTotal=()=>{\r\n\r\n        \r\n        setTotalamount(prevtotal=>Number(prevtotal) + Number(calcamount))\r\n    }\r\n\r\n    const handleChangeType=async (e)=>{\r\n        await setType(e.target.value)\r\n    }\r\n\r\n    const handleAmount= async()=>{\r\n        await setQAmount(null)\r\n       // alert(\"Iam chaning qamount\")\r\n    }\r\n    const handleClickProd=async()=>{\r\n        console.log(\"amount: \",productItemI.amount)\r\n        console.log(\"qamount: \",qamount)\r\n        console.log(\"calcamount: \",calcamount)\r\n\r\n        if ( quantity===0||quantity===\"\"|| productId===\"\"){\r\n            toast({\r\n                message: 'You need to choose a product and quantity to proceed',\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              }) \r\n              return \r\n        }\r\n\r\n        await setSuccess(false)\r\n        await setProductItem(\r\n            prevProd=>prevProd.concat(productItemI)\r\n        )\r\n       handleUpdateTotal()\r\n        setName(\"\")\r\n        setBaseunit(\"\")\r\n        setQuantity(\"\")\r\n        setInventoryId(\"\")\r\n        setSellingPrice(\"\")\r\n        setInvQuantity(\"\")\r\n            handleAmount()\r\n       // setCalcAmount(null)\r\n       await setSuccess(true)\r\n      /*  console.log(success)\r\n       console.log(qamount)\r\n       console.log(productItem) */\r\n       setChangeAmount(true)\r\n    }\r\n  //check user for facility or get list of facility  \r\n   /*  useEffect(()=>{\r\n        //setFacility(user.activeProductEntry.FacilityId)//\r\n      if (!user.stacker){\r\n          console.log(currentUser)\r\n           /* setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })  \r\n\r\n      }\r\n    }) */\r\n\r\n    const handleQtty=async(e)=>{\r\n        if (invquantity<e.target.value){\r\n            toast({\r\n                message: 'You can not sell more quantity than exist in inventory ' ,\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              })\r\n            return\r\n        }\r\n        setQuantity(e.target.value)\r\n        calcamount1=quantity*sellingprice\r\n        await setCalcAmount(calcamount1)\r\n        console.log(calcamount)\r\n\r\n       \r\n\r\n    }\r\n\r\n    useEffect( () => {\r\n         setProductEntry({\r\n            \r\n            date,\r\n            documentNo,\r\n            type,\r\n            totalamount,\r\n            source,\r\n        })\r\n       setCalcAmount(quantity*sellingprice) \r\n        return () => {\r\n            \r\n        }\r\n    },[date])\r\n\r\n    const resetform=()=>{\r\n     setType(\"Sales\")\r\n    setDocumentNo(\"\")\r\n    setTotalamount(\"\")\r\n    setProductId(\"\")\r\n    setSource(\"\")\r\n    setDate(\"\")\r\n    setName(\"\")\r\n    setBaseunit()\r\n    setCostprice()\r\n    setProductItem([])\r\n    }\r\n\r\n    const onSubmit = async(e) =>{\r\n        e.preventDefault();\r\n        setMessage(\"\")\r\n        setError(false)\r\n        setSuccess(false)\r\n        /* await setProductEntry({\r\n            \r\n            date,\r\n            documentNo,\r\n            type,\r\n            totalamount,\r\n            source,\r\n        }) */\r\n        productEntry.date = date\r\n        productEntry.documentNo= documentNo\r\n        productEntry.type=type\r\n        productEntry.totalamount= totalamount\r\n        productEntry.source=source\r\n        productEntry.productitems=productItem\r\n        productEntry.createdby=user._id\r\n        productEntry.transactioncategory=\"debit\"\r\n       \r\n          console.log(\"b4 facility\",productEntry);\r\n          if (user.currentEmployee){\r\n         productEntry.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\r\n          }else{\r\n            toast({\r\n                message: 'You can not remove inventory from any organization',\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              }) \r\n              return\r\n          }\r\n          if (state.StoreModule.selectedStore._id){\r\n            productEntry.storeId=state.StoreModule.selectedStore._id\r\n          }else{\r\n            toast({\r\n                message: 'You need to select a store before removing inventory',\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              }) \r\n              return\r\n\r\n          }\r\n          console.log(\"b4 create\",productEntry);\r\n        ProductEntryServ.create(productEntry)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                resetform()\r\n               /*  setMessage(\"Created ProductEntry successfully\") */\r\n                setSuccess(true)\r\n                toast({\r\n                    message: 'ProductExit created succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  setSuccess(false)\r\n                  setProductItem([])\r\n                  const today=new Date().toLocaleString()\r\n      \r\n                  setDate(today)\r\n                  const invoiceNo=random(6,'uppernumeric')\r\n                setDocumentNo(invoiceNo)\r\n                setType(\"Sales\")\r\n            })\r\n            .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating ProductExit ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n\r\n      const handleChangeAmount=()=>{\r\n        setChangeAmount((rev)=>(!rev))\r\n        \r\n    }\r\n   // console.log(\"i am rendering\")\r\n\r\n    useEffect(() => {\r\n        const today=new Date().toLocaleString()\r\n        //console.log(today)\r\n        setDate(today)\r\n        const invoiceNo=random(6,'uppernumeric')\r\n        setDocumentNo(invoiceNo)\r\n        return () => {\r\n            \r\n        }\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        calcamount1=quantity*sellingprice\r\n         setCalcAmount(calcamount1)\r\n         console.log(calcamount)\r\n         setChangeAmount(true)\r\n        return () => {\r\n            \r\n        }\r\n    }, [quantity])\r\n\r\n  \r\n    \r\n\r\n    return (\r\n        <>\r\n            <div className=\"card card-overflow\">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                   Point of Sale: Sales, Dispense, Audit, Transfer out\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content \">\r\n   \r\n            <form onSubmit={onSubmit}> {/* handleSubmit(onSubmit) */}\r\n            <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n            <div className=\"field\">    \r\n                <div className=\"control\">\r\n                    <div className=\"select is-small\">\r\n                        <select name=\"type\" value={type} onChange={handleChangeType} className=\"selectadd\">\r\n                           <option value=\"\">Choose Type </option>\r\n                            <option value=\"Sales\">Sales </option>\r\n                            <option value=\"In-house\">In-House </option>\r\n                            <option value=\"Dispense\">Dispense</option>\r\n                            <option value=\"Audit\">Audit</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input is-small\" /* ref={register({ required: true })} */ value={source} name=\"client\" type=\"text\" onChange={e=>setSource(e.target.value)} placeholder=\"Client\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                </div>\r\n           \r\n            </div>\r\n            </div> {/* horizontal end */}\r\n           {/*  <div className=\"field\">\r\n                <p className=\"control has-icons-left\"> // Audit/initialization/Purchase Invoice \r\n                    <input className=\"input is-small\"  ref={register({ required: true })} name=\"type\" type=\"text\" placeholder=\"Type of Product Entry\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\" fas fa-user-md \"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n               <div className=\"field is-horizontal\">\r\n               <div className=\"field-body\">\r\n               <div className=\"field\">\r\n                <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small\"  /* ref={register({ required: true })} */ value={date}  name=\"date\" type=\"text\" onChange={e=>setDate(e.target.value)} placeholder=\"Date\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" /* ref={register} */ name=\"documentNo\" value={documentNo} type=\"text\" onChange={e=>setDocumentNo(e.target.value)} placeholder=\" Invoice Number\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" /* ref={register({ required: true })} */ value={totalamount} name=\"totalamount\" type=\"text\" onChange={e=>setTotalamount(e.target.value)} placeholder=\" Total Amount\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-coins\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n\r\n                </div> \r\n                </div> \r\n               \r\n                </form>   \r\n               \r\n           \r\n         {/* array of ProductEntry items */}\r\n        \r\n        <label className=\"label is-small\">Add Product Items:</label>\r\n         <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n            <div className=\"field is-expanded\"  /* style={ !user.stacker?{display:\"none\"}:{}} */ >\r\n                    <InventorySearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                    <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                        <input className=\"input is-small\" /* ref={register ({ required: true }) }  *//* add array no */  value={productId} name=\"productId\" type=\"text\" onChange={e=>setProductId(e.target.value)} placeholder=\"Product Id\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas  fa-map-marker-alt\"></i>\r\n                        </span>\r\n                    </p>\r\n                 {sellingprice &&   \"N\"}{sellingprice} {sellingprice &&   \"per\"}  {baseunit} {invquantity} {sellingprice &&   \"remaining\"} \r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\" >\r\n                <div className=\"field\" style={{width:\"40%\"}}>\r\n                <p className=\"control has-icons-left\" >\r\n                    <input className=\"input is-small\"  /* ref={register({ required: true })} */ name=\"quantity\" value={quantity} type=\"text\" onChange={ e=> handleQtty(e)} placeholder=\"Quantity\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hashtag\"></i>\r\n                    </span>\r\n                   \r\n                </p>\r\n        <label >{baseunit}</label>\r\n            </div> \r\n            <div className=\"field\">\r\n            <label>Amount:</label>{/* <p>{quantity*sellingprice}</p> */}\r\n            </div>\r\n            <div className=\"field\" style={{width:\"40%\"}}>\r\n                <p className=\"control has-icons-left \" /* style={{display:\"none\"}} */>\r\n                    <input className=\"input is-small\" name=\"qamount\" disabled={changeAmount} value={calcamount} type=\"text\"  onChange={async e=> await setCalcAmount(e.target.value)}  placeholder=\"Amount\"   />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-dollar-sign\"></i>\r\n                    </span>\r\n                </p>\r\n                <button className=\"button is-small is-success btnheight\" onClick={handleChangeAmount}>Adjust</button>\r\n            </div> \r\n            <div className=\"field\">\r\n            <p className=\"control\">\r\n                    <button className=\"button is-info is-small  is-pulled-right\">\r\n                      <span className=\"is-small\" onClick={handleClickProd}> +</span>\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            </div>\r\n         </div>\r\n            \r\n       {(productItem.length>0) && <div>\r\n            <label>Product Items:</label>\r\n         <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\r\n                <thead>\r\n                    <tr>\r\n                    <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                    <th><abbr title=\"Type\">Name</abbr></th>\r\n                    <th><abbr title=\"Type\">Quanitity</abbr></th>\r\n                    <th><abbr title=\"Document No\">Unit</abbr></th>\r\n                    <th><abbr title=\"Cost Price\">Selling Price</abbr></th>\r\n                    <th><abbr title=\"Cost Price\">Amount</abbr></th>\r\n                    <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                    </tr>\r\n                </thead>\r\n                <tfoot>\r\n                    \r\n                </tfoot>\r\n                <tbody>\r\n                   { productItem.map((ProductEntry, i)=>(\r\n\r\n                        <tr key={i}>\r\n                        <th>{i+1}</th>\r\n                        <td>{ProductEntry.name}</td>\r\n                        <th>{ProductEntry.quantity}</th>\r\n                        <td>{ProductEntry.baseunit}</td>\r\n                        <td>{ProductEntry.sellingprice}</td>\r\n                        <td>{ProductEntry.amount}</td>\r\n                        <td><span className=\"showAction\"  >x</span></td>\r\n                        \r\n                        </tr>\r\n\r\n                    ))}\r\n                </tbody>\r\n                </table>\r\n                <div className=\"field mt-2 is-grouped\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" disabled={!productItem.length>0} onClick={onSubmit}>\r\n                        Sell\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" disabled={!productItem.length>0} /* onClick={onSubmit} */>\r\n                        Clear\r\n                    </button>\r\n                </p>\r\n                </div>\r\n                </div>\r\n           \r\n            }\r\n            \r\n            \r\n            </div>\r\n            </div>\r\n        </>\r\n    )\r\n   \r\n}\r\n\r\nexport function ProductExitList(){\r\n   // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const ProductEntryServ=client.service('productentry')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedProductEntry, setSelectedProductEntry]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n    // eslint-disable-next-line\r\n    const {user,setUser}=useContext(UserContext)\r\n\r\n\r\n\r\n    const handleCreateNew = async()=>{\r\n        const    newProductExitModule={\r\n            selectedProductEntry:{},\r\n            show :'create'\r\n            }\r\n       await setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n       //console.log(state)\r\n        \r\n\r\n    }\r\n    const handleRow= async(ProductEntry)=>{\r\n        //console.log(\"b4\",state)\r\n\r\n        //console.log(\"handlerow\",ProductEntry)\r\n\r\n        await setSelectedProductEntry(ProductEntry)\r\n\r\n        const    newProductExitModule={\r\n            selectedProductEntry:ProductEntry,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n       //console.log(state)\r\n\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='name'\r\n       console.log(val)\r\n       ProductEntryServ.find({query: {\r\n                [field]: {\r\n                    $regex:val,\r\n                    $options:'i'\r\n                   \r\n                },\r\n                transactioncategory:\"debit\",\r\n                storeId:state.StoreModule.selectedStore._id,\r\n               facility:user.currentEmployee.facilityDetail._id || \"\",\r\n                $limit:10,\r\n                $sort: {\r\n                    createdAt: -1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" ProductEntry  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error fetching ProductEntry, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n   \r\n        const getFacilities= async()=>{\r\n            if (user.currentEmployee){\r\n            \r\n        const findProductEntry= await ProductEntryServ.find(\r\n                {query: {\r\n                    transactioncategory:\"debit\",\r\n                    facility:user.currentEmployee.facilityDetail._id,\r\n                    storeId:state.StoreModule.selectedStore._id,\r\n                    $limit:20,\r\n                    $sort: {\r\n                        createdAt: -1\r\n                    }\r\n                    }})\r\n\r\n         await setFacilities(findProductEntry.data)\r\n                }\r\n                else {\r\n                    if (user.stacker){\r\n                        /* toast({\r\n                            message: 'You do not qualify to view this',\r\n                            type: 'is-danger',\r\n                            dismissible: true,\r\n                            pauseOnHover: true,\r\n                          }) \r\n                          return */\r\n                        const findProductEntry= await ProductEntryServ.find(\r\n                            {query: {\r\n                                transactioncategory:\"debit\",\r\n                                $limit:20,\r\n                                $sort: {\r\n                                    createdAt: -1\r\n                                }\r\n                                }})\r\n            \r\n                    await setFacilities(findProductEntry.data)\r\n\r\n                    }\r\n                }\r\n          /*   .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" ProductEntry  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\r\n                    setError(true)\r\n                }) */\r\n            }\r\n            \r\n         /*    useEffect(() => {\r\n                setTimeout(() => {\r\n                    console.log(\"happy birthday\")\r\n                    //getFacilities(user)\r\n                }, 200);\r\n\r\n                return () => {\r\n                    \r\n\r\n                }\r\n            },[]) */\r\n\r\n            useEffect(() => {\r\n               \r\n                if (!state.StoreModule.selectedStore){\r\n                    toast({\r\n                        message: 'kindly select a store',\r\n                        type: 'is-danger',\r\n                        dismissible: true,\r\n                        pauseOnHover: true,\r\n                      }) \r\n                      return\r\n                    getFacilities()\r\n\r\n                }else{\r\n                    /* const localUser= localStorage.getItem(\"user\")\r\n                    const user1=JSON.parse(localUser)\r\n                    console.log(localUser)\r\n                    console.log(user1)\r\n                    fetchUser(user1)\r\n                    console.log(user)\r\n                    getFacilities(user) */\r\n                }\r\n                ProductEntryServ.on('created', (obj)=>getFacilities())\r\n                ProductEntryServ.on('updated', (obj)=>getFacilities())\r\n                ProductEntryServ.on('patched', (obj)=>getFacilities())\r\n                ProductEntryServ.on('removed', (obj)=>getFacilities())\r\n                return () => {\r\n                \r\n                }\r\n            },[])\r\n\r\n            useEffect(() => {\r\n                getFacilities()\r\n                console.log(\"store changed\")\r\n                return () => {\r\n                   \r\n                }\r\n            }, [state.StoreModule.selectedStore])\r\n    //todo: pagination and vertical scroll bar\r\n\r\n    return(\r\n        <>\r\n           {state.StoreModule.selectedStore?( <>  \r\n                <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search ProductEntry\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Product Exits </span></div>\r\n                    <div className=\"level-right\">\r\n                        <div className=\"level-item\"> \r\n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <div className=\"table-container pullup \">\r\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\r\n                                    <thead>\r\n                                        <tr>\r\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                        <th><abbr title=\"Date\">Date</abbr></th>\r\n                                        <th><abbr title=\"Type\">Type</abbr></th>\r\n                                        <th>Client</th>\r\n                                        <th><abbr title=\"Document No\">Document No</abbr></th>\r\n                                        <th><abbr title=\"Total Amount\">Total Amount</abbr></th>\r\n                                        <th><abbr title=\"Enteredby\">Entered By</abbr></th>\r\n                                        <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tfoot>\r\n                                        \r\n                                    </tfoot>\r\n                                    <tbody>\r\n                                        {facilities.map((ProductEntry, i)=>(\r\n\r\n                                            <tr key={ProductEntry._id} onClick={()=>handleRow(ProductEntry)}>\r\n                                            <th>{i+1}</th>\r\n                                            <td>{ProductEntry.date}</td>\r\n                                            <th>{ProductEntry.type}</th>\r\n                                            <td>{ProductEntry.source}</td>\r\n                                            <td>{ProductEntry.documentNo}</td>\r\n                                            <td>{ProductEntry.totalamount}</td>\r\n                                            <td>{ProductEntry.enteredby}</td>\r\n                                            <td><span className=\"showAction\"  >...</span></td>\r\n                                           \r\n                                            </tr>\r\n\r\n                                        ))}\r\n                                    </tbody>\r\n                                    </table>\r\n                                    \r\n                </div>              \r\n            </>):<div>loading... Choose a Store</div>}\r\n            </>\r\n              \r\n    )\r\n    }\r\n\r\n\r\nexport function ProductExitDetail(){\r\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\r\n     // eslint-disable-next-line\r\n    const [error, setError] =useState(false) //, \r\n    //const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [message, setMessage] = useState(\"\") //,\r\n    //const ProductEntryServ=client.service('/ProductEntry')\r\n    //const history = useHistory()\r\n    //const {user,setUser} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n   \r\n\r\n   const ProductEntry =state.ProductExitModule.selectedProductEntry \r\n\r\n    const handleEdit= async()=>{\r\n        const    newProductExitModule={\r\n            selectedProductEntry:ProductEntry,\r\n            show :'modify'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n       //console.log(state)\r\n       \r\n    }\r\n \r\n    return (\r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    ProductEntry Details\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n                <table> \r\n                <tbody>         \r\n                <tr>\r\n                    <td>\r\n                      <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Type\r\n                        </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {ProductEntry.type} </span>\r\n                    </td>\r\n                    <td>\r\n\r\n                    </td>\r\n                    <td>\r\n                        <label className=\"label is-small padleft\"><span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-map-signs\"></i>\r\n                        </span>Supplier:\r\n                        </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"ProductEntryType\">{ProductEntry.source} </span> \r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\r\n                        <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Date:\r\n                        </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {ProductEntry.date} </span>\r\n                    </td>\r\n                    <td>\r\n                                \r\n                    </td>\r\n                    <td>\r\n                        <label className=\"label is-small padleft\"><span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-map-signs\"></i>\r\n                        </span>Invoice No:\r\n                        </label>\r\n                    </td>\r\n                    \r\n                    <td>\r\n                         <span className=\"is-size-7 padleft\"   name=\"ProductEntryType\">{ProductEntry.documentNo} </span> \r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\r\n                \r\n                        <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-hospital\"></i>\r\n                    </span>            \r\n                        Total Amount:\r\n                    </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {ProductEntry.totalamount} </span>\r\n                    </td>\r\n                </tr>\r\n\r\n                </tbody> \r\n            </table> \r\n            <label className=\"label is-size-7 mt-2\">Product Items:</label>\r\n         <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\r\n                <thead>\r\n                    <tr>\r\n                    <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                    <th><abbr title=\"Type\">Name</abbr></th>\r\n                    <th><abbr title=\"Type\">Quanitity</abbr></th>\r\n                    <th><abbr title=\"Document No\">Unit</abbr></th>\r\n                    <th><abbr title=\"Selling Price\">Selling Price</abbr></th>\r\n                    <th><abbr title=\"Amount\">Amount</abbr></th>\r\n                   \r\n                    </tr>\r\n                </thead>\r\n                <tfoot>\r\n                    \r\n                </tfoot>\r\n                <tbody>\r\n                   { ProductEntry.productitems.map((ProductEntry, i)=>(\r\n\r\n                        <tr key={i}>\r\n                        <th>{i+1}</th>\r\n                        <td>{ProductEntry.name}</td>\r\n                        <th>{ProductEntry.quantity}</th>\r\n                        <td>{ProductEntry.baseunit}</td>\r\n                        <td>{ProductEntry.sellingprice}</td>\r\n                        <td>{ProductEntry.amount}</td>\r\n                        \r\n                        \r\n                        </tr>\r\n\r\n                    ))}\r\n                </tbody>\r\n                </table>\r\n                  {/*   <tr>\r\n                    <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>Profession: \r\n                \r\n                    \r\n                    </label>\r\n                    </td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"ProductEntryCity\">{ProductEntry.profession}</span> \r\n                </td>\r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>Phone:           \r\n                    \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft \"  name=\"ProductEntryContactPhone\" >{ProductEntry.phone}</span>\r\n                        </td>\r\n                  </tr>\r\n                    <tr><td>\r\n            \r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>Email:                     \r\n                    \r\n                         </label></td><td>\r\n                         <span className=\"is-size-7 padleft \"  name=\"ProductEntryEmail\" >{ProductEntry.email}</span>\r\n                         </td>\r\n             \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i></span>Department:\r\n                    \r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft \"  name=\"ProductEntryOwner\">{ProductEntry.department}</span>\r\n                    </td>\r\n               \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>Departmental Unit:              \r\n                    \r\n                </label></td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"ProductEntryType\">{ProductEntry.deptunit}</span>\r\n                </td>\r\n              \r\n                </tr> */}\r\n                    \r\n          {/*   <div className=\"field\">\r\n             <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>Category:              \r\n                    <span className=\"is-size-7 padleft \"  name= \"ProductEntryCategory\">{ProductEntry.ProductEntryCategory}</span>\r\n                </label>\r\n                 </div> */}\r\n\r\n            \r\n           \r\n           {/*  <div className=\"field mt-2\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\r\n                        Edit\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            { error && <div className=\"message\"> {message}</div>} */}\r\n           \r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n}\r\n\r\nexport function ProductExitModify(){\r\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\r\n    // eslint-disable-next-line \r\n    const [error, setError] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [success, setSuccess] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line \r\n    const ProductEntryServ=client.service('productentry')\r\n    //const history = useHistory()\r\n     // eslint-disable-next-line\r\n    const {user} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n    const ProductEntry =state.ProductExitModule.selectedProductEntry \r\n\r\n        useEffect(() => {\r\n            setValue(\"name\", ProductEntry.name,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"ProductEntryType\", ProductEntry.ProductEntryType,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n           /*  setValue(\"profession\", ProductEntry.profession,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"phone\", ProductEntry.phone,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"email\", ProductEntry.email,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"department\", ProductEntry.department,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"deptunit\", ProductEntry.deptunit,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n          /*   setValue(\"ProductEntryCategory\", ProductEntry.ProductEntryCategory,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n            \r\n            return () => {\r\n                \r\n            }\r\n        })\r\n\r\n   const handleCancel=async()=>{\r\n    const    newProductExitModule={\r\n        selectedProductEntry:{},\r\n        show :'create'\r\n      }\r\n   await setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n   //console.log(state)\r\n           }\r\n\r\n\r\n        const changeState =()=>{\r\n        const    newProductExitModule={\r\n            selectedProductEntry:{},\r\n            show :'create'\r\n        }\r\n        setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n\r\n        }\r\n    const handleDelete=async()=>{\r\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\r\n        \r\n        const dleteId=ProductEntry._id\r\n        if (conf){\r\n             \r\n        ProductEntryServ.remove(dleteId)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                reset();\r\n               /*  setMessage(\"Deleted ProductEntry successfully\")\r\n                setSuccess(true)\r\n                changeState()\r\n               setTimeout(() => {\r\n                setSuccess(false)\r\n                }, 200); */\r\n                toast({\r\n                    message: 'ProductEntry deleted succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                changeState()\r\n            })\r\n            .catch((err)=>{\r\n               // setMessage(\"Error deleting ProductEntry, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error deleting ProductEntry, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n        }\r\n    }\r\n        \r\n\r\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n          })) */\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        \r\n        setSuccess(false)\r\n        console.log(data)\r\n        data.facility=ProductEntry.facility\r\n          //console.log(data);\r\n          \r\n        ProductEntryServ.patch(ProductEntry._id,data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n               // e.target.reset();\r\n               // setMessage(\"updated ProductEntry successfully\")\r\n                 toast({\r\n                    message: 'ProductEntry updated succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  \r\n                changeState()\r\n\r\n            })\r\n            .catch((err)=>{\r\n                //setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error updating ProductEntry, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n     \r\n      \r\n    return (\r\n        \r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    ProductEntry Details-Modify\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <div className=\"field\">\r\n                    <label className=\"label is-small\"> Name\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"name\" type=\"text\" placeholder=\"Name\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                    </label>\r\n                    </div>\r\n                <div className=\"field\">\r\n                <label className=\"label is-small\">ProductEntry Type\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small \" ref={register({ required: true })} disabled name=\"ProductEntryType\" type=\"text\" placeholder=\"ProductEntry Type\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n                </label>\r\n                </div>\r\n            {/* <div className=\"field\">\r\n            <label className=\"label is-small\">Profession\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"profession\" type=\"text\" placeholder=\"Profession\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Phone\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"phone\" type=\"text\" placeholder=\"Phone No\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                 </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Email\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"email\" type=\"email\" placeholder=\"ProductEntry Email\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Department\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                {errors.department && <span>This field is required</span>}\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Departmental Unit\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Departmental Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div> */}\r\n           {/*  <div className=\"field\">\r\n            <label className=\"label is-small\">Category\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"ProductEntryCategory\" type=\"text\" placeholder=\"ProductEntry Category\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n            </div> */}\r\n           \r\n           \r\n            </form>\r\n            \r\n            <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p>\r\n            </div>\r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n                \r\n}   \r\n\r\nexport  function InventorySearch({getSearchfacility,clear}) {\r\n    \r\n    const productServ=client.service('inventory')\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n     const [searchError, setSearchError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [showPanel, setShowPanel] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [searchMessage, setSearchMessage] = useState(\"\") \r\n   // eslint-disable-next-line \r\n   const [simpa,setSimpa]=useState(\"\")\r\n   // eslint-disable-next-line \r\n   const [chosen,setChosen]=useState(false)\r\n   // eslint-disable-next-line \r\n   const [count,setCount]=useState(0)\r\n   const inputEl=useRef(null)\r\n   const [val,setVal]=useState(\"\")\r\n   const {user} = useContext(UserContext) \r\n   const {state}=useContext(ObjectContext)\r\n    const [productModal,setProductModal]=useState(false)\r\n\r\n   const handleRow= async(obj)=>{\r\n        await setChosen(true)\r\n        //alert(\"something is chaning\")\r\n       getSearchfacility(obj)\r\n       \r\n       await setSimpa(obj.name)\r\n       \r\n        // setSelectedFacility(obj)\r\n        setShowPanel(false)\r\n        await setCount(2)\r\n        /* const    newfacilityModule={\r\n            selectedFacility:facility,\r\n            show :'detail'\r\n        }\r\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\r\n   //console.log(state)\r\n    }\r\n    const handleBlur=async(e)=>{\r\n         if (count===2){\r\n             console.log(\"stuff was chosen\")\r\n         }\r\n       \r\n       /*  console.log(\"blur\")\r\n         setShowPanel(false)\r\n        console.log(JSON.stringify(simpa))\r\n        if (simpa===\"\"){\r\n            console.log(facilities.length)\r\n            setSimpa(\"abc\")\r\n            setSimpa(\"\")\r\n            setFacilities([])\r\n            inputEl.current.setValue=\"\"\r\n        }\r\n        console.log(facilities.length)\r\n        console.log(inputEl.current) */\r\n    }\r\n    const handleSearch=async(value)=>{\r\n        setVal(value)\r\n        if (value===\"\"){\r\n            setShowPanel(false)\r\n            getSearchfacility(false)\r\n            return\r\n        }\r\n        const field='name' //field variable\r\n\r\n       \r\n        if (value.length>=3 ){\r\n            productServ.find({query: {     //service\r\n                 [field]: {\r\n                     $regex:value,\r\n                     $options:'i'\r\n                    \r\n                 },\r\n                 facility: user.currentEmployee.facilityDetail._id,\r\n                 storeId: state.StoreModule.selectedStore._id,\r\n                 $limit:10,\r\n                 $sort: {\r\n                     createdAt: -1\r\n                   }\r\n                     }}).then((res)=>{\r\n              console.log(\"product  fetched successfully\") \r\n              console.log(res.data) \r\n                setFacilities(res.data)\r\n                 setSearchMessage(\" product  fetched successfully\")\r\n                 setShowPanel(true)\r\n             })\r\n             .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating ProductEntry ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n             })\r\n         }\r\n        else{\r\n            console.log(\"less than 3 \")\r\n            console.log(val)\r\n            setShowPanel(false)\r\n            await setFacilities([])\r\n            console.log(facilities)\r\n        }\r\n    }\r\n\r\n    const handleAddproduct =()=>{\r\n        setProductModal(true) \r\n    }\r\n    const handlecloseModal =()=>{\r\n        setProductModal(false)\r\n        handleSearch(val)\r\n    }\r\n    useEffect(() => {\r\n       if (clear){\r\n           console.log(\"success has changed\",clear)\r\n           setSimpa(\"\")\r\n       }\r\n        return () => {\r\n            \r\n        }\r\n    }, [clear] )\r\n    return (\r\n        <div>\r\n            <div className=\"field\">\r\n                <div className=\"control has-icons-left  \">\r\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`} style={{width:\"100%\"}}>\r\n                        <div className=\"dropdown-trigger\" style={{width:\"100%\"}}>\r\n                            <DebounceInput className=\"input is-small  is-expanded\" \r\n                                type=\"text\" placeholder=\"Search Product\"\r\n                                value={simpa}\r\n                                minLength={3}\r\n                                debounceTimeout={400}\r\n                                onBlur={(e)=>handleBlur(e)}\r\n                                onChange={(e)=>handleSearch(e.target.value)}\r\n                                inputRef={inputEl}\r\n                                  />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-search\"></i>\r\n                            </span>\r\n                        </div>\r\n                        {/* {searchError&&<div>{searchMessage}</div>} */}\r\n                        <div className=\"dropdown-menu expanded\" style={{width:\"100%\"}}>\r\n                            <div className=\"dropdown-content\">\r\n                          { facilities.length>0?\"\":<div className=\"dropdown-item\" /* onClick={handleAddproduct} */> <span> {val} is not in your inventory</span> </div>}\r\n\r\n                              {facilities.map((facility, i)=>(\r\n                                    \r\n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\r\n                                        \r\n                                        <div><span>{facility.name}</span></div>\r\n                                        <div><span><strong>{facility.quantity}</strong></span>\r\n                                        <span>{facility.baseunit}(s) remaining</span>\r\n                                        <span className=\"padleft\"><strong>Price:</strong> N{facility.sellingprice}</span></div>\r\n                                        \r\n                                    </div>\r\n                                    \r\n                                    ))}\r\n                                    \r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className={`modal ${productModal?\"is-active\":\"\"}` }>\r\n                                    <div className=\"modal-background\"></div>\r\n                                    <div className=\"modal-card\">\r\n                                        <header className=\"modal-card-head\">\r\n                                        <p className=\"modal-card-title\">Choose Store</p>\r\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={handlecloseModal}></button>\r\n                                        </header>\r\n                                        <section className=\"modal-card-body\">\r\n                                        {/* <StoreList standalone=\"true\" /> */}\r\n                                        <ProductCreate />\r\n                                        </section>\r\n                                        {/* <footer className=\"modal-card-foot\">\r\n                                        <button className=\"button is-success\">Save changes</button>\r\n                                        <button className=\"button\">Cancel</button>\r\n                                        </footer> */}\r\n                                    </div>\r\n                                </div>       \r\n        </div>\r\n    )\r\n}","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\App.js",["481","482"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\LandingPage.js",[],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Clinic\\ClinicReport.js",[],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\DeptUnits.js",[],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\ClientMgt\\Patient.js",["483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport {Route, Switch,  useRouteMatch, Link, NavLink, useHistory} from 'react-router-dom'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\nimport { formatDistanceToNowStrict } from 'date-fns'\r\n// eslint-disable-next-line\r\nconst searchfacility={};\r\n\r\n\r\nexport default function Client() {\r\n    const {state}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedClient,setSelectedClient]=useState()\r\n    //const [showState,setShowState]=useState() //create|modify|detail\r\n    \r\n    return(\r\n        <section className= \"section remPadTop\">\r\n            <div className=\"columns \">\r\n            <div className=\"column is-6 \">\r\n                <ClientList />\r\n                </div>\r\n            <div className=\"column is-6 \">\r\n                {(state.ClientModule.show ==='create')&&<ClientCreate />}\r\n                {(state.ClientModule.show ==='detail')&&<ClientDetail  />}\r\n                {(state.ClientModule.show ==='modify')&&<ClientModify Client={selectedClient} />}\r\n               \r\n            </div>\r\n\r\n            </div>                            \r\n            </section>\r\n       \r\n    )\r\n    \r\n}\r\n\r\nexport function ClientCreate(){\r\n    const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \r\n    const [error, setError] =useState(false)\r\n    const [success, setSuccess] =useState(false)\r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line\r\n    const [facility,setFacility] = useState()\r\n    const ClientServ=client.service('client')\r\n    //const history = useHistory()\r\n    const {user} = useContext(UserContext) //,setUser\r\n    // eslint-disable-next-line\r\n    const [currentUser,setCurrentUser] = useState()\r\n\r\n\r\n\r\n    const getSearchfacility=(obj)=>{\r\n        setValue(\"facility\", obj._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })\r\n    }\r\n    \r\n    useEffect(() => {\r\n        setCurrentUser(user)\r\n        //console.log(currentUser)\r\n        return () => {\r\n        \r\n        }\r\n    }, [user])\r\n\r\n  //check user for facility or get list of facility  \r\n    useEffect(()=>{\r\n        //setFacility(user.activeClient.FacilityId)//\r\n      if (!user.stacker){\r\n       /*    console.log(currentUser)\r\n        setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })  */\r\n      }\r\n    })\r\n\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        setMessage(\"\")\r\n        setError(false)\r\n        setSuccess(false)\r\n         // data.createdby=user._id\r\n          console.log(data);\r\n          if (user.currentEmployee){\r\n          data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\r\n          }\r\n        ClientServ.create(data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                e.target.reset();\r\n               /*  setMessage(\"Created Client successfully\") */\r\n                setSuccess(true)\r\n                toast({\r\n                    message: 'Client created succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  setSuccess(false)\r\n            })\r\n            .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating Client ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n\r\n    return (\r\n        <>\r\n            <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Create Client\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable remPad1\">\r\n           {/*  <p className=\" is-small\">\r\n                    Kindly search Client list before creating new Clients!\r\n                </p> */}\r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <p className=\" is-small\">Names</p>\r\n            <div className=\"field is-horizontal\">\r\n                <div className=\"field-body\">\r\n                    <div className=\"field\">\r\n                        <p className=\"control has-icons-left has-icons-right\">\r\n                            <input className=\"input is-small is-danger\" ref={register({ required: true })}  name=\"firstname\" type=\"text\" placeholder=\"First Name\" />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-hospital\"></i>\r\n                            </span>                    \r\n                        </p>\r\n                    </div>\r\n                \r\n                \r\n                    <div className=\"field\">\r\n                        <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input is-small\" ref={register()}  name=\"middlename\" type=\"text\" placeholder=\"Middle Name\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-map-signs\"></i>\r\n                        </span>\r\n                        \r\n                        </p>\r\n                    </div>\r\n              \r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                        <input className=\"input is-small is-danger\" ref={register({ required: true })} name=\"lastname\" type=\"text\" placeholder=\"Last Name\"/>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\" fas fa-user-md \"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>\r\n            </div>  \r\n        </div>\r\n        <p className=\" is-small\">Biodata</p>\r\n        <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small is-danger\" ref={register({ required: true })} name=\"dob\" type=\"text\" placeholder=\"Date of Birth\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> \r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small\" ref={register()} name=\"gender\" type=\"text\" placeholder=\"Gender\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> \r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small\" ref={register()} name=\"maritalstatus\" type=\"text\" placeholder=\"Marital Status\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> \r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small\" ref={register()} name=\"mrn\" type=\"text\" placeholder=\"Medical Records Number\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> \r\n            </div>\r\n        </div>\r\n        <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small\" ref={register()} name=\"religion\" type=\"text\" placeholder=\"Religion\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> \r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small\" ref={register()} name=\"profession\" type=\"text\" placeholder=\"Profession\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> \r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                        <input className=\"input is-small is-danger\" ref={register({ required: true })} name=\"phone\" type=\"text\" placeholder=\" Phone No\"/>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-phone-alt\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>\r\n\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small is-danger\" ref={register({ required: true })} name=\"email\" type=\"email\" placeholder=\"Email\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> \r\n            </div>\r\n        </div>\r\n        <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                \r\n                    <input className=\"input is-small\" ref={register()} name=\"clientTags\" type=\"text\" placeholder=\"Tags\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> \r\n        <p className=\" is-small\">Address</p>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                \r\n                    <input className=\"input is-small\" ref={register()} name=\"address\" type=\"text\" placeholder=\"Residential Address\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> \r\n        <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small\" ref={register()} name=\"city\" type=\"text\" placeholder=\"Town/City\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> \r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small\" ref={register()} name=\"lga\" type=\"text\" placeholder=\"Local Govt Area\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> \r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small\" ref={register()} name=\"state\" type=\"text\" placeholder=\"State\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> \r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small\" ref={register()} name=\"country\" type=\"text\" placeholder=\"Country\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div> \r\n        <p className=\" is-small\">Medical Data</p>\r\n        <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n                    <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <input className=\"input is-small\" ref={register()} name=\"bloodgroup\" type=\"text\" placeholder=\"Blood Group\"  />\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div> \r\n                    <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <input className=\"input is-small\" ref={register()} name=\"genotype\" type=\"text\" placeholder=\"Genotype\"  />\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div> \r\n                    <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <input className=\"input is-small\" ref={register()} name=\"disabilities\" type=\"text\" placeholder=\"Disabilities\"  />\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div> \r\n                </div> \r\n            </div>  \r\n            \r\n        <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small\" ref={register()} name=\"allergies\" type=\"text\" placeholder=\"Allergies\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> \r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small\" ref={register()} name=\"comorbidities\" type=\"text\" placeholder=\"Co-mobidities\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> \r\n            </div>\r\n        </div>\r\n            \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register()} name=\"specificDetails\" type=\"text\" placeholder=\"Specific Details about patient\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> \r\n            <p className=\" is-small\">Next of Kin Information</p>\r\n        <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                        <input className=\"input is-small\" ref={register()} name=\"nok_name\" type=\"text\" placeholder=\"Next of Kin Full Name\"/>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-clinic-medical\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                        <input className=\"input is-small\" ref={register()} name=\"nok_phoneno\" type=\"text\" placeholder=\"Next of Kin Phone Number\"/>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-clinic-medical\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> \r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small\" ref={register()} name=\"nok_email\" type=\"email\" placeholder=\"Next of Kin Email\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <input className=\"input is-small\" ref={register()} name=\"nok_relationship\" type=\"text\" placeholder=\"Next of Kin Relationship\"  />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div> \r\n        <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" >\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={(e)=>e.target.reset()}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n               {/*  <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p> */}\r\n            </div>\r\n     \r\n            </form>\r\n            </div>\r\n            </div>\r\n                 {/*  <div className=\"field\"  style={ !user.stacker?{display:\"none\"}:{}} >\r\n                <InputSearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                    <input className=\"input is-small\" ref={register ({ required: true }) } name=\"facility\" type=\"text\" placeholder=\"Facility\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas  fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n         {/*   <div className=\"field\">\r\n                <div className=\"control has-icons-left\">\r\n                    <div className=\"dropdown \">\r\n                        <div className=\"dropdown-trigger\">\r\n                            <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital-symbol\"></i>\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"dropdown-menu\">\r\n                            <div className=\"dropdown-content\">\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa\r\n                                </div>\r\n                                <div className=\"dropdown-item is-active\">\r\n                                    simpa 2\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 3\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 4\r\n                                </div>\r\n                            </div>\r\n                        </div>   \r\n                    </div>\r\n                </div>\r\n            </div> */}\r\n        </>\r\n    )\r\n   \r\n}\r\n\r\nexport function ClientList(){\r\n   // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const ClientServ=client.service('client')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedClient, setSelectedClient]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n    // eslint-disable-next-line\r\n    const {user,setUser}=useContext(UserContext)\r\n\r\n\r\n\r\n    const handleCreateNew = async()=>{\r\n        const newClientModule={\r\n            selectedClient:{},\r\n            show :'create'\r\n            }\r\n        await setState((prevstate)=>({...prevstate, ClientModule:newClientModule}))\r\n       //console.log(state)\r\n        } \r\n\r\n    \r\n    const handleRow= async(Client)=>{\r\n        await setSelectedClient(Client)\r\n        const    newClientModule={\r\n            selectedClient:Client,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ClientModule:newClientModule}))\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='firstname'\r\n       console.log(val)\r\n       ClientServ.find({query: {\r\n                $or:[\r\n                    { firstname: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { lastname: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { middlename: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { phone: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { clientTags: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { mrn: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { specificDetails: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                ],\r\n              \r\n              facility:user.currentEmployee.facilityDetail._id, // || \"\",\r\n                $limit:10,\r\n                $sort: {\r\n                    createdAt: -1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" Client  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error fetching Client, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n   \r\n    const getFacilities= async()=>{\r\n            if (user.currentEmployee){      \r\n            const findClient= await ClientServ.find(\r\n                {query: {\r\n                   // facility:user.currentEmployee.facilityDetail._id,\r\n                    $limit:20,\r\n                    $sort: {\r\n                        createdAt: -1\r\n                    }\r\n                    }})\r\n\r\n         await setFacilities(findClient.data)\r\n                }\r\n                else {\r\n                    if (user.stacker){\r\n                        const findClient= await ClientServ.find(\r\n                            {query: {\r\n                                \r\n                                $limit:20,\r\n                                $sort: {\r\n                                    createdAt: -1\r\n                                }\r\n                                }})\r\n            \r\n                    await setFacilities(findClient.data)\r\n\r\n                    }\r\n                }\r\n          /*   .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" Client  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating Client, probable network issues \"+ err )\r\n                    setError(true)\r\n                }) */\r\n            }\r\n            \r\n    /* useEffect(() => {\r\n                setTimeout(() => {\r\n                    console.log(\"happy birthday\")\r\n                    //getFacilities(user)\r\n                }, 200);\r\n\r\n                return () => {\r\n                    \r\n\r\n                }\r\n            },[]) */\r\n\r\n    useEffect(() => {\r\n               \r\n                if (user){\r\n                    getFacilities()\r\n                }else{\r\n                    /* const localUser= localStorage.getItem(\"user\")\r\n                    const user1=JSON.parse(localUser)\r\n                    console.log(localUser)\r\n                    console.log(user1)\r\n                    fetchUser(user1)\r\n                    console.log(user)\r\n                    getFacilities(user) */\r\n                }\r\n                ClientServ.on('created', (obj)=>getFacilities())\r\n                ClientServ.on('updated', (obj)=>getFacilities())\r\n                ClientServ.on('patched', (obj)=>getFacilities())\r\n                ClientServ.on('removed', (obj)=>getFacilities())\r\n                return () => {\r\n                \r\n                }\r\n            },[])\r\n\r\n\r\n    //todo: pagination and vertical scroll bar\r\n\r\n    return(\r\n        <>\r\n           {user?( <>  \r\n                <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search Clients\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Clients </span></div>\r\n                    <div className=\"level-right\">\r\n                        <div className=\"level-item\"> \r\n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <div className=\"table-container pullup \">\r\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\r\n                                    <thead>\r\n                                        <tr>\r\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                        <th>First Name</th>\r\n                                        <th><abbr title=\"Middle Name\">Middle Name</abbr></th>\r\n                                       <th><abbr title=\"Last Name\">Last Name</abbr></th>\r\n                                       <th><abbr title=\"Age\">Age</abbr></th>\r\n                                        <th><abbr title=\"Gender\">Gender</abbr></th> \r\n                                        <th><abbr title=\"Phone\">Phone</abbr></th>\r\n                                        <th><abbr title=\"Email\">Email</abbr></th>\r\n                                        <th><abbr title=\"Tags\">Tags</abbr></th>\r\n                                        <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tfoot>\r\n                                        \r\n                                    </tfoot>\r\n                                    <tbody>\r\n                                        {facilities.map((Client, i)=>(\r\n\r\n                                            <tr key={Client._id} onClick={()=>handleRow(Client)}  className={Client._id===(selectedClient?._id||null)?\"is-selected\":\"\"}>\r\n                                            <th>{i+1}</th>\r\n                                            <th>{Client.firstname}</th>\r\n                                            <td>{Client.middlename}</td>\r\n                                           < td>{Client.lastname}</td>\r\n                                           <td>{Client.dob && <>{formatDistanceToNowStrict(new Date(Client.dob))}</>}</td>\r\n                                            <td>{Client.gender}</td>\r\n                                             <td>{Client.phone}</td>\r\n                                            <td>{Client.email}</td>\r\n                                            <td>{Client.clientTags}</td>\r\n                                            <td><span   className=\"showAction\"  >...</span></td>\r\n                                           \r\n                                            </tr>\r\n\r\n                                        ))}\r\n                                    </tbody>\r\n                                    </table>\r\n                                    \r\n                </div>              \r\n            </>):<div>loading</div>}\r\n            </>\r\n              \r\n    )\r\n    }\r\n\r\n\r\n\r\nexport function ClientDetail(){\r\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\r\n     // eslint-disable-next-line\r\n    const history =useHistory()\r\n    let { path, url } = useRouteMatch();\r\n    const [error, setError] =useState(false) //, \r\n    //const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [message, setMessage] = useState(\"\") //,\r\n    //const ClientServ=client.service('/Client')\r\n    //const history = useHistory()\r\n    //const {user,setUser} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n   \r\n\r\n   const Client =state.ClientModule.selectedClient \r\n    const client=Client\r\n    const handleEdit= async()=>{\r\n        const    newClientModule={\r\n            selectedClient:Client,\r\n            show :'modify'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ClientModule:newClientModule}))\r\n       //console.log(state)\r\n       \r\n    }\r\n \r\n    return (\r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Client Details\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <div className=\"field is-horizontal\">\r\n                <div className=\"field-body\">\r\n                {Client.firstname &&  <div className=\"field\">\r\n                        <p className=\"control has-icons-left has-icons-right\">\r\n                            <label className=\"label is-size-7 my-0 \"   name=\"firstname\" type=\"text\">First Name </label><label className=\"is-size-7 my-0 \">{Client.firstname }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"nop-hospital\"></i>\r\n                            </span>                    \r\n                        </p>\r\n                    </div>}\r\n\r\n\r\n                    {Client.middlename &&  <div className=\"field\">\r\n                        <p className=\"control has-icons-left has-icons-right\">\r\n                        <label className=\"label is-size-7 my-0\"   name=\"middlename\" type=\"text\"> Middle Name </label><label className=\"is-size-7 my-0\">{Client.middlename }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-map-signs\"></i>\r\n                        </span>\r\n                        \r\n                        </p>\r\n                    </div>}\r\n             {Client.lastname &&\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                        <label className=\"label is-size-7 my-0\"  name=\"lastname\" type=\"text\">Last Name</label><label className=\"is-size-7 my-0\">{Client.lastname }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\" nop-user-md \"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>}\r\n                </div>  \r\n                </div>\r\n                <div className=\"field is-horizontal\">\r\n                <div className=\"field-body\">\r\n                {Client.dob &&<div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"dob\" type=\"text\">Date of Birth </label><label className=\"is-size-7 my-0\">{ new Date(Client.dob).toLocaleDateString('en-GB')}</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> }\r\n                {Client.gender &&<div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"gender\" type=\"text\">Gender </label><label className=\"is-size-7 my-0\">{Client.gender }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> }\r\n                {Client.maritalstatus && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"maritalstatus\" type=\"text\">Marital Status </label><label className=\"is-size-7 my-0\">{Client.maritalstatus }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> }\r\n                {Client.mrn && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"mrn\" type=\"text\">Medical Records Number  </label><label className=\"is-size-7 my-0\">{Client.mrn }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> }\r\n                </div>\r\n                </div>\r\n                <div className=\"field is-horizontal\">\r\n                    <div className=\"field-body\">\r\n                    {Client.religion && <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <label className=\"label is-size-7 my-0\"  name=\"religion\" type=\"text\">Religion  </label><label className=\"is-size-7 my-0\">{Client.religion }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div> }\r\n                    {Client.profession &&  <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <label className=\"label is-size-7 my-0\"  name=\"profession\" type=\"text\">Profession  </label><label className=\"is-size-7 my-0\">{Client.profession }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div> }\r\n                    {Client.phone &&<div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                            <label className=\"label is-size-7 my-0\"  name=\"phone\" type=\"text\"> Phone No</label><label className=\"is-size-7 my-0\">{Client.phone }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-phone-alt\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div>}\r\n\r\n                    {Client.email && <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <label className=\"label is-size-7 my-0\"  name=\"email\" type=\"email\">Email  </label><label className=\"is-size-7 my-0\">{Client.email }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div> }\r\n                    </div>\r\n                </div>\r\n\r\n                {Client.address &&<div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n\r\n                    <label className=\"label is-size-7 my-0\"  name=\"address\" type=\"text\">Residential Address  </label><label className=\"is-size-7 my-0\">{Client.address }</label>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"nop-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                </div>} \r\n                <div className=\"field is-horizontal\">\r\n                    <div className=\"field-body\">\r\n                        {Client.city && <div className=\"field\">\r\n                            <p className=\"control has-icons-left\">\r\n                            \r\n                                <label className=\"label is-size-7 my-0\"  name=\"city\" type=\"text\">Town/City  </label><label className=\"is-size-7 my-0\">{Client.city }</label>\r\n                                <span className=\"icon is-small is-left\">\r\n                                <i className=\"nop-envelope\"></i>\r\n                                </span>\r\n                            </p>\r\n                        </div> }\r\n                        {Client.lga && <div className=\"field\">\r\n                            <p className=\"control has-icons-left\">\r\n                            \r\n                                <label className=\"label is-size-7 my-0\"  name=\"lga\" type=\"text\">Local Govt Area  </label><label className=\"is-size-7 my-0\">{Client.lga }</label>\r\n                                <span className=\"icon is-small is-left\">\r\n                                <i className=\"nop-envelope\"></i>\r\n                                </span>\r\n                            </p>\r\n                        </div> }\r\n                        {Client.state && <div className=\"field\">\r\n                            <p className=\"control has-icons-left\">\r\n                                <label className=\"label is-size-7 my-0\"  name=\"state\" type=\"text\">State  </label><label className=\"is-size-7 my-0\">{Client.state }</label>\r\n                                <span className=\"icon is-small is-left\">\r\n                                <i className=\"nop-envelope\"></i>\r\n                                </span>\r\n                            </p>\r\n                        </div> }\r\n                        {Client.country &&<div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <label className=\"label is-size-7 my-0\"  name=\"country\" type=\"text\">Country  </label><label className=\"is-size-7 my-0\">{Client.country }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div>}\r\n                    </div>\r\n                </div> \r\n                <div className=\"field is-horizontal\">\r\n                <div className=\"field-body\">\r\n                     {Client.bloodgroup &&  <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <label className=\"label is-size-7 my-0\"  name=\"bloodgroup\" type=\"text\">Blood Group </label><label className=\"is-size-7 my-0\">{Client.bloodgroup }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div>}\r\n                   \r\n                    {Client.genotype && <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <label className=\"label is-size-7 my-0\"  name=\"genotype\" type=\"text\">Genotype  </label><label className=\"is-size-7 my-0\">{Client.genotype }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div> }\r\n                    {Client.disabilities && <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <label className=\"label is-size-7 my-0\"  name=\"disabilities\" type=\"text\">Disabilities  </label><label className=\"is-size-7 my-0\">{Client.disabilities }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div> }\r\n                </div> \r\n                </div>  \r\n\r\n                <div className=\"field is-horizontal\">\r\n                <div className=\"field-body\">\r\n\r\n                {Client.allergies && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"allergies\" type=\"text\">Allergies  </label><label className=\"is-size-7 my-0\">{Client.allergies }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> }\r\n                {Client.comorbidities && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"comorbidities\" type=\"text\">Co-mobidities  </label><label className=\"is-size-7 my-0\">{Client.comorbidities }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> }\r\n                </div>\r\n                </div>\r\n               {Client.clientTags && <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n\r\n                    <label className=\"label is-size-7 my-0\"  name=\"clientTags\" type=\"text\">Tags </label><label className=\"is-size-7 my-0\">{Client.clientTags }</label>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"nop-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                </div> }\r\n                {Client.specificDetails && <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <label className=\"label is-size-7 my-0\"  name=\"specificDetails\" type=\"text\">Specific Details about Client </label><label className=\"is-size-7 my-0\">{Client.specificDetails }</label>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"nop-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                </div> }\r\n                <div className=\"field is-horizontal\">\r\n                <div className=\"field-body\">\r\n                {Client.nok_name && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                        <label className=\"label is-size-7 my-0\"  name=\"nok_name\" type=\"text\">Next of Kin Full Name</label><label className=\"is-size-7 my-0\">{Client.nok_name }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-clinic-medical\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>}\r\n                {Client.nok_phoneno && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                        <label className=\"label is-size-7 my-0\"  name=\"nok_phoneno\" type=\"text\">Next of Kin Phone Number</label><label className=\"is-size-7 my-0\">{Client.nok_phoneno }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-clinic-medical\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> }\r\n                {Client.nok_email && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"nok_email\" type=\"email\">Next of Kin Email </label><label className=\"is-size-7 my-0\">{Client.nok_email }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>}\r\n                {Client.nok_relationship && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"nok_relationship\" type=\"text\">Next of Kin Relationship\"  </label><label className=\"is-size-7 my-0\">{Client.nok_relationship }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>}\r\n                </div>\r\n                </div> \r\n            <div className=\"field is-grouped  mt-2\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\r\n                        Edit Details\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-info is-small\" >\r\n                        Financial Info\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" >\r\n                        Schedule appointment\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" >\r\n                        Check into Clinic \r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-link is-small\" onClick={()=>{history.push('/app/clinic/encounter')}} >\r\n                        Attend to Client\r\n                    </button>\r\n                </p>\r\n\r\n            </div>\r\n            \r\n           \r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n}\r\n\r\nexport function ClientModify(){\r\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\r\n    // eslint-disable-next-line \r\n    const [error, setError] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [success, setSuccess] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line \r\n    const ClientServ=client.service('client')\r\n    //const history = useHistory()\r\n     // eslint-disable-next-line\r\n    const {user} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n    const Client =state.ClientModule.selectedClient \r\n\r\n        useEffect(() => {\r\n            setValue(\"firstname\", Client.firstname,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"middlename\", Client.middlename,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n             setValue(\"lastname\", Client.lastname,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"phone\", Client.phone,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"email\", Client.email,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"dob\", Client.dob,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"gender\", Client.gender,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) \r\n             setValue(\"profession\", Client.profession,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) \r\n            setValue(\"address\", Client.address,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"city\", Client.city,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n             setValue(\"state\", Client.state,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"country\", Client.country,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"nok_name\", Client.nok_name,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"nok_email\", Client.nok_email,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"nok_phoneno\", Client.nokphoneno,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) \r\n             setValue(\"lga\", Client.lga,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) \r\n            setValue(\"bloodgroup\", Client.bloodgroup,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"genotype\", Client.genotype,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n             setValue(\"disabilities\", Client.disabilities,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"specificDetails\", Client.specificDetails,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"clientTags\", Client.clientTags,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"mrn\", Client.mrn,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"comorbidities\", Client.comorbidities,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) \r\n             setValue(\"allergies\", Client.allergies,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) \r\n           \r\n            \r\n            return () => {\r\n                \r\n            }\r\n        })\r\n\r\n   const handleCancel=async()=>{\r\n    const    newClientModule={\r\n        selectedClient:{},\r\n        show :'create'\r\n      }\r\n   await setState((prevstate)=>({...prevstate, ClientModule:newClientModule}))\r\n   //console.log(state)\r\n           }\r\n\r\n\r\n        const changeState =()=>{\r\n        const    newClientModule={\r\n            selectedClient:{},\r\n            show :'create'\r\n        }\r\n        setState((prevstate)=>({...prevstate, ClientModule:newClientModule}))\r\n\r\n        }\r\n    const handleDelete=async()=>{\r\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\r\n        \r\n        const dleteId=Client._id\r\n        if (conf){\r\n             \r\n        ClientServ.remove(dleteId)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                reset();\r\n               /*  setMessage(\"Deleted Client successfully\")\r\n                setSuccess(true)\r\n                changeState()\r\n               setTimeout(() => {\r\n                setSuccess(false)\r\n                }, 200); */\r\n                toast({\r\n                    message: 'Client deleted succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                changeState()\r\n            })\r\n            .catch((err)=>{\r\n               // setMessage(\"Error deleting Client, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error deleting Client, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n        }\r\n    }\r\n        \r\n\r\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n          })) */\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        \r\n        setSuccess(false)\r\n       // console.log(data)\r\n      //  data.facility=Client.facility\r\n          //console.log(data);\r\n          \r\n        ClientServ.patch(Client._id,data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n               // e.target.reset();\r\n               // setMessage(\"updated Client successfully\")\r\n                 toast({\r\n                    message: 'Client updated succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  \r\n                changeState()\r\n\r\n            })\r\n            .catch((err)=>{\r\n                //setMessage(\"Error creating Client, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error updating Client, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n     \r\n      \r\n    return (\r\n        \r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Client Details-Modify\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n            <div className=\"field is-horizontal\">\r\n        <div className=\"field-body\">\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left has-icons-right\">\r\n                    <label className=\"label is-size-7\"   >First Name </label> <input className=\"input is-small\" ref={register()} name=\"firstname\" type=\"text\"placeholder=\"First Name \" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-hospital\"></i>\r\n                    </span>                    \r\n                </p>\r\n            </div>\r\n\r\n\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left has-icons-right\">\r\n                <label className=\"label is-size-7\"   > Middle Name </label><input className=\"input is-small\" ref={register()} name=\"middlename\" type=\"text\" placeholder=\"Middle Name \" />\r\n                <span className=\"icon is-small is-left\">\r\n                    <i className=\"nop-map-signs\"></i>\r\n                </span>\r\n                \r\n                </p>\r\n            </div>\r\n\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n                <label className=\"label is-size-7\"  >Last Name</label><input className=\"input is-small\" ref={register()} name=\"lastname\" type=\"text\"placeholder=\"Last Name \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\" nop-user-md \"></i>\r\n                </span>\r\n            </p>\r\n        </div>\r\n        </div>  \r\n        </div>\r\n        \r\n        <div className=\"field is-horizontal\">\r\n        <div className=\"field-body\">\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Date of Birth  </label><input className=\"input is-small\" ref={register()} name=\"dob\" type=\"text\"placeholder=\"Date of Birth \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Gender  </label><input className=\"input is-small\" ref={register()} name=\"gender\" type=\"text\"placeholder=\"Gender  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Marital Status  </label><input className=\"input is-small\" ref={register()} name=\"maritalstatus\" type=\"text\"placeholder=\"Marital Status  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  > Records Number </label><input className=\"input is-small\" ref={register()} name=\"mrn\" type=\"text\"placeholder=\"Records Number  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        </div>\r\n        </div>\r\n        <div className=\"field is-horizontal\">\r\n        <div className=\"field-body\">\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Religion</label><input className=\"input is-small\" ref={register()} name=\"religion\" type=\"text\"placeholder=\"Religion \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Profession  </label><input className=\"input is-small\" ref={register()} name=\"profession\" type=\"text\" placeholder=\"Profession\" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n                <label className=\"label is-size-7\"  > Phone No</label><input className=\"input is-small\" ref={register()} name=\"phone\" type=\"text\" placeholder=\" Phone No \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-phone-alt\"></i>\r\n                </span>\r\n            </p>\r\n        </div>\r\n\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Email  </label><input className=\"input is-small\" ref={register()} name=\"email\" type=\"email\"placeholder=\"Email  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        </div>\r\n        </div>\r\n\r\n        <div className=\"field\">\r\n        <p className=\"control has-icons-left\">\r\n\r\n            <label className=\"label is-size-7\"  >Residential Address  </label><input className=\"input is-small\" ref={register()} name=\"address\" type=\"text\" placeholder=\"Residential Address  \" />\r\n            <span className=\"icon is-small is-left\">\r\n            <i className=\"nop-envelope\"></i>\r\n            </span>\r\n        </p>\r\n        </div> \r\n        <div className=\"field is-horizontal\">\r\n        <div className=\"field-body\">\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Town/City  </label><input className=\"input is-small\" ref={register()} name=\"city\" type=\"text\" placeholder=\"Town/City  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Local Govt Area  </label><input className=\"input is-small\" ref={register()} name=\"lga\" type=\"text\"placeholder=\"Local Govt Area  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >State  </label><input className=\"input is-small\" ref={register()} name=\"state\" type=\"text\"placeholder=\"State\" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Country  </label><input className=\"input is-small\" ref={register()} name=\"country\" type=\"text\" placeholder=\"Country  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div>\r\n        </div>\r\n        </div> \r\n        <div className=\"field is-horizontal\">\r\n        <div className=\"field-body\">\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                \r\n                    <label className=\"label is-size-7\"  >Blood Group </label><input className=\"input is-small\" ref={register()} name=\"bloodgroup\" type=\"text\"placeholder=\"Blood Group \" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"nop-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                \r\n                    <label className=\"label is-size-7\"  >Genotype  </label><input className=\"input is-small\" ref={register()} name=\"genotype\" type=\"text\" placeholder=\"Genotype \" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"nop-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                \r\n                    <label className=\"label is-size-7\" >Disabilities  </label><input className=\"input is-small\" ref={register()}  name=\"disabilities\" type=\"text\"placeholder=\"Disabilities  \" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"nop-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> \r\n        </div> \r\n        </div>  \r\n\r\n        <div className=\"field is-horizontal\">\r\n        <div className=\"field-body\">\r\n\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Allergies  </label><input className=\"input is-small\" ref={register()} name=\"allergies\" type=\"text\"placeholder=\"Allergies  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Co-mobidities </label><input className=\"input is-small\" ref={register()} name=\"comorbidities\" type=\"text\"placeholder=\"Co-mobidities \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        </div>\r\n        </div>\r\n        <div className=\"field\">\r\n        <p className=\"control has-icons-left\">\r\n\r\n            <label className=\"label is-size-7\"  >Tags  </label><input className=\"input is-small\" ref={register()} name=\"clientTags\" type=\"text\" placeholder=\"Tags \" />\r\n            <span className=\"icon is-small is-left\">\r\n            <i className=\"nop-envelope\"></i>\r\n            </span>\r\n        </p>\r\n        </div> \r\n        <div className=\"field\">\r\n        <p className=\"control has-icons-left\">\r\n            <label className=\"label is-size-7\"  >Specific Details about client  </label><input className=\"input is-small\" ref={register()} name=\"specificDetails\" type=\"text\"placeholder=\"Specific Details about client \" />\r\n            <span className=\"icon is-small is-left\">\r\n            <i className=\"nop-envelope\"></i>\r\n            </span>\r\n        </p>\r\n        </div> \r\n        <div className=\"field is-horizontal\">\r\n        <div className=\"field-body\">\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n                <label className=\"label is-size-7\"  >Next of Kin Full Name</label><input className=\"input is-small\" ref={register()} name=\"nok_name\" type=\"text\"placeholder=\"Next of Kin Full Name \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-clinic-medical\"></i>\r\n                </span>\r\n            </p>\r\n        </div>\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n                <label className=\"label is-size-7\" >Phone Number</label><input className=\"input is-small\" ref={register()}  name=\"nok_phoneno\" type=\"text\"placeholder=\" \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-clinic-medical\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Next of Kin Email  </label><input className=\"input is-small\" ref={register()} name=\"nok_email\" type=\"email\"placeholder=\"Next of Kin Email  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div>\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  > Relationship  </label><input className=\"input is-small\" ref={register()} name=\"nok_relationship\" type=\"text\" placeholder=\"Next of Kin Relationship\" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div>\r\n        </div>\r\n        </div> \r\n           \r\n           \r\n            </form>\r\n            \r\n            <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n               {/*  <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p> */}\r\n            </div>\r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n                \r\n}   \r\n\r\nexport  function InputSearch({getSearchfacility,clear}) {\r\n    const ClientServ=client.service('client')\r\n   // const facilityServ=client.service('facility')\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n     const [searchError, setSearchError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [showPanel, setShowPanel] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [searchMessage, setSearchMessage] = useState(\"\") \r\n   // eslint-disable-next-line \r\n   const [simpa,setSimpa]=useState(\"\")\r\n   // eslint-disable-next-line \r\n   const [chosen,setChosen]=useState(false)\r\n   // eslint-disable-next-line \r\n   const [count,setCount]=useState(0)\r\n   const inputEl=useRef(null)\r\n\r\n\r\n   const handleRow= async(obj)=>{\r\n        await setChosen(true)\r\n        //alert(\"something is chaning\")\r\n       getSearchfacility(obj)\r\n       \r\n       await setSimpa(obj.facilityName)\r\n       \r\n        // setSelectedFacility(obj)\r\n        setShowPanel(false)\r\n        await setCount(2)\r\n        /* const    newfacilityModule={\r\n            selectedFacility:facility,\r\n            show :'detail'\r\n        }\r\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\r\n   //console.log(state)\r\n}\r\n    const handleBlur=async(e)=>{\r\n         if (count===2){\r\n             console.log(\"stuff was chosen\")\r\n         }\r\n       \r\n       /*  console.log(\"blur\")\r\n         setShowPanel(false)\r\n        console.log(JSON.stringify(simpa))\r\n        if (simpa===\"\"){\r\n            console.log(facilities.length)\r\n            setSimpa(\"abc\")\r\n            setSimpa(\"\")\r\n            setFacilities([])\r\n            inputEl.current.setValue=\"\"\r\n        }\r\n        console.log(facilities.length)\r\n        console.log(inputEl.current) */\r\n    }\r\n    const handleSearch=async(val)=>{\r\n        \r\n        const field='facilityName' //field variable\r\n       \r\n        if (val.length>=3){\r\n            ClientServ.find({query: {     //service\r\n                 [field]: {\r\n                     $regex:val,\r\n                     $options:'i'\r\n                    \r\n                 },\r\n                 $limit:10,\r\n                 $sort: {\r\n                     createdAt: -1\r\n                   }\r\n                     }}).then((res)=>{\r\n              console.log(\"facility  fetched successfully\") \r\n                setFacilities(res.data)\r\n                 setSearchMessage(\" facility  fetched successfully\")\r\n                 setShowPanel(true)\r\n             })\r\n             .catch((err)=>{\r\n                 console.log(err)\r\n                 setSearchMessage(\"Error searching facility, probable network issues \"+ err )\r\n                 setSearchError(true)\r\n             })\r\n         }\r\n        else{\r\n            console.log(\"less than 3 \")\r\n            console.log(val)\r\n            setShowPanel(false)\r\n            await setFacilities([])\r\n            console.log(facilities)\r\n        }\r\n    }\r\n    useEffect(() => {\r\n       if (clear){\r\n           setSimpa(\"\")\r\n       }\r\n        return () => {\r\n            \r\n        }\r\n    }, [clear] )\r\n    return (\r\n        <div>\r\n            <div className=\"field\">\r\n                <div className=\"control has-icons-left  \">\r\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`}>\r\n                        <div className=\"dropdown-trigger\">\r\n                            <DebounceInput className=\"input is-small \" \r\n                                type=\"text\" placeholder=\"Search Facilities\"\r\n                                value={simpa}\r\n                                minLength={1}\r\n                                debounceTimeout={400}\r\n                                onBlur={(e)=>handleBlur(e)}\r\n                                onChange={(e)=>handleSearch(e.target.value)}\r\n                                inputRef={inputEl}\r\n                                  />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-search\"></i>\r\n                            </span>\r\n                        </div>\r\n                        {searchError&&<div>{searchMessage}</div>}\r\n                        <div className=\"dropdown-menu\" >\r\n                            <div className=\"dropdown-content\">\r\n                            {facilities.map((facility, i)=>(\r\n                                    \r\n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\r\n                                        \r\n                                        <span>{facility.facilityName}</span>\r\n                                        \r\n                                    </div>\r\n                                    \r\n                                    ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n          \r\n        </div>\r\n    )\r\n}","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\ProductEntry.js",["500","501","502","503","504","505","506"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\FinanceHome.js",["507","508","509","510","511","512"],"import React ,{useState,useEffect,useContext} from 'react'\r\nimport Store, { StoreList } from './Store'\r\nimport {UserContext,ObjectContext} from '../../context'\r\n\r\nexport default function InventoryHome() {\r\n   // const [activeModal, setActiveModal]=useState(\"modal is-active \")\r\n    const {state,setState}=useContext(ObjectContext)\r\n    const handleCloseModal=()=>{\r\n        state.showStoreModal  =  \"modal\"                                                                                                                                                        \r\n        setState(state)\r\n        console.log( state.showStoreModal)\r\n    }\r\n    \r\n       \r\n \r\n    return (\r\n       \r\n            <section className= \"section remPadTop\">\r\n              <section className=\"hero is-info is-fullheight\">\r\n                <div className=\"hero-body\">\r\n                    <div className=\"container has-text-centered\">\r\n                    <h1 className=\"title\">\r\n                      Finance Module\r\n                    </h1>\r\n                    <h2 className=\"subtitle\">\r\n                        Have fun working today!\r\n                    </h2>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n                                         \r\n            </section>\r\n    )\r\n}\r\n","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\BillPrescription.js",["513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\EncounterMgt\\DocumentClass.js",["531","532","533","534","535"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\EncounterMgt\\Prescription.js",["536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\DispenseExit.js",["557","558","559","560","561","562","563","564","565","566","567","568","569","570","571"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\nimport {ProductCreate} from './Products'\r\nvar random = require('random-string-generator');\r\n// eslint-disable-next-line\r\nconst searchfacility={};\r\n\r\n\r\nexport default function ProductEntry() {\r\n    const {state}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedProductEntry,setSelectedProductEntry]=useState()\r\n    //const [showState,setShowState]=useState() //create|modify|detail\r\n    \r\n    return(\r\n        <section className= \"section remPadTop\">\r\n           {/*  <div className=\"level\">\r\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">ProductEntry  Module</span></div>\r\n            </div> */}\r\n            <div className=\"columns \">\r\n            <div className=\"column is-6 \">\r\n                <ProductExitList />\r\n                </div>\r\n            <div className=\"column is-6 \">\r\n                {(state.ProductExitModule.show ==='create')&&<ProductExitCreate />}\r\n                {(state.ProductExitModule.show ==='detail')&&<ProductExitDetail  />}\r\n                {(state.ProductExitModule.show ==='modify')&&<ProductExitModify ProductEntry={selectedProductEntry} />}\r\n               \r\n            </div>\r\n\r\n            </div>                            \r\n            </section>\r\n       \r\n    )\r\n    \r\n}\r\n\r\nexport function ProductExitCreate(){\r\n   // const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \r\n    const [error, setError] =useState(false)\r\n    const [success, setSuccess] =useState(false)\r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line\r\n    const [facility,setFacility] = useState()\r\n    const ProductEntryServ=client.service('productentry')\r\n    //const history = useHistory()\r\n    const {user} = useContext(UserContext) //,setUser\r\n    // eslint-disable-next-line\r\n    const [currentUser,setCurrentUser] = useState()\r\n    const [type,setType] = useState(\"Sales\")\r\n    const [documentNo,setDocumentNo] = useState(\"\")\r\n    const [totalamount,setTotalamount] = useState(0)\r\n    const [qamount,setQAmount] = useState(null)\r\n    const [productId,setProductId] = useState(\"\")\r\n    const [source,setSource] = useState(\"\")\r\n    const [date,setDate] = useState(\"\")\r\n    const [name,setName] = useState(\"\")\r\n    const [inventoryId,setInventoryId] = useState(\"\")\r\n    const [baseunit,setBaseunit] = useState(\"\")\r\n    const [quantity,setQuantity] = useState(\"\")\r\n    const [sellingprice,setSellingPrice] = useState(\"\")\r\n    const [costprice,setCostprice] = useState(0)\r\n    const [invquantity,setInvQuantity] = useState(\"\")\r\n    const [calcamount,setCalcAmount] = useState(0)\r\n    const [productItem,setProductItem] = useState([])\r\n    const [billingId,setBilllingId]=useState(\"\")  \r\n    const [changeAmount, setChangeAmount] = useState(true)\r\n    const {state}=useContext(ObjectContext)\r\n    const inputEl = useRef(0);\r\n    let calcamount1\r\n    let hidestatus\r\n\r\n    let medication =state.financeModule.selectedFinance\r\n    console.log(\"medication\", medication)\r\n\r\n    const [productEntry,setProductEntry]=useState({\r\n        productitems:[],\r\n        date,\r\n        documentNo,\r\n        type,\r\n        totalamount,\r\n        source,\r\n\r\n    })\r\n \r\n    const productItemI={\r\n        productId,\r\n        name,\r\n        quantity,\r\n        sellingprice,\r\n        amount:calcamount, //qamount||\r\n        baseunit,\r\n        costprice,\r\n        billingId\r\n\r\n    }\r\n    // consider batchformat{batchno,expirydate,qtty,baseunit}\r\n    //consider baseunoit conversions\r\n    const getSearchfacility=(obj)=>{\r\n\r\n        setProductId(obj.productId)\r\n        setName(obj.name)\r\n        setBaseunit(obj.baseunit)\r\n        setInventoryId(obj.inventoryId)\r\n        setSellingPrice(obj.sellingprice)\r\n        setInvQuantity(obj.quantity)\r\n        setCostprice(obj.costprice)\r\n        setBilllingId(obj.billingId)\r\n        if (!obj){\r\n            //\"clear stuff\"\r\n            setProductId(\"\")\r\n            setName(\"\")\r\n            setBaseunit(\"\")\r\n            setInventoryId(\"\")\r\n            setSellingPrice(\"\")\r\n            setInvQuantity(\"\")\r\n            setQAmount(null)\r\n            setCostprice(\"\")\r\n           // setCalcAmount(null)\r\n\r\n        }\r\n        \r\n       /*  setValue(\"facility\", obj._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        }) */\r\n    }\r\n    \r\n    useEffect(() => {\r\n        setCurrentUser(user)\r\n        //console.log(currentUser)\r\n        return () => {\r\n        \r\n        }\r\n    }, [user])\r\n\r\n    const handleUpdateTotal=()=>{\r\n\r\n        \r\n        setTotalamount(prevtotal=>Number(prevtotal) + Number(calcamount))\r\n    }\r\n\r\n    const handleChangeType=async (e)=>{\r\n        await setType(e.target.value)\r\n    }\r\n\r\n    const handleAmount= async()=>{\r\n        await setQAmount(null)\r\n       // alert(\"Iam chaning qamount\")\r\n    }\r\n    const handleClickProd=async()=>{\r\n        console.log(\"amount: \",productItemI.amount)\r\n        console.log(\"qamount: \",qamount)\r\n        console.log(\"calcamount: \",calcamount)\r\n\r\n        if ( quantity===0||quantity===\"\"|| productId===\"\"){\r\n            toast({\r\n                message: 'You need to choose a product and quantity to proceed',\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              }) \r\n              return \r\n        }\r\n\r\n        await setSuccess(false)\r\n        await setProductItem(\r\n            prevProd=>prevProd.concat(productItemI)\r\n        )\r\n       handleUpdateTotal()\r\n        setName(\"\")\r\n        setBaseunit(\"\")\r\n        setQuantity(\"\")\r\n        setInventoryId(\"\")\r\n        setSellingPrice(\"\")\r\n        setInvQuantity(\"\")\r\n            handleAmount()\r\n       // setCalcAmount(null)\r\n       await setSuccess(true)\r\n      /*  console.log(success)\r\n       console.log(qamount)\r\n       console.log(productItem) */\r\n       setChangeAmount(true)\r\n    }\r\n  //check user for facility or get list of facility  \r\n   /*  useEffect(()=>{\r\n        //setFacility(user.activeProductEntry.FacilityId)//\r\n      if (!user.stacker){\r\n          console.log(currentUser)\r\n           /* setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })  \r\n\r\n      }\r\n    }) */\r\n\r\n    const handleQtty=async(e)=>{\r\n        if (invquantity<e.target.value){\r\n            toast({\r\n                message: 'You can not sell more quantity than exist in inventory ' ,\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              })\r\n            return\r\n        }\r\n        setQuantity(e.target.value)\r\n        calcamount1=quantity*sellingprice\r\n        await setCalcAmount(calcamount1)\r\n        console.log(calcamount)\r\n\r\n       \r\n\r\n    }\r\n\r\n    useEffect( () => {\r\n         setProductEntry({\r\n            \r\n            date,\r\n            documentNo,\r\n            type,\r\n            totalamount,\r\n            source,\r\n        })\r\n       setCalcAmount(quantity*sellingprice) \r\n        return () => {\r\n            \r\n        }\r\n    },[date])\r\n\r\n    const resetform=()=>{\r\n     setType(\"Sales\")\r\n    setDocumentNo(\"\")\r\n    setTotalamount(\"\")\r\n    setProductId(\"\")\r\n    setSource(\"\")\r\n    setDate(\"\")\r\n    setName(\"\")\r\n    setBaseunit()\r\n    setCostprice()\r\n    setProductItem([])\r\n    }\r\n\r\n    const onSubmit = async(e) =>{\r\n        e.preventDefault();\r\n        setMessage(\"\")\r\n        setError(false)\r\n        setSuccess(false)\r\n        /* await setProductEntry({\r\n            \r\n            date,\r\n            documentNo,\r\n            type,\r\n            totalamount,\r\n            source,\r\n        }) */\r\n        productEntry.date = date\r\n        productEntry.documentNo= documentNo\r\n        productEntry.type=type\r\n        productEntry.totalamount= totalamount\r\n        productEntry.source=source\r\n        productEntry.productitems=productItem\r\n        productEntry.createdby=user._id\r\n        productEntry.transactioncategory=\"debit\"\r\n       \r\n          console.log(\"b4 facility\",productEntry);\r\n          if (user.currentEmployee){\r\n         productEntry.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\r\n          }else{\r\n            toast({\r\n                message: 'You can not remove inventory from any organization',\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              }) \r\n              return\r\n          }\r\n          if (state.StoreModule.selectedStore._id){\r\n            productEntry.storeId=state.StoreModule.selectedStore._id\r\n          }else{\r\n            toast({\r\n                message: 'You need to select a store before removing inventory',\r\n                type: 'is-danger',\r\n                dismissible: true,\r\n                pauseOnHover: true,\r\n              }) \r\n              return\r\n\r\n          }\r\n          console.log(\"b4 create\",productEntry);\r\n        ProductEntryServ.create(productEntry)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                resetform()\r\n               /*  setMessage(\"Created ProductEntry successfully\") */\r\n                setSuccess(true)\r\n                toast({\r\n                    message: 'ProductExit created succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  setSuccess(false)\r\n                  setProductItem([])\r\n                  const today=new Date().toLocaleString()\r\n      \r\n                  setDate(today)\r\n                  const invoiceNo=random(6,'uppernumeric')\r\n                setDocumentNo(invoiceNo)\r\n                setType(\"Sales\")\r\n            })\r\n            .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating ProductExit ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n\r\n      const handleChangeAmount=()=>{\r\n        setChangeAmount((rev)=>(!rev))\r\n        \r\n    }\r\n   // console.log(\"i am rendering\")\r\n\r\n    useEffect(() => {\r\n        const today=new Date().toLocaleString()\r\n        //console.log(today)\r\n        setDate(today)\r\n        const invoiceNo=random(6,'uppernumeric')\r\n        setDocumentNo(invoiceNo)\r\n        return () => {\r\n            \r\n        }\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        calcamount1=quantity*sellingprice\r\n         setCalcAmount(calcamount1)\r\n         console.log(calcamount)\r\n         setChangeAmount(true)\r\n        return () => {\r\n            \r\n        }\r\n    }, [quantity])\r\n\r\n    useEffect(() => {\r\n        if (!!medication){\r\n\r\n      \r\n        const oldname=medication.participantInfo.client.firstname + \" \"+ medication.participantInfo.client.lastname\r\n       // console.log(\"oldname\",oldname)\r\n        setSource(medication.participantInfo.client.firstname + \" \"+ medication.participantInfo.client.lastname)\r\n\r\n        const newname=source\r\n       // console.log(\"newname\",newname)\r\n        if (oldname!==newname){\r\n            //newdispense\r\n        \r\n        setProductItem([])\r\n        setTotalamount(0)\r\n\r\n        }\r\n        setType(\"Dispense\")\r\n        if (state.financeModule.state){\r\n           /*  medication.show=\"none\"\r\n            medication.proposedpayment={\r\n                balance:0,\r\n                paidup:medication.paymentInfo.paidup + medication.paymentInfo.balance,\r\n                amount:medication.paymentInfo.balance\r\n            } */\r\n            //no payment detail push\r\n            getTotal()\r\n          medication.serviceInfo.sellingprice=medication.serviceInfo.price\r\n          medication.serviceInfo.billinfo={\r\n              billid:medication._id,\r\n              bill_status:medication.billing_status,\r\n              orderId:medication.orderInfo.orderId\r\n          }\r\n          \r\n         setProductItem(\r\n            prevProd=>prevProd.concat(medication.serviceInfo)\r\n        )\r\n        }else{\r\n            if(productItem.length>0){\r\n                setProductItem(\r\n                    prevProd=>prevProd.filter(el=>el.productId!==medication.serviceInfo.productId)\r\n                )\r\n            }\r\n        }\r\n\r\n       // const paymentoptions= []\r\n        //const info = medication.participantInfo.client.paymentinfo\r\n        //let billme={}\r\n        getTotal()\r\n        \r\n    }\r\n        return () => {\r\n           \r\n        }\r\n    }, [state.financeModule])\r\n\r\n        const getTotal= async()=>{\r\n            setTotalamount(0)\r\n            productItem.forEach(el=>{\r\n                    setTotalamount(prevtotal=>Number(prevtotal) + Number(el.amount) )\r\n                })\r\n        }\r\n\r\n    useEffect(() => {\r\n     getTotal()\r\n    console.log(totalamount)\r\n        return () => {\r\n           \r\n        }\r\n    }, [productItem])\r\n    \r\n\r\n    return (\r\n        <>\r\n            <div className=\"card card-overflow\">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                   Point of Sale: Sales, Dispense, Audit, Transfer out\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content \">\r\n   \r\n            <form onSubmit={onSubmit}> {/* handleSubmit(onSubmit) */}\r\n            <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n            <div className=\"field\">    \r\n                <div className=\"control\">\r\n                    <div className=\"select is-small\">\r\n                        <select name=\"type\" value={type} onChange={handleChangeType} className=\"selectadd\">\r\n                           <option value=\"\">Choose Type </option>\r\n                            <option value=\"Sales\">Sales </option>\r\n                            <option value=\"In-house\">In-House </option>\r\n                            <option value=\"Dispense\">Dispense</option>\r\n                            <option value=\"Audit\">Audit</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input is-small\" /* ref={register({ required: true })} */ value={source} name=\"client\" type=\"text\" onChange={e=>setSource(e.target.value)} placeholder=\"Client\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                </div>\r\n           \r\n            </div>\r\n            </div> {/* horizontal end */}\r\n           {/*  <div className=\"field\">\r\n                <p className=\"control has-icons-left\"> // Audit/initialization/Purchase Invoice \r\n                    <input className=\"input is-small\"  ref={register({ required: true })} name=\"type\" type=\"text\" placeholder=\"Type of Product Entry\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\" fas fa-user-md \"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n               <div className=\"field is-horizontal\">\r\n               <div className=\"field-body\">\r\n               <div className=\"field\">\r\n                <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small\"  /* ref={register({ required: true })} */ value={date}  name=\"date\" type=\"text\" onChange={e=>setDate(e.target.value)} placeholder=\"Date\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" /* ref={register} */ name=\"documentNo\" value={documentNo} type=\"text\" onChange={e=>setDocumentNo(e.target.value)} placeholder=\" Invoice Number\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" /* ref={register({ required: true })} */ value={totalamount} name=\"totalamount\" type=\"text\" onChange={e=>setTotalamount(e.target.value)} placeholder=\" Total Amount\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-coins\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n\r\n                </div> \r\n                </div> \r\n               \r\n                </form>   \r\n               \r\n           \r\n         {/* array of ProductEntry items */}\r\n        \r\n        <label className=\"label is-small\">Add Product Items:</label>\r\n         <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n            <div className=\"field is-expanded\"  /* style={ !user.stacker?{display:\"none\"}:{}} */ >\r\n                    <InventorySearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                    <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                        <input className=\"input is-small\" /* ref={register ({ required: true }) }  *//* add array no */  value={productId} name=\"productId\" type=\"text\" onChange={e=>setProductId(e.target.value)} placeholder=\"Product Id\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas  fa-map-marker-alt\"></i>\r\n                        </span>\r\n                    </p>\r\n                 {sellingprice &&   \"N\"}{sellingprice} {sellingprice &&   \"per\"}  {baseunit} {invquantity} {sellingprice &&   \"remaining\"} \r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\" >\r\n                <div className=\"field\" style={{width:\"40%\"}}>\r\n                <p className=\"control has-icons-left\" >\r\n                    <input className=\"input is-small\"  /* ref={register({ required: true })} */ name=\"quantity\" value={quantity} type=\"text\" onChange={ e=> handleQtty(e)} placeholder=\"Quantity\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hashtag\"></i>\r\n                    </span>\r\n                   \r\n                </p>\r\n        <label >{baseunit}</label>\r\n            </div> \r\n            <div className=\"field\">\r\n            <label>Amount:</label>{/* <p>{quantity*sellingprice}</p> */}\r\n            </div>\r\n            <div className=\"field\" style={{width:\"40%\"}}>\r\n                <p className=\"control has-icons-left \" /* style={{display:\"none\"}} */>\r\n                    <input className=\"input is-small\" name=\"qamount\" disabled={changeAmount} value={calcamount} type=\"text\"  onChange={async e=> await setCalcAmount(e.target.value)}  placeholder=\"Amount\"   />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-dollar-sign\"></i>\r\n                    </span>\r\n                </p>\r\n                <button className=\"button is-small is-success btnheight\" onClick={handleChangeAmount}>Adjust</button>\r\n            </div> \r\n            <div className=\"field\">\r\n            <p className=\"control\">\r\n                    <button className=\"button is-info is-small  is-pulled-right\">\r\n                      <span className=\"is-small\" onClick={handleClickProd}> +</span>\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            </div>\r\n         </div>\r\n            \r\n       {(productItem.length>0) && <div>\r\n            <label>Product Items:</label>\r\n         <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\r\n                <thead>\r\n                    <tr>\r\n                    <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                    <th><abbr title=\"Type\">Name</abbr></th>\r\n                    <th><abbr title=\"Type\">Quanitity</abbr></th>\r\n                    <th><abbr title=\"Document No\">Unit</abbr></th>\r\n                    <th><abbr title=\"Cost Price\">Selling Price</abbr></th>\r\n                    <th><abbr title=\"Cost Price\">Amount</abbr></th>\r\n                    <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                    </tr>\r\n                </thead>\r\n                <tfoot>\r\n                    \r\n                </tfoot>\r\n                <tbody>\r\n                   { productItem.map((ProductEntry, i)=>(\r\n\r\n                        <tr key={i}>\r\n                        <th>{i+1}</th>\r\n                        <td>{ProductEntry.name}</td>\r\n                        <th>{ProductEntry.quantity}</th>\r\n                        <td>{ProductEntry.baseunit}</td>\r\n                        <td>{ProductEntry.sellingprice}</td>\r\n                        <td>{ProductEntry.amount}</td>\r\n                        <td><span className=\"showAction\"  >x</span></td>\r\n                        \r\n                        </tr>\r\n\r\n                    ))}\r\n                </tbody>\r\n                </table>\r\n                <div className=\"field mt-2 is-grouped\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" disabled={!productItem.length>0} onClick={onSubmit}>\r\n                        Sell\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" disabled={!productItem.length>0} /* onClick={onSubmit} */>\r\n                        Clear\r\n                    </button>\r\n                </p>\r\n                </div>\r\n                </div>\r\n           \r\n            }\r\n            \r\n            \r\n            </div>\r\n            </div>\r\n        </>\r\n    )\r\n   \r\n}\r\n\r\nexport function ProductExitList(){\r\n   // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const ProductEntryServ=client.service('productentry')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedProductEntry, setSelectedProductEntry]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n    // eslint-disable-next-line\r\n    const {user,setUser}=useContext(UserContext)\r\n\r\n\r\n\r\n    const handleCreateNew = async()=>{\r\n        const    newProductExitModule={\r\n            selectedProductEntry:{},\r\n            show :'create'\r\n            }\r\n       await setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n       //console.log(state)\r\n        \r\n\r\n    }\r\n    const handleRow= async(ProductEntry)=>{\r\n        //console.log(\"b4\",state)\r\n\r\n        //console.log(\"handlerow\",ProductEntry)\r\n\r\n        await setSelectedProductEntry(ProductEntry)\r\n\r\n        const    newProductExitModule={\r\n            selectedProductEntry:ProductEntry,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n       //console.log(state)\r\n\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='name'\r\n       console.log(val)\r\n       ProductEntryServ.find({query: {\r\n                [field]: {\r\n                    $regex:val,\r\n                    $options:'i'\r\n                   \r\n                },\r\n                transactioncategory:\"debit\",\r\n                storeId:state.StoreModule.selectedStore._id,\r\n               facility:user.currentEmployee.facilityDetail._id || \"\",\r\n                $limit:10,\r\n                $sort: {\r\n                    createdAt: -1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" ProductEntry  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error fetching ProductEntry, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n   \r\n        const getFacilities= async()=>{\r\n            if (user.currentEmployee){\r\n            \r\n        const findProductEntry= await ProductEntryServ.find(\r\n                {query: {\r\n                    transactioncategory:\"debit\",\r\n                    facility:user.currentEmployee.facilityDetail._id,\r\n                    storeId:state.StoreModule.selectedStore._id,\r\n                    $limit:20,\r\n                    $sort: {\r\n                        createdAt: -1\r\n                    }\r\n                    }})\r\n\r\n         await setFacilities(findProductEntry.data)\r\n                }\r\n                else {\r\n                    if (user.stacker){\r\n                        /* toast({\r\n                            message: 'You do not qualify to view this',\r\n                            type: 'is-danger',\r\n                            dismissible: true,\r\n                            pauseOnHover: true,\r\n                          }) \r\n                          return */\r\n                        const findProductEntry= await ProductEntryServ.find(\r\n                            {query: {\r\n                                transactioncategory:\"debit\",\r\n                                $limit:20,\r\n                                $sort: {\r\n                                    createdAt: -1\r\n                                }\r\n                                }})\r\n            \r\n                    await setFacilities(findProductEntry.data)\r\n\r\n                    }\r\n                }\r\n          /*   .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" ProductEntry  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\r\n                    setError(true)\r\n                }) */\r\n            }\r\n            \r\n         /*    useEffect(() => {\r\n                setTimeout(() => {\r\n                    console.log(\"happy birthday\")\r\n                    //getFacilities(user)\r\n                }, 200);\r\n\r\n                return () => {\r\n                    \r\n\r\n                }\r\n            },[]) */\r\n\r\n            useEffect(() => {\r\n               \r\n                if (!state.StoreModule.selectedStore){\r\n                    toast({\r\n                        message: 'kindly select a store',\r\n                        type: 'is-danger',\r\n                        dismissible: true,\r\n                        pauseOnHover: true,\r\n                      }) \r\n                      return\r\n                    getFacilities()\r\n\r\n                }else{\r\n                    /* const localUser= localStorage.getItem(\"user\")\r\n                    const user1=JSON.parse(localUser)\r\n                    console.log(localUser)\r\n                    console.log(user1)\r\n                    fetchUser(user1)\r\n                    console.log(user)\r\n                    getFacilities(user) */\r\n                }\r\n                ProductEntryServ.on('created', (obj)=>getFacilities())\r\n                ProductEntryServ.on('updated', (obj)=>getFacilities())\r\n                ProductEntryServ.on('patched', (obj)=>getFacilities())\r\n                ProductEntryServ.on('removed', (obj)=>getFacilities())\r\n                return () => {\r\n                \r\n                }\r\n            },[])\r\n\r\n            useEffect(() => {\r\n                getFacilities()\r\n                console.log(\"store changed\")\r\n                return () => {\r\n                   \r\n                }\r\n            }, [state.StoreModule.selectedStore])\r\n    //todo: pagination and vertical scroll bar\r\n\r\n    return(\r\n        <>\r\n           {state.StoreModule.selectedStore?( <>  \r\n                <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search ProductEntry\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Product Exits </span></div>\r\n                    <div className=\"level-right\">\r\n                        <div className=\"level-item\"> \r\n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <div className=\"table-container pullup \">\r\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\r\n                                    <thead>\r\n                                        <tr>\r\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                        <th><abbr title=\"Date\">Date</abbr></th>\r\n                                        <th><abbr title=\"Type\">Type</abbr></th>\r\n                                        <th>Client</th>\r\n                                        <th><abbr title=\"Document No\">Document No</abbr></th>\r\n                                        <th><abbr title=\"Total Amount\">Total Amount</abbr></th>\r\n                                        <th><abbr title=\"Enteredby\">Entered By</abbr></th>\r\n                                        <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tfoot>\r\n                                        \r\n                                    </tfoot>\r\n                                    <tbody>\r\n                                        {facilities.map((ProductEntry, i)=>(\r\n\r\n                                            <tr key={ProductEntry._id} onClick={()=>handleRow(ProductEntry)}>\r\n                                            <th>{i+1}</th>\r\n                                            <td>{ProductEntry.date}</td>\r\n                                            <th>{ProductEntry.type}</th>\r\n                                            <td>{ProductEntry.source}</td>\r\n                                            <td>{ProductEntry.documentNo}</td>\r\n                                            <td>{ProductEntry.totalamount}</td>\r\n                                            <td>{ProductEntry.enteredby}</td>\r\n                                            <td><span className=\"showAction\"  >...</span></td>\r\n                                           \r\n                                            </tr>\r\n\r\n                                        ))}\r\n                                    </tbody>\r\n                                    </table>\r\n                                    \r\n                </div>              \r\n            </>):<div>loading... Choose a Store</div>}\r\n            </>\r\n              \r\n    )\r\n    }\r\n\r\n\r\nexport function ProductExitDetail(){\r\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\r\n     // eslint-disable-next-line\r\n    const [error, setError] =useState(false) //, \r\n    //const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [message, setMessage] = useState(\"\") //,\r\n    //const ProductEntryServ=client.service('/ProductEntry')\r\n    //const history = useHistory()\r\n    //const {user,setUser} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n   \r\n\r\n   const ProductEntry =state.ProductExitModule.selectedProductEntry \r\n\r\n    const handleEdit= async()=>{\r\n        const    newProductExitModule={\r\n            selectedProductEntry:ProductEntry,\r\n            show :'modify'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n       //console.log(state)\r\n       \r\n    }\r\n \r\n    return (\r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    ProductEntry Details\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n                <table> \r\n                <tbody>         \r\n                <tr>\r\n                    <td>\r\n                      <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Type\r\n                        </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {ProductEntry.type} </span>\r\n                    </td>\r\n                    <td>\r\n\r\n                    </td>\r\n                    <td>\r\n                        <label className=\"label is-small padleft\"><span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-map-signs\"></i>\r\n                        </span>Supplier:\r\n                        </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"ProductEntryType\">{ProductEntry.source} </span> \r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\r\n                        <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Date:\r\n                        </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {ProductEntry.date} </span>\r\n                    </td>\r\n                    <td>\r\n                                \r\n                    </td>\r\n                    <td>\r\n                        <label className=\"label is-small padleft\"><span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-map-signs\"></i>\r\n                        </span>Invoice No:\r\n                        </label>\r\n                    </td>\r\n                    \r\n                    <td>\r\n                         <span className=\"is-size-7 padleft\"   name=\"ProductEntryType\">{ProductEntry.documentNo} </span> \r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\r\n                \r\n                        <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-hospital\"></i>\r\n                    </span>            \r\n                        Total Amount:\r\n                    </label>\r\n                    </td>\r\n                    <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {ProductEntry.totalamount} </span>\r\n                    </td>\r\n                </tr>\r\n\r\n                </tbody> \r\n            </table> \r\n            <label className=\"label is-size-7 mt-2\">Product Items:</label>\r\n         <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\r\n                <thead>\r\n                    <tr>\r\n                    <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                    <th><abbr title=\"Type\">Name</abbr></th>\r\n                    <th><abbr title=\"Type\">Quanitity</abbr></th>\r\n                    <th><abbr title=\"Document No\">Unit</abbr></th>\r\n                    <th><abbr title=\"Selling Price\">Selling Price</abbr></th>\r\n                    <th><abbr title=\"Amount\">Amount</abbr></th>\r\n                   \r\n                    </tr>\r\n                </thead>\r\n                <tfoot>\r\n                    \r\n                </tfoot>\r\n                <tbody>\r\n                   { ProductEntry.productitems.map((ProductEntry, i)=>(\r\n\r\n                        <tr key={i}>\r\n                        <th>{i+1}</th>\r\n                        <td>{ProductEntry.name}</td>\r\n                        <th>{ProductEntry.quantity}</th>\r\n                        <td>{ProductEntry.baseunit}</td>\r\n                        <td>{ProductEntry.sellingprice}</td>\r\n                        <td>{ProductEntry.amount}</td>\r\n                        \r\n                        \r\n                        </tr>\r\n\r\n                    ))}\r\n                </tbody>\r\n                </table>\r\n                  {/*   <tr>\r\n                    <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>Profession: \r\n                \r\n                    \r\n                    </label>\r\n                    </td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"ProductEntryCity\">{ProductEntry.profession}</span> \r\n                </td>\r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>Phone:           \r\n                    \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft \"  name=\"ProductEntryContactPhone\" >{ProductEntry.phone}</span>\r\n                        </td>\r\n                  </tr>\r\n                    <tr><td>\r\n            \r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>Email:                     \r\n                    \r\n                         </label></td><td>\r\n                         <span className=\"is-size-7 padleft \"  name=\"ProductEntryEmail\" >{ProductEntry.email}</span>\r\n                         </td>\r\n             \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i></span>Department:\r\n                    \r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft \"  name=\"ProductEntryOwner\">{ProductEntry.department}</span>\r\n                    </td>\r\n               \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>Departmental Unit:              \r\n                    \r\n                </label></td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"ProductEntryType\">{ProductEntry.deptunit}</span>\r\n                </td>\r\n              \r\n                </tr> */}\r\n                    \r\n          {/*   <div className=\"field\">\r\n             <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>Category:              \r\n                    <span className=\"is-size-7 padleft \"  name= \"ProductEntryCategory\">{ProductEntry.ProductEntryCategory}</span>\r\n                </label>\r\n                 </div> */}\r\n\r\n            \r\n           \r\n           {/*  <div className=\"field mt-2\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\r\n                        Edit\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            { error && <div className=\"message\"> {message}</div>} */}\r\n           \r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n}\r\n\r\nexport function ProductExitModify(){\r\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\r\n    // eslint-disable-next-line \r\n    const [error, setError] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [success, setSuccess] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line \r\n    const ProductEntryServ=client.service('productentry')\r\n    //const history = useHistory()\r\n     // eslint-disable-next-line\r\n    const {user} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n    const ProductEntry =state.ProductExitModule.selectedProductEntry \r\n\r\n        useEffect(() => {\r\n            setValue(\"name\", ProductEntry.name,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"ProductEntryType\", ProductEntry.ProductEntryType,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n           /*  setValue(\"profession\", ProductEntry.profession,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"phone\", ProductEntry.phone,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"email\", ProductEntry.email,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"department\", ProductEntry.department,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"deptunit\", ProductEntry.deptunit,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n          /*   setValue(\"ProductEntryCategory\", ProductEntry.ProductEntryCategory,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n            \r\n            return () => {\r\n                \r\n            }\r\n        })\r\n\r\n   const handleCancel=async()=>{\r\n    const    newProductExitModule={\r\n        selectedProductEntry:{},\r\n        show :'create'\r\n      }\r\n   await setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n   //console.log(state)\r\n           }\r\n\r\n\r\n        const changeState =()=>{\r\n        const    newProductExitModule={\r\n            selectedProductEntry:{},\r\n            show :'create'\r\n        }\r\n        setState((prevstate)=>({...prevstate, ProductExitModule:newProductExitModule}))\r\n\r\n        }\r\n    const handleDelete=async()=>{\r\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\r\n        \r\n        const dleteId=ProductEntry._id\r\n        if (conf){\r\n             \r\n        ProductEntryServ.remove(dleteId)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                reset();\r\n               /*  setMessage(\"Deleted ProductEntry successfully\")\r\n                setSuccess(true)\r\n                changeState()\r\n               setTimeout(() => {\r\n                setSuccess(false)\r\n                }, 200); */\r\n                toast({\r\n                    message: 'ProductEntry deleted succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                changeState()\r\n            })\r\n            .catch((err)=>{\r\n               // setMessage(\"Error deleting ProductEntry, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error deleting ProductEntry, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n        }\r\n    }\r\n        \r\n\r\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n          })) */\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        \r\n        setSuccess(false)\r\n        console.log(data)\r\n        data.facility=ProductEntry.facility\r\n          //console.log(data);\r\n          \r\n        ProductEntryServ.patch(ProductEntry._id,data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n               // e.target.reset();\r\n               // setMessage(\"updated ProductEntry successfully\")\r\n                 toast({\r\n                    message: 'ProductEntry updated succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  \r\n                changeState()\r\n\r\n            })\r\n            .catch((err)=>{\r\n                //setMessage(\"Error creating ProductEntry, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error updating ProductEntry, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n     \r\n      \r\n    return (\r\n        \r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    ProductEntry Details-Modify\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <div className=\"field\">\r\n                    <label className=\"label is-small\"> Name\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"name\" type=\"text\" placeholder=\"Name\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                    </label>\r\n                    </div>\r\n                <div className=\"field\">\r\n                <label className=\"label is-small\">ProductEntry Type\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small \" ref={register({ required: true })} disabled name=\"ProductEntryType\" type=\"text\" placeholder=\"ProductEntry Type\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n                </label>\r\n                </div>\r\n            {/* <div className=\"field\">\r\n            <label className=\"label is-small\">Profession\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"profession\" type=\"text\" placeholder=\"Profession\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Phone\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"phone\" type=\"text\" placeholder=\"Phone No\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                 </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Email\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"email\" type=\"email\" placeholder=\"ProductEntry Email\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Department\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                {errors.department && <span>This field is required</span>}\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Departmental Unit\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Departmental Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div> */}\r\n           {/*  <div className=\"field\">\r\n            <label className=\"label is-small\">Category\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"ProductEntryCategory\" type=\"text\" placeholder=\"ProductEntry Category\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n            </div> */}\r\n           \r\n           \r\n            </form>\r\n            \r\n            <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p>\r\n            </div>\r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n                \r\n}   \r\n\r\nexport  function InventorySearch({getSearchfacility,clear}) {\r\n    \r\n    const productServ=client.service('inventory')\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n     const [searchError, setSearchError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [showPanel, setShowPanel] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [searchMessage, setSearchMessage] = useState(\"\") \r\n   // eslint-disable-next-line \r\n   const [simpa,setSimpa]=useState(\"\")\r\n   // eslint-disable-next-line \r\n   const [chosen,setChosen]=useState(false)\r\n   // eslint-disable-next-line \r\n   const [count,setCount]=useState(0)\r\n   const inputEl=useRef(null)\r\n   const [val,setVal]=useState(\"\")\r\n   const {user} = useContext(UserContext) \r\n   const {state}=useContext(ObjectContext)\r\n    const [productModal,setProductModal]=useState(false)\r\n\r\n   const handleRow= async(obj)=>{\r\n        await setChosen(true)\r\n        //alert(\"something is chaning\")\r\n       getSearchfacility(obj)\r\n       \r\n       await setSimpa(obj.name)\r\n       \r\n        // setSelectedFacility(obj)\r\n        setShowPanel(false)\r\n        await setCount(2)\r\n        /* const    newfacilityModule={\r\n            selectedFacility:facility,\r\n            show :'detail'\r\n        }\r\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\r\n   //console.log(state)\r\n    }\r\n    const handleBlur=async(e)=>{\r\n         if (count===2){\r\n             console.log(\"stuff was chosen\")\r\n         }\r\n       \r\n       /*  console.log(\"blur\")\r\n         setShowPanel(false)\r\n        console.log(JSON.stringify(simpa))\r\n        if (simpa===\"\"){\r\n            console.log(facilities.length)\r\n            setSimpa(\"abc\")\r\n            setSimpa(\"\")\r\n            setFacilities([])\r\n            inputEl.current.setValue=\"\"\r\n        }\r\n        console.log(facilities.length)\r\n        console.log(inputEl.current) */\r\n    }\r\n    const handleSearch=async(value)=>{\r\n        setVal(value)\r\n        if (value===\"\"){\r\n            setShowPanel(false)\r\n            getSearchfacility(false)\r\n            return\r\n        }\r\n        const field='name' //field variable\r\n\r\n       \r\n        if (value.length>=3 ){\r\n            productServ.find({query: {     //service\r\n                 [field]: {\r\n                     $regex:value,\r\n                     $options:'i'\r\n                    \r\n                 },\r\n                 facility: user.currentEmployee.facilityDetail._id,\r\n                 storeId: state.StoreModule.selectedStore._id,\r\n                 $limit:10,\r\n                 $sort: {\r\n                     createdAt: -1\r\n                   }\r\n                     }}).then((res)=>{\r\n              console.log(\"product  fetched successfully\") \r\n              console.log(res.data) \r\n                setFacilities(res.data)\r\n                 setSearchMessage(\" product  fetched successfully\")\r\n                 setShowPanel(true)\r\n             })\r\n             .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating ProductEntry ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n             })\r\n         }\r\n        else{\r\n            console.log(\"less than 3 \")\r\n            console.log(val)\r\n            setShowPanel(false)\r\n            await setFacilities([])\r\n            console.log(facilities)\r\n        }\r\n    }\r\n\r\n    const handleAddproduct =()=>{\r\n        setProductModal(true) \r\n    }\r\n    const handlecloseModal =()=>{\r\n        setProductModal(false)\r\n        handleSearch(val)\r\n    }\r\n    useEffect(() => {\r\n       if (clear){\r\n           console.log(\"success has changed\",clear)\r\n           setSimpa(\"\")\r\n       }\r\n        return () => {\r\n            \r\n        }\r\n    }, [clear] )\r\n    return (\r\n        <div>\r\n            <div className=\"field\">\r\n                <div className=\"control has-icons-left  \">\r\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`} style={{width:\"100%\"}}>\r\n                        <div className=\"dropdown-trigger\" style={{width:\"100%\"}}>\r\n                            <DebounceInput className=\"input is-small  is-expanded\" \r\n                                type=\"text\" placeholder=\"Search Product\"\r\n                                value={simpa}\r\n                                minLength={3}\r\n                                debounceTimeout={400}\r\n                                onBlur={(e)=>handleBlur(e)}\r\n                                onChange={(e)=>handleSearch(e.target.value)}\r\n                                inputRef={inputEl}\r\n                                  />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-search\"></i>\r\n                            </span>\r\n                        </div>\r\n                        {/* {searchError&&<div>{searchMessage}</div>} */}\r\n                        <div className=\"dropdown-menu expanded\" style={{width:\"100%\"}}>\r\n                            <div className=\"dropdown-content\">\r\n                          { facilities.length>0?\"\":<div className=\"dropdown-item\" /* onClick={handleAddproduct} */> <span> {val} is not in your inventory</span> </div>}\r\n\r\n                              {facilities.map((facility, i)=>(\r\n                                    \r\n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\r\n                                        \r\n                                        <div><span>{facility.name}</span></div>\r\n                                        <div><span><strong>{facility.quantity}</strong></span>\r\n                                        <span>{facility.baseunit}(s) remaining</span>\r\n                                        <span className=\"padleft\"><strong>Price:</strong> N{facility.sellingprice}</span></div>\r\n                                        \r\n                                    </div>\r\n                                    \r\n                                    ))}\r\n                                    \r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className={`modal ${productModal?\"is-active\":\"\"}` }>\r\n                                    <div className=\"modal-background\"></div>\r\n                                    <div className=\"modal-card\">\r\n                                        <header className=\"modal-card-head\">\r\n                                        <p className=\"modal-card-title\">Choose Store</p>\r\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={handlecloseModal}></button>\r\n                                        </header>\r\n                                        <section className=\"modal-card-body\">\r\n                                        {/* <StoreList standalone=\"true\" /> */}\r\n                                        <ProductCreate />\r\n                                        </section>\r\n                                        {/* <footer className=\"modal-card-foot\">\r\n                                        <button className=\"button is-success\">Save changes</button>\r\n                                        <button className=\"button\">Cancel</button>\r\n                                        </footer> */}\r\n                                    </div>\r\n                                </div>       \r\n        </div>\r\n    )\r\n}","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\FacilityModule.js",["572"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\Facility.js",["573"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\Location.js",["574","575","576","577"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\FinanceSetup.js",[],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\Products.js",["578","579","580","581","582","583","584"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\n// eslint-disable-next-line\r\nconst searchfacility={};\r\n\r\n\r\nexport default function Product() {\r\n    const {state}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedProduct,setSelectedProduct]=useState()\r\n    //const [showState,setShowState]=useState() //create|modify|detail\r\n    \r\n    return(\r\n        <section className= \"section remPadTop\">\r\n           {/*  <div className=\"level\">\r\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Product  Module</span></div>\r\n            </div> */}\r\n            <div className=\"columns \">\r\n            <div className=\"column is-8 \">\r\n                <ProductList />\r\n                </div>\r\n            <div className=\"column is-4 \">\r\n                {(state.ProductModule.show ==='create')&&<ProductCreate />}\r\n                {(state.ProductModule.show ==='detail')&&<ProductDetail  />}\r\n                {(state.ProductModule.show ==='modify')&&<ProductModify Product={selectedProduct} />}\r\n               \r\n            </div>\r\n\r\n            </div>                            \r\n            </section>\r\n       \r\n    )\r\n    \r\n}\r\n\r\nexport function ProductCreate(){\r\n    const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \r\n    const [error, setError] =useState(false)\r\n    const [success, setSuccess] =useState(false)\r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line\r\n    const [facility,setFacility] = useState()\r\n    const ProductServ=client.service('products')\r\n    //const history = useHistory()\r\n    const {user} = useContext(UserContext) //,setUser\r\n    // eslint-disable-next-line\r\n    const [currentUser,setCurrentUser] = useState()\r\n\r\n\r\n\r\n    const getSearchfacility=(obj)=>{\r\n        \r\n        setValue(\"facility\", obj._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })\r\n    }\r\n    \r\n    useEffect(() => {\r\n        setCurrentUser(user)\r\n        //console.log(currentUser)\r\n        return () => {\r\n        \r\n        }\r\n    }, [user])\r\n\r\n  //check user for facility or get list of facility  \r\n    useEffect(()=>{\r\n        //setFacility(user.activeProduct.FacilityId)//\r\n      if (!user.stacker){\r\n       /*    console.log(currentUser)\r\n        setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })  */\r\n      }\r\n    })\r\n\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        setMessage(\"\")\r\n        setError(false)\r\n        setSuccess(false)\r\n         // data.createdby=user._id\r\n          console.log(data);\r\n          if (user.currentEmployee){\r\n        // data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\r\n          }\r\n        ProductServ.create(data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                e.target.reset();\r\n               /*  setMessage(\"Created Product successfully\") */\r\n                setSuccess(true)\r\n                toast({\r\n                    message: 'Product created succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  setSuccess(false)\r\n            })\r\n            .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating Product ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n\r\n    return (\r\n        <>\r\n            <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Create Product\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n            <p className=\" is-small\">\r\n                    Kindly search product list before creating new products!\r\n                </p>\r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input is-small\" ref={register({ required: true })}  name=\"category\" type=\"text\" placeholder=\"Category of Product\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                </div>\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })}  name=\"name\" type=\"text\" placeholder=\"Name of Product\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"baseunit\" type=\"text\" placeholder=\"Base unit of product\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\" fas fa-user-md \"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n             {/*<div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"phone\" type=\"text\" placeholder=\" Phone No\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n           \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                \r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"email\" type=\"email\" placeholder=\"Email\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n          {/*  <div className=\"field\"  style={ !user.stacker?{display:\"none\"}:{}} >\r\n                <InputSearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                    <input className=\"input is-small\" ref={register ({ required: true }) } name=\"facility\" type=\"text\" placeholder=\"Facility\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas  fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n           {/*  <div className=\"field\">\r\n                <div className=\"control has-icons-left\">\r\n                    <div className=\"dropdown \">\r\n                        <div className=\"dropdown-trigger\">\r\n                            <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital-symbol\"></i>\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"dropdown-menu\">\r\n                            <div className=\"dropdown-content\">\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa\r\n                                </div>\r\n                                <div className=\"dropdown-item is-active\">\r\n                                    simpa 2\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 3\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 4\r\n                                </div>\r\n                            </div>\r\n                        </div>   \r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Department Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"password\" type=\"text\" placeholder=\"password\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n            <div className=\"field\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\">\r\n                        Create\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            \r\n            </form>\r\n            </div>\r\n            </div>\r\n        </>\r\n    )\r\n   \r\n}\r\n\r\nexport function ProductList(){\r\n   // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const ProductServ=client.service('products')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedProduct, setSelectedProduct]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n    // eslint-disable-next-line\r\n    const {user,setUser}=useContext(UserContext)\r\n\r\n\r\n\r\n    const handleCreateNew = async()=>{\r\n        const    newProductModule={\r\n            selectedProduct:{},\r\n            show :'create'\r\n            }\r\n       await setState((prevstate)=>({...prevstate, ProductModule:newProductModule}))\r\n       //console.log(state)\r\n        \r\n\r\n    }\r\n    const handleRow= async(Product)=>{\r\n        //console.log(\"b4\",state)\r\n\r\n        //console.log(\"handlerow\",Product)\r\n\r\n        await setSelectedProduct(Product)\r\n\r\n        const    newProductModule={\r\n            selectedProduct:Product,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ProductModule:newProductModule}))\r\n       //console.log(state)\r\n\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='name'\r\n       console.log(val)\r\n       ProductServ.find({query: {\r\n                [field]: {\r\n                    $regex:val,\r\n                    $options:'i'\r\n                   \r\n                },\r\n              // facility:user.currentEmployee.facilityDetail._id || \"\",\r\n                $limit:10,\r\n                $sort: {\r\n                    createdAt: -1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" Product  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error fetching Product, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n   \r\n        const getFacilities= async()=>{\r\n            if (user.currentEmployee){\r\n            \r\n        const findProduct= await ProductServ.find(\r\n                {query: {\r\n                   // facility:user.currentEmployee.facilityDetail._id,\r\n                    $limit:20,\r\n                    $sort: {\r\n                        createdAt: -1\r\n                    }\r\n                    }})\r\n\r\n         await setFacilities(findProduct.data)\r\n                }\r\n                else {\r\n                    if (user.stacker){\r\n                        const findProduct= await ProductServ.find(\r\n                            {query: {\r\n                                \r\n                                $limit:20,\r\n                                $sort: {\r\n                                    createdAt: -1\r\n                                }\r\n                                }})\r\n            \r\n                    await setFacilities(findProduct.data)\r\n\r\n                    }\r\n                }\r\n          /*   .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" Product  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating Product, probable network issues \"+ err )\r\n                    setError(true)\r\n                }) */\r\n            }\r\n            \r\n            useEffect(() => {\r\n                setTimeout(() => {\r\n                    console.log(\"happy birthday\")\r\n                    //getFacilities(user)\r\n                }, 200);\r\n\r\n                return () => {\r\n                    \r\n\r\n                }\r\n            },[])\r\n\r\n            useEffect(() => {\r\n               \r\n                if (user){\r\n                    getFacilities()\r\n                }else{\r\n                    /* const localUser= localStorage.getItem(\"user\")\r\n                    const user1=JSON.parse(localUser)\r\n                    console.log(localUser)\r\n                    console.log(user1)\r\n                    fetchUser(user1)\r\n                    console.log(user)\r\n                    getFacilities(user) */\r\n                }\r\n                ProductServ.on('created', (obj)=>getFacilities())\r\n                ProductServ.on('updated', (obj)=>getFacilities())\r\n                ProductServ.on('patched', (obj)=>getFacilities())\r\n                ProductServ.on('removed', (obj)=>getFacilities())\r\n                return () => {\r\n                \r\n                }\r\n            },[])\r\n\r\n\r\n    //todo: pagination and vertical scroll bar\r\n\r\n    return(\r\n        <>\r\n           {user?( <>  \r\n                <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search Products\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Products </span></div>\r\n                    <div className=\"level-right\">\r\n                        <div className=\"level-item\"> \r\n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <div className=\"table-container pullup \">\r\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\r\n                                    <thead>\r\n                                        <tr>\r\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                        <th>Name</th>\r\n                                        \r\n                                       <th><abbr title=\"Base Unit\">Base Unit</abbr></th>\r\n                                         {/* <th><abbr title=\"Phone\">Phone</abbr></th>\r\n                                        <th><abbr title=\"Email\">Email</abbr></th>\r\n                                        <th><abbr title=\"Department\">Department</abbr></th>\r\n                                        <th><abbr title=\"Departmental Unit\">Departmental Unit</abbr></th> \r\n                                        <th><abbr title=\"Facility\">facility</abbr></th>*/}\r\n                                        <th><abbr title=\"Last Name\">Product Category</abbr></th>\r\n                                        <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tfoot>\r\n                                        \r\n                                    </tfoot>\r\n                                    <tbody>\r\n                                        {facilities.map((Product, i)=>(\r\n\r\n                                            <tr key={Product._id} onClick={()=>handleRow(Product)}>\r\n                                            <th>{i+1}</th>\r\n                                            <th>{Product.name}</th>\r\n                                            <td>{Product.baseunit}</td>\r\n                                           < td>{Product.category}</td>\r\n                                             {/*<td>{Product.phone}</td>\r\n                                            <td>{Product.email}</td>\r\n                                            <td>{Product.department}</td>\r\n                                            <td>{Product.deptunit}</td> \r\n                                            <td>{Product.facility}</td>*/}\r\n                                            <td><span   className=\"showAction\"  >...</span></td>\r\n                                           \r\n                                            </tr>\r\n\r\n                                        ))}\r\n                                    </tbody>\r\n                                    </table>\r\n                                    \r\n                </div>              \r\n            </>):<div>loading</div>}\r\n            </>\r\n              \r\n    )\r\n    }\r\n\r\n\r\nexport function ProductDetail(){\r\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\r\n     // eslint-disable-next-line\r\n    const [error, setError] =useState(false) //, \r\n    //const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [message, setMessage] = useState(\"\") //,\r\n    //const ProductServ=client.service('/Product')\r\n    //const history = useHistory()\r\n    //const {user,setUser} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n   \r\n\r\n   const Product =state.ProductModule.selectedProduct \r\n\r\n    const handleEdit= async()=>{\r\n        const    newProductModule={\r\n            selectedProduct:Product,\r\n            show :'modify'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ProductModule:newProductModule}))\r\n       //console.log(state)\r\n       \r\n    }\r\n \r\n    return (\r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Product Details\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n                <table> \r\n                <tbody>         \r\n                <tr>\r\n                    <td>\r\n                \r\n                    <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Name: \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {Product.name} </span>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                    <td>\r\n                <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>Base Unit:\r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft\"   name=\"ProductType\">{Product.baseunit} </span> \r\n                    </td>\r\n                </tr>\r\n                   <tr>\r\n                    <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>Product Category: \r\n                \r\n                    \r\n                    </label>\r\n                    </td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"ProductCity\">{Product.category}</span> \r\n                </td>\r\n                </tr>\r\n             {/*         <tr>\r\n            <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>Phone:           \r\n                    \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft \"  name=\"ProductContactPhone\" >{Product.phone}</span>\r\n                        </td>\r\n                  </tr>\r\n                    <tr><td>\r\n            \r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>Email:                     \r\n                    \r\n                         </label></td><td>\r\n                         <span className=\"is-size-7 padleft \"  name=\"ProductEmail\" >{Product.email}</span>\r\n                         </td>\r\n             \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i></span>Department:\r\n                    \r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft \"  name=\"ProductOwner\">{Product.department}</span>\r\n                    </td>\r\n               \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>Departmental Unit:              \r\n                    \r\n                </label></td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"ProductType\">{Product.deptunit}</span>\r\n                </td>\r\n              \r\n                </tr> */}\r\n                    \r\n          {/*   <div className=\"field\">\r\n             <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>Category:              \r\n                    <span className=\"is-size-7 padleft \"  name= \"ProductCategory\">{Product.ProductCategory}</span>\r\n                </label>\r\n                 </div> */}\r\n\r\n            </tbody> \r\n            </table> \r\n           \r\n            <div className=\"field mt-2\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\r\n                        Edit\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            { error && <div className=\"message\"> {message}</div>}\r\n           \r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n}\r\n\r\nexport function ProductModify(){\r\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\r\n    // eslint-disable-next-line \r\n    const [error, setError] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [success, setSuccess] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line \r\n    const ProductServ=client.service('products')\r\n    //const history = useHistory()\r\n     // eslint-disable-next-line\r\n    const {user} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n    const Product =state.ProductModule.selectedProduct \r\n\r\n        useEffect(() => {\r\n            setValue(\"name\", Product.name,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"baseunit\", Product.baseunit,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n             setValue(\"category\", Product.category,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n           /* setValue(\"phone\", Product.phone,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"email\", Product.email,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"department\", Product.department,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"deptunit\", Product.deptunit,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n          /*   setValue(\"ProductCategory\", Product.ProductCategory,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n            \r\n            return () => {\r\n                \r\n            }\r\n        })\r\n\r\n   const handleCancel=async()=>{\r\n    const    newProductModule={\r\n        selectedProduct:{},\r\n        show :'create'\r\n      }\r\n   await setState((prevstate)=>({...prevstate, ProductModule:newProductModule}))\r\n   //console.log(state)\r\n           }\r\n\r\n\r\n        const changeState =()=>{\r\n        const    newProductModule={\r\n            selectedProduct:{},\r\n            show :'create'\r\n        }\r\n        setState((prevstate)=>({...prevstate, ProductModule:newProductModule}))\r\n\r\n        }\r\n    const handleDelete=async()=>{\r\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\r\n        \r\n        const dleteId=Product._id\r\n        if (conf){\r\n             \r\n        ProductServ.remove(dleteId)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                reset();\r\n               /*  setMessage(\"Deleted Product successfully\")\r\n                setSuccess(true)\r\n                changeState()\r\n               setTimeout(() => {\r\n                setSuccess(false)\r\n                }, 200); */\r\n                toast({\r\n                    message: 'Product deleted succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                changeState()\r\n            })\r\n            .catch((err)=>{\r\n               // setMessage(\"Error deleting Product, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error deleting Product, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n        }\r\n    }\r\n        \r\n\r\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n          })) */\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        \r\n        setSuccess(false)\r\n       // console.log(data)\r\n      //  data.facility=Product.facility\r\n          //console.log(data);\r\n          \r\n        ProductServ.patch(Product._id,data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n               // e.target.reset();\r\n               // setMessage(\"updated Product successfully\")\r\n                 toast({\r\n                    message: 'Product updated succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  \r\n                changeState()\r\n\r\n            })\r\n            .catch((err)=>{\r\n                //setMessage(\"Error creating Product, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error updating Product, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n     \r\n      \r\n    return (\r\n        \r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Product Details-Modify\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <div className=\"field\">\r\n                    <label className=\"label is-small\"> Name\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"name\" type=\"text\" placeholder=\"Name\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                    </label>\r\n                    </div>\r\n                <div className=\"field\">\r\n                <label className=\"label is-small\">Base Unit\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small \" ref={register({ required: true })}  name=\"baseunit\" type=\"text\" placeholder=\"Base Unit\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Product Category\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })}  disabled name=\"category\" type=\"text\" placeholder=\"Product Category\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n             {/*<div className=\"field\">\r\n            <label className=\"label is-small\">Phone\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"phone\" type=\"text\" placeholder=\"Phone No\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                 </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Email\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"email\" type=\"email\" placeholder=\"Product Email\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Department\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                {errors.department && <span>This field is required</span>}\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Departmental Unit\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Departmental Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div> */}\r\n           {/*  <div className=\"field\">\r\n            <label className=\"label is-small\">Category\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"ProductCategory\" type=\"text\" placeholder=\"Product Category\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n            </div> */}\r\n           \r\n           \r\n            </form>\r\n            \r\n            <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n               {/*  <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p> */}\r\n            </div>\r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n                \r\n}   \r\n\r\nexport  function InputSearch({getSearchfacility,clear}) {\r\n    const ProductServ=client.service('products')\r\n   // const facilityServ=client.service('facility')\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n     const [searchError, setSearchError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [showPanel, setShowPanel] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [searchMessage, setSearchMessage] = useState(\"\") \r\n   // eslint-disable-next-line \r\n   const [simpa,setSimpa]=useState(\"\")\r\n   // eslint-disable-next-line \r\n   const [chosen,setChosen]=useState(false)\r\n   // eslint-disable-next-line \r\n   const [count,setCount]=useState(0)\r\n   const inputEl=useRef(null)\r\n\r\n\r\n   const handleRow= async(obj)=>{\r\n        await setChosen(true)\r\n        //alert(\"something is chaning\")\r\n       getSearchfacility(obj)\r\n       \r\n       await setSimpa(obj.facilityName)\r\n       \r\n        // setSelectedFacility(obj)\r\n        setShowPanel(false)\r\n        await setCount(2)\r\n        /* const    newfacilityModule={\r\n            selectedFacility:facility,\r\n            show :'detail'\r\n        }\r\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\r\n   //console.log(state)\r\n}\r\n    const handleBlur=async(e)=>{\r\n         if (count===2){\r\n             console.log(\"stuff was chosen\")\r\n         }\r\n       \r\n       /*  console.log(\"blur\")\r\n         setShowPanel(false)\r\n        console.log(JSON.stringify(simpa))\r\n        if (simpa===\"\"){\r\n            console.log(facilities.length)\r\n            setSimpa(\"abc\")\r\n            setSimpa(\"\")\r\n            setFacilities([])\r\n            inputEl.current.setValue=\"\"\r\n        }\r\n        console.log(facilities.length)\r\n        console.log(inputEl.current) */\r\n    }\r\n    const handleSearch=async(val)=>{\r\n        \r\n        const field='facilityName' //field variable\r\n       \r\n        if (val.length>=3){\r\n            ProductServ.find({query: {     //service\r\n                 [field]: {\r\n                     $regex:val,\r\n                     $options:'i'\r\n                    \r\n                 },\r\n                 $limit:10,\r\n                 $sort: {\r\n                     createdAt: -1\r\n                   }\r\n                     }}).then((res)=>{\r\n              console.log(\"facility  fetched successfully\") \r\n                setFacilities(res.data)\r\n                 setSearchMessage(\" facility  fetched successfully\")\r\n                 setShowPanel(true)\r\n             })\r\n             .catch((err)=>{\r\n                 console.log(err)\r\n                 setSearchMessage(\"Error searching facility, probable network issues \"+ err )\r\n                 setSearchError(true)\r\n             })\r\n         }\r\n        else{\r\n            console.log(\"less than 3 \")\r\n            console.log(val)\r\n            setShowPanel(false)\r\n            await setFacilities([])\r\n            console.log(facilities)\r\n        }\r\n    }\r\n    useEffect(() => {\r\n       if (clear){\r\n           setSimpa(\"\")\r\n       }\r\n        return () => {\r\n            \r\n        }\r\n    }, [clear] )\r\n    return (\r\n        <div>\r\n            <div className=\"field\">\r\n                <div className=\"control has-icons-left  \">\r\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`}>\r\n                        <div className=\"dropdown-trigger\">\r\n                            <DebounceInput className=\"input is-small \" \r\n                                type=\"text\" placeholder=\"Search Facilities\"\r\n                                value={simpa}\r\n                                minLength={1}\r\n                                debounceTimeout={400}\r\n                                onBlur={(e)=>handleBlur(e)}\r\n                                onChange={(e)=>handleSearch(e.target.value)}\r\n                                inputRef={inputEl}\r\n                                  />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-search\"></i>\r\n                            </span>\r\n                        </div>\r\n                        {searchError&&<div>{searchMessage}</div>}\r\n                        <div className=\"dropdown-menu\" >\r\n                            <div className=\"dropdown-content\">\r\n                            {facilities.map((facility, i)=>(\r\n                                    \r\n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\r\n                                        \r\n                                        <span>{facility.facilityName}</span>\r\n                                        \r\n                                    </div>\r\n                                    \r\n                                    ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n          \r\n        </div>\r\n    )\r\n}","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Clinic\\ClinicHome.js",["585","586","587","588","589","590"],"import React ,{useState,useEffect,useContext} from 'react'\r\nimport Store, { StoreList } from './Clinic'\r\nimport {UserContext,ObjectContext} from '../../context'\r\n\r\nexport default function InventoryHome() {\r\n   // const [activeModal, setActiveModal]=useState(\"modal is-active \")\r\n    const {state,setState}=useContext(ObjectContext)\r\n    const handleCloseModal=()=>{\r\n        state.showStoreModal  =  \"modal\"                                                                                                                                                        \r\n        setState(state)\r\n        console.log( state.showStoreModal)\r\n    }\r\n    \r\n       \r\n \r\n    return (\r\n       \r\n            <section className= \"section remPadTop\">\r\n              {/*  <div className=\"is-1\"> Appointment sdchedule for patients for this clinic</div>\r\n               <div className=\"is-1\"> Communication Command Center</div>     */}  \r\n               <section className=\"hero is-info is-fullheight\">\r\n                <div className=\"hero-body\">\r\n                    <div className=\"container has-text-centered\">\r\n                    <h1 className=\"title\">\r\n                      Clinic Module\r\n                    </h1>\r\n                    <h2 className=\"subtitle\">\r\n                        Have fun working today!\r\n                    </h2>\r\n                    </div>\r\n                </div>\r\n            </section>                  \r\n            </section>\r\n    )\r\n}\r\n","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Clinic\\Appointments.js",["591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport {Route, Switch,  useRouteMatch, Link, NavLink, useHistory} from 'react-router-dom'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\nimport { formatDistanceToNowStrict, format } from 'date-fns'\r\n// eslint-disable-next-line\r\nconst searchfacility={};\r\n\r\n\r\nexport default function Appointments() {\r\n    const {state}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedClient,setSelectedClient]=useState()\r\n    const [selectedAppointment,setSelectedAppointment]=useState()\r\n    //const [showState,setShowState]=useState() //create|modify|detail\r\n    \r\n    return(\r\n        <section className= \"section remPadTop\">\r\n            <div className=\"columns \">\r\n           \r\n            <div className=\"column is-8 \">\r\n                <ClientList />\r\n                </div>\r\n            <div className=\"column is-4 \">\r\n                {(state.AppointmentModule.show ==='create')&&<AppointmentCreate />}\r\n                {(state.AppointmentModule.show ==='detail')&&<ClientDetail  />}\r\n                {(state.AppointmentModule.show ==='modify')&&<ClientModify Client={selectedClient} />}\r\n               \r\n            </div>\r\n\r\n            </div>                            \r\n            </section>\r\n       \r\n    )\r\n    \r\n}\r\n\r\nexport function AppointmentCreate(){\r\n    const {state,setState}=useContext(ObjectContext) \r\n    const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \r\n    const [error, setError] =useState(false)\r\n    const [success, setSuccess] =useState(false)\r\n    const [message,setMessage] = useState(\"\")\r\n    const [clientId,setClientId] = useState()\r\n    const [type,setType] = useState()\r\n    // eslint-disable-next-line\r\n    const [facility,setFacility] = useState()\r\n    const ClientServ=client.service('appointments')\r\n    //const history = useHistory()\r\n    const {user} = useContext(UserContext) //,setUser\r\n    // eslint-disable-next-line\r\n    const [currentUser,setCurrentUser] = useState()\r\n    const [selectedClient,setSelectedClient]=useState()\r\n    const [selectedAppointment,setSelectedAppointment]=useState()\r\n   // const [appointment_reason,setAppointment_reason]= useState()\r\n    const [appointment_status,setAppointment_status]=useState(\"\")\r\n    const [appointment_type, setAppointment_type]=useState(\"\")\r\n    const [chosen, setChosen]=useState()\r\n\r\n\r\n   /*  const getSearchfacility=(obj)=>{\r\n        setValue(\"facility\", obj._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })\r\n    } */\r\n    const handleChangeType=async (e)=>{\r\n        await setAppointment_type(e.target.value)\r\n    }\r\n\r\n    const handleChangeStatus=async (e)=>{\r\n        await setAppointment_status(e.target.value)\r\n    }\r\n\r\n    const getSearchfacility=(obj)=>{\r\n\r\n       setClientId(obj._id)\r\n       setChosen(obj)\r\n       \r\n        if (!obj){\r\n            //\"clear stuff\"\r\n            setClientId()\r\n            setChosen()\r\n           \r\n        }\r\n    \r\n        \r\n       /*  setValue(\"facility\", obj._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        }) */\r\n    }\r\n\r\n    useEffect(() => {\r\n        setCurrentUser(user)\r\n        //console.log(currentUser)\r\n        return () => {\r\n        \r\n        }\r\n    }, [user])\r\n\r\n  //check user for facility or get list of facility  \r\n    useEffect(()=>{\r\n        //setFacility(user.activeClient.FacilityId)//\r\n      if (!user.stacker){\r\n       /*    console.log(currentUser)\r\n        setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })  */\r\n      }\r\n    })\r\n\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        setMessage(\"\")\r\n        setError(false)\r\n        setSuccess(false)\r\n         // data.createdby=user._id\r\n          console.log(data);\r\n          if (user.currentEmployee){\r\n          data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\r\n          }\r\n          data.locationId=state.ClinicModule.selectedClinic._id\r\n          data.appointment_type=appointment_type\r\n         // data.appointment_reason=appointment_reason\r\n          data.appointment_status=appointment_status\r\n          data.clientId=clientId\r\n          data.firstname=chosen.firstname\r\n            data.middlename=chosen.middlename\r\n            data.lastname=chosen.lastname\r\n            data.dob=chosen.dob\r\n            data.gender=chosen.gender\r\n            data.phone=chosen.phone\r\n            data.email=chosen.email\r\n          data.actions=[{\r\n              action:appointment_status,\r\n              actor:user.currentEmployee._id\r\n          }]\r\n\r\n        ClientServ.create(data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                e.target.reset();\r\n               setAppointment_type(\"\")\r\n               setAppointment_status(\"\")\r\n               setClientId(\"\")\r\n               /*  setMessage(\"Created Client successfully\") */\r\n                setSuccess(true)\r\n                toast({\r\n                    message: 'Appointment created succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  setSuccess(false)\r\n            })\r\n            .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating Appointment ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n\r\n    return (\r\n        <>\r\n            \r\n            <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Create Client\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           {/*  <p className=\" is-small\">\r\n                    Kindly search Client list before creating new Clients!\r\n                </p> */}\r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n            <input name=\"start_time\" ref={register ({ required: true })} type=\"datetime-local\" />\r\n           \r\n            <label className=\"label is-small\">Client:</label>\r\n         <div className=\"field is-horizontal\">\r\n            <div className=\"field-body\">\r\n            <div className=\"field is-expanded\"  /* style={ !user.stacker?{display:\"none\"}:{}} */ >\r\n                    <ClientSearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                    <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                        <input className=\"input is-small\"  /* ref={register ({ required: true }) } */  /* add array no */  value={clientId} name=\"ClientId\" type=\"text\" onChange={e=>setClientId(e.target.value)} placeholder=\"Product Id\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas  fa-map-marker-alt\"></i>\r\n                        </span>\r\n                    </p>\r\n                 {/* {sellingprice &&   \"N\"}{sellingprice} {sellingprice &&   \"per\"}  {baseunit} {invquantity} {sellingprice &&   \"remaining\"}  */}\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div className=\"field\">    \r\n                <div className=\"control\">\r\n                    <div className=\"select is-small\">\r\n                        <select name=\"type\" value={type} onChange={handleChangeType}>\r\n                           <option value=\"\">Choose Appointment Type  </option>\r\n                            <option value=\"New\">New</option>\r\n                            <option value=\"Followup\">Followup</option>\r\n                            <option value=\"Readmission with 24hrs\">Readmission with 24hrs</option>\r\n                            <option value=\"Annual Checkup\">Annual Checkup</option>\r\n                            <option value=\"Walk in\">Walk-in</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        <div className=\"field\">    \r\n                <div className=\"control\">\r\n                    <div className=\"select is-small\">\r\n                        <select name=\"appointment_status\" value={appointment_status} onChange={handleChangeStatus}>\r\n                           <option value=\"\">Appointment Status  </option>\r\n                            <option value=\"Scheduled\">Scheduled</option>\r\n                            <option value=\"Confirmed\">Confirmed</option>\r\n                            <option value=\"Checked In\">Checked In</option>\r\n                            <option value=\"Vitals Taken\">Vitals Taken</option>\r\n                            <option value=\"With Nurse\">With Nurse</option>\r\n                            <option value=\"With Doctor\">With Doctor</option>\r\n                            <option value=\"No Show\">No Show</option>\r\n                            <option value=\"Cancelled\">Cancelled</option>\r\n                            <option value=\"Billed\">Billed</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n        </div>\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left has-icons-right\">\r\n                <input className=\"input is-small\" ref={register()}  name=\"appointment_reason\" type=\"text\" placeholder=\"Reason For Appointment\" />\r\n                <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital\"></i>\r\n                </span>                    \r\n            </p>\r\n        </div>\r\n        <div className=\"field \" style={{display:\"none\"}} >\r\n            <p className=\"control has-icons-left has-icons-right\">\r\n                <input className=\"input is-small\" ref={register()}  name=\"billingservice\" type=\"text\" placeholder=\"Billing service\" />\r\n                <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital\"></i>\r\n                </span>                    \r\n            </p>\r\n        </div>\r\n           \r\n        <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" >\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={(e)=>e.target.reset()}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n               {/*  <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p> */}\r\n            </div>\r\n     \r\n            </form>\r\n            </div>\r\n            </div>\r\n                 {/*  <div className=\"field\"  style={ !user.stacker?{display:\"none\"}:{}} >\r\n                <InputSearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                    <input className=\"input is-small\" ref={register ({ required: true }) } name=\"facility\" type=\"text\" placeholder=\"Facility\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas  fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n         {/*   <div className=\"field\">\r\n                <div className=\"control has-icons-left\">\r\n                    <div className=\"dropdown \">\r\n                        <div className=\"dropdown-trigger\">\r\n                            <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital-symbol\"></i>\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"dropdown-menu\">\r\n                            <div className=\"dropdown-content\">\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa\r\n                                </div>\r\n                                <div className=\"dropdown-item is-active\">\r\n                                    simpa 2\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 3\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 4\r\n                                </div>\r\n                            </div>\r\n                        </div>   \r\n                    </div>\r\n                </div>\r\n            </div> */}\r\n        </>\r\n    )\r\n   \r\n}\r\n\r\nexport function ClientList(){\r\n   // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const ClientServ=client.service('appointments')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedClient, setSelectedClient]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n    // eslint-disable-next-line\r\n    const {user,setUser}=useContext(UserContext)\r\n    \r\n    const [selectedAppointment,setSelectedAppointment]=useState()\r\n\r\n\r\n\r\n    const handleCreateNew = async()=>{\r\n        const newClientModule={\r\n            selectedAppointment:{},\r\n            show :'create'\r\n            }\r\n        await setState((prevstate)=>({...prevstate, AppointmentModule:newClientModule}))\r\n       //console.log(state)\r\n        } \r\n\r\n    \r\n    const handleRow= async(Client)=>{\r\n        await setSelectedAppointment(Client)\r\n        const    newClientModule={\r\n            selectedAppointment:Client,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, AppointmentModule:newClientModule}))\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='firstname'\r\n       console.log(val)\r\n       ClientServ.find({query: {\r\n                $or:[\r\n                    { firstname: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { lastname: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { middlename: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { phone: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { clientTags: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { mrn: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { specificDetails: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                ],\r\n              \r\n              facility:user.currentEmployee.facilityDetail._id, // || \"\",\r\n                $limit:10,\r\n                $sort: {\r\n                    createdAt: -1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" Client  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error fetching Client, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n   \r\n    const getFacilities= async()=>{\r\n            if (user.currentEmployee){      \r\n            const findClient= await ClientServ.find(\r\n                {query: {\r\n                   // facility:user.currentEmployee.facilityDetail._id,\r\n                    $limit:20,\r\n                    $sort: {\r\n                        createdAt: -1\r\n                    }\r\n                    }})\r\n\r\n         await setFacilities(findClient.data)\r\n                }\r\n                else {\r\n                    if (user.stacker){\r\n                        const findClient= await ClientServ.find(\r\n                            {query: {\r\n                                \r\n                                $limit:20,\r\n                                $sort: {\r\n                                    createdAt: -1\r\n                                }\r\n                                }})\r\n            \r\n                    await setFacilities(findClient.data)\r\n\r\n                    }\r\n                }\r\n          /*   .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" Client  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating Client, probable network issues \"+ err )\r\n                    setError(true)\r\n                }) */\r\n            }\r\n            \r\n    /* useEffect(() => {\r\n                setTimeout(() => {\r\n                    console.log(\"happy birthday\")\r\n                    //getFacilities(user)\r\n                }, 200);\r\n\r\n                return () => {\r\n                    \r\n\r\n                }\r\n            },[]) */\r\n\r\n    useEffect(() => {\r\n               \r\n                if (user){\r\n                    getFacilities()\r\n                }else{\r\n                    /* const localUser= localStorage.getItem(\"user\")\r\n                    const user1=JSON.parse(localUser)\r\n                    console.log(localUser)\r\n                    console.log(user1)\r\n                    fetchUser(user1)\r\n                    console.log(user)\r\n                    getFacilities(user) */\r\n                }\r\n                ClientServ.on('created', (obj)=>getFacilities())\r\n                ClientServ.on('updated', (obj)=>getFacilities())\r\n                ClientServ.on('patched', (obj)=>getFacilities())\r\n                ClientServ.on('removed', (obj)=>getFacilities())\r\n                return () => {\r\n                \r\n                }\r\n            },[])\r\n\r\n\r\n    //todo: pagination and vertical scroll bar\r\n\r\n    return(\r\n        <>\r\n           {user?( <>  \r\n                <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search Appointments\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Appointments </span></div>\r\n                    <div className=\"level-right\">\r\n                        <div className=\"level-item\"> \r\n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <div className=\"table-container pullup \">\r\n                                <table className=\"table is-striped is-narrow is-hoverable is-fullwidth is-scrollable \">\r\n                                    <thead>\r\n                                        <tr>\r\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                        <th><abbr title=\"Time\">Date/Time</abbr></th>\r\n                                        <th>First Name</th>\r\n                                        <th><abbr title=\"Middle Name\">Middle Name</abbr></th>\r\n                                       <th><abbr title=\"Last Name\">Last Name</abbr></th>\r\n                                       <th><abbr title=\"Age\">Age</abbr></th>\r\n                                        <th><abbr title=\"Gender\">Gender</abbr></th> \r\n                                        <th><abbr title=\"Phone\">Phone</abbr></th>\r\n                                        <th><abbr title=\"Email\">Email</abbr></th>\r\n                                        <th><abbr title=\"Type\">Type</abbr></th>\r\n                                        <th><abbr title=\"Status\">Status</abbr></th>\r\n                                        <th><abbr title=\"Reason\">Reason</abbr></th>\r\n                                        <th><abbr title=\"Actions\">Actions</abbr></th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tfoot>\r\n                                        \r\n                                    </tfoot>\r\n                                    <tbody>\r\n                                        {facilities.map((Client, i)=>(\r\n\r\n                                            <tr key={Client._id} onClick={()=>handleRow(Client)}  className={Client._id===(selectedAppointment?._id||null)?\"is-selected\":\"\"}>\r\n                                            <th>{i+1}</th>\r\n                                            <td><strong>{format(new Date(Client.start_time),\"dd-MM-yy HH:mm:ss\")}</strong></td>\r\n                                            <th>{Client.firstname}</th>\r\n                                            <td>{Client.middlename}</td>\r\n                                           < td>{Client.lastname}</td>\r\n                                           < td>{formatDistanceToNowStrict(new Date(Client.dob))}</td>\r\n                                            <td>{Client.gender}</td>\r\n                                             <td>{Client.phone}</td>\r\n                                            <td>{Client.email}</td>\r\n                                            <td>{Client.appointment_type}</td>\r\n                                            <td>{Client.appointment_status}</td>\r\n                                            <td>{Client.appointment_reason}</td>\r\n                                            <td><span   className=\"showAction\"  >...</span></td>\r\n                                           \r\n                                            </tr>\r\n\r\n                                        ))}\r\n                                    </tbody>\r\n                                    </table>\r\n                                    \r\n                </div>              \r\n            </>):<div>loading</div>}\r\n            </>\r\n              \r\n    )\r\n    }\r\n\r\n\r\n\r\nexport function ClientDetail(){\r\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\r\n     // eslint-disable-next-line\r\n    const history =useHistory()\r\n    let { path, url } = useRouteMatch();\r\n    const [error, setError] =useState(false) //, \r\n    //const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [message, setMessage] = useState(\"\") //,\r\n    //const ClientServ=client.service('/Client')\r\n    //const history = useHistory()\r\n    //const {user,setUser} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n    const [selectedClient,setSelectedClient]=useState()\r\n    const [selectedAppointment,setSelectedAppointment]=useState()\r\n\r\n   \r\n\r\n   const Client =state.AppointmentModule.selectedAppointment \r\n    //const client=Client\r\n    const handleEdit= async()=>{\r\n        const    newClientModule={\r\n            selectedAppointment:Client,\r\n            show :'modify'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, AppointmentModule:newClientModule}))\r\n       //console.log(state)\r\n       \r\n    }\r\n    const handleAttend=async()=>{\r\n        \r\n        const patient = await client.service('client').get(Client.clientId)\r\n        await setSelectedClient(patient)\r\n        const    newClientModule={\r\n            selectedClient:patient, \r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, ClientModule:newClientModule}))\r\n        history.push('/app/clinic/encounter')\r\n    }\r\n \r\n    return (\r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Client Details\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <div className=\"field is-horizontal\">\r\n                <div className=\"field-body\">\r\n                {Client.firstname &&  <div className=\"field\">\r\n                        <p className=\"control has-icons-left has-icons-right\">\r\n                            <label className=\"label is-size-7 my-0 \"   name=\"firstname\" type=\"text\">First Name </label><label className=\"is-size-7 my-0 \">{Client.firstname }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"nop-hospital\"></i>\r\n                            </span>                    \r\n                        </p>\r\n                    </div>}\r\n\r\n\r\n                    {Client.middlename &&  <div className=\"field\">\r\n                        <p className=\"control has-icons-left has-icons-right\">\r\n                        <label className=\"label is-size-7 my-0\"   name=\"middlename\" type=\"text\"> Middle Name </label><label className=\"is-size-7 my-0\">{Client.middlename }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-map-signs\"></i>\r\n                        </span>\r\n                        \r\n                        </p>\r\n                    </div>}\r\n             {Client.lastname &&\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                        <label className=\"label is-size-7 my-0\"  name=\"lastname\" type=\"text\">Last Name</label><label className=\"is-size-7 my-0\">{Client.lastname }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\" nop-user-md \"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>}\r\n                </div>  \r\n                </div>\r\n                <div className=\"field is-horizontal\">\r\n                <div className=\"field-body\">\r\n                {Client.dob &&<div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"dob\" type=\"text\">Date of Birth </label><label className=\"is-size-7 my-0\">{ new Date(Client.dob).toLocaleDateString('en-GB')}</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> }\r\n                {Client.gender &&<div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"gender\" type=\"text\">Gender </label><label className=\"is-size-7 my-0\">{Client.gender }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> }\r\n                {Client.maritalstatus && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"maritalstatus\" type=\"text\">Marital Status </label><label className=\"is-size-7 my-0\">{Client.maritalstatus }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> }\r\n                {Client.mrn && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"mrn\" type=\"text\">Medical Records Number  </label><label className=\"is-size-7 my-0\">{Client.mrn }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> }\r\n                </div>\r\n                </div>\r\n                <div className=\"field is-horizontal\">\r\n                    <div className=\"field-body\">\r\n                    {Client.religion && <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <label className=\"label is-size-7 my-0\"  name=\"religion\" type=\"text\">Religion  </label><label className=\"is-size-7 my-0\">{Client.religion }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div> }\r\n                    {Client.profession &&  <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <label className=\"label is-size-7 my-0\"  name=\"profession\" type=\"text\">Profession  </label><label className=\"is-size-7 my-0\">{Client.profession }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div> }\r\n                    {Client.phone &&<div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                            <label className=\"label is-size-7 my-0\"  name=\"phone\" type=\"text\"> Phone No</label><label className=\"is-size-7 my-0\">{Client.phone }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-phone-alt\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div>}\r\n\r\n                    {Client.email && <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <label className=\"label is-size-7 my-0\"  name=\"email\" type=\"email\">Email  </label><label className=\"is-size-7 my-0\">{Client.email }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div> }\r\n                    </div>\r\n                </div>\r\n\r\n                {Client.address &&<div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n\r\n                    <label className=\"label is-size-7 my-0\"  name=\"address\" type=\"text\">Residential Address  </label><label className=\"is-size-7 my-0\">{Client.address }</label>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"nop-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                </div>} \r\n                <div className=\"field is-horizontal\">\r\n                    <div className=\"field-body\">\r\n                        {Client.city && <div className=\"field\">\r\n                            <p className=\"control has-icons-left\">\r\n                            \r\n                                <label className=\"label is-size-7 my-0\"  name=\"city\" type=\"text\">Town/City  </label><label className=\"is-size-7 my-0\">{Client.city }</label>\r\n                                <span className=\"icon is-small is-left\">\r\n                                <i className=\"nop-envelope\"></i>\r\n                                </span>\r\n                            </p>\r\n                        </div> }\r\n                        {Client.lga && <div className=\"field\">\r\n                            <p className=\"control has-icons-left\">\r\n                            \r\n                                <label className=\"label is-size-7 my-0\"  name=\"lga\" type=\"text\">Local Govt Area  </label><label className=\"is-size-7 my-0\">{Client.lga }</label>\r\n                                <span className=\"icon is-small is-left\">\r\n                                <i className=\"nop-envelope\"></i>\r\n                                </span>\r\n                            </p>\r\n                        </div> }\r\n                        {Client.state && <div className=\"field\">\r\n                            <p className=\"control has-icons-left\">\r\n                                <label className=\"label is-size-7 my-0\"  name=\"state\" type=\"text\">State  </label><label className=\"is-size-7 my-0\">{Client.state }</label>\r\n                                <span className=\"icon is-small is-left\">\r\n                                <i className=\"nop-envelope\"></i>\r\n                                </span>\r\n                            </p>\r\n                        </div> }\r\n                        {Client.country &&<div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <label className=\"label is-size-7 my-0\"  name=\"country\" type=\"text\">Country  </label><label className=\"is-size-7 my-0\">{Client.country }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div>}\r\n                    </div>\r\n                </div> \r\n                <div className=\"field is-horizontal\">\r\n                <div className=\"field-body\">\r\n                     {Client.bloodgroup &&  <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <label className=\"label is-size-7 my-0\"  name=\"bloodgroup\" type=\"text\">Blood Group </label><label className=\"is-size-7 my-0\">{Client.bloodgroup }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div>}\r\n                   \r\n                    {Client.genotype && <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <label className=\"label is-size-7 my-0\"  name=\"genotype\" type=\"text\">Genotype  </label><label className=\"is-size-7 my-0\">{Client.genotype }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div> }\r\n                    {Client.disabilities && <div className=\"field\">\r\n                        <p className=\"control has-icons-left\">\r\n                        \r\n                            <label className=\"label is-size-7 my-0\"  name=\"disabilities\" type=\"text\">Disabilities  </label><label className=\"is-size-7 my-0\">{Client.disabilities }</label>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"nop-envelope\"></i>\r\n                            </span>\r\n                        </p>\r\n                    </div> }\r\n                </div> \r\n                </div>  \r\n\r\n                <div className=\"field is-horizontal\">\r\n                <div className=\"field-body\">\r\n\r\n                {Client.allergies && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"allergies\" type=\"text\">Allergies  </label><label className=\"is-size-7 my-0\">{Client.allergies }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> }\r\n                {Client.comorbidities && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"comorbidities\" type=\"text\">Co-mobidities  </label><label className=\"is-size-7 my-0\">{Client.comorbidities }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> }\r\n                </div>\r\n                </div>\r\n               {Client.clientTags && <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n\r\n                    <label className=\"label is-size-7 my-0\"  name=\"clientTags\" type=\"text\">Tags </label><label className=\"is-size-7 my-0\">{Client.clientTags }</label>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"nop-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                </div> }\r\n                {Client.specificDetails && <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <label className=\"label is-size-7 my-0\"  name=\"specificDetails\" type=\"text\">Specific Details about Client </label><label className=\"is-size-7 my-0\">{Client.specificDetails }</label>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"nop-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                </div> }\r\n                <div className=\"field is-horizontal\">\r\n                <div className=\"field-body\">\r\n                {Client.nok_name && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                        <label className=\"label is-size-7 my-0\"  name=\"nok_name\" type=\"text\">Next of Kin Full Name</label><label className=\"is-size-7 my-0\">{Client.nok_name }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-clinic-medical\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>}\r\n                {Client.nok_phoneno && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                        <label className=\"label is-size-7 my-0\"  name=\"nok_phoneno\" type=\"text\">Next of Kin Phone Number</label><label className=\"is-size-7 my-0\">{Client.nok_phoneno }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-clinic-medical\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div> }\r\n                {Client.nok_email && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"nok_email\" type=\"email\">Next of Kin Email </label><label className=\"is-size-7 my-0\">{Client.nok_email }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>}\r\n                {Client.nok_relationship && <div className=\"field\">\r\n                    <p className=\"control has-icons-left\">\r\n                    \r\n                        <label className=\"label is-size-7 my-0\"  name=\"nok_relationship\" type=\"text\">Next of Kin Relationship\"  </label><label className=\"is-size-7 my-0\">{Client.nok_relationship }</label>\r\n                        <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-envelope\"></i>\r\n                        </span>\r\n                    </p>\r\n                </div>}\r\n                </div>\r\n                </div> \r\n            <div className=\"field is-grouped  mt-2\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\r\n                        Edit Details\r\n                    </button>\r\n                </p>\r\n              {/*   <p className=\"control\">\r\n                    <button className=\"button is-info is-small\" >\r\n                        Financial Info\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" >\r\n                        Schedule appointment\r\n                    </button>\r\n                </p> */}\r\n               {/*  <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" >\r\n                        Check into Clinic \r\n                    </button>\r\n                </p> */}\r\n                <p className=\"control\">\r\n                    <button className=\"button is-link is-small\" onClick={()=>handleAttend()} >\r\n                        Attend to Client\r\n                    </button>\r\n                </p>\r\n\r\n            </div>\r\n            \r\n           \r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n}\r\n\r\nexport function ClientModify(){\r\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\r\n    // eslint-disable-next-line \r\n    const [error, setError] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [success, setSuccess] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line \r\n    const ClientServ=client.service('client')\r\n    //const history = useHistory()\r\n     // eslint-disable-next-line\r\n    const {user} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n    const [selectedClient,setSelectedClient]=useState()\r\n    const [selectedAppointment,setSelectedAppointment]=useState()\r\n\r\n    const Client =state.AppointmentModule.selectedAppointment\r\n\r\n        useEffect(() => {\r\n            setValue(\"firstname\", Client.firstname,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"middlename\", Client.middlename,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n             setValue(\"lastname\", Client.lastname,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"phone\", Client.phone,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"email\", Client.email,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"dob\", Client.dob,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"gender\", Client.gender,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) \r\n             setValue(\"profession\", Client.profession,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) \r\n            setValue(\"address\", Client.address,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"city\", Client.city,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n             setValue(\"state\", Client.state,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"country\", Client.country,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"nok_name\", Client.nok_name,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"nok_email\", Client.nok_email,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"nok_phoneno\", Client.nokphoneno,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) \r\n             setValue(\"lga\", Client.lga,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) \r\n            setValue(\"bloodgroup\", Client.bloodgroup,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"genotype\", Client.genotype,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n             setValue(\"disabilities\", Client.disabilities,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"specificDetails\", Client.specificDetails,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"clientTags\", Client.clientTags,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"mrn\", Client.mrn,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"comorbidities\", Client.comorbidities,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) \r\n             setValue(\"allergies\", Client.allergies,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) \r\n           \r\n            \r\n            return () => {\r\n                \r\n            }\r\n        })\r\n\r\n   const handleCancel=async()=>{\r\n    const    newClientModule={\r\n        selectedAppointment:{},\r\n        show :'create'\r\n      }\r\n         await setState((prevstate)=>({...prevstate, AppointmentModule:newClientModule}))\r\n            //console.log(state)\r\n           }\r\n\r\n\r\n    const changeState =()=>{\r\n        const    newClientModule={\r\n            selectedAppointment:{},\r\n            show :'create'\r\n        }\r\n        setState((prevstate)=>({...prevstate, AppointmentModule:newClientModule}))\r\n\r\n        }\r\n    const handleDelete=async()=>{\r\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\r\n        \r\n        const dleteId=Client._id\r\n        if (conf){\r\n             \r\n        ClientServ.remove(dleteId)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                reset();\r\n               /*  setMessage(\"Deleted Client successfully\")\r\n                setSuccess(true)\r\n                changeState()\r\n               setTimeout(() => {\r\n                setSuccess(false)\r\n                }, 200); */\r\n                toast({\r\n                    message: 'Client deleted succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                changeState()\r\n            })\r\n            .catch((err)=>{\r\n               // setMessage(\"Error deleting Client, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error deleting Client, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n        }\r\n    }\r\n        \r\n\r\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n          })) */\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        \r\n        setSuccess(false)\r\n       // console.log(data)\r\n      //  data.facility=Client.facility\r\n          //console.log(data);\r\n          \r\n        ClientServ.patch(Client._id,data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n               // e.target.reset();\r\n               // setMessage(\"updated Client successfully\")\r\n                 toast({\r\n                    message: 'Client updated succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  \r\n                changeState()\r\n\r\n            })\r\n            .catch((err)=>{\r\n                //setMessage(\"Error creating Client, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error updating Client, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n     \r\n      \r\n    return (\r\n        \r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Client Details-Modify\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n            <div className=\"field is-horizontal\">\r\n        <div className=\"field-body\">\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left has-icons-right\">\r\n                    <label className=\"label is-size-7\"   >First Name </label> <input className=\"input is-small\" ref={register()} name=\"firstname\" type=\"text\"placeholder=\"First Name \" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"nop-hospital\"></i>\r\n                    </span>                    \r\n                </p>\r\n            </div>\r\n\r\n\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left has-icons-right\">\r\n                <label className=\"label is-size-7\"   > Middle Name </label><input className=\"input is-small\" ref={register()} name=\"middlename\" type=\"text\" placeholder=\"Middle Name \" />\r\n                <span className=\"icon is-small is-left\">\r\n                    <i className=\"nop-map-signs\"></i>\r\n                </span>\r\n                \r\n                </p>\r\n            </div>\r\n\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n                <label className=\"label is-size-7\"  >Last Name</label><input className=\"input is-small\" ref={register()} name=\"lastname\" type=\"text\"placeholder=\"Last Name \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\" nop-user-md \"></i>\r\n                </span>\r\n            </p>\r\n        </div>\r\n        </div>  \r\n        </div>\r\n        \r\n        <div className=\"field is-horizontal\">\r\n        <div className=\"field-body\">\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Date of Birth  </label><input className=\"input is-small\" ref={register()} name=\"dob\" type=\"text\"placeholder=\"Date of Birth \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Gender  </label><input className=\"input is-small\" ref={register()} name=\"gender\" type=\"text\"placeholder=\"Gender  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Marital Status  </label><input className=\"input is-small\" ref={register()} name=\"maritalstatus\" type=\"text\"placeholder=\"Marital Status  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  > Records Number </label><input className=\"input is-small\" ref={register()} name=\"mrn\" type=\"text\"placeholder=\"Records Number  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        </div>\r\n        </div>\r\n        <div className=\"field is-horizontal\">\r\n        <div className=\"field-body\">\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Religion</label><input className=\"input is-small\" ref={register()} name=\"religion\" type=\"text\"placeholder=\"Religion \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Profession  </label><input className=\"input is-small\" ref={register()} name=\"profession\" type=\"text\" placeholder=\"Profession\" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n                <label className=\"label is-size-7\"  > Phone No</label><input className=\"input is-small\" ref={register()} name=\"phone\" type=\"text\" placeholder=\" Phone No \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-phone-alt\"></i>\r\n                </span>\r\n            </p>\r\n        </div>\r\n\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Email  </label><input className=\"input is-small\" ref={register()} name=\"email\" type=\"email\"placeholder=\"Email  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        </div>\r\n        </div>\r\n\r\n        <div className=\"field\">\r\n        <p className=\"control has-icons-left\">\r\n\r\n            <label className=\"label is-size-7\"  >Residential Address  </label><input className=\"input is-small\" ref={register()} name=\"address\" type=\"text\" placeholder=\"Residential Address  \" />\r\n            <span className=\"icon is-small is-left\">\r\n            <i className=\"nop-envelope\"></i>\r\n            </span>\r\n        </p>\r\n        </div> \r\n        <div className=\"field is-horizontal\">\r\n        <div className=\"field-body\">\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Town/City  </label><input className=\"input is-small\" ref={register()} name=\"city\" type=\"text\" placeholder=\"Town/City  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Local Govt Area  </label><input className=\"input is-small\" ref={register()} name=\"lga\" type=\"text\"placeholder=\"Local Govt Area  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >State  </label><input className=\"input is-small\" ref={register()} name=\"state\" type=\"text\"placeholder=\"State\" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Country  </label><input className=\"input is-small\" ref={register()} name=\"country\" type=\"text\" placeholder=\"Country  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div>\r\n        </div>\r\n        </div> \r\n        <div className=\"field is-horizontal\">\r\n        <div className=\"field-body\">\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                \r\n                    <label className=\"label is-size-7\"  >Blood Group </label><input className=\"input is-small\" ref={register()} name=\"bloodgroup\" type=\"text\"placeholder=\"Blood Group \" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"nop-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                \r\n                    <label className=\"label is-size-7\"  >Genotype  </label><input className=\"input is-small\" ref={register()} name=\"genotype\" type=\"text\" placeholder=\"Genotype \" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"nop-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                \r\n                    <label className=\"label is-size-7\" >Disabilities  </label><input className=\"input is-small\" ref={register()}  name=\"disabilities\" type=\"text\"placeholder=\"Disabilities  \" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"nop-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> \r\n        </div> \r\n        </div>  \r\n\r\n        <div className=\"field is-horizontal\">\r\n        <div className=\"field-body\">\r\n\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Allergies  </label><input className=\"input is-small\" ref={register()} name=\"allergies\" type=\"text\"placeholder=\"Allergies  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Co-mobidities </label><input className=\"input is-small\" ref={register()} name=\"comorbidities\" type=\"text\"placeholder=\"Co-mobidities \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        </div>\r\n        </div>\r\n        <div className=\"field\">\r\n        <p className=\"control has-icons-left\">\r\n\r\n            <label className=\"label is-size-7\"  >Tags  </label><input className=\"input is-small\" ref={register()} name=\"clientTags\" type=\"text\" placeholder=\"Tags \" />\r\n            <span className=\"icon is-small is-left\">\r\n            <i className=\"nop-envelope\"></i>\r\n            </span>\r\n        </p>\r\n        </div> \r\n        <div className=\"field\">\r\n        <p className=\"control has-icons-left\">\r\n            <label className=\"label is-size-7\"  >Specific Details about client  </label><input className=\"input is-small\" ref={register()} name=\"specificDetails\" type=\"text\"placeholder=\"Specific Details about client \" />\r\n            <span className=\"icon is-small is-left\">\r\n            <i className=\"nop-envelope\"></i>\r\n            </span>\r\n        </p>\r\n        </div> \r\n        <div className=\"field is-horizontal\">\r\n        <div className=\"field-body\">\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n                <label className=\"label is-size-7\"  >Next of Kin Full Name</label><input className=\"input is-small\" ref={register()} name=\"nok_name\" type=\"text\"placeholder=\"Next of Kin Full Name \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-clinic-medical\"></i>\r\n                </span>\r\n            </p>\r\n        </div>\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n                <label className=\"label is-size-7\" >Phone Number</label><input className=\"input is-small\" ref={register()}  name=\"nok_phoneno\" type=\"text\"placeholder=\" \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-clinic-medical\"></i>\r\n                </span>\r\n            </p>\r\n        </div> \r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  >Next of Kin Email  </label><input className=\"input is-small\" ref={register()} name=\"nok_email\" type=\"email\"placeholder=\"Next of Kin Email  \" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div>\r\n        <div className=\"field\">\r\n            <p className=\"control has-icons-left\">\r\n            \r\n                <label className=\"label is-size-7\"  > Relationship  </label><input className=\"input is-small\" ref={register()} name=\"nok_relationship\" type=\"text\" placeholder=\"Next of Kin Relationship\" />\r\n                <span className=\"icon is-small is-left\">\r\n                <i className=\"nop-envelope\"></i>\r\n                </span>\r\n            </p>\r\n        </div>\r\n        </div>\r\n        </div> \r\n           \r\n           \r\n            </form>\r\n            \r\n            <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n               {/*  <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p> */}\r\n            </div>\r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n                \r\n}   \r\n\r\nexport  function ClientSearch({getSearchfacility,clear}) {\r\n    \r\n    const ClientServ=client.service('client')\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n     const [searchError, setSearchError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [showPanel, setShowPanel] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [searchMessage, setSearchMessage] = useState(\"\") \r\n   // eslint-disable-next-line \r\n   const [simpa,setSimpa]=useState(\"\")\r\n   // eslint-disable-next-line \r\n   const [chosen,setChosen]=useState(false)\r\n   // eslint-disable-next-line \r\n   const [count,setCount]=useState(0)\r\n   const inputEl=useRef(null)\r\n   const [val,setVal]=useState(\"\")\r\n   const {user} = useContext(UserContext) \r\n   const {state}=useContext(ObjectContext)\r\n    const [productModal,setProductModal]=useState(false)\r\n\r\n   const handleRow= async(obj)=>{\r\n        await setChosen(true)\r\n        //alert(\"something is chaning\")\r\n       getSearchfacility(obj)\r\n       \r\n       await setSimpa(obj.firstname + \" \"+ obj.middlename+ \" \"+obj.lastname + \" \"+obj.gender+\" \"+obj.phone )\r\n       \r\n        // setSelectedFacility(obj)\r\n        setShowPanel(false)\r\n        await setCount(2)\r\n        /* const    newfacilityModule={\r\n            selectedFacility:facility,\r\n            show :'detail'\r\n        }\r\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\r\n   //console.log(state)\r\n    }\r\n    const handleBlur=async(e)=>{\r\n         if (count===2){\r\n             console.log(\"stuff was chosen\")\r\n         }\r\n       \r\n       /*  console.log(\"blur\")\r\n         setShowPanel(false)\r\n        console.log(JSON.stringify(simpa))\r\n        if (simpa===\"\"){\r\n            console.log(facilities.length)\r\n            setSimpa(\"abc\")\r\n            setSimpa(\"\")\r\n            setFacilities([])\r\n            inputEl.current.setValue=\"\"\r\n        }\r\n        console.log(facilities.length)\r\n        console.log(inputEl.current) */\r\n    }\r\n    const handleSearch=async(val)=>{\r\n        setVal(val)\r\n        if (val===\"\"){\r\n            setShowPanel(false)\r\n            getSearchfacility(false)\r\n            return\r\n        }\r\n        const field='name' //field variable\r\n\r\n       \r\n        if (val.length>=3 ){\r\n            ClientServ.find({query: {\r\n                $or:[\r\n                    { firstname: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { lastname: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { middlename: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { phone: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { clientTags: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { mrn: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                    { specificDetails: {\r\n                        $regex:val,\r\n                        $options:'i' \r\n                    }},\r\n                ],\r\n              \r\n                 //facility: user.currentEmployee.facilityDetail._id,\r\n                 //storeId: state.StoreModule.selectedStore._id,\r\n                 $limit:10,\r\n                 $sort: {\r\n                     createdAt: -1\r\n                   }\r\n                     }}).then((res)=>{\r\n              console.log(\"product  fetched successfully\") \r\n              console.log(res.data) \r\n                setFacilities(res.data)\r\n                 setSearchMessage(\" product  fetched successfully\")\r\n                 setShowPanel(true)\r\n             })\r\n             .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating ProductEntry ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n             })\r\n         }\r\n        else{\r\n            console.log(\"less than 3 \")\r\n            console.log(val)\r\n            setShowPanel(false)\r\n            await setFacilities([])\r\n            console.log(facilities)\r\n        }\r\n    }\r\n\r\n    const handleAddproduct =()=>{\r\n        setProductModal(true) \r\n    }\r\n    const handlecloseModal =()=>{\r\n        setProductModal(false)\r\n        handleSearch(val)\r\n    }\r\n    useEffect(() => {\r\n       if (clear){\r\n           console.log(\"success has changed\",clear)\r\n           setSimpa(\"\")\r\n       }\r\n        return () => {\r\n            \r\n        }\r\n    }, [clear] )\r\n    return (\r\n        <div>\r\n            <div className=\"field\">\r\n                <div className=\"control has-icons-left  \">\r\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`} style={{width:\"100%\"}}>\r\n                        <div className=\"dropdown-trigger\" style={{width:\"100%\"}}>\r\n                            <DebounceInput className=\"input is-small  is-expanded mb-0\" \r\n                                type=\"text\" placeholder=\"Search for Client\"\r\n                                value={simpa}\r\n                                minLength={3}\r\n                                debounceTimeout={400}\r\n                                onBlur={(e)=>handleBlur(e)}\r\n                                onChange={(e)=>handleSearch(e.target.value)}\r\n                                inputRef={inputEl}\r\n                                  />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-search\"></i>\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"dropdown-menu expanded\" style={{width:\"100%\"}}>\r\n                            <div className=\"dropdown-content\">\r\n                          { facilities.length>0?\"\":<div className=\"dropdown-item\" /* onClick={handleAddproduct} */> <span> {val} is not yet your client</span> </div>}\r\n\r\n                              {facilities.map((facility, i)=>(\r\n                                    \r\n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)}>\r\n                                        \r\n                                        <div><span>{facility.firstname}</span>\r\n                                        <span className=\"padleft\">{facility.middlename}</span>\r\n                                        <span className=\"padleft\">{facility.lastname}</span>\r\n                                        <span className=\"padleft\"> {formatDistanceToNowStrict(new Date(facility.dob))}</span>\r\n                                        <span className=\"padleft\">{facility.gender}</span>\r\n                                        <span className=\"padleft\">{facility.profession}</span>\r\n                                        <span className=\"padleft\">{facility.phone}</span>\r\n                                        <span className=\"padleft\">{facility.email}</span>\r\n                                        </div>\r\n                                       \r\n                                    </div>\r\n                                    \r\n                                    ))}\r\n                                    \r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className={`modal ${productModal?\"is-active\":\"\"}` }>\r\n                                    <div className=\"modal-background\"></div>\r\n                                    <div className=\"modal-card\">\r\n                                        <header className=\"modal-card-head\">\r\n                                        <p className=\"modal-card-title\">Choose Store</p>\r\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={handlecloseModal}></button>\r\n                                        </header>\r\n                                        <section className=\"modal-card-body\">\r\n                                        {/* <StoreList standalone=\"true\" /> */}\r\n                                        {/* <ProductCreate /> */}\r\n                                        </section>\r\n                                        {/* <footer className=\"modal-card-foot\">\r\n                                        <button className=\"button is-success\">Save changes</button>\r\n                                        <button className=\"button\">Cancel</button>\r\n                                        </footer> */}\r\n                                    </div>\r\n                                </div>       \r\n        </div>\r\n    )\r\n}","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\FinanceModule.js",["625","626","627","628","629","630","631","632","633","634","635","636"],"import React,{useState,useContext,useEffect} from 'react'\r\nimport {Route, Switch,  useRouteMatch, Link, NavLink} from 'react-router-dom'\r\nimport FinanceReport from './Finance/FinanceReport'\r\nimport FinanceSetup from './Finance/FinanceSetup'\r\nimport FinanceStore from './Finance/FinanceStore'\r\nimport FinanceHome from './Finance/FinanceHome'\r\nimport ProductEntry from './Finance/ProductEntry'\r\nimport ProductExit from './Finance/ProductExit'\r\nimport Payment from './Finance/Payment'\r\nimport Products from './Finance/Products'\r\nimport Store, { StoreList, StoreListStandalone } from './Finance/Store'\r\nimport {UserContext,ObjectContext} from '../context'\r\nimport BillPrescription from './Finance/BillPrescription'\r\n\r\nexport default function FinanceModule() {\r\n    const {state,setState}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedStore,setSelectedStore]=useState()\r\n    const [showModal,setShowModal]=useState(false)\r\n\r\n    let { path, url } = useRouteMatch();\r\n    \r\n    useEffect(() => {\r\n       \r\n        console.log(\"starting up Finance module\")\r\n        if (!selectedStore){\r\n            handleChangeStore()\r\n\r\n            }\r\n         return () => {       \r\n            }\r\n        }, [])\r\n   \r\n    useEffect(()=>{\r\n     setSelectedStore(state.StoreModule.selectedStore)\r\n\r\n    },[state.StoreModule])\r\n\r\n    const handleChangeStore= async()=>{\r\n        await setShowModal(true)                                                                                                                                                        \r\n        console.log( showModal)\r\n    }\r\n\r\n    return (\r\n            <section className=\"section has-background-info remPad\">\r\n               \r\n               {/*  <div className=\"\"> */}\r\n                    <nav className=\"navbar minHt z10 has-background-info\">\r\n                        <div className=\"container minHt \">\r\n                            <div className=\"navbar-brand minHt\">\r\n                                <div className=\"navbar-item \">\r\n                                    <span className=\"is-size-6 has-text-weight-medium\">\r\n                                        Health Stack::Finance::{selectedStore?selectedStore.name:\"\"}</span>\r\n                                        <button className=\"button is-small is-info selectadd\" onClick={()=>handleChangeStore()}>Change Location</button> \r\n                                </div>\r\n                                \r\n                            {/* <div className=\"navbar-item\">\r\n                                <img src=\"https://bulma.io/images/bulma-type-white.png\" alt=\"Logo\" />\r\n                            </div> */}\r\n                                <span className=\"navbar-burger\" data-target=\"navbarMenuHeroB\">\r\n                                    <span></span>\r\n                                    <span></span>\r\n                                    <span></span>\r\n                                </span>\r\n                            </div>\r\n                            <div id=\"navbarMenuHeroB\" className=\"navbar-menu\">\r\n                                <div className=\"navbar-end\">\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/payment`}>Payment</NavLink>\r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/location`}>Finance Locations</NavLink>\r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}`}>Home Page</NavLink> \r\n                                    </div>\r\n                                    \r\n                                    {/* <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/inv-bill`}>Bill Prescription</NavLink>\r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/inv-Finance`}>Store Finance</NavLink>\r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/inv-entry`}>Product Entry</NavLink>\r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/inv-exit`}>Product Exit</NavLink>\r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/inv-products`}>Products</NavLink>\r\n                                    </div>\r\n                                    <div className=\"navbar-item\">\r\n                                        <NavLink to={`${url}/inv-reports`}>Reports</NavLink>\r\n                                    </div> */}\r\n                                {/* <span className=\"navbar-item\">\r\n                                <div className=\"button is-info is-inverted\">\r\n                                    <span className=\"icon\">\r\n                                    <i className=\"fab fa-github\"></i>\r\n                                    </span>\r\n                                    <span>Download</span>\r\n                                </div>\r\n                                </span> */}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </nav>\r\n                    \r\n               {/*  </div> */}\r\n                \r\n                {/* <div className=\"section\"> */}\r\n                {/* <div className=\"container mvUp \" > */}\r\n                       \r\n                    <Switch>\r\n                        <Route path={path} exact>\r\n                            <FinanceHome />\r\n                        </Route>\r\n                        <Route path={`${path}/payment`} exact >\r\n                            <Payment />\r\n                        </Route>\r\n                        {/* <Route path={`${path}/inv-bill`} exact >\r\n                            <BillPrescription />\r\n                        </Route>\r\n                        <Route path={`${path}/inv-admin`} exact >\r\n                            <FinanceSetup />\r\n                        </Route>\r\n                        <Route path={`${path}/inv-Finance`} exact>\r\n                            <FinanceStore />\r\n                        </Route>\r\n                        <Route path={`${path}/inv-entry`} exact>\r\n                            <ProductEntry />\r\n                        </Route>\r\n                        <Route path={`${path}/inv-exit`} exact>\r\n                            <ProductExit/>\r\n                        </Route>\r\n                        <Route path={`${path}/inv-products`} exact>\r\n                            <Products />\r\n                        </Route>\r\n                        <Route path={`${path}/inv-reports`} exact>\r\n                            <FinanceReport />\r\n                        </Route> */}\r\n                        <Route path={`${path}/location`} exact>\r\n                            <Store />\r\n                        </Route>\r\n\r\n                    </Switch>\r\n                  \r\n\r\n                    <div className={`modal ${showModal?\"is-active\":\"\"}` }>\r\n                                    <div className=\"modal-background\"></div>\r\n                                    <div className=\"modal-card\">\r\n                                        <header className=\"modal-card-head\">\r\n                                        <p className=\"modal-card-title\">Choose Location</p>\r\n                                        <button className=\"delete\" aria-label=\"close\"  onClick={()=>setShowModal(false)}></button>\r\n                                        </header>\r\n                                        <section className=\"modal-card-body\">\r\n                                        <StoreListStandalone standalone=\"true\" closeModal={()=>setShowModal(false)} />\r\n                                        </section>\r\n                                        {/* <footer className=\"modal-card-foot\">\r\n                                        <button className=\"button is-success\">Save changes</button>\r\n                                        <button className=\"button\">Cancel</button>\r\n                                        </footer> */}\r\n                                    </div>\r\n                                </div>        \r\n            </section>\r\n    )\r\n}\r\n","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\Store.js",["637","638","639","640","641","642"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\n// eslint-disable-next-line\r\nconst searchfacility={};\r\n\r\n\r\nexport default function Store() {\r\n    const {state}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedStore,setSelectedStore]=useState()\r\n    //const [showState,setShowState]=useState() //create|modify|detail\r\n    \r\n    return(\r\n        <section className= \"section remPadTop\">\r\n           {/*  <div className=\"level\">\r\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Store  Module</span></div>\r\n            </div> */}\r\n            <div className=\"columns \">\r\n            <div className=\"column is-8 \">\r\n                <StoreList />\r\n                </div>\r\n            <div className=\"column is-4 \">\r\n                {(state.StoreModule.show ==='create')&&<StoreCreate />}\r\n                {(state.StoreModule.show ==='detail')&&<StoreDetail  />}\r\n                {(state.StoreModule.show ==='modify')&&<StoreModify Store={selectedStore} />}\r\n               \r\n            </div>\r\n\r\n            </div>                            \r\n            </section>\r\n       \r\n    )\r\n    \r\n}\r\n\r\nexport function StoreCreate(){\r\n    const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \r\n    const [error, setError] =useState(false)\r\n    const [success, setSuccess] =useState(false)\r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line\r\n    const [facility,setFacility] = useState()\r\n    const StoreServ=client.service('location')\r\n    //const history = useHistory()\r\n    const {user} = useContext(UserContext) //,setUser\r\n    // eslint-disable-next-line\r\n    const [currentUser,setCurrentUser] = useState()\r\n\r\n\r\n\r\n    const getSearchfacility=(obj)=>{ // buble-up from inputsearch for creating resource\r\n        \r\n        setValue(\"facility\", obj._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })\r\n    }\r\n    \r\n    useEffect(() => {\r\n        setCurrentUser(user)\r\n        //console.log(currentUser)\r\n        return () => {\r\n        \r\n        }\r\n    }, [user])\r\n\r\n  //check user for facility or get list of facility  \r\n    useEffect(()=>{\r\n        //setFacility(user.activeStore.FacilityId)//\r\n      if (!user.stacker){\r\n          console.log(currentUser)\r\n        setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        }) \r\n      }\r\n    })\r\n\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        setMessage(\"\")\r\n        setError(false)\r\n        setSuccess(false)\r\n         // data.createdby=user._id\r\n          console.log(data);\r\n          if (user.currentEmployee){\r\n         data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\r\n          }\r\n          data.locationType=\"Store\"\r\n        StoreServ.create(data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                e.target.reset();\r\n               /*  setMessage(\"Created Store successfully\") */\r\n                setSuccess(true)\r\n                toast({\r\n                    message: 'Store created succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  setSuccess(false)\r\n            })\r\n            .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating Store ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n\r\n    return (\r\n        <>\r\n            <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Create Location\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n   \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n               {/*  <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input is-small\" ref={register({ required: true })}  name=\"StoreType\" type=\"text\" placeholder=\"Type of Store\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                </div> */}\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })}  name=\"name\" type=\"text\" placeholder=\"Name of Location\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n            </div>\r\n           {/*  <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"profession\" type=\"text\" placeholder=\"Profession\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\" fas fa-user-md \"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"phone\" type=\"text\" placeholder=\" Phone No\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n           \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                \r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"email\" type=\"email\" placeholder=\"Email\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n           <div className=\"field\"  style={ !user.stacker?{display:\"none\"}:{}} >\r\n                <InputSearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                    <input className=\"input is-small\" ref={register ({ required: true }) } name=\"facility\" type=\"text\" placeholder=\"Facility\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas  fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n           {/*  <div className=\"field\">\r\n                <div className=\"control has-icons-left\">\r\n                    <div className=\"dropdown \">\r\n                        <div className=\"dropdown-trigger\">\r\n                            <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital-symbol\"></i>\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"dropdown-menu\">\r\n                            <div className=\"dropdown-content\">\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa\r\n                                </div>\r\n                                <div className=\"dropdown-item is-active\">\r\n                                    simpa 2\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 3\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 4\r\n                                </div>\r\n                            </div>\r\n                        </div>   \r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Department Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"password\" type=\"text\" placeholder=\"password\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n            <div className=\"field\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\">\r\n                        Create\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            \r\n            </form>\r\n            </div>\r\n            </div>\r\n        </>\r\n    )\r\n   \r\n}\r\n\r\nexport function StoreList({standalone,closeModal}){\r\n   // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const StoreServ=client.service('location')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedStore, setSelectedStore]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n    // eslint-disable-next-line\r\n    const {user,setUser}=useContext(UserContext)\r\n\r\n\r\n\r\n    const handleCreateNew = async()=>{\r\n        const    newStoreModule={\r\n            selectedStore:{},\r\n            show :'create'\r\n            }\r\n       await setState((prevstate)=>({...prevstate, StoreModule:newStoreModule}))\r\n       //console.log(state)\r\n        \r\n\r\n    }\r\n    const handleRow= async(Store)=>{\r\n        //console.log(\"b4\",state)\r\n\r\n        //console.log(\"handlerow\",Store)\r\n\r\n        await setSelectedStore(Store)\r\n\r\n        const    newStoreModule={\r\n            selectedStore:Store,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, StoreModule:newStoreModule}))\r\n       //console.log(state)\r\n       //closeModal()\r\n\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='name'\r\n       console.log(val)\r\n       StoreServ.find({query: {\r\n                [field]: {\r\n                    $regex:val,\r\n                    $options:'i'\r\n                   \r\n                },\r\n               facility:user.currentEmployee.facilityDetail._id || \"\",\r\n                locationType:\"Finance\",\r\n               $limit:10,\r\n                $sort: {\r\n                    name: 1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" Store  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error fetching Store, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n   \r\n        const getFacilities= async()=>{\r\n            if (user.currentEmployee){\r\n            \r\n        const findStore= await StoreServ.find(\r\n                {query: {\r\n                    locationType:\"Finance\",\r\n                    facility:user.currentEmployee.facilityDetail._id,\r\n                    $limit:20,\r\n                    $sort: {\r\n                        name: 1\r\n                    }\r\n                    }})\r\n\r\n         await setFacilities(findStore.data)\r\n                }\r\n                else {\r\n                    if (user.stacker){\r\n                        const findStore= await StoreServ.find(\r\n                            {query: {\r\n                                locationType:\"Finance\",\r\n                                $limit:20,\r\n                                $sort: {\r\n                                    name: 1\r\n                                }\r\n                                }})\r\n            \r\n                    await setFacilities(findStore.data)\r\n\r\n                    }\r\n                }\r\n          /*   .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" Store  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating Store, probable network issues \"+ err )\r\n                    setError(true)\r\n                }) */\r\n            }\r\n            \r\n            useEffect(() => {\r\n                setTimeout(() => {\r\n                    console.log(\"happy birthday\")\r\n                    //getFacilities(user)\r\n                }, 200);\r\n\r\n                return () => {\r\n                    \r\n\r\n                }\r\n            },[])\r\n\r\n            useEffect(() => {\r\n               \r\n                if (user){\r\n                    getFacilities()\r\n                }else{\r\n                    /* const localUser= localStorage.getItem(\"user\")\r\n                    const user1=JSON.parse(localUser)\r\n                    console.log(localUser)\r\n                    console.log(user1)\r\n                    fetchUser(user1)\r\n                    console.log(user)\r\n                    getFacilities(user) */\r\n                }\r\n                StoreServ.on('created', (obj)=>getFacilities())\r\n                StoreServ.on('updated', (obj)=>getFacilities())\r\n                StoreServ.on('patched', (obj)=>getFacilities())\r\n                StoreServ.on('removed', (obj)=>getFacilities())\r\n                return () => {\r\n                \r\n                }\r\n            },[])\r\n\r\n\r\n    //todo: pagination and vertical scroll bar\r\n\r\n    return(\r\n        <>\r\n           {user?( <>  \r\n                <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search Stores\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Locations </span></div>\r\n                    <div className=\"level-right\">\r\n                { !standalone &&   <div className=\"level-item\"> \r\n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                        </div>}\r\n                    </div>\r\n\r\n                </div>\r\n                <div className=\"table-container pullup \">\r\n                                <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\r\n                                    <thead>\r\n                                        <tr>\r\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                        <th>Name</th>\r\n                                        {/* <th><abbr title=\"Last Name\">Store Type</abbr></th>\r\n                                       <th><abbr title=\"Profession\">Profession</abbr></th>\r\n                                         <th><abbr title=\"Phone\">Phone</abbr></th>\r\n                                        <th><abbr title=\"Email\">Email</abbr></th>\r\n                                        <th><abbr title=\"Department\">Department</abbr></th>\r\n                                        <th><abbr title=\"Departmental Unit\">Departmental Unit</abbr></th> \r\n                                        <th><abbr title=\"Facility\">Facility</abbr></th>*/}\r\n                                       { !standalone &&  <th><abbr title=\"Actions\">Actions</abbr></th>}\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tfoot>\r\n                                        \r\n                                    </tfoot>\r\n                                    <tbody>\r\n                                        {facilities.map((Store, i)=>(\r\n\r\n                                            <tr key={Store._id} onClick={()=>handleRow(Store)} className={Store._id===(selectedStore?._id||null)?\"is-selected\":\"\"}>\r\n                                            <th>{i+1}</th>\r\n                                            <th>{Store.name}</th>\r\n                                            {/*<td>{Store.StoreType}</td>\r\n                                            < td>{Store.profession}</td>\r\n                                            <td>{Store.phone}</td>\r\n                                            <td>{Store.email}</td>\r\n                                            <td>{Store.department}</td>\r\n                                            <td>{Store.deptunit}</td> \r\n                                            <td>{Store.facility}</td>*/}\r\n                                          { !standalone &&   <td><span   className=\"showAction\"  >...</span></td>}\r\n                                           \r\n                                            </tr>\r\n\r\n                                        ))}\r\n                                    </tbody>\r\n                                    </table>\r\n                                    \r\n                </div>              \r\n            </>):<div>loading</div>}\r\n            </>\r\n              \r\n    )\r\n    }\r\n\r\n\r\n    export function StoreListStandalone({standalone,closeModal}){\r\n        // const { register, handleSubmit, watch, errors } = useForm();\r\n         // eslint-disable-next-line\r\n         const [error, setError] =useState(false)\r\n          // eslint-disable-next-line\r\n         const [success, setSuccess] =useState(false)\r\n          // eslint-disable-next-line\r\n        const [message, setMessage] = useState(\"\") \r\n         const StoreServ=client.service('location')\r\n         //const history = useHistory()\r\n        // const {user,setUser} = useContext(UserContext)\r\n         const [facilities,setFacilities]=useState([])\r\n          // eslint-disable-next-line\r\n        const [selectedStore, setSelectedStore]=useState() //\r\n         // eslint-disable-next-line\r\n         const {state,setState}=useContext(ObjectContext)\r\n         // eslint-disable-next-line\r\n         const {user,setUser}=useContext(UserContext)\r\n     \r\n     \r\n     \r\n         const handleCreateNew = async()=>{\r\n             const    newStoreModule={\r\n                 selectedStore:{},\r\n                 show :'create'\r\n                 }\r\n            await setState((prevstate)=>({...prevstate, StoreModule:newStoreModule}))\r\n            //console.log(state)\r\n             \r\n     \r\n         }\r\n         const handleRow= async(Store)=>{\r\n             //console.log(\"b4\",state)\r\n     \r\n             //console.log(\"handlerow\",Store)\r\n     \r\n             await setSelectedStore(Store)\r\n     \r\n             const    newStoreModule={\r\n                 selectedStore:Store,\r\n                 show :'detail'\r\n             }\r\n            await setState((prevstate)=>({...prevstate, StoreModule:newStoreModule}))\r\n            //console.log(state)\r\n            closeModal()\r\n     \r\n         }\r\n     \r\n        const handleSearch=(val)=>{\r\n            const field='name'\r\n            console.log(val)\r\n            StoreServ.find({query: {\r\n                     [field]: {\r\n                         $regex:val,\r\n                         $options:'i'\r\n                        \r\n                     },\r\n                    facility:user.currentEmployee.facilityDetail._id || \"\",\r\n                     locationType:\"Finance\",\r\n                    $limit:10,\r\n                     $sort: {\r\n                         name: 1\r\n                       }\r\n                         }}).then((res)=>{\r\n                     console.log(res)\r\n                    setFacilities(res.data)\r\n                     setMessage(\" Store  fetched successfully\")\r\n                     setSuccess(true) \r\n                 })\r\n                 .catch((err)=>{\r\n                     console.log(err)\r\n                     setMessage(\"Error fetching Store, probable network issues \"+ err )\r\n                     setError(true)\r\n                 })\r\n             }\r\n        \r\n             const getFacilities= async()=>{\r\n                 if (user.currentEmployee){\r\n                 \r\n             const findStore= await StoreServ.find(\r\n                     {query: {\r\n                         locationType:\"Finance\",\r\n                         facility:user.currentEmployee.facilityDetail._id,\r\n                         $limit:20,\r\n                         $sort: {\r\n                             name: 1\r\n                         }\r\n                         }})\r\n     \r\n              await setFacilities(findStore.data)\r\n                     }\r\n                     else {\r\n                         if (user.stacker){\r\n                             const findStore= await StoreServ.find(\r\n                                 {query: {\r\n                                     locationType:\"Finance\",\r\n                                     $limit:20,\r\n                                     $sort: {\r\n                                         name: 1\r\n                                     }\r\n                                     }})\r\n                 \r\n                         await setFacilities(findStore.data)\r\n     \r\n                         }\r\n                     }\r\n               /*   .then((res)=>{\r\n                     console.log(res)\r\n                         setFacilities(res.data)\r\n                         setMessage(\" Store  fetched successfully\")\r\n                         setSuccess(true)\r\n                     })\r\n                     .catch((err)=>{\r\n                         setMessage(\"Error creating Store, probable network issues \"+ err )\r\n                         setError(true)\r\n                     }) */\r\n                 }\r\n                 \r\n                 useEffect(() => {\r\n                     setTimeout(() => {\r\n                         console.log(\"happy birthday\")\r\n                         //getFacilities(user)\r\n                     }, 200);\r\n     \r\n                     return () => {\r\n                         \r\n     \r\n                     }\r\n                 },[])\r\n     \r\n                 useEffect(() => {\r\n                    \r\n                     if (user){\r\n                         getFacilities()\r\n                     }else{\r\n                         /* const localUser= localStorage.getItem(\"user\")\r\n                         const user1=JSON.parse(localUser)\r\n                         console.log(localUser)\r\n                         console.log(user1)\r\n                         fetchUser(user1)\r\n                         console.log(user)\r\n                         getFacilities(user) */\r\n                     }\r\n                     StoreServ.on('created', (obj)=>getFacilities())\r\n                     StoreServ.on('updated', (obj)=>getFacilities())\r\n                     StoreServ.on('patched', (obj)=>getFacilities())\r\n                     StoreServ.on('removed', (obj)=>getFacilities())\r\n                     return () => {\r\n                     \r\n                     }\r\n                 },[])\r\n     \r\n     \r\n         //todo: pagination and vertical scroll bar\r\n     \r\n         return(\r\n             <>\r\n                {user?( <>  \r\n                     <div className=\"level\">\r\n                         <div className=\"level-left\">\r\n                             <div className=\"level-item\">\r\n                                 <div className=\"field\">\r\n                                     <p className=\"control has-icons-left  \">\r\n                                         <DebounceInput className=\"input is-small \" \r\n                                             type=\"text\" placeholder=\"Search Stores\"\r\n                                             minLength={3}\r\n                                             debounceTimeout={400}\r\n                                             onChange={(e)=>handleSearch(e.target.value)} />\r\n                                         <span className=\"icon is-small is-left\">\r\n                                             <i className=\"fas fa-search\"></i>\r\n                                         </span>\r\n                                     </p>\r\n                                 </div>\r\n                             </div>\r\n                         </div>\r\n                         <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Stores </span></div>\r\n                         <div className=\"level-right\">\r\n                     { !standalone &&   <div className=\"level-item\"> \r\n                                 <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                             </div>}\r\n                         </div>\r\n     \r\n                     </div>\r\n                     <div className=\"table-container pullup \">\r\n                                     <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\r\n                                         <thead>\r\n                                             <tr>\r\n                                             <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                             <th>Name</th>\r\n                                             {/* <th><abbr title=\"Last Name\">Store Type</abbr></th>\r\n                                            <th><abbr title=\"Profession\">Profession</abbr></th>\r\n                                              <th><abbr title=\"Phone\">Phone</abbr></th>\r\n                                             <th><abbr title=\"Email\">Email</abbr></th>\r\n                                             <th><abbr title=\"Department\">Department</abbr></th>\r\n                                             <th><abbr title=\"Departmental Unit\">Departmental Unit</abbr></th> \r\n                                             <th><abbr title=\"Facility\">Facility</abbr></th>*/}\r\n                                            { !standalone &&  <th><abbr title=\"Actions\">Actions</abbr></th>}\r\n                                             </tr>\r\n                                         </thead>\r\n                                         <tfoot>\r\n                                             \r\n                                         </tfoot>\r\n                                         <tbody>\r\n                                             {facilities.map((Store, i)=>(\r\n     \r\n                                                 <tr key={Store._id} onClick={()=>handleRow(Store)} className={Store._id===(selectedStore?._id||null)?\"is-selected\":\"\"}>\r\n                                                 <th>{i+1}</th>\r\n                                                 <th>{Store.name}</th>\r\n                                                 {/*<td>{Store.StoreType}</td>\r\n                                                 < td>{Store.profession}</td>\r\n                                                 <td>{Store.phone}</td>\r\n                                                 <td>{Store.email}</td>\r\n                                                 <td>{Store.department}</td>\r\n                                                 <td>{Store.deptunit}</td> \r\n                                                 <td>{Store.facility}</td>*/}\r\n                                               { !standalone &&   <td><span   className=\"showAction\"  >...</span></td>}\r\n                                                \r\n                                                 </tr>\r\n     \r\n                                             ))}\r\n                                         </tbody>\r\n                                         </table>\r\n                                         \r\n                     </div>              \r\n                 </>):<div>loading</div>}\r\n                 </>\r\n                   \r\n         )\r\n         }\r\n\r\nexport function StoreDetail(){\r\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\r\n     // eslint-disable-next-line\r\n    const [error, setError] =useState(false) //, \r\n    //const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [message, setMessage] = useState(\"\") //,\r\n    //const StoreServ=client.service('/Store')\r\n    //const history = useHistory()\r\n    //const {user,setUser} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n   \r\n\r\n   const Store =state.StoreModule.selectedStore \r\n\r\n    const handleEdit= async()=>{\r\n        const    newStoreModule={\r\n            selectedStore:Store,\r\n            show :'modify'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, StoreModule:newStoreModule}))\r\n       //console.log(state)\r\n       \r\n    }\r\n \r\n    return (\r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Store Details\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n                <table> \r\n                <tbody>         \r\n                <tr>\r\n                    <td>\r\n                \r\n                    <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Name: \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {Store.name} </span>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                    <td>\r\n                <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>Location Type:\r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft\"   name=\"StoreType\">{Store.locationType} </span> \r\n                    </td>\r\n                </tr>\r\n                  {/*   <tr>\r\n                    <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>Profession: \r\n                \r\n                    \r\n                    </label>\r\n                    </td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"StoreCity\">{Store.profession}</span> \r\n                </td>\r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>Phone:           \r\n                    \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft \"  name=\"StoreContactPhone\" >{Store.phone}</span>\r\n                        </td>\r\n                  </tr>\r\n                    <tr><td>\r\n            \r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>Email:                     \r\n                    \r\n                         </label></td><td>\r\n                         <span className=\"is-size-7 padleft \"  name=\"StoreEmail\" >{Store.email}</span>\r\n                         </td>\r\n             \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i></span>Department:\r\n                    \r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft \"  name=\"StoreOwner\">{Store.department}</span>\r\n                    </td>\r\n               \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>Departmental Unit:              \r\n                    \r\n                </label></td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"StoreType\">{Store.deptunit}</span>\r\n                </td>\r\n              \r\n                </tr> */}\r\n                    \r\n          {/*   <div className=\"field\">\r\n             <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>Category:              \r\n                    <span className=\"is-size-7 padleft \"  name= \"StoreCategory\">{Store.StoreCategory}</span>\r\n                </label>\r\n                 </div> */}\r\n\r\n            </tbody> \r\n            </table> \r\n           \r\n            <div className=\"field mt-2\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\r\n                        Edit\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            { error && <div className=\"message\"> {message}</div>}\r\n           \r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n}\r\n\r\nexport function StoreModify(){\r\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\r\n    // eslint-disable-next-line \r\n    const [error, setError] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [success, setSuccess] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line \r\n    const StoreServ=client.service('location')\r\n    //const history = useHistory()\r\n     // eslint-disable-next-line\r\n    const {user} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n    const Store =state.StoreModule.selectedStore \r\n\r\n        useEffect(() => {\r\n            setValue(\"name\", Store.name,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"locationType\", Store.locationType,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n           /*  setValue(\"profession\", Store.profession,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"phone\", Store.phone,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"email\", Store.email,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"department\", Store.department,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"deptunit\", Store.deptunit,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n          /*   setValue(\"StoreCategory\", Store.StoreCategory,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n            \r\n            return () => {\r\n                \r\n            }\r\n        })\r\n\r\n   const handleCancel=async()=>{\r\n    const    newStoreModule={\r\n        selectedStore:{},\r\n        show :'create'\r\n      }\r\n   await setState((prevstate)=>({...prevstate, StoreModule:newStoreModule}))\r\n   //console.log(state)\r\n           }\r\n\r\n\r\n        const changeState =()=>{\r\n        const    newStoreModule={\r\n            selectedStore:{},\r\n            show :'create'\r\n        }\r\n        setState((prevstate)=>({...prevstate, StoreModule:newStoreModule}))\r\n\r\n        }\r\n    const handleDelete=async()=>{\r\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\r\n        \r\n        const dleteId=Store._id\r\n        if (conf){\r\n             \r\n        StoreServ.remove(dleteId)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                reset();\r\n               /*  setMessage(\"Deleted Store successfully\")\r\n                setSuccess(true)\r\n                changeState()\r\n               setTimeout(() => {\r\n                setSuccess(false)\r\n                }, 200); */\r\n                toast({\r\n                    message: 'Store deleted succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                changeState()\r\n            })\r\n            .catch((err)=>{\r\n               // setMessage(\"Error deleting Store, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error deleting Store, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n        }\r\n    }\r\n        \r\n\r\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n          })) */\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        \r\n        setSuccess(false)\r\n        console.log(data)\r\n        data.facility=Store.facility\r\n          //console.log(data);\r\n          \r\n        StoreServ.patch(Store._id,data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n               // e.target.reset();\r\n               // setMessage(\"updated Store successfully\")\r\n                 toast({\r\n                    message: 'Store updated succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  \r\n                changeState()\r\n\r\n            })\r\n            .catch((err)=>{\r\n                //setMessage(\"Error creating Store, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error updating Store, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n     \r\n      \r\n    return (\r\n        \r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Store Details-Modify\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <div className=\"field\">\r\n                    <label className=\"label is-small\"> Name\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"name\" type=\"text\" placeholder=\"Name\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                    </label>\r\n                    </div>\r\n                <div className=\"field\">\r\n                <label className=\"label is-small\">Location Type\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small \" ref={register({ required: true })} disabled name=\"StoreType\" type=\"text\" placeholder=\"Store Type\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n                </label>\r\n                </div>\r\n            {/* <div className=\"field\">\r\n            <label className=\"label is-small\">Profession\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"profession\" type=\"text\" placeholder=\"Profession\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Phone\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"phone\" type=\"text\" placeholder=\"Phone No\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                 </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Email\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"email\" type=\"email\" placeholder=\"Store Email\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Department\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                {errors.department && <span>This field is required</span>}\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Departmental Unit\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Departmental Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div> */}\r\n           {/*  <div className=\"field\">\r\n            <label className=\"label is-small\">Category\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"StoreCategory\" type=\"text\" placeholder=\"Store Category\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n            </div> */}\r\n           \r\n           \r\n            </form>\r\n            \r\n            <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n                {/* <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p> */}\r\n            </div>\r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n                \r\n}   \r\n\r\nexport  function InputSearch({getSearchfacility,clear}) {\r\n    \r\n    const facilityServ=client.service('facility')\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n     const [searchError, setSearchError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [showPanel, setShowPanel] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [searchMessage, setSearchMessage] = useState(\"\") \r\n   // eslint-disable-next-line \r\n   const [simpa,setSimpa]=useState(\"\")\r\n   // eslint-disable-next-line \r\n   const [chosen,setChosen]=useState(false)\r\n   // eslint-disable-next-line \r\n   const [count,setCount]=useState(0)\r\n   const inputEl=useRef(null)\r\n\r\n\r\n   const handleRow= async(obj)=>{\r\n        await setChosen(true)\r\n        //alert(\"something is chaning\")\r\n       getSearchfacility(obj)\r\n       \r\n       await setSimpa(obj.facilityName)\r\n       \r\n        // setSelectedFacility(obj)\r\n        setShowPanel(false)\r\n        await setCount(2)\r\n        /* const    newfacilityModule={\r\n            selectedFacility:facility,\r\n            show :'detail'\r\n        }\r\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\r\n   //console.log(state)\r\n}\r\n    const handleBlur=async(e)=>{\r\n         if (count===2){\r\n             console.log(\"stuff was chosen\")\r\n         }\r\n       \r\n       /*  console.log(\"blur\")\r\n         setShowPanel(false)\r\n        console.log(JSON.stringify(simpa))\r\n        if (simpa===\"\"){\r\n            console.log(facilities.length)\r\n            setSimpa(\"abc\")\r\n            setSimpa(\"\")\r\n            setFacilities([])\r\n            inputEl.current.setValue=\"\"\r\n        }\r\n        console.log(facilities.length)\r\n        console.log(inputEl.current) */\r\n    }\r\n    const handleSearch=async(val)=>{\r\n        \r\n        const field='facilityName' //field variable\r\n       \r\n        if (val.length>=3){\r\n            facilityServ.find({query: {     //service\r\n                 [field]: {\r\n                     $regex:val,\r\n                     $options:'i'\r\n                    \r\n                 },\r\n                 $limit:10,\r\n                 $sort: {\r\n                     createdAt: -1\r\n                   }\r\n                     }}).then((res)=>{\r\n              console.log(\"facility  fetched successfully\") \r\n                setFacilities(res.data)\r\n                 setSearchMessage(\" facility  fetched successfully\")\r\n                 setShowPanel(true)\r\n             })\r\n             .catch((err)=>{\r\n                 console.log(err)\r\n                 setSearchMessage(\"Error searching facility, probable network issues \"+ err )\r\n                 setSearchError(true)\r\n             })\r\n         }\r\n        else{\r\n            console.log(\"less than 3 \")\r\n            console.log(val)\r\n            setShowPanel(false)\r\n            await setFacilities([])\r\n            console.log(facilities)\r\n        }\r\n    }\r\n    useEffect(() => {\r\n       if (clear){\r\n           setSimpa(\"\")\r\n       }\r\n        return () => {\r\n            \r\n        }\r\n    }, [clear] )\r\n    return (\r\n        <div>\r\n            <div className=\"field\">\r\n                <div className=\"control has-icons-left  \">\r\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`}>\r\n                        <div className=\"dropdown-trigger\">\r\n                            <DebounceInput className=\"input is-small \" \r\n                                type=\"text\" placeholder=\"Search Facilities\"\r\n                                value={simpa}\r\n                                minLength={1}\r\n                                debounceTimeout={400}\r\n                                onBlur={(e)=>handleBlur(e)}\r\n                                onChange={(e)=>handleSearch(e.target.value)}\r\n                                inputRef={inputEl}\r\n                                  />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-search\"></i>\r\n                            </span>\r\n                        </div>\r\n                        {searchError&&<div>{searchMessage}</div>}\r\n                        <div className=\"dropdown-menu\" >\r\n                            <div className=\"dropdown-content\">\r\n                            {facilities.map((facility, i)=>(\r\n                                    \r\n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)} >\r\n                                        \r\n                                        <span>{facility.facilityName}</span>\r\n                                        \r\n                                    </div>\r\n                                    \r\n                                    ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n          \r\n        </div>\r\n    )\r\n}","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\Store.js",["643","644","645","646","647","648"],"import React, {useState,useContext, useEffect,useRef} from 'react'\r\nimport client from '../../feathers'\r\nimport {DebounceInput} from 'react-debounce-input';\r\nimport { useForm } from \"react-hook-form\";\r\n//import {useHistory} from 'react-router-dom'\r\nimport {UserContext,ObjectContext} from '../../context'\r\nimport {toast} from 'bulma-toast'\r\n// eslint-disable-next-line\r\nconst searchfacility={};\r\n\r\n\r\nexport default function Store() {\r\n    const {state}=useContext(ObjectContext) //,setState\r\n    // eslint-disable-next-line\r\n    const [selectedStore,setSelectedStore]=useState()\r\n    //const [showState,setShowState]=useState() //create|modify|detail\r\n    \r\n    return(\r\n        <section className= \"section remPadTop\">\r\n           {/*  <div className=\"level\">\r\n            <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">Store  Module</span></div>\r\n            </div> */}\r\n            <div className=\"columns \">\r\n            <div className=\"column is-8 \">\r\n                <StoreList />\r\n                </div>\r\n            <div className=\"column is-4 \">\r\n                {(state.StoreModule.show ==='create')&&<StoreCreate />}\r\n                {(state.StoreModule.show ==='detail')&&<StoreDetail  />}\r\n                {(state.StoreModule.show ==='modify')&&<StoreModify Store={selectedStore} />}\r\n               \r\n            </div>\r\n\r\n            </div>                            \r\n            </section>\r\n       \r\n    )\r\n    \r\n}\r\n\r\nexport function StoreCreate(){\r\n    const { register, handleSubmit,setValue} = useForm(); //, watch, errors, reset \r\n    const [error, setError] =useState(false)\r\n    const [success, setSuccess] =useState(false)\r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line\r\n    const [facility,setFacility] = useState()\r\n    const StoreServ=client.service('location')\r\n    //const history = useHistory()\r\n    const {user} = useContext(UserContext) //,setUser\r\n    // eslint-disable-next-line\r\n    const [currentUser,setCurrentUser] = useState()\r\n\r\n\r\n\r\n    const getSearchfacility=(obj)=>{ // buble-up from inputsearch for creating resource\r\n        \r\n        setValue(\"facility\", obj._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        })\r\n    }\r\n    \r\n    useEffect(() => {\r\n        setCurrentUser(user)\r\n        //console.log(currentUser)\r\n        return () => {\r\n        \r\n        }\r\n    }, [user])\r\n\r\n  //check user for facility or get list of facility  \r\n    useEffect(()=>{\r\n        //setFacility(user.activeStore.FacilityId)//\r\n      if (!user.stacker){\r\n          console.log(currentUser)\r\n        setValue(\"facility\", user.currentEmployee.facilityDetail._id,  {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n        }) \r\n      }\r\n    })\r\n\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        setMessage(\"\")\r\n        setError(false)\r\n        setSuccess(false)\r\n         // data.createdby=user._id\r\n          console.log(data);\r\n          if (user.currentEmployee){\r\n         data.facility=user.currentEmployee.facilityDetail._id  // or from facility dropdown\r\n          }\r\n          data.locationType=\"Store\"\r\n        StoreServ.create(data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                e.target.reset();\r\n               /*  setMessage(\"Created Store successfully\") */\r\n                setSuccess(true)\r\n                toast({\r\n                    message: 'Store created succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  setSuccess(false)\r\n            })\r\n            .catch((err)=>{\r\n                toast({\r\n                    message: 'Error creating Store ' + err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n\r\n    return (\r\n        <>\r\n            <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Create Store\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n   \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n               {/*  <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input is-small\" ref={register({ required: true })}  name=\"StoreType\" type=\"text\" placeholder=\"Type of Store\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                </div> */}\r\n                <div className=\"field\">\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })}  name=\"name\" type=\"text\" placeholder=\"Name of Store\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n            </div>\r\n           {/*  <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"profession\" type=\"text\" placeholder=\"Profession\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\" fas fa-user-md \"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"phone\" type=\"text\" placeholder=\" Phone No\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n           \r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                \r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"email\" type=\"email\" placeholder=\"Email\"  />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n           <div className=\"field\"  style={ !user.stacker?{display:\"none\"}:{}} >\r\n                <InputSearch  getSearchfacility={getSearchfacility} clear={success} /> \r\n                <p className=\"control has-icons-left \" style={{display:\"none\"}}>\r\n                    <input className=\"input is-small\" ref={register ({ required: true }) } name=\"facility\" type=\"text\" placeholder=\"Facility\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas  fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n           {/*  <div className=\"field\">\r\n                <div className=\"control has-icons-left\">\r\n                    <div className=\"dropdown \">\r\n                        <div className=\"dropdown-trigger\">\r\n                            <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                            <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital-symbol\"></i>\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"dropdown-menu\">\r\n                            <div className=\"dropdown-content\">\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa\r\n                                </div>\r\n                                <div className=\"dropdown-item is-active\">\r\n                                    simpa 2\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 3\r\n                                </div>\r\n                                <div className=\"dropdown-item\">\r\n                                    simpa 4\r\n                                </div>\r\n                            </div>\r\n                        </div>   \r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Department Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div>\r\n            <div className=\"field\">\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"password\" type=\"text\" placeholder=\"password\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n            </div> */}\r\n            <div className=\"field\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\">\r\n                        Create\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            \r\n            </form>\r\n            </div>\r\n            </div>\r\n        </>\r\n    )\r\n   \r\n}\r\n\r\nexport function StoreList({standalone,closeModal}){\r\n   // const { register, handleSubmit, watch, errors } = useForm();\r\n    // eslint-disable-next-line\r\n    const [error, setError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [message, setMessage] = useState(\"\") \r\n    const StoreServ=client.service('location')\r\n    //const history = useHistory()\r\n   // const {user,setUser} = useContext(UserContext)\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n   const [selectedStore, setSelectedStore]=useState() //\r\n    // eslint-disable-next-line\r\n    const {state,setState}=useContext(ObjectContext)\r\n    // eslint-disable-next-line\r\n    const {user,setUser}=useContext(UserContext)\r\n\r\n\r\n\r\n    const handleCreateNew = async()=>{\r\n        const    newStoreModule={\r\n            selectedStore:{},\r\n            show :'create'\r\n            }\r\n       await setState((prevstate)=>({...prevstate, StoreModule:newStoreModule}))\r\n       //console.log(state)\r\n        \r\n\r\n    }\r\n    const handleRow= async(Store)=>{\r\n        //console.log(\"b4\",state)\r\n\r\n        //console.log(\"handlerow\",Store)\r\n\r\n        await setSelectedStore(Store)\r\n\r\n        const    newStoreModule={\r\n            selectedStore:Store,\r\n            show :'detail'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, StoreModule:newStoreModule}))\r\n       //console.log(state)\r\n       //closeModal()\r\n\r\n    }\r\n\r\n   const handleSearch=(val)=>{\r\n       const field='name'\r\n       console.log(val)\r\n       StoreServ.find({query: {\r\n                [field]: {\r\n                    $regex:val,\r\n                    $options:'i'\r\n                   \r\n                },\r\n               facility:user.currentEmployee.facilityDetail._id || \"\",\r\n                locationType:\"Store\",\r\n               $limit:10,\r\n                $sort: {\r\n                    name: 1\r\n                  }\r\n                    }}).then((res)=>{\r\n                console.log(res)\r\n               setFacilities(res.data)\r\n                setMessage(\" Store  fetched successfully\")\r\n                setSuccess(true) \r\n            })\r\n            .catch((err)=>{\r\n                console.log(err)\r\n                setMessage(\"Error fetching Store, probable network issues \"+ err )\r\n                setError(true)\r\n            })\r\n        }\r\n   \r\n        const getFacilities= async()=>{\r\n            if (user.currentEmployee){\r\n            \r\n        const findStore= await StoreServ.find(\r\n                {query: {\r\n                    locationType:\"Store\",\r\n                    facility:user.currentEmployee.facilityDetail._id,\r\n                    $limit:20,\r\n                    $sort: {\r\n                        name: 1\r\n                    }\r\n                    }})\r\n\r\n         await setFacilities(findStore.data)\r\n                }\r\n                else {\r\n                    if (user.stacker){\r\n                        const findStore= await StoreServ.find(\r\n                            {query: {\r\n                                locationType:\"Store\",\r\n                                $limit:20,\r\n                                $sort: {\r\n                                    name: 1\r\n                                }\r\n                                }})\r\n            \r\n                    await setFacilities(findStore.data)\r\n\r\n                    }\r\n                }\r\n          /*   .then((res)=>{\r\n                console.log(res)\r\n                    setFacilities(res.data)\r\n                    setMessage(\" Store  fetched successfully\")\r\n                    setSuccess(true)\r\n                })\r\n                .catch((err)=>{\r\n                    setMessage(\"Error creating Store, probable network issues \"+ err )\r\n                    setError(true)\r\n                }) */\r\n            }\r\n            \r\n            useEffect(() => {\r\n                setTimeout(() => {\r\n                    console.log(\"happy birthday\")\r\n                    //getFacilities(user)\r\n                }, 200);\r\n\r\n                return () => {\r\n                    \r\n\r\n                }\r\n            },[])\r\n\r\n            useEffect(() => {\r\n               \r\n                if (user){\r\n                    getFacilities()\r\n                }else{\r\n                    /* const localUser= localStorage.getItem(\"user\")\r\n                    const user1=JSON.parse(localUser)\r\n                    console.log(localUser)\r\n                    console.log(user1)\r\n                    fetchUser(user1)\r\n                    console.log(user)\r\n                    getFacilities(user) */\r\n                }\r\n                StoreServ.on('created', (obj)=>getFacilities())\r\n                StoreServ.on('updated', (obj)=>getFacilities())\r\n                StoreServ.on('patched', (obj)=>getFacilities())\r\n                StoreServ.on('removed', (obj)=>getFacilities())\r\n                return () => {\r\n                \r\n                }\r\n            },[])\r\n\r\n\r\n    //todo: pagination and vertical scroll bar\r\n\r\n    return(\r\n        <>\r\n           {user?( <>  \r\n                <div className=\"level\">\r\n                    <div className=\"level-left\">\r\n                        <div className=\"level-item\">\r\n                            <div className=\"field\">\r\n                                <p className=\"control has-icons-left  \">\r\n                                    <DebounceInput className=\"input is-small \" \r\n                                        type=\"text\" placeholder=\"Search Stores\"\r\n                                        minLength={3}\r\n                                        debounceTimeout={400}\r\n                                        onChange={(e)=>handleSearch(e.target.value)} />\r\n                                    <span className=\"icon is-small is-left\">\r\n                                        <i className=\"fas fa-search\"></i>\r\n                                    </span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Stores </span></div>\r\n                    <div className=\"level-right\">\r\n                { !standalone &&   <div className=\"level-item\"> \r\n                            <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                        </div>}\r\n                    </div>\r\n\r\n                </div>\r\n                <div className=\"table-container pullup \">\r\n                                <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\r\n                                    <thead>\r\n                                        <tr>\r\n                                        <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                        <th>Name</th>\r\n                                        {/* <th><abbr title=\"Last Name\">Store Type</abbr></th>\r\n                                       <th><abbr title=\"Profession\">Profession</abbr></th>\r\n                                         <th><abbr title=\"Phone\">Phone</abbr></th>\r\n                                        <th><abbr title=\"Email\">Email</abbr></th>\r\n                                        <th><abbr title=\"Department\">Department</abbr></th>\r\n                                        <th><abbr title=\"Departmental Unit\">Departmental Unit</abbr></th> \r\n                                        <th><abbr title=\"Facility\">Facility</abbr></th>*/}\r\n                                       { !standalone &&  <th><abbr title=\"Actions\">Actions</abbr></th>}\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tfoot>\r\n                                        \r\n                                    </tfoot>\r\n                                    <tbody>\r\n                                        {facilities.map((Store, i)=>(\r\n\r\n                                            <tr key={Store._id} onClick={()=>handleRow(Store)} className={Store._id===(selectedStore?._id||null)?\"is-selected\":\"\"}>\r\n                                            <th>{i+1}</th>\r\n                                            <th>{Store.name}</th>\r\n                                            {/*<td>{Store.StoreType}</td>\r\n                                            < td>{Store.profession}</td>\r\n                                            <td>{Store.phone}</td>\r\n                                            <td>{Store.email}</td>\r\n                                            <td>{Store.department}</td>\r\n                                            <td>{Store.deptunit}</td> \r\n                                            <td>{Store.facility}</td>*/}\r\n                                          { !standalone &&   <td><span   className=\"showAction\"  >...</span></td>}\r\n                                           \r\n                                            </tr>\r\n\r\n                                        ))}\r\n                                    </tbody>\r\n                                    </table>\r\n                                    \r\n                </div>              \r\n            </>):<div>loading</div>}\r\n            </>\r\n              \r\n    )\r\n    }\r\n\r\n    export function StoreListStandalone({standalone,closeModal}){\r\n        // const { register, handleSubmit, watch, errors } = useForm();\r\n         // eslint-disable-next-line\r\n         const [error, setError] =useState(false)\r\n          // eslint-disable-next-line\r\n         const [success, setSuccess] =useState(false)\r\n          // eslint-disable-next-line\r\n        const [message, setMessage] = useState(\"\") \r\n         const StoreServ=client.service('location')\r\n         //const history = useHistory()\r\n        // const {user,setUser} = useContext(UserContext)\r\n         const [facilities,setFacilities]=useState([])\r\n          // eslint-disable-next-line\r\n        const [selectedStore, setSelectedStore]=useState() //\r\n         // eslint-disable-next-line\r\n         const {state,setState}=useContext(ObjectContext)\r\n         // eslint-disable-next-line\r\n         const {user,setUser}=useContext(UserContext)\r\n     \r\n     \r\n     \r\n         const handleCreateNew = async()=>{\r\n             const    newStoreModule={\r\n                 selectedStore:{},\r\n                 show :'create'\r\n                 }\r\n            await setState((prevstate)=>({...prevstate, StoreModule:newStoreModule}))\r\n            //console.log(state)\r\n             \r\n     \r\n         }\r\n         const handleRow= async(Store)=>{\r\n             //console.log(\"b4\",state)\r\n     \r\n             //console.log(\"handlerow\",Store)\r\n     \r\n             await setSelectedStore(Store)\r\n     \r\n             const    newStoreModule={\r\n                 selectedStore:Store,\r\n                 show :'detail'\r\n             }\r\n            await setState((prevstate)=>({...prevstate, StoreModule:newStoreModule}))\r\n            //console.log(state)\r\n            closeModal()\r\n     \r\n         }\r\n     \r\n        const handleSearch=(val)=>{\r\n            const field='name'\r\n            console.log(val)\r\n            StoreServ.find({query: {\r\n                     [field]: {\r\n                         $regex:val,\r\n                         $options:'i'\r\n                        \r\n                     },\r\n                    facility:user.currentEmployee.facilityDetail._id || \"\",\r\n                     locationType:\"Store\",\r\n                    $limit:10,\r\n                     $sort: {\r\n                         name: 1\r\n                       }\r\n                         }}).then((res)=>{\r\n                     console.log(res)\r\n                    setFacilities(res.data)\r\n                     setMessage(\" Store  fetched successfully\")\r\n                     setSuccess(true) \r\n                 })\r\n                 .catch((err)=>{\r\n                     console.log(err)\r\n                     setMessage(\"Error fetching Store, probable network issues \"+ err )\r\n                     setError(true)\r\n                 })\r\n             }\r\n        \r\n             const getFacilities= async()=>{\r\n                 if (user.currentEmployee){\r\n                 \r\n             const findStore= await StoreServ.find(\r\n                     {query: {\r\n                         locationType:\"Store\",\r\n                         facility:user.currentEmployee.facilityDetail._id,\r\n                         $limit:20,\r\n                         $sort: {\r\n                             name: 1\r\n                         }\r\n                         }})\r\n     \r\n              await setFacilities(findStore.data)\r\n                     }\r\n                     else {\r\n                         if (user.stacker){\r\n                             const findStore= await StoreServ.find(\r\n                                 {query: {\r\n                                     locationType:\"Store\",\r\n                                     $limit:20,\r\n                                     $sort: {\r\n                                         name: 1\r\n                                     }\r\n                                     }})\r\n                 \r\n                         await setFacilities(findStore.data)\r\n     \r\n                         }\r\n                     }\r\n               /*   .then((res)=>{\r\n                     console.log(res)\r\n                         setFacilities(res.data)\r\n                         setMessage(\" Store  fetched successfully\")\r\n                         setSuccess(true)\r\n                     })\r\n                     .catch((err)=>{\r\n                         setMessage(\"Error creating Store, probable network issues \"+ err )\r\n                         setError(true)\r\n                     }) */\r\n                 }\r\n                 \r\n                 useEffect(() => {\r\n                     setTimeout(() => {\r\n                         console.log(\"happy birthday\")\r\n                         //getFacilities(user)\r\n                     }, 200);\r\n     \r\n                     return () => {\r\n                         \r\n     \r\n                     }\r\n                 },[])\r\n     \r\n                 useEffect(() => {\r\n                    \r\n                     if (user){\r\n                         getFacilities()\r\n                     }else{\r\n                         /* const localUser= localStorage.getItem(\"user\")\r\n                         const user1=JSON.parse(localUser)\r\n                         console.log(localUser)\r\n                         console.log(user1)\r\n                         fetchUser(user1)\r\n                         console.log(user)\r\n                         getFacilities(user) */\r\n                     }\r\n                     StoreServ.on('created', (obj)=>getFacilities())\r\n                     StoreServ.on('updated', (obj)=>getFacilities())\r\n                     StoreServ.on('patched', (obj)=>getFacilities())\r\n                     StoreServ.on('removed', (obj)=>getFacilities())\r\n                     return () => {\r\n                     \r\n                     }\r\n                 },[])\r\n     \r\n     \r\n         //todo: pagination and vertical scroll bar\r\n     \r\n         return(\r\n             <>\r\n                {user?( <>  \r\n                     <div className=\"level\">\r\n                         <div className=\"level-left\">\r\n                             <div className=\"level-item\">\r\n                                 <div className=\"field\">\r\n                                     <p className=\"control has-icons-left  \">\r\n                                         <DebounceInput className=\"input is-small \" \r\n                                             type=\"text\" placeholder=\"Search Stores\"\r\n                                             minLength={3}\r\n                                             debounceTimeout={400}\r\n                                             onChange={(e)=>handleSearch(e.target.value)} />\r\n                                         <span className=\"icon is-small is-left\">\r\n                                             <i className=\"fas fa-search\"></i>\r\n                                         </span>\r\n                                     </p>\r\n                                 </div>\r\n                             </div>\r\n                         </div>\r\n                         <div className=\"level-item\"> <span className=\"is-size-6 has-text-weight-medium\">List of Stores </span></div>\r\n                         <div className=\"level-right\">\r\n                     { !standalone &&   <div className=\"level-item\"> \r\n                                 <div className=\"level-item\"><div className=\"button is-success is-small\" onClick={handleCreateNew}>New</div></div>\r\n                             </div>}\r\n                         </div>\r\n     \r\n                     </div>\r\n                     <div className=\"table-container pullup \">\r\n                                     <table className=\"table is-striped  is-hoverable is-fullwidth is-scrollable \">\r\n                                         <thead>\r\n                                             <tr>\r\n                                             <th><abbr title=\"Serial No\">S/No</abbr></th>\r\n                                             <th>Name</th>\r\n                                             {/* <th><abbr title=\"Last Name\">Store Type</abbr></th>\r\n                                            <th><abbr title=\"Profession\">Profession</abbr></th>\r\n                                              <th><abbr title=\"Phone\">Phone</abbr></th>\r\n                                             <th><abbr title=\"Email\">Email</abbr></th>\r\n                                             <th><abbr title=\"Department\">Department</abbr></th>\r\n                                             <th><abbr title=\"Departmental Unit\">Departmental Unit</abbr></th> \r\n                                             <th><abbr title=\"Facility\">Facility</abbr></th>*/}\r\n                                            { !standalone &&  <th><abbr title=\"Actions\">Actions</abbr></th>}\r\n                                             </tr>\r\n                                         </thead>\r\n                                         <tfoot>\r\n                                             \r\n                                         </tfoot>\r\n                                         <tbody>\r\n                                             {facilities.map((Store, i)=>(\r\n     \r\n                                                 <tr key={Store._id} onClick={()=>handleRow(Store)} className={Store._id===(selectedStore?._id||null)?\"is-selected\":\"\"}>\r\n                                                 <th>{i+1}</th>\r\n                                                 <th>{Store.name}</th>\r\n                                                 {/*<td>{Store.StoreType}</td>\r\n                                                 < td>{Store.profession}</td>\r\n                                                 <td>{Store.phone}</td>\r\n                                                 <td>{Store.email}</td>\r\n                                                 <td>{Store.department}</td>\r\n                                                 <td>{Store.deptunit}</td> \r\n                                                 <td>{Store.facility}</td>*/}\r\n                                               { !standalone &&   <td><span   className=\"showAction\"  >...</span></td>}\r\n                                                \r\n                                                 </tr>\r\n     \r\n                                             ))}\r\n                                         </tbody>\r\n                                         </table>\r\n                                         \r\n                     </div>              \r\n                 </>):<div>loading</div>}\r\n                 </>\r\n                   \r\n         )\r\n         }\r\nexport function StoreDetail(){\r\n    //const { register, handleSubmit, watch, setValue } = useForm(); //errors,\r\n     // eslint-disable-next-line\r\n    const [error, setError] =useState(false) //, \r\n    //const [success, setSuccess] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [message, setMessage] = useState(\"\") //,\r\n    //const StoreServ=client.service('/Store')\r\n    //const history = useHistory()\r\n    //const {user,setUser} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n   \r\n\r\n   const Store =state.StoreModule.selectedStore \r\n\r\n    const handleEdit= async()=>{\r\n        const    newStoreModule={\r\n            selectedStore:Store,\r\n            show :'modify'\r\n        }\r\n       await setState((prevstate)=>({...prevstate, StoreModule:newStoreModule}))\r\n       //console.log(state)\r\n       \r\n    }\r\n \r\n    return (\r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Store Details\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n                <table> \r\n                <tbody>         \r\n                <tr>\r\n                    <td>\r\n                \r\n                    <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                        Name: \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft\"   name=\"name\"> {Store.name} </span>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                    <td>\r\n                <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>Location Type:\r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft\"   name=\"StoreType\">{Store.locationType} </span> \r\n                    </td>\r\n                </tr>\r\n                  {/*   <tr>\r\n                    <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>Profession: \r\n                \r\n                    \r\n                    </label>\r\n                    </td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"StoreCity\">{Store.profession}</span> \r\n                </td>\r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>Phone:           \r\n                    \r\n                        </label>\r\n                        </td>\r\n                        <td>\r\n                        <span className=\"is-size-7 padleft \"  name=\"StoreContactPhone\" >{Store.phone}</span>\r\n                        </td>\r\n                  </tr>\r\n                    <tr><td>\r\n            \r\n            <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>Email:                     \r\n                    \r\n                         </label></td><td>\r\n                         <span className=\"is-size-7 padleft \"  name=\"StoreEmail\" >{Store.email}</span>\r\n                         </td>\r\n             \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i></span>Department:\r\n                    \r\n                    </label></td>\r\n                    <td>\r\n                    <span className=\"is-size-7 padleft \"  name=\"StoreOwner\">{Store.department}</span>\r\n                    </td>\r\n               \r\n                </tr>\r\n                    <tr>\r\n            <td>\r\n            <label className=\"label is-small\"> <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>Departmental Unit:              \r\n                    \r\n                </label></td>\r\n                <td>\r\n                <span className=\"is-size-7 padleft \"  name=\"StoreType\">{Store.deptunit}</span>\r\n                </td>\r\n              \r\n                </tr> */}\r\n                    \r\n          {/*   <div className=\"field\">\r\n             <label className=\"label is-small\"><span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>Category:              \r\n                    <span className=\"is-size-7 padleft \"  name= \"StoreCategory\">{Store.StoreCategory}</span>\r\n                </label>\r\n                 </div> */}\r\n\r\n            </tbody> \r\n            </table> \r\n           \r\n            <div className=\"field mt-2\">\r\n                <p className=\"control\">\r\n                    <button className=\"button is-success is-small\" onClick={handleEdit}>\r\n                        Edit\r\n                    </button>\r\n                </p>\r\n            </div>\r\n            { error && <div className=\"message\"> {message}</div>}\r\n           \r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n}\r\n\r\nexport function StoreModify(){\r\n    const { register, handleSubmit, setValue,reset, errors } = useForm(); //watch, errors,\r\n    // eslint-disable-next-line \r\n    const [error, setError] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [success, setSuccess] =useState(false)\r\n    // eslint-disable-next-line \r\n    const [message,setMessage] = useState(\"\")\r\n    // eslint-disable-next-line \r\n    const StoreServ=client.service('location')\r\n    //const history = useHistory()\r\n     // eslint-disable-next-line\r\n    const {user} = useContext(UserContext)\r\n    const {state,setState} = useContext(ObjectContext)\r\n\r\n    const Store =state.StoreModule.selectedStore \r\n\r\n        useEffect(() => {\r\n            setValue(\"name\", Store.name,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"locationType\", Store.locationType,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n           /*  setValue(\"profession\", Store.profession,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"phone\", Store.phone,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"email\", Store.email,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"department\", Store.department,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            })\r\n            setValue(\"deptunit\", Store.deptunit,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n          /*   setValue(\"StoreCategory\", Store.StoreCategory,  {\r\n                shouldValidate: true,\r\n                shouldDirty: true\r\n            }) */\r\n            \r\n            return () => {\r\n                \r\n            }\r\n        })\r\n\r\n   const handleCancel=async()=>{\r\n    const    newStoreModule={\r\n        selectedStore:{},\r\n        show :'create'\r\n      }\r\n   await setState((prevstate)=>({...prevstate, StoreModule:newStoreModule}))\r\n   //console.log(state)\r\n           }\r\n\r\n\r\n        const changeState =()=>{\r\n        const    newStoreModule={\r\n            selectedStore:{},\r\n            show :'create'\r\n        }\r\n        setState((prevstate)=>({...prevstate, StoreModule:newStoreModule}))\r\n\r\n        }\r\n    const handleDelete=async()=>{\r\n        let conf=window.confirm(\"Are you sure you want to delete this data?\")\r\n        \r\n        const dleteId=Store._id\r\n        if (conf){\r\n             \r\n        StoreServ.remove(dleteId)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                reset();\r\n               /*  setMessage(\"Deleted Store successfully\")\r\n                setSuccess(true)\r\n                changeState()\r\n               setTimeout(() => {\r\n                setSuccess(false)\r\n                }, 200); */\r\n                toast({\r\n                    message: 'Store deleted succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                changeState()\r\n            })\r\n            .catch((err)=>{\r\n               // setMessage(\"Error deleting Store, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error deleting Store, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n        }\r\n    }\r\n        \r\n\r\n   /* ()=> setValue(\"firstName\", \"Bill\", , {\r\n            shouldValidate: true,\r\n            shouldDirty: true\r\n          })) */\r\n    const onSubmit = (data,e) =>{\r\n        e.preventDefault();\r\n        \r\n        setSuccess(false)\r\n        console.log(data)\r\n        data.facility=Store.facility\r\n          //console.log(data);\r\n          \r\n        StoreServ.patch(Store._id,data)\r\n        .then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n               // e.target.reset();\r\n               // setMessage(\"updated Store successfully\")\r\n                 toast({\r\n                    message: 'Store updated succesfully',\r\n                    type: 'is-success',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n                  \r\n                changeState()\r\n\r\n            })\r\n            .catch((err)=>{\r\n                //setMessage(\"Error creating Store, probable network issues \"+ err )\r\n               // setError(true)\r\n                toast({\r\n                    message: \"Error updating Store, probable network issues or \"+ err,\r\n                    type: 'is-danger',\r\n                    dismissible: true,\r\n                    pauseOnHover: true,\r\n                  })\r\n            })\r\n\r\n      } \r\n     \r\n      \r\n    return (\r\n        \r\n        <>\r\n        <div className=\"card \">\r\n            <div className=\"card-header\">\r\n                <p className=\"card-header-title\">\r\n                    Store Details-Modify\r\n                </p>\r\n            </div>\r\n            <div className=\"card-content vscrollable\">\r\n           \r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <div className=\"field\">\r\n                    <label className=\"label is-small\"> Name\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                        <input className=\"input  is-small\" ref={register({ required: true })}  name=\"name\" type=\"text\" placeholder=\"Name\" />\r\n                        <span className=\"icon is-small is-left\">\r\n                            <i className=\"fas fa-hospital\"></i>\r\n                        </span>                    \r\n                    </p>\r\n                    </label>\r\n                    </div>\r\n                <div className=\"field\">\r\n                <label className=\"label is-small\">Location Type\r\n                    <p className=\"control has-icons-left has-icons-right\">\r\n                    <input className=\"input is-small \" ref={register({ required: true })} disabled name=\"StoreType\" type=\"text\" placeholder=\"Store Type\" />\r\n                    <span className=\"icon is-small is-left\">\r\n                        <i className=\"fas fa-map-signs\"></i>\r\n                    </span>\r\n                    \r\n                </p>\r\n                </label>\r\n                </div>\r\n            {/* <div className=\"field\">\r\n            <label className=\"label is-small\">Profession\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"profession\" type=\"text\" placeholder=\"Profession\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Phone\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"phone\" type=\"text\" placeholder=\"Phone No\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-phone-alt\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                 </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Email\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"email\" type=\"email\" placeholder=\"Store Email\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-envelope\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Department\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"department\" type=\"text\" placeholder=\"Department\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-user-md\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                {errors.department && <span>This field is required</span>}\r\n                </div>\r\n            <div className=\"field\">\r\n            <label className=\"label is-small\">Departmental Unit\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"deptunit\" type=\"text\" placeholder=\"Departmental Unit\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-hospital-symbol\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n                </div> */}\r\n           {/*  <div className=\"field\">\r\n            <label className=\"label is-small\">Category\r\n                <p className=\"control has-icons-left\">\r\n                    <input className=\"input is-small\" ref={register({ required: true })} name=\"StoreCategory\" type=\"text\" placeholder=\"Store Category\"/>\r\n                    <span className=\"icon is-small is-left\">\r\n                    <i className=\"fas fa-clinic-medical\"></i>\r\n                    </span>\r\n                </p>\r\n                </label>\r\n            </div> */}\r\n           \r\n           \r\n            </form>\r\n            \r\n            <div className=\"field  is-grouped mt-2\" >\r\n                <p className=\"control\">\r\n                    <button type=\"submit\" className=\"button is-success is-small\" onClick={handleSubmit(onSubmit)}>\r\n                        Save\r\n                    </button>\r\n                </p>\r\n                <p className=\"control\">\r\n                    <button className=\"button is-warning is-small\" onClick={handleCancel}>\r\n                        Cancel\r\n                    </button>\r\n                </p>\r\n                {/* <p className=\"control\">\r\n                    <button className=\"button is-danger is-small\" onClick={()=>handleDelete()} type=\"delete\">\r\n                       Delete\r\n                    </button>\r\n                </p> */}\r\n            </div>\r\n        </div>\r\n        </div>\r\n        </>\r\n    )\r\n   \r\n   \r\n                \r\n}   \r\n\r\nexport  function InputSearch({getSearchfacility,clear}) {\r\n    \r\n    const facilityServ=client.service('facility')\r\n    const [facilities,setFacilities]=useState([])\r\n     // eslint-disable-next-line\r\n     const [searchError, setSearchError] =useState(false)\r\n     // eslint-disable-next-line\r\n    const [showPanel, setShowPanel] =useState(false)\r\n     // eslint-disable-next-line\r\n   const [searchMessage, setSearchMessage] = useState(\"\") \r\n   // eslint-disable-next-line \r\n   const [simpa,setSimpa]=useState(\"\")\r\n   // eslint-disable-next-line \r\n   const [chosen,setChosen]=useState(false)\r\n   // eslint-disable-next-line \r\n   const [count,setCount]=useState(0)\r\n   const inputEl=useRef(null)\r\n\r\n\r\n   const handleRow= async(obj)=>{\r\n        await setChosen(true)\r\n        //alert(\"something is chaning\")\r\n       getSearchfacility(obj)\r\n       \r\n       await setSimpa(obj.facilityName)\r\n       \r\n        // setSelectedFacility(obj)\r\n        setShowPanel(false)\r\n        await setCount(2)\r\n        /* const    newfacilityModule={\r\n            selectedFacility:facility,\r\n            show :'detail'\r\n        }\r\n   await setState((prevstate)=>({...prevstate, facilityModule:newfacilityModule})) */\r\n   //console.log(state)\r\n}\r\n    const handleBlur=async(e)=>{\r\n         if (count===2){\r\n             console.log(\"stuff was chosen\")\r\n         }\r\n       \r\n       /*  console.log(\"blur\")\r\n         setShowPanel(false)\r\n        console.log(JSON.stringify(simpa))\r\n        if (simpa===\"\"){\r\n            console.log(facilities.length)\r\n            setSimpa(\"abc\")\r\n            setSimpa(\"\")\r\n            setFacilities([])\r\n            inputEl.current.setValue=\"\"\r\n        }\r\n        console.log(facilities.length)\r\n        console.log(inputEl.current) */\r\n    }\r\n    const handleSearch=async(val)=>{\r\n        \r\n        const field='facilityName' //field variable\r\n       \r\n        if (val.length>=3){\r\n            facilityServ.find({query: {     //service\r\n                 [field]: {\r\n                     $regex:val,\r\n                     $options:'i'\r\n                    \r\n                 },\r\n                 $limit:10,\r\n                 $sort: {\r\n                     createdAt: -1\r\n                   }\r\n                     }}).then((res)=>{\r\n              console.log(\"facility  fetched successfully\") \r\n                setFacilities(res.data)\r\n                 setSearchMessage(\" facility  fetched successfully\")\r\n                 setShowPanel(true)\r\n             })\r\n             .catch((err)=>{\r\n                 console.log(err)\r\n                 setSearchMessage(\"Error searching facility, probable network issues \"+ err )\r\n                 setSearchError(true)\r\n             })\r\n         }\r\n        else{\r\n            console.log(\"less than 3 \")\r\n            console.log(val)\r\n            setShowPanel(false)\r\n            await setFacilities([])\r\n            console.log(facilities)\r\n        }\r\n    }\r\n    useEffect(() => {\r\n       if (clear){\r\n           setSimpa(\"\")\r\n       }\r\n        return () => {\r\n            \r\n        }\r\n    }, [clear] )\r\n    return (\r\n        <div>\r\n            <div className=\"field\">\r\n                <div className=\"control has-icons-left  \">\r\n                    <div className={`dropdown ${showPanel?\"is-active\":\"\"}`}>\r\n                        <div className=\"dropdown-trigger\">\r\n                            <DebounceInput className=\"input is-small \" \r\n                                type=\"text\" placeholder=\"Search Facilities\"\r\n                                value={simpa}\r\n                                minLength={1}\r\n                                debounceTimeout={400}\r\n                                onBlur={(e)=>handleBlur(e)}\r\n                                onChange={(e)=>handleSearch(e.target.value)}\r\n                                inputRef={inputEl}\r\n                                  />\r\n                            <span className=\"icon is-small is-left\">\r\n                                <i className=\"fas fa-search\"></i>\r\n                            </span>\r\n                        </div>\r\n                        {searchError&&<div>{searchMessage}</div>}\r\n                        <div className=\"dropdown-menu\" >\r\n                            <div className=\"dropdown-content\">\r\n                            {facilities.map((facility, i)=>(\r\n                                    \r\n                                    <div className=\"dropdown-item\" key={facility._id} onClick={()=>handleRow(facility)} >\r\n                                        \r\n                                        <span>{facility.facilityName}</span>\r\n                                        \r\n                                    </div>\r\n                                    \r\n                                    ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n          \r\n        </div>\r\n    )\r\n}","C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\BillPrescription.js",["649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\Roaster.js",[],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\InventoryReport.js",[],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\Finance\\FinanceReport.js",[],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\EncounterMgt\\EncounterRight.js",["667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\inventory\\ClientPrescription.js",["687","688","689","690","691","692","693","694","695","696","697","698","699","700"],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\facility\\Accessibility.js",[],"C:\\Users\\simpa\\Documents\\healthstack\\frontend\\frontend\\src\\components\\ClientMgt\\PatientProfile.js",["701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726"],{"ruleId":"727","severity":1,"message":"728","line":1,"column":47,"nodeType":"729","messageId":"730","endLine":1,"endColumn":53},{"ruleId":"727","severity":1,"message":"731","line":4,"column":10,"nodeType":"729","messageId":"730","endLine":4,"endColumn":17},{"ruleId":"727","severity":1,"message":"732","line":7,"column":9,"nodeType":"729","messageId":"730","endLine":7,"endColumn":14},{"ruleId":"727","severity":1,"message":"733","line":8,"column":17,"nodeType":"729","messageId":"730","endLine":8,"endColumn":42},{"ruleId":"727","severity":1,"message":"734","line":10,"column":8,"nodeType":"729","messageId":"730","endLine":10,"endColumn":22},{"ruleId":"727","severity":1,"message":"735","line":18,"column":5,"nodeType":"729","messageId":"730","endLine":18,"endColumn":23},{"ruleId":"727","severity":1,"message":"736","line":34,"column":12,"nodeType":"729","messageId":"730","endLine":34,"endColumn":17},{"ruleId":"727","severity":1,"message":"737","line":34,"column":19,"nodeType":"729","messageId":"730","endLine":34,"endColumn":27},{"ruleId":"727","severity":1,"message":"738","line":39,"column":10,"nodeType":"729","messageId":"730","endLine":39,"endColumn":18},{"ruleId":"727","severity":1,"message":"739","line":42,"column":11,"nodeType":"729","messageId":"730","endLine":42,"endColumn":21},{"ruleId":"727","severity":1,"message":"740","line":42,"column":22,"nodeType":"729","messageId":"730","endLine":42,"endColumn":35},{"ruleId":"727","severity":1,"message":"741","line":96,"column":12,"nodeType":"729","messageId":"730","endLine":96,"endColumn":20},{"ruleId":"727","severity":1,"message":"742","line":96,"column":22,"nodeType":"729","messageId":"730","endLine":96,"endColumn":33},{"ruleId":"727","severity":1,"message":"743","line":137,"column":11,"nodeType":"729","messageId":"730","endLine":137,"endColumn":30},{"ruleId":"727","severity":1,"message":"744","line":158,"column":11,"nodeType":"729","messageId":"730","endLine":158,"endColumn":26},{"ruleId":"727","severity":1,"message":"745","line":171,"column":14,"nodeType":"729","messageId":"730","endLine":171,"endColumn":19},{"ruleId":"727","severity":1,"message":"746","line":223,"column":11,"nodeType":"729","messageId":"730","endLine":223,"endColumn":20},{"ruleId":"747","severity":1,"message":"748","line":238,"column":15,"nodeType":"749","endLine":238,"endColumn":17,"suggestions":"750"},{"ruleId":"747","severity":1,"message":"751","line":258,"column":8,"nodeType":"749","endLine":258,"endColumn":34,"suggestions":"752"},{"ruleId":"727","severity":1,"message":"753","line":359,"column":12,"nodeType":"729","messageId":"730","endLine":359,"endColumn":24},{"ruleId":"727","severity":1,"message":"754","line":370,"column":6,"nodeType":"729","messageId":"730","endLine":370,"endColumn":18},{"ruleId":"727","severity":1,"message":"755","line":390,"column":11,"nodeType":"729","messageId":"730","endLine":390,"endColumn":21},{"ruleId":"747","severity":1,"message":"756","line":412,"column":8,"nodeType":"749","endLine":412,"endColumn":10,"suggestions":"757"},{"ruleId":"747","severity":1,"message":"758","line":437,"column":7,"nodeType":"749","endLine":437,"endColumn":9,"suggestions":"759"},{"ruleId":"727","severity":1,"message":"731","line":4,"column":10,"nodeType":"729","messageId":"730","endLine":4,"endColumn":17},{"ruleId":"727","severity":1,"message":"760","line":8,"column":9,"nodeType":"729","messageId":"730","endLine":8,"endColumn":22},{"ruleId":"727","severity":1,"message":"761","line":17,"column":13,"nodeType":"729","messageId":"730","endLine":17,"endColumn":20},{"ruleId":"727","severity":1,"message":"762","line":18,"column":13,"nodeType":"729","messageId":"730","endLine":18,"endColumn":20},{"ruleId":"727","severity":1,"message":"763","line":37,"column":13,"nodeType":"729","messageId":"730","endLine":37,"endColumn":24},{"ruleId":"727","severity":1,"message":"764","line":48,"column":14,"nodeType":"729","messageId":"730","endLine":48,"endColumn":28},{"ruleId":"727","severity":1,"message":"765","line":48,"column":30,"nodeType":"729","messageId":"730","endLine":48,"endColumn":47},{"ruleId":"727","severity":1,"message":"766","line":49,"column":24,"nodeType":"729","messageId":"730","endLine":49,"endColumn":35},{"ruleId":"727","severity":1,"message":"767","line":55,"column":14,"nodeType":"729","messageId":"730","endLine":55,"endColumn":21},{"ruleId":"727","severity":1,"message":"768","line":58,"column":12,"nodeType":"729","messageId":"730","endLine":58,"endColumn":19},{"ruleId":"727","severity":1,"message":"769","line":60,"column":10,"nodeType":"729","messageId":"730","endLine":60,"endColumn":20},{"ruleId":"727","severity":1,"message":"770","line":67,"column":9,"nodeType":"729","messageId":"730","endLine":67,"endColumn":26},{"ruleId":"727","severity":1,"message":"771","line":135,"column":9,"nodeType":"729","messageId":"730","endLine":135,"endColumn":26},{"ruleId":"727","severity":1,"message":"772","line":210,"column":12,"nodeType":"729","messageId":"730","endLine":210,"endColumn":28},{"ruleId":"727","severity":1,"message":"773","line":220,"column":12,"nodeType":"729","messageId":"730","endLine":220,"endColumn":27},{"ruleId":"727","severity":1,"message":"774","line":314,"column":12,"nodeType":"729","messageId":"730","endLine":314,"endColumn":22},{"ruleId":"747","severity":1,"message":"775","line":344,"column":8,"nodeType":"749","endLine":344,"endColumn":14,"suggestions":"776"},{"ruleId":"727","severity":1,"message":"777","line":346,"column":12,"nodeType":"729","messageId":"730","endLine":346,"endColumn":21},{"ruleId":"727","severity":1,"message":"778","line":360,"column":12,"nodeType":"729","messageId":"730","endLine":360,"endColumn":32},{"ruleId":"727","severity":1,"message":"779","line":377,"column":12,"nodeType":"729","messageId":"730","endLine":377,"endColumn":20},{"ruleId":"727","severity":1,"message":"780","line":420,"column":11,"nodeType":"729","messageId":"730","endLine":420,"endColumn":29},{"ruleId":"727","severity":1,"message":"781","line":425,"column":11,"nodeType":"729","messageId":"730","endLine":425,"endColumn":20},{"ruleId":"747","severity":1,"message":"782","line":529,"column":8,"nodeType":"749","endLine":529,"endColumn":29,"suggestions":"783"},{"ruleId":"747","severity":1,"message":"784","line":551,"column":8,"nodeType":"749","endLine":551,"endColumn":21,"suggestions":"785"},{"ruleId":"747","severity":1,"message":"786","line":605,"column":9,"nodeType":"749","endLine":605,"endColumn":11,"suggestions":"787"},{"ruleId":"727","severity":1,"message":"788","line":1094,"column":12,"nodeType":"729","messageId":"730","endLine":1094,"endColumn":24},{"ruleId":"727","severity":1,"message":"789","line":1179,"column":11,"nodeType":"729","messageId":"730","endLine":1179,"endColumn":27},{"ruleId":"727","severity":1,"message":"790","line":1182,"column":11,"nodeType":"729","messageId":"730","endLine":1182,"endColumn":27},{"ruleId":"791","replacedBy":"792"},{"ruleId":"793","replacedBy":"794"},{"ruleId":"727","severity":1,"message":"795","line":6,"column":7,"nodeType":"729","messageId":"730","endLine":6,"endColumn":12},{"ruleId":"727","severity":1,"message":"796","line":8,"column":7,"nodeType":"729","messageId":"730","endLine":8,"endColumn":10},{"ruleId":"791","replacedBy":"797"},{"ruleId":"793","replacedBy":"798"},{"ruleId":"727","severity":1,"message":"799","line":2,"column":40,"nodeType":"729","messageId":"730","endLine":2,"endColumn":44},{"ruleId":"727","severity":1,"message":"800","line":14,"column":12,"nodeType":"729","messageId":"730","endLine":14,"endColumn":16},{"ruleId":"727","severity":1,"message":"801","line":14,"column":17,"nodeType":"729","messageId":"730","endLine":14,"endColumn":24},{"ruleId":"727","severity":1,"message":"802","line":88,"column":16,"nodeType":"729","messageId":"730","endLine":88,"endColumn":20},{"ruleId":"747","severity":1,"message":"803","line":113,"column":7,"nodeType":"749","endLine":113,"endColumn":9,"suggestions":"804"},{"ruleId":"727","severity":1,"message":"805","line":8,"column":37,"nodeType":"729","messageId":"730","endLine":8,"endColumn":42},{"ruleId":"727","severity":1,"message":"806","line":8,"column":44,"nodeType":"729","messageId":"730","endLine":8,"endColumn":50},{"ruleId":"727","severity":1,"message":"807","line":11,"column":11,"nodeType":"729","messageId":"730","endLine":11,"endColumn":19},{"ruleId":"727","severity":1,"message":"805","line":7,"column":37,"nodeType":"729","messageId":"730","endLine":7,"endColumn":42},{"ruleId":"727","severity":1,"message":"806","line":7,"column":44,"nodeType":"729","messageId":"730","endLine":7,"endColumn":50},{"ruleId":"791","replacedBy":"808"},{"ruleId":"793","replacedBy":"809"},{"ruleId":"727","severity":1,"message":"799","line":2,"column":40,"nodeType":"729","messageId":"730","endLine":2,"endColumn":44},{"ruleId":"727","severity":1,"message":"810","line":11,"column":17,"nodeType":"729","messageId":"730","endLine":11,"endColumn":26},{"ruleId":"727","severity":1,"message":"811","line":12,"column":9,"nodeType":"729","messageId":"730","endLine":12,"endColumn":20},{"ruleId":"727","severity":1,"message":"812","line":16,"column":18,"nodeType":"729","messageId":"730","endLine":16,"endColumn":26},{"ruleId":"747","severity":1,"message":"813","line":32,"column":12,"nodeType":"749","endLine":32,"endColumn":14,"suggestions":"814"},{"ruleId":"727","severity":1,"message":"799","line":2,"column":40,"nodeType":"729","messageId":"730","endLine":2,"endColumn":44},{"ruleId":"727","severity":1,"message":"811","line":11,"column":9,"nodeType":"729","messageId":"730","endLine":11,"endColumn":20},{"ruleId":"727","severity":1,"message":"812","line":14,"column":18,"nodeType":"729","messageId":"730","endLine":14,"endColumn":26},{"ruleId":"747","severity":1,"message":"815","line":30,"column":12,"nodeType":"749","endLine":30,"endColumn":14,"suggestions":"816"},{"ruleId":"747","severity":1,"message":"817","line":81,"column":7,"nodeType":"749","endLine":81,"endColumn":13,"suggestions":"818"},{"ruleId":"747","severity":1,"message":"819","line":389,"column":15,"nodeType":"749","endLine":389,"endColumn":17,"suggestions":"820"},{"ruleId":"727","severity":1,"message":"736","line":43,"column":12,"nodeType":"729","messageId":"730","endLine":43,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":45,"column":12,"nodeType":"729","messageId":"730","endLine":45,"endColumn":19},{"ruleId":"747","severity":1,"message":"821","line":416,"column":15,"nodeType":"749","endLine":416,"endColumn":17,"suggestions":"822"},{"ruleId":"747","severity":1,"message":"823","line":423,"column":12,"nodeType":"749","endLine":423,"endColumn":45,"suggestions":"824"},{"ruleId":"747","severity":1,"message":"823","line":544,"column":11,"nodeType":"749","endLine":544,"endColumn":22,"suggestions":"825"},{"ruleId":"727","severity":1,"message":"806","line":666,"column":53,"nodeType":"729","messageId":"730","endLine":666,"endColumn":59},{"ruleId":"747","severity":1,"message":"826","line":706,"column":11,"nodeType":"749","endLine":706,"endColumn":13,"suggestions":"827"},{"ruleId":"727","severity":1,"message":"828","line":729,"column":11,"nodeType":"729","messageId":"730","endLine":729,"endColumn":23},{"ruleId":"727","severity":1,"message":"736","line":43,"column":12,"nodeType":"729","messageId":"730","endLine":43,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":45,"column":12,"nodeType":"729","messageId":"730","endLine":45,"endColumn":19},{"ruleId":"747","severity":1,"message":"821","line":416,"column":15,"nodeType":"749","endLine":416,"endColumn":17,"suggestions":"829"},{"ruleId":"747","severity":1,"message":"823","line":423,"column":12,"nodeType":"749","endLine":423,"endColumn":45,"suggestions":"830"},{"ruleId":"747","severity":1,"message":"823","line":544,"column":11,"nodeType":"749","endLine":544,"endColumn":22,"suggestions":"831"},{"ruleId":"727","severity":1,"message":"806","line":666,"column":53,"nodeType":"729","messageId":"730","endLine":666,"endColumn":59},{"ruleId":"747","severity":1,"message":"826","line":706,"column":11,"nodeType":"749","endLine":706,"endColumn":13,"suggestions":"832"},{"ruleId":"727","severity":1,"message":"828","line":729,"column":11,"nodeType":"729","messageId":"730","endLine":729,"endColumn":23},{"ruleId":"727","severity":1,"message":"736","line":44,"column":12,"nodeType":"729","messageId":"730","endLine":44,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":46,"column":12,"nodeType":"729","messageId":"730","endLine":46,"endColumn":19},{"ruleId":"833","severity":1,"message":"834","line":537,"column":21,"nodeType":"835","messageId":"836","endLine":537,"endColumn":36},{"ruleId":"747","severity":1,"message":"837","line":555,"column":15,"nodeType":"749","endLine":555,"endColumn":17,"suggestions":"838"},{"ruleId":"747","severity":1,"message":"823","line":563,"column":16,"nodeType":"749","endLine":563,"endColumn":49,"suggestions":"839"},{"ruleId":"727","severity":1,"message":"755","line":654,"column":11,"nodeType":"729","messageId":"730","endLine":654,"endColumn":21},{"ruleId":"727","severity":1,"message":"806","line":862,"column":53,"nodeType":"729","messageId":"730","endLine":862,"endColumn":59},{"ruleId":"727","severity":1,"message":"736","line":45,"column":12,"nodeType":"729","messageId":"730","endLine":45,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":47,"column":12,"nodeType":"729","messageId":"730","endLine":47,"endColumn":19},{"ruleId":"727","severity":1,"message":"763","line":63,"column":12,"nodeType":"729","messageId":"730","endLine":63,"endColumn":23},{"ruleId":"727","severity":1,"message":"768","line":74,"column":11,"nodeType":"729","messageId":"730","endLine":74,"endColumn":18},{"ruleId":"727","severity":1,"message":"769","line":76,"column":9,"nodeType":"729","messageId":"730","endLine":76,"endColumn":19},{"ruleId":"747","severity":1,"message":"775","line":231,"column":7,"nodeType":"749","endLine":231,"endColumn":13,"suggestions":"840"},{"ruleId":"747","severity":1,"message":"841","line":338,"column":21,"nodeType":"842","endLine":338,"endColumn":42},{"ruleId":"833","severity":1,"message":"834","line":682,"column":21,"nodeType":"835","messageId":"836","endLine":682,"endColumn":36},{"ruleId":"747","severity":1,"message":"837","line":700,"column":15,"nodeType":"749","endLine":700,"endColumn":17,"suggestions":"843"},{"ruleId":"747","severity":1,"message":"823","line":708,"column":16,"nodeType":"749","endLine":708,"endColumn":49,"suggestions":"844"},{"ruleId":"727","severity":1,"message":"755","line":799,"column":11,"nodeType":"729","messageId":"730","endLine":799,"endColumn":21},{"ruleId":"727","severity":1,"message":"806","line":1007,"column":53,"nodeType":"729","messageId":"730","endLine":1007,"endColumn":59},{"ruleId":"727","severity":1,"message":"789","line":1388,"column":11,"nodeType":"729","messageId":"730","endLine":1388,"endColumn":27},{"ruleId":"727","severity":1,"message":"736","line":43,"column":12,"nodeType":"729","messageId":"730","endLine":43,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":45,"column":12,"nodeType":"729","messageId":"730","endLine":45,"endColumn":19},{"ruleId":"747","severity":1,"message":"821","line":416,"column":15,"nodeType":"749","endLine":416,"endColumn":17,"suggestions":"845"},{"ruleId":"747","severity":1,"message":"823","line":423,"column":12,"nodeType":"749","endLine":423,"endColumn":45,"suggestions":"846"},{"ruleId":"747","severity":1,"message":"823","line":546,"column":11,"nodeType":"749","endLine":546,"endColumn":22,"suggestions":"847"},{"ruleId":"727","severity":1,"message":"806","line":668,"column":53,"nodeType":"729","messageId":"730","endLine":668,"endColumn":59},{"ruleId":"747","severity":1,"message":"826","line":708,"column":11,"nodeType":"749","endLine":708,"endColumn":13,"suggestions":"848"},{"ruleId":"727","severity":1,"message":"828","line":731,"column":11,"nodeType":"729","messageId":"730","endLine":731,"endColumn":23},{"ruleId":"727","severity":1,"message":"736","line":43,"column":12,"nodeType":"729","messageId":"730","endLine":43,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":45,"column":12,"nodeType":"729","messageId":"730","endLine":45,"endColumn":19},{"ruleId":"747","severity":1,"message":"849","line":392,"column":15,"nodeType":"749","endLine":392,"endColumn":17,"suggestions":"850"},{"ruleId":"727","severity":1,"message":"806","line":623,"column":53,"nodeType":"729","messageId":"730","endLine":623,"endColumn":59},{"ruleId":"727","severity":1,"message":"828","line":696,"column":11,"nodeType":"729","messageId":"730","endLine":696,"endColumn":23},{"ruleId":"727","severity":1,"message":"728","line":1,"column":47,"nodeType":"729","messageId":"730","endLine":1,"endColumn":53},{"ruleId":"727","severity":1,"message":"851","line":3,"column":9,"nodeType":"729","messageId":"730","endLine":3,"endColumn":22},{"ruleId":"727","severity":1,"message":"731","line":4,"column":10,"nodeType":"729","messageId":"730","endLine":4,"endColumn":17},{"ruleId":"727","severity":1,"message":"732","line":7,"column":9,"nodeType":"729","messageId":"730","endLine":7,"endColumn":14},{"ruleId":"727","severity":1,"message":"733","line":8,"column":17,"nodeType":"729","messageId":"730","endLine":8,"endColumn":42},{"ruleId":"727","severity":1,"message":"734","line":10,"column":8,"nodeType":"729","messageId":"730","endLine":10,"endColumn":22},{"ruleId":"727","severity":1,"message":"743","line":57,"column":12,"nodeType":"729","messageId":"730","endLine":57,"endColumn":31},{"ruleId":"727","severity":1,"message":"744","line":76,"column":12,"nodeType":"729","messageId":"730","endLine":76,"endColumn":27},{"ruleId":"727","severity":1,"message":"852","line":88,"column":12,"nodeType":"729","messageId":"730","endLine":88,"endColumn":24},{"ruleId":"727","severity":1,"message":"745","line":89,"column":15,"nodeType":"729","messageId":"730","endLine":89,"endColumn":20},{"ruleId":"853","severity":1,"message":"854","line":102,"column":18,"nodeType":"855","messageId":"856","endLine":102,"endColumn":30},{"ruleId":"747","severity":1,"message":"857","line":158,"column":16,"nodeType":"749","endLine":158,"endColumn":18,"suggestions":"858"},{"ruleId":"727","severity":1,"message":"746","line":160,"column":16,"nodeType":"729","messageId":"730","endLine":160,"endColumn":25},{"ruleId":"727","severity":1,"message":"731","line":4,"column":10,"nodeType":"729","messageId":"730","endLine":4,"endColumn":17},{"ruleId":"727","severity":1,"message":"736","line":15,"column":13,"nodeType":"729","messageId":"730","endLine":15,"endColumn":18},{"ruleId":"727","severity":1,"message":"762","line":17,"column":13,"nodeType":"729","messageId":"730","endLine":17,"endColumn":20},{"ruleId":"727","severity":1,"message":"763","line":33,"column":13,"nodeType":"729","messageId":"730","endLine":33,"endColumn":24},{"ruleId":"727","severity":1,"message":"768","line":44,"column":12,"nodeType":"729","messageId":"730","endLine":44,"endColumn":19},{"ruleId":"727","severity":1,"message":"769","line":46,"column":10,"nodeType":"729","messageId":"730","endLine":46,"endColumn":20},{"ruleId":"747","severity":1,"message":"775","line":201,"column":8,"nodeType":"749","endLine":201,"endColumn":14,"suggestions":"859"},{"ruleId":"747","severity":1,"message":"841","line":308,"column":22,"nodeType":"842","endLine":308,"endColumn":43},{"ruleId":"727","severity":1,"message":"789","line":609,"column":11,"nodeType":"729","messageId":"730","endLine":609,"endColumn":27},{"ruleId":"727","severity":1,"message":"731","line":4,"column":10,"nodeType":"729","messageId":"730","endLine":4,"endColumn":17},{"ruleId":"727","severity":1,"message":"732","line":8,"column":9,"nodeType":"729","messageId":"730","endLine":8,"endColumn":14},{"ruleId":"727","severity":1,"message":"860","line":11,"column":25,"nodeType":"729","messageId":"730","endLine":11,"endColumn":43},{"ruleId":"727","severity":1,"message":"861","line":34,"column":18,"nodeType":"729","messageId":"730","endLine":34,"endColumn":25},{"ruleId":"727","severity":1,"message":"862","line":36,"column":11,"nodeType":"729","messageId":"730","endLine":36,"endColumn":17},{"ruleId":"727","severity":1,"message":"744","line":51,"column":11,"nodeType":"729","messageId":"730","endLine":51,"endColumn":26},{"ruleId":"727","severity":1,"message":"863","line":124,"column":19,"nodeType":"729","messageId":"730","endLine":124,"endColumn":25},{"ruleId":"747","severity":1,"message":"864","line":203,"column":15,"nodeType":"749","endLine":203,"endColumn":17,"suggestions":"865"},{"ruleId":"727","severity":1,"message":"866","line":10,"column":12,"nodeType":"729","messageId":"730","endLine":10,"endColumn":17},{"ruleId":"747","severity":1,"message":"867","line":283,"column":7,"nodeType":"749","endLine":283,"endColumn":9,"suggestions":"868"},{"ruleId":"727","severity":1,"message":"731","line":4,"column":10,"nodeType":"729","messageId":"730","endLine":4,"endColumn":17},{"ruleId":"727","severity":1,"message":"760","line":8,"column":9,"nodeType":"729","messageId":"730","endLine":8,"endColumn":22},{"ruleId":"727","severity":1,"message":"762","line":18,"column":13,"nodeType":"729","messageId":"730","endLine":18,"endColumn":20},{"ruleId":"727","severity":1,"message":"869","line":21,"column":12,"nodeType":"729","messageId":"730","endLine":21,"endColumn":28},{"ruleId":"727","severity":1,"message":"870","line":30,"column":13,"nodeType":"729","messageId":"730","endLine":30,"endColumn":20},{"ruleId":"727","severity":1,"message":"763","line":35,"column":13,"nodeType":"729","messageId":"730","endLine":35,"endColumn":24},{"ruleId":"727","severity":1,"message":"768","line":52,"column":12,"nodeType":"729","messageId":"730","endLine":52,"endColumn":19},{"ruleId":"727","severity":1,"message":"769","line":54,"column":10,"nodeType":"729","messageId":"730","endLine":54,"endColumn":20},{"ruleId":"727","severity":1,"message":"772","line":226,"column":12,"nodeType":"729","messageId":"730","endLine":226,"endColumn":28},{"ruleId":"747","severity":1,"message":"775","line":365,"column":8,"nodeType":"749","endLine":365,"endColumn":14,"suggestions":"871"},{"ruleId":"727","severity":1,"message":"777","line":367,"column":12,"nodeType":"729","messageId":"730","endLine":367,"endColumn":21},{"ruleId":"727","severity":1,"message":"781","line":487,"column":11,"nodeType":"729","messageId":"730","endLine":487,"endColumn":20},{"ruleId":"747","severity":1,"message":"872","line":584,"column":8,"nodeType":"749","endLine":584,"endColumn":20,"suggestions":"873"},{"ruleId":"747","severity":1,"message":"841","line":599,"column":21,"nodeType":"842","endLine":599,"endColumn":42},{"ruleId":"727","severity":1,"message":"788","line":868,"column":12,"nodeType":"729","messageId":"730","endLine":868,"endColumn":24},{"ruleId":"727","severity":1,"message":"789","line":953,"column":11,"nodeType":"729","messageId":"730","endLine":953,"endColumn":27},{"ruleId":"727","severity":1,"message":"790","line":956,"column":11,"nodeType":"729","messageId":"730","endLine":956,"endColumn":27},{"ruleId":"791","replacedBy":"874"},{"ruleId":"793","replacedBy":"875"},{"ruleId":"727","severity":1,"message":"728","line":1,"column":47,"nodeType":"729","messageId":"730","endLine":1,"endColumn":53},{"ruleId":"727","severity":1,"message":"731","line":4,"column":10,"nodeType":"729","messageId":"730","endLine":4,"endColumn":17},{"ruleId":"727","severity":1,"message":"732","line":7,"column":9,"nodeType":"729","messageId":"730","endLine":7,"endColumn":14},{"ruleId":"727","severity":1,"message":"733","line":8,"column":17,"nodeType":"729","messageId":"730","endLine":8,"endColumn":42},{"ruleId":"727","severity":1,"message":"734","line":10,"column":8,"nodeType":"729","messageId":"730","endLine":10,"endColumn":22},{"ruleId":"727","severity":1,"message":"735","line":18,"column":5,"nodeType":"729","messageId":"730","endLine":18,"endColumn":23},{"ruleId":"727","severity":1,"message":"736","line":35,"column":12,"nodeType":"729","messageId":"730","endLine":35,"endColumn":17},{"ruleId":"727","severity":1,"message":"737","line":35,"column":19,"nodeType":"729","messageId":"730","endLine":35,"endColumn":27},{"ruleId":"727","severity":1,"message":"738","line":40,"column":10,"nodeType":"729","messageId":"730","endLine":40,"endColumn":18},{"ruleId":"727","severity":1,"message":"739","line":43,"column":11,"nodeType":"729","messageId":"730","endLine":43,"endColumn":21},{"ruleId":"727","severity":1,"message":"740","line":43,"column":22,"nodeType":"729","messageId":"730","endLine":43,"endColumn":35},{"ruleId":"727","severity":1,"message":"741","line":97,"column":12,"nodeType":"729","messageId":"730","endLine":97,"endColumn":20},{"ruleId":"727","severity":1,"message":"742","line":97,"column":22,"nodeType":"729","messageId":"730","endLine":97,"endColumn":33},{"ruleId":"727","severity":1,"message":"743","line":138,"column":11,"nodeType":"729","messageId":"730","endLine":138,"endColumn":30},{"ruleId":"727","severity":1,"message":"744","line":159,"column":11,"nodeType":"729","messageId":"730","endLine":159,"endColumn":26},{"ruleId":"727","severity":1,"message":"745","line":172,"column":14,"nodeType":"729","messageId":"730","endLine":172,"endColumn":19},{"ruleId":"727","severity":1,"message":"746","line":229,"column":11,"nodeType":"729","messageId":"730","endLine":229,"endColumn":20},{"ruleId":"747","severity":1,"message":"876","line":245,"column":15,"nodeType":"749","endLine":245,"endColumn":17,"suggestions":"877"},{"ruleId":"747","severity":1,"message":"751","line":282,"column":8,"nodeType":"749","endLine":282,"endColumn":34,"suggestions":"878"},{"ruleId":"727","severity":1,"message":"753","line":383,"column":12,"nodeType":"729","messageId":"730","endLine":383,"endColumn":24},{"ruleId":"727","severity":1,"message":"754","line":394,"column":6,"nodeType":"729","messageId":"730","endLine":394,"endColumn":18},{"ruleId":"727","severity":1,"message":"755","line":414,"column":11,"nodeType":"729","messageId":"730","endLine":414,"endColumn":21},{"ruleId":"747","severity":1,"message":"756","line":436,"column":8,"nodeType":"749","endLine":436,"endColumn":10,"suggestions":"879"},{"ruleId":"747","severity":1,"message":"758","line":461,"column":7,"nodeType":"749","endLine":461,"endColumn":9,"suggestions":"880"},{"ruleId":"727","severity":1,"message":"736","line":45,"column":12,"nodeType":"729","messageId":"730","endLine":45,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":47,"column":12,"nodeType":"729","messageId":"730","endLine":47,"endColumn":19},{"ruleId":"727","severity":1,"message":"763","line":63,"column":12,"nodeType":"729","messageId":"730","endLine":63,"endColumn":23},{"ruleId":"727","severity":1,"message":"768","line":74,"column":11,"nodeType":"729","messageId":"730","endLine":74,"endColumn":18},{"ruleId":"727","severity":1,"message":"769","line":76,"column":9,"nodeType":"729","messageId":"730","endLine":76,"endColumn":19},{"ruleId":"747","severity":1,"message":"775","line":235,"column":7,"nodeType":"749","endLine":235,"endColumn":13,"suggestions":"881"},{"ruleId":"747","severity":1,"message":"841","line":347,"column":21,"nodeType":"842","endLine":347,"endColumn":42},{"ruleId":"833","severity":1,"message":"834","line":694,"column":21,"nodeType":"835","messageId":"836","endLine":694,"endColumn":36},{"ruleId":"747","severity":1,"message":"837","line":712,"column":15,"nodeType":"749","endLine":712,"endColumn":17,"suggestions":"882"},{"ruleId":"747","severity":1,"message":"823","line":720,"column":16,"nodeType":"749","endLine":720,"endColumn":49,"suggestions":"883"},{"ruleId":"727","severity":1,"message":"755","line":811,"column":11,"nodeType":"729","messageId":"730","endLine":811,"endColumn":21},{"ruleId":"727","severity":1,"message":"806","line":1019,"column":53,"nodeType":"729","messageId":"730","endLine":1019,"endColumn":59},{"ruleId":"727","severity":1,"message":"789","line":1400,"column":11,"nodeType":"729","messageId":"730","endLine":1400,"endColumn":27},{"ruleId":"727","severity":1,"message":"884","line":138,"column":18,"nodeType":"729","messageId":"730","endLine":138,"endColumn":23},{"ruleId":"747","severity":1,"message":"885","line":159,"column":4,"nodeType":"749","endLine":159,"endColumn":6,"suggestions":"886"},{"ruleId":"727","severity":1,"message":"887","line":2,"column":9,"nodeType":"729","messageId":"730","endLine":2,"endColumn":14},{"ruleId":"727","severity":1,"message":"888","line":2,"column":16,"nodeType":"729","messageId":"730","endLine":2,"endColumn":22},{"ruleId":"727","severity":1,"message":"799","line":2,"column":40,"nodeType":"729","messageId":"730","endLine":2,"endColumn":44},{"ruleId":"727","severity":1,"message":"889","line":2,"column":46,"nodeType":"729","messageId":"730","endLine":2,"endColumn":53},{"ruleId":"727","severity":1,"message":"736","line":42,"column":12,"nodeType":"729","messageId":"730","endLine":42,"endColumn":17},{"ruleId":"727","severity":1,"message":"761","line":43,"column":12,"nodeType":"729","messageId":"730","endLine":43,"endColumn":19},{"ruleId":"727","severity":1,"message":"762","line":44,"column":12,"nodeType":"729","messageId":"730","endLine":44,"endColumn":19},{"ruleId":"727","severity":1,"message":"771","line":55,"column":11,"nodeType":"729","messageId":"730","endLine":55,"endColumn":28},{"ruleId":"727","severity":1,"message":"745","line":511,"column":14,"nodeType":"729","messageId":"730","endLine":511,"endColumn":19},{"ruleId":"747","severity":1,"message":"890","line":635,"column":15,"nodeType":"749","endLine":635,"endColumn":17,"suggestions":"891"},{"ruleId":"727","severity":1,"message":"892","line":721,"column":11,"nodeType":"729","messageId":"730","endLine":721,"endColumn":15},{"ruleId":"727","severity":1,"message":"893","line":721,"column":17,"nodeType":"729","messageId":"730","endLine":721,"endColumn":20},{"ruleId":"727","severity":1,"message":"736","line":722,"column":12,"nodeType":"729","messageId":"730","endLine":722,"endColumn":17},{"ruleId":"727","severity":1,"message":"737","line":722,"column":19,"nodeType":"729","messageId":"730","endLine":722,"endColumn":27},{"ruleId":"727","severity":1,"message":"894","line":734,"column":11,"nodeType":"729","messageId":"730","endLine":734,"endColumn":17},{"ruleId":"727","severity":1,"message":"806","line":1066,"column":53,"nodeType":"729","messageId":"730","endLine":1066,"endColumn":59},{"ruleId":"727","severity":1,"message":"828","line":1204,"column":11,"nodeType":"729","messageId":"730","endLine":1204,"endColumn":23},{"ruleId":"727","severity":1,"message":"736","line":44,"column":12,"nodeType":"729","messageId":"730","endLine":44,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":46,"column":12,"nodeType":"729","messageId":"730","endLine":46,"endColumn":19},{"ruleId":"833","severity":1,"message":"834","line":537,"column":21,"nodeType":"835","messageId":"836","endLine":537,"endColumn":36},{"ruleId":"747","severity":1,"message":"837","line":555,"column":15,"nodeType":"749","endLine":555,"endColumn":17,"suggestions":"895"},{"ruleId":"747","severity":1,"message":"823","line":563,"column":16,"nodeType":"749","endLine":563,"endColumn":49,"suggestions":"896"},{"ruleId":"727","severity":1,"message":"755","line":654,"column":11,"nodeType":"729","messageId":"730","endLine":654,"endColumn":21},{"ruleId":"727","severity":1,"message":"806","line":862,"column":53,"nodeType":"729","messageId":"730","endLine":862,"endColumn":59},{"ruleId":"727","severity":1,"message":"897","line":1,"column":16,"nodeType":"729","messageId":"730","endLine":1,"endColumn":24},{"ruleId":"727","severity":1,"message":"898","line":1,"column":25,"nodeType":"729","messageId":"730","endLine":1,"endColumn":34},{"ruleId":"727","severity":1,"message":"899","line":2,"column":8,"nodeType":"729","messageId":"730","endLine":2,"endColumn":13},{"ruleId":"727","severity":1,"message":"810","line":2,"column":17,"nodeType":"729","messageId":"730","endLine":2,"endColumn":26},{"ruleId":"727","severity":1,"message":"811","line":3,"column":9,"nodeType":"729","messageId":"730","endLine":3,"endColumn":20},{"ruleId":"727","severity":1,"message":"900","line":8,"column":11,"nodeType":"729","messageId":"730","endLine":8,"endColumn":27},{"ruleId":"727","severity":1,"message":"728","line":1,"column":47,"nodeType":"729","messageId":"730","endLine":1,"endColumn":53},{"ruleId":"727","severity":1,"message":"731","line":4,"column":10,"nodeType":"729","messageId":"730","endLine":4,"endColumn":17},{"ruleId":"727","severity":1,"message":"732","line":7,"column":9,"nodeType":"729","messageId":"730","endLine":7,"endColumn":14},{"ruleId":"727","severity":1,"message":"733","line":8,"column":17,"nodeType":"729","messageId":"730","endLine":8,"endColumn":42},{"ruleId":"727","severity":1,"message":"736","line":33,"column":12,"nodeType":"729","messageId":"730","endLine":33,"endColumn":17},{"ruleId":"727","severity":1,"message":"737","line":33,"column":19,"nodeType":"729","messageId":"730","endLine":33,"endColumn":27},{"ruleId":"727","severity":1,"message":"901","line":38,"column":10,"nodeType":"729","messageId":"730","endLine":38,"endColumn":19},{"ruleId":"727","severity":1,"message":"739","line":41,"column":11,"nodeType":"729","messageId":"730","endLine":41,"endColumn":21},{"ruleId":"727","severity":1,"message":"740","line":41,"column":22,"nodeType":"729","messageId":"730","endLine":41,"endColumn":35},{"ruleId":"727","severity":1,"message":"744","line":136,"column":11,"nodeType":"729","messageId":"730","endLine":136,"endColumn":26},{"ruleId":"727","severity":1,"message":"745","line":149,"column":14,"nodeType":"729","messageId":"730","endLine":149,"endColumn":19},{"ruleId":"747","severity":1,"message":"857","line":225,"column":15,"nodeType":"749","endLine":225,"endColumn":17,"suggestions":"902"},{"ruleId":"727","severity":1,"message":"746","line":227,"column":15,"nodeType":"729","messageId":"730","endLine":227,"endColumn":24},{"ruleId":"727","severity":1,"message":"753","line":325,"column":12,"nodeType":"729","messageId":"730","endLine":325,"endColumn":24},{"ruleId":"727","severity":1,"message":"754","line":336,"column":6,"nodeType":"729","messageId":"730","endLine":336,"endColumn":18},{"ruleId":"727","severity":1,"message":"755","line":356,"column":11,"nodeType":"729","messageId":"730","endLine":356,"endColumn":21},{"ruleId":"747","severity":1,"message":"756","line":378,"column":8,"nodeType":"749","endLine":378,"endColumn":10,"suggestions":"903"},{"ruleId":"747","severity":1,"message":"904","line":403,"column":7,"nodeType":"749","endLine":403,"endColumn":9,"suggestions":"905"},{"ruleId":"727","severity":1,"message":"736","line":43,"column":12,"nodeType":"729","messageId":"730","endLine":43,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":45,"column":12,"nodeType":"729","messageId":"730","endLine":45,"endColumn":19},{"ruleId":"747","severity":1,"message":"906","line":317,"column":15,"nodeType":"749","endLine":317,"endColumn":17,"suggestions":"907"},{"ruleId":"727","severity":1,"message":"806","line":548,"column":53,"nodeType":"729","messageId":"730","endLine":548,"endColumn":59},{"ruleId":"727","severity":1,"message":"828","line":621,"column":11,"nodeType":"729","messageId":"730","endLine":621,"endColumn":23},{"ruleId":"727","severity":1,"message":"733","line":9,"column":17,"nodeType":"729","messageId":"730","endLine":9,"endColumn":42},{"ruleId":"727","severity":1,"message":"736","line":46,"column":12,"nodeType":"729","messageId":"730","endLine":46,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":48,"column":12,"nodeType":"729","messageId":"730","endLine":48,"endColumn":19},{"ruleId":"727","severity":1,"message":"869","line":51,"column":11,"nodeType":"729","messageId":"730","endLine":51,"endColumn":27},{"ruleId":"727","severity":1,"message":"908","line":59,"column":12,"nodeType":"729","messageId":"730","endLine":59,"endColumn":21},{"ruleId":"727","severity":1,"message":"909","line":62,"column":12,"nodeType":"729","messageId":"730","endLine":62,"endColumn":16},{"ruleId":"727","severity":1,"message":"910","line":72,"column":12,"nodeType":"729","messageId":"730","endLine":72,"endColumn":24},{"ruleId":"727","severity":1,"message":"911","line":72,"column":25,"nodeType":"729","messageId":"730","endLine":72,"endColumn":40},{"ruleId":"727","severity":1,"message":"772","line":145,"column":11,"nodeType":"729","messageId":"730","endLine":145,"endColumn":27},{"ruleId":"727","severity":1,"message":"777","line":189,"column":11,"nodeType":"729","messageId":"730","endLine":189,"endColumn":20},{"ruleId":"747","severity":1,"message":"912","line":260,"column":8,"nodeType":"749","endLine":260,"endColumn":10,"suggestions":"913"},{"ruleId":"727","severity":1,"message":"745","line":454,"column":14,"nodeType":"729","messageId":"730","endLine":454,"endColumn":19},{"ruleId":"747","severity":1,"message":"857","line":518,"column":15,"nodeType":"749","endLine":518,"endColumn":17,"suggestions":"914"},{"ruleId":"727","severity":1,"message":"755","line":608,"column":11,"nodeType":"729","messageId":"730","endLine":608,"endColumn":21},{"ruleId":"727","severity":1,"message":"806","line":816,"column":53,"nodeType":"729","messageId":"730","endLine":816,"endColumn":59},{"ruleId":"727","severity":1,"message":"788","line":1110,"column":12,"nodeType":"729","messageId":"730","endLine":1110,"endColumn":24},{"ruleId":"727","severity":1,"message":"915","line":1131,"column":11,"nodeType":"729","messageId":"730","endLine":1131,"endColumn":21},{"ruleId":"727","severity":1,"message":"789","line":1204,"column":11,"nodeType":"729","messageId":"730","endLine":1204,"endColumn":27},{"ruleId":"727","severity":1,"message":"790","line":1207,"column":11,"nodeType":"729","messageId":"730","endLine":1207,"endColumn":27},{"ruleId":"747","severity":1,"message":"916","line":1216,"column":8,"nodeType":"749","endLine":1216,"endColumn":15,"suggestions":"917"},{"ruleId":"918","severity":1,"message":"919","line":1254,"column":75,"nodeType":"920","endLine":1254,"endColumn":79},{"ruleId":"727","severity":1,"message":"736","line":45,"column":12,"nodeType":"729","messageId":"730","endLine":45,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":47,"column":12,"nodeType":"729","messageId":"730","endLine":47,"endColumn":19},{"ruleId":"727","severity":1,"message":"763","line":63,"column":12,"nodeType":"729","messageId":"730","endLine":63,"endColumn":23},{"ruleId":"727","severity":1,"message":"768","line":74,"column":11,"nodeType":"729","messageId":"730","endLine":74,"endColumn":18},{"ruleId":"727","severity":1,"message":"769","line":76,"column":9,"nodeType":"729","messageId":"730","endLine":76,"endColumn":19},{"ruleId":"747","severity":1,"message":"775","line":235,"column":7,"nodeType":"749","endLine":235,"endColumn":13,"suggestions":"921"},{"ruleId":"747","severity":1,"message":"841","line":347,"column":21,"nodeType":"842","endLine":347,"endColumn":42},{"ruleId":"747","severity":1,"message":"922","line":410,"column":8,"nodeType":"749","endLine":410,"endColumn":29,"suggestions":"923"},{"ruleId":"747","severity":1,"message":"924","line":425,"column":8,"nodeType":"749","endLine":425,"endColumn":21,"suggestions":"925"},{"ruleId":"833","severity":1,"message":"834","line":763,"column":21,"nodeType":"835","messageId":"836","endLine":763,"endColumn":36},{"ruleId":"747","severity":1,"message":"837","line":781,"column":15,"nodeType":"749","endLine":781,"endColumn":17,"suggestions":"926"},{"ruleId":"747","severity":1,"message":"823","line":789,"column":16,"nodeType":"749","endLine":789,"endColumn":49,"suggestions":"927"},{"ruleId":"727","severity":1,"message":"755","line":880,"column":11,"nodeType":"729","messageId":"730","endLine":880,"endColumn":21},{"ruleId":"727","severity":1,"message":"806","line":1088,"column":53,"nodeType":"729","messageId":"730","endLine":1088,"endColumn":59},{"ruleId":"727","severity":1,"message":"789","line":1469,"column":11,"nodeType":"729","messageId":"730","endLine":1469,"endColumn":27},{"ruleId":"727","severity":1,"message":"799","line":2,"column":40,"nodeType":"729","messageId":"730","endLine":2,"endColumn":44},{"ruleId":"747","severity":1,"message":"867","line":275,"column":7,"nodeType":"749","endLine":275,"endColumn":9,"suggestions":"928"},{"ruleId":"727","severity":1,"message":"736","line":43,"column":12,"nodeType":"729","messageId":"730","endLine":43,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":45,"column":12,"nodeType":"729","messageId":"730","endLine":45,"endColumn":19},{"ruleId":"747","severity":1,"message":"929","line":389,"column":15,"nodeType":"749","endLine":389,"endColumn":17,"suggestions":"930"},{"ruleId":"727","severity":1,"message":"806","line":620,"column":53,"nodeType":"729","messageId":"730","endLine":620,"endColumn":59},{"ruleId":"727","severity":1,"message":"736","line":43,"column":12,"nodeType":"729","messageId":"730","endLine":43,"endColumn":17},{"ruleId":"727","severity":1,"message":"761","line":44,"column":12,"nodeType":"729","messageId":"730","endLine":44,"endColumn":19},{"ruleId":"727","severity":1,"message":"762","line":45,"column":12,"nodeType":"729","messageId":"730","endLine":45,"endColumn":19},{"ruleId":"727","severity":1,"message":"771","line":56,"column":11,"nodeType":"729","messageId":"730","endLine":56,"endColumn":28},{"ruleId":"747","severity":1,"message":"931","line":392,"column":15,"nodeType":"749","endLine":392,"endColumn":17,"suggestions":"932"},{"ruleId":"727","severity":1,"message":"806","line":624,"column":53,"nodeType":"729","messageId":"730","endLine":624,"endColumn":59},{"ruleId":"727","severity":1,"message":"828","line":697,"column":11,"nodeType":"729","messageId":"730","endLine":697,"endColumn":23},{"ruleId":"727","severity":1,"message":"897","line":1,"column":16,"nodeType":"729","messageId":"730","endLine":1,"endColumn":24},{"ruleId":"727","severity":1,"message":"898","line":1,"column":25,"nodeType":"729","messageId":"730","endLine":1,"endColumn":34},{"ruleId":"727","severity":1,"message":"899","line":2,"column":8,"nodeType":"729","messageId":"730","endLine":2,"endColumn":13},{"ruleId":"727","severity":1,"message":"810","line":2,"column":17,"nodeType":"729","messageId":"730","endLine":2,"endColumn":26},{"ruleId":"727","severity":1,"message":"811","line":3,"column":9,"nodeType":"729","messageId":"730","endLine":3,"endColumn":20},{"ruleId":"727","severity":1,"message":"900","line":8,"column":11,"nodeType":"729","messageId":"730","endLine":8,"endColumn":27},{"ruleId":"727","severity":1,"message":"887","line":2,"column":9,"nodeType":"729","messageId":"730","endLine":2,"endColumn":14},{"ruleId":"727","severity":1,"message":"888","line":2,"column":16,"nodeType":"729","messageId":"730","endLine":2,"endColumn":22},{"ruleId":"727","severity":1,"message":"799","line":2,"column":40,"nodeType":"729","messageId":"730","endLine":2,"endColumn":44},{"ruleId":"727","severity":1,"message":"889","line":2,"column":46,"nodeType":"729","messageId":"730","endLine":2,"endColumn":53},{"ruleId":"727","severity":1,"message":"933","line":18,"column":12,"nodeType":"729","messageId":"730","endLine":18,"endColumn":31},{"ruleId":"727","severity":1,"message":"934","line":18,"column":32,"nodeType":"729","messageId":"730","endLine":18,"endColumn":54},{"ruleId":"727","severity":1,"message":"812","line":43,"column":18,"nodeType":"729","messageId":"730","endLine":43,"endColumn":26},{"ruleId":"727","severity":1,"message":"935","line":44,"column":36,"nodeType":"729","messageId":"730","endLine":44,"endColumn":44},{"ruleId":"727","severity":1,"message":"736","line":45,"column":12,"nodeType":"729","messageId":"730","endLine":45,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":47,"column":12,"nodeType":"729","messageId":"730","endLine":47,"endColumn":19},{"ruleId":"727","severity":1,"message":"936","line":49,"column":17,"nodeType":"729","messageId":"730","endLine":49,"endColumn":24},{"ruleId":"727","severity":1,"message":"937","line":57,"column":12,"nodeType":"729","messageId":"730","endLine":57,"endColumn":26},{"ruleId":"727","severity":1,"message":"938","line":57,"column":27,"nodeType":"729","messageId":"730","endLine":57,"endColumn":44},{"ruleId":"727","severity":1,"message":"933","line":58,"column":12,"nodeType":"729","messageId":"730","endLine":58,"endColumn":31},{"ruleId":"727","severity":1,"message":"934","line":58,"column":32,"nodeType":"729","messageId":"730","endLine":58,"endColumn":54},{"ruleId":"727","severity":1,"message":"745","line":359,"column":14,"nodeType":"729","messageId":"730","endLine":359,"endColumn":19},{"ruleId":"747","severity":1,"message":"890","line":483,"column":15,"nodeType":"749","endLine":483,"endColumn":17,"suggestions":"939"},{"ruleId":"727","severity":1,"message":"892","line":575,"column":11,"nodeType":"729","messageId":"730","endLine":575,"endColumn":15},{"ruleId":"727","severity":1,"message":"893","line":575,"column":17,"nodeType":"729","messageId":"730","endLine":575,"endColumn":20},{"ruleId":"727","severity":1,"message":"736","line":576,"column":12,"nodeType":"729","messageId":"730","endLine":576,"endColumn":17},{"ruleId":"727","severity":1,"message":"737","line":576,"column":19,"nodeType":"729","messageId":"730","endLine":576,"endColumn":27},{"ruleId":"727","severity":1,"message":"937","line":584,"column":12,"nodeType":"729","messageId":"730","endLine":584,"endColumn":26},{"ruleId":"727","severity":1,"message":"933","line":585,"column":12,"nodeType":"729","messageId":"730","endLine":585,"endColumn":31},{"ruleId":"727","severity":1,"message":"934","line":585,"column":32,"nodeType":"729","messageId":"730","endLine":585,"endColumn":54},{"ruleId":"727","severity":1,"message":"806","line":933,"column":53,"nodeType":"729","messageId":"730","endLine":933,"endColumn":59},{"ruleId":"727","severity":1,"message":"937","line":946,"column":12,"nodeType":"729","messageId":"730","endLine":946,"endColumn":26},{"ruleId":"727","severity":1,"message":"938","line":946,"column":27,"nodeType":"729","messageId":"730","endLine":946,"endColumn":44},{"ruleId":"727","severity":1,"message":"933","line":947,"column":12,"nodeType":"729","messageId":"730","endLine":947,"endColumn":31},{"ruleId":"727","severity":1,"message":"934","line":947,"column":32,"nodeType":"729","messageId":"730","endLine":947,"endColumn":54},{"ruleId":"727","severity":1,"message":"828","line":1073,"column":11,"nodeType":"729","messageId":"730","endLine":1073,"endColumn":23},{"ruleId":"727","severity":1,"message":"800","line":1485,"column":11,"nodeType":"729","messageId":"730","endLine":1485,"endColumn":15},{"ruleId":"727","severity":1,"message":"866","line":1486,"column":11,"nodeType":"729","messageId":"730","endLine":1486,"endColumn":16},{"ruleId":"727","severity":1,"message":"745","line":1531,"column":15,"nodeType":"729","messageId":"730","endLine":1531,"endColumn":20},{"ruleId":"727","severity":1,"message":"789","line":1598,"column":11,"nodeType":"729","messageId":"730","endLine":1598,"endColumn":27},{"ruleId":"727","severity":1,"message":"799","line":2,"column":40,"nodeType":"729","messageId":"730","endLine":2,"endColumn":44},{"ruleId":"727","severity":1,"message":"940","line":3,"column":8,"nodeType":"729","messageId":"730","endLine":3,"endColumn":21},{"ruleId":"727","severity":1,"message":"941","line":4,"column":8,"nodeType":"729","messageId":"730","endLine":4,"endColumn":20},{"ruleId":"727","severity":1,"message":"942","line":5,"column":8,"nodeType":"729","messageId":"730","endLine":5,"endColumn":20},{"ruleId":"727","severity":1,"message":"943","line":7,"column":8,"nodeType":"729","messageId":"730","endLine":7,"endColumn":20},{"ruleId":"727","severity":1,"message":"944","line":8,"column":8,"nodeType":"729","messageId":"730","endLine":8,"endColumn":19},{"ruleId":"727","severity":1,"message":"945","line":10,"column":8,"nodeType":"729","messageId":"730","endLine":10,"endColumn":16},{"ruleId":"727","severity":1,"message":"810","line":11,"column":17,"nodeType":"729","messageId":"730","endLine":11,"endColumn":26},{"ruleId":"727","severity":1,"message":"811","line":12,"column":9,"nodeType":"729","messageId":"730","endLine":12,"endColumn":20},{"ruleId":"727","severity":1,"message":"946","line":13,"column":8,"nodeType":"729","messageId":"730","endLine":13,"endColumn":24},{"ruleId":"727","severity":1,"message":"812","line":16,"column":18,"nodeType":"729","messageId":"730","endLine":16,"endColumn":26},{"ruleId":"747","severity":1,"message":"813","line":32,"column":12,"nodeType":"749","endLine":32,"endColumn":14,"suggestions":"947"},{"ruleId":"727","severity":1,"message":"736","line":43,"column":12,"nodeType":"729","messageId":"730","endLine":43,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":45,"column":12,"nodeType":"729","messageId":"730","endLine":45,"endColumn":19},{"ruleId":"747","severity":1,"message":"948","line":393,"column":15,"nodeType":"749","endLine":393,"endColumn":17,"suggestions":"949"},{"ruleId":"747","severity":1,"message":"948","line":624,"column":20,"nodeType":"749","endLine":624,"endColumn":22,"suggestions":"950"},{"ruleId":"727","severity":1,"message":"806","line":854,"column":53,"nodeType":"729","messageId":"730","endLine":854,"endColumn":59},{"ruleId":"727","severity":1,"message":"828","line":927,"column":11,"nodeType":"729","messageId":"730","endLine":927,"endColumn":23},{"ruleId":"727","severity":1,"message":"736","line":43,"column":12,"nodeType":"729","messageId":"730","endLine":43,"endColumn":17},{"ruleId":"727","severity":1,"message":"762","line":45,"column":12,"nodeType":"729","messageId":"730","endLine":45,"endColumn":19},{"ruleId":"747","severity":1,"message":"948","line":393,"column":15,"nodeType":"749","endLine":393,"endColumn":17,"suggestions":"951"},{"ruleId":"747","severity":1,"message":"948","line":623,"column":20,"nodeType":"749","endLine":623,"endColumn":22,"suggestions":"952"},{"ruleId":"727","severity":1,"message":"806","line":852,"column":53,"nodeType":"729","messageId":"730","endLine":852,"endColumn":59},{"ruleId":"727","severity":1,"message":"828","line":925,"column":11,"nodeType":"729","messageId":"730","endLine":925,"endColumn":23},{"ruleId":"727","severity":1,"message":"728","line":1,"column":47,"nodeType":"729","messageId":"730","endLine":1,"endColumn":53},{"ruleId":"727","severity":1,"message":"731","line":4,"column":10,"nodeType":"729","messageId":"730","endLine":4,"endColumn":17},{"ruleId":"727","severity":1,"message":"732","line":7,"column":9,"nodeType":"729","messageId":"730","endLine":7,"endColumn":14},{"ruleId":"727","severity":1,"message":"733","line":8,"column":17,"nodeType":"729","messageId":"730","endLine":8,"endColumn":42},{"ruleId":"727","severity":1,"message":"736","line":33,"column":12,"nodeType":"729","messageId":"730","endLine":33,"endColumn":17},{"ruleId":"727","severity":1,"message":"737","line":33,"column":19,"nodeType":"729","messageId":"730","endLine":33,"endColumn":27},{"ruleId":"727","severity":1,"message":"901","line":38,"column":10,"nodeType":"729","messageId":"730","endLine":38,"endColumn":19},{"ruleId":"727","severity":1,"message":"739","line":41,"column":11,"nodeType":"729","messageId":"730","endLine":41,"endColumn":21},{"ruleId":"727","severity":1,"message":"740","line":41,"column":22,"nodeType":"729","messageId":"730","endLine":41,"endColumn":35},{"ruleId":"727","severity":1,"message":"744","line":136,"column":11,"nodeType":"729","messageId":"730","endLine":136,"endColumn":26},{"ruleId":"727","severity":1,"message":"745","line":149,"column":14,"nodeType":"729","messageId":"730","endLine":149,"endColumn":19},{"ruleId":"747","severity":1,"message":"857","line":225,"column":15,"nodeType":"749","endLine":225,"endColumn":17,"suggestions":"953"},{"ruleId":"727","severity":1,"message":"746","line":227,"column":11,"nodeType":"729","messageId":"730","endLine":227,"endColumn":20},{"ruleId":"727","severity":1,"message":"753","line":326,"column":12,"nodeType":"729","messageId":"730","endLine":326,"endColumn":24},{"ruleId":"727","severity":1,"message":"754","line":337,"column":6,"nodeType":"729","messageId":"730","endLine":337,"endColumn":18},{"ruleId":"727","severity":1,"message":"755","line":357,"column":11,"nodeType":"729","messageId":"730","endLine":357,"endColumn":21},{"ruleId":"747","severity":1,"message":"756","line":379,"column":8,"nodeType":"749","endLine":379,"endColumn":10,"suggestions":"954"},{"ruleId":"747","severity":1,"message":"904","line":404,"column":7,"nodeType":"749","endLine":404,"endColumn":9,"suggestions":"955"},{"ruleId":"727","severity":1,"message":"728","line":1,"column":47,"nodeType":"729","messageId":"730","endLine":1,"endColumn":53},{"ruleId":"727","severity":1,"message":"851","line":3,"column":9,"nodeType":"729","messageId":"730","endLine":3,"endColumn":22},{"ruleId":"727","severity":1,"message":"956","line":5,"column":9,"nodeType":"729","messageId":"730","endLine":5,"endColumn":26},{"ruleId":"727","severity":1,"message":"812","line":11,"column":18,"nodeType":"729","messageId":"730","endLine":11,"endColumn":26},{"ruleId":"727","severity":1,"message":"736","line":24,"column":12,"nodeType":"729","messageId":"730","endLine":24,"endColumn":17},{"ruleId":"727","severity":1,"message":"761","line":25,"column":12,"nodeType":"729","messageId":"730","endLine":25,"endColumn":19},{"ruleId":"727","severity":1,"message":"762","line":26,"column":12,"nodeType":"729","messageId":"730","endLine":26,"endColumn":19},{"ruleId":"727","severity":1,"message":"771","line":38,"column":11,"nodeType":"729","messageId":"730","endLine":38,"endColumn":28},{"ruleId":"727","severity":1,"message":"736","line":244,"column":12,"nodeType":"729","messageId":"730","endLine":244,"endColumn":17},{"ruleId":"727","severity":1,"message":"761","line":245,"column":12,"nodeType":"729","messageId":"730","endLine":245,"endColumn":19},{"ruleId":"727","severity":1,"message":"762","line":246,"column":12,"nodeType":"729","messageId":"730","endLine":246,"endColumn":19},{"ruleId":"727","severity":1,"message":"771","line":258,"column":11,"nodeType":"729","messageId":"730","endLine":258,"endColumn":28},{"ruleId":"727","severity":1,"message":"736","line":481,"column":12,"nodeType":"729","messageId":"730","endLine":481,"endColumn":17},{"ruleId":"727","severity":1,"message":"761","line":482,"column":12,"nodeType":"729","messageId":"730","endLine":482,"endColumn":19},{"ruleId":"727","severity":1,"message":"762","line":483,"column":12,"nodeType":"729","messageId":"730","endLine":483,"endColumn":19},{"ruleId":"727","severity":1,"message":"771","line":495,"column":11,"nodeType":"729","messageId":"730","endLine":495,"endColumn":28},{"ruleId":"727","severity":1,"message":"736","line":700,"column":12,"nodeType":"729","messageId":"730","endLine":700,"endColumn":17},{"ruleId":"727","severity":1,"message":"761","line":701,"column":12,"nodeType":"729","messageId":"730","endLine":701,"endColumn":19},{"ruleId":"727","severity":1,"message":"762","line":702,"column":12,"nodeType":"729","messageId":"730","endLine":702,"endColumn":19},{"ruleId":"727","severity":1,"message":"771","line":714,"column":11,"nodeType":"729","messageId":"730","endLine":714,"endColumn":28},{"ruleId":"727","severity":1,"message":"728","line":1,"column":47,"nodeType":"729","messageId":"730","endLine":1,"endColumn":53},{"ruleId":"727","severity":1,"message":"851","line":3,"column":9,"nodeType":"729","messageId":"730","endLine":3,"endColumn":22},{"ruleId":"727","severity":1,"message":"731","line":4,"column":10,"nodeType":"729","messageId":"730","endLine":4,"endColumn":17},{"ruleId":"727","severity":1,"message":"732","line":7,"column":9,"nodeType":"729","messageId":"730","endLine":7,"endColumn":14},{"ruleId":"727","severity":1,"message":"733","line":8,"column":17,"nodeType":"729","messageId":"730","endLine":8,"endColumn":42},{"ruleId":"727","severity":1,"message":"957","line":9,"column":8,"nodeType":"729","messageId":"730","endLine":9,"endColumn":26},{"ruleId":"727","severity":1,"message":"734","line":10,"column":8,"nodeType":"729","messageId":"730","endLine":10,"endColumn":22},{"ruleId":"727","severity":1,"message":"743","line":57,"column":12,"nodeType":"729","messageId":"730","endLine":57,"endColumn":31},{"ruleId":"727","severity":1,"message":"744","line":76,"column":12,"nodeType":"729","messageId":"730","endLine":76,"endColumn":27},{"ruleId":"727","severity":1,"message":"852","line":88,"column":12,"nodeType":"729","messageId":"730","endLine":88,"endColumn":24},{"ruleId":"727","severity":1,"message":"745","line":89,"column":15,"nodeType":"729","messageId":"730","endLine":89,"endColumn":20},{"ruleId":"853","severity":1,"message":"854","line":102,"column":18,"nodeType":"855","messageId":"856","endLine":102,"endColumn":30},{"ruleId":"747","severity":1,"message":"857","line":158,"column":16,"nodeType":"749","endLine":158,"endColumn":18,"suggestions":"958"},{"ruleId":"727","severity":1,"message":"746","line":160,"column":16,"nodeType":"729","messageId":"730","endLine":160,"endColumn":25},{"ruleId":"727","severity":1,"message":"728","line":1,"column":47,"nodeType":"729","messageId":"730","endLine":1,"endColumn":53},{"ruleId":"727","severity":1,"message":"959","line":2,"column":8,"nodeType":"729","messageId":"730","endLine":2,"endColumn":14},{"ruleId":"727","severity":1,"message":"851","line":3,"column":9,"nodeType":"729","messageId":"730","endLine":3,"endColumn":22},{"ruleId":"727","severity":1,"message":"731","line":4,"column":10,"nodeType":"729","messageId":"730","endLine":4,"endColumn":17},{"ruleId":"727","severity":1,"message":"811","line":6,"column":9,"nodeType":"729","messageId":"730","endLine":6,"endColumn":20},{"ruleId":"727","severity":1,"message":"732","line":7,"column":9,"nodeType":"729","messageId":"730","endLine":7,"endColumn":14},{"ruleId":"727","severity":1,"message":"960","line":9,"column":8,"nodeType":"729","messageId":"730","endLine":9,"endColumn":23},{"ruleId":"727","severity":1,"message":"894","line":26,"column":11,"nodeType":"729","messageId":"730","endLine":26,"endColumn":17},{"ruleId":"727","severity":1,"message":"961","line":35,"column":9,"nodeType":"729","messageId":"730","endLine":35,"endColumn":14},{"ruleId":"727","severity":1,"message":"962","line":36,"column":9,"nodeType":"729","messageId":"730","endLine":36,"endColumn":14},{"ruleId":"727","severity":1,"message":"963","line":39,"column":9,"nodeType":"729","messageId":"730","endLine":39,"endColumn":17},{"ruleId":"727","severity":1,"message":"964","line":40,"column":9,"nodeType":"729","messageId":"730","endLine":40,"endColumn":20},{"ruleId":"727","severity":1,"message":"965","line":41,"column":9,"nodeType":"729","messageId":"730","endLine":41,"endColumn":18},{"ruleId":"727","severity":1,"message":"966","line":42,"column":9,"nodeType":"729","messageId":"730","endLine":42,"endColumn":25},{"ruleId":"727","severity":1,"message":"967","line":48,"column":9,"nodeType":"729","messageId":"730","endLine":48,"endColumn":12},{"ruleId":"727","severity":1,"message":"968","line":49,"column":9,"nodeType":"729","messageId":"730","endLine":49,"endColumn":16},{"ruleId":"727","severity":1,"message":"969","line":50,"column":9,"nodeType":"729","messageId":"730","endLine":50,"endColumn":13},{"ruleId":"727","severity":1,"message":"970","line":51,"column":9,"nodeType":"729","messageId":"730","endLine":51,"endColumn":12},{"ruleId":"727","severity":1,"message":"971","line":53,"column":9,"nodeType":"729","messageId":"730","endLine":53,"endColumn":16},{"ruleId":"727","severity":1,"message":"972","line":56,"column":9,"nodeType":"729","messageId":"730","endLine":56,"endColumn":20},{"ruleId":"727","severity":1,"message":"973","line":61,"column":9,"nodeType":"729","messageId":"730","endLine":61,"endColumn":20},{"ruleId":"727","severity":1,"message":"974","line":63,"column":9,"nodeType":"729","messageId":"730","endLine":63,"endColumn":22},{"ruleId":"727","severity":1,"message":"975","line":65,"column":9,"nodeType":"729","messageId":"730","endLine":65,"endColumn":23},{"ruleId":"727","severity":1,"message":"976","line":67,"column":9,"nodeType":"729","messageId":"730","endLine":67,"endColumn":19},{"ruleId":"747","severity":1,"message":"977","line":77,"column":5,"nodeType":"729","endLine":77,"endColumn":14,"suggestions":"978"},{"ruleId":"979","severity":1,"message":"980","line":93,"column":30,"nodeType":"981","endLine":93,"endColumn":114},"no-unused-vars","'useRef' is defined but never used.","Identifier","unusedVar","'useForm' is defined but never used.","'toast' is defined but never used.","'formatDistanceToNowStrict' is defined but never used.","'PatientProfile' is defined but never used.","'AccordionItemState' is defined but never used.","'error' is assigned a value but never used.","'setError' is assigned a value but never used.","'BillServ' is assigned a value but never used.","'facilities' is assigned a value but never used.","'setFacilities' is assigned a value but never used.","'expanded' is assigned a value but never used.","'setExpanded' is assigned a value but never used.","'handleMedicationRow' is assigned a value but never used.","'handleCreateNew' is assigned a value but never used.","'field' is assigned a value but never used.","'handleRow' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'BillServ' and 'getFacilities'. Either include them or remove the dependency array.","ArrayExpression",["982"],"React Hook useEffect has a missing dependency: 'selectedOrders'. Either include it or remove the dependency array.",["983"],"'currentOrder' is assigned a value but never used.","'ProductEntry' is assigned a value but never used.","'handleEdit' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'state.DispenseModule.selectedDispense' and 'state.currentClients'. Either include them or remove the dependency array.",["984"],"React Hook useEffect has missing dependencies: 'BillServ' and 'state.currentClients'. Either include them or remove the dependency array.",["985"],"'ProductCreate' is defined but never used.","'success' is assigned a value but never used.","'message' is assigned a value but never used.","'inventoryId' is assigned a value but never used.","'paymentOptions' is assigned a value but never used.","'setPaymentOptions' is assigned a value but never used.","'setBillMode' is assigned a value but never used.","'partPay' is assigned a value but never used.","'inputEl' is assigned a value but never used.","'hidestatus' is defined but never used.","'showDocumentation' is assigned a value but never used.","'getSearchfacility' is assigned a value but never used.","'handleChangeType' is assigned a value but never used.","'handleClickProd' is assigned a value but never used.","'handleQtty' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'documentNo', 'quantity', 'sellingprice', 'source', 'totalamount', and 'type'. Either include them or remove the dependency array. You can also replace multiple useState variables with useReducer if 'setProductEntry' needs the current value of 'documentNo'.",["986"],"'resetform' is assigned a value but never used.","'handleMedicationDone' is assigned a value but never used.","'onSubmit' is assigned a value but never used.","'handleChangeAmount' is assigned a value but never used.","'newclient' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'getFacilities', 'medication', 'productItem.length', and 'source'. Either include them or remove the dependency array.",["987"],"React Hook useEffect has a missing dependency: 'getTotal'. Either include it or remove the dependency array.",["988"],"React Hook useEffect has missing dependencies: 'SubwalletServ', 'getFacilities', and 'setState'. Either include them or remove the dependency array.",["989"],"'productModal' is assigned a value but never used.","'handleAddproduct' is assigned a value but never used.","'handlecloseModal' is assigned a value but never used.","no-native-reassign",["990"],"no-negated-in-lhs",["991"],"'herok' is assigned a value but never used.","'API' is assigned a value but never used.",["990"],["991"],"'Link' is defined but never used.","'user' is assigned a value but never used.","'setUser' is assigned a value but never used.","'resp' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'reAuth', 'setUser', and 'user'. Either include them or remove the dependency array.",["992"],"'watch' is assigned a value but never used.","'errors' is assigned a value but never used.","'userServ' is assigned a value but never used.",["990"],["991"],"'StoreList' is defined but never used.","'UserContext' is defined but never used.","'setState' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'handleChangeStore' and 'selectedStore'. Either include them or remove the dependency array.",["993"],"React Hook useEffect has a missing dependency: 'selectedClinic'. Either include it or remove the dependency array.",["994"],"React Hook useEffect has a missing dependency: 'setValue'. Either include it or remove the dependency array.",["995"],"React Hook useEffect has missing dependencies: 'EmployeeServ', 'getFacilities', and 'user'. Either include them or remove the dependency array.",["996"],"React Hook useEffect has missing dependencies: 'InventoryServ', 'getFacilities', and 'user'. Either include them or remove the dependency array.",["997"],"React Hook useEffect has a missing dependency: 'getFacilities'. Either include it or remove the dependency array.",["998"],["999"],"React Hook useEffect has a missing dependency: 'handleSetPrice'. Either include it or remove the dependency array.",["1000"],"'handleDelete' is assigned a value but never used.",["1001"],["1002"],["1003"],["1004"],"no-unreachable","Unreachable code.","ExpressionStatement","unreachableCode","React Hook useEffect has missing dependencies: 'ProductEntryServ', 'getFacilities', and 'state.StoreModule.selectedStore'. Either include them or remove the dependency array.",["1005"],["1006"],["1007"],"Assignments to the 'calcamount1' variable from inside React Hook useEffect will be lost after each render. To preserve the value over time, store it in a useRef Hook and keep the mutable value in the '.current' property. Otherwise, you can move this variable directly inside useEffect.","BinaryExpression",["1008"],["1009"],["1010"],["1011"],["1012"],["1013"],"React Hook useEffect has missing dependencies: 'ClinicServ', 'getFacilities', and 'user'. Either include them or remove the dependency array.",["1014"],"'DebounceInput' is defined but never used.","'handleSearch' is assigned a value but never used.","no-dupe-keys","Duplicate key 'order_status'.","ObjectExpression","unexpected","React Hook useEffect has missing dependencies: 'OrderServ' and 'getFacilities'. Either include them or remove the dependency array.",["1015"],["1016"],"'PrescriptionCreate' is defined but never used.","'setPage' is assigned a value but never used.","'loader' is assigned a value but never used.","'ulimit' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'ClinicServ', 'getFacilities', 'page', and 'user'. Either include them or remove the dependency array.",["1017"],"'state' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'facilityServ' and 'getFacilities'. Either include them or remove the dependency array.",["1018"],"'ProductEntryServ' is assigned a value but never used.","'qamount' is assigned a value but never used.",["1019"],"React Hook useEffect has missing dependencies: 'billMode' and 'source'. Either include them or remove the dependency array.",["1020"],["990"],["991"],"React Hook useEffect has missing dependencies: 'BillServ', 'cleanup', and 'getFacilities'. Either include them or remove the dependency array.",["1021"],["1022"],["1023"],["1024"],["1025"],["1026"],["1027"],"'user1' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'setUser' and 'user'. Either include them or remove the dependency array.",["1028"],"'Route' is defined but never used.","'Switch' is defined but never used.","'NavLink' is defined but never used.","React Hook useEffect has missing dependencies: 'ClientServ', 'getFacilities', and 'user'. Either include them or remove the dependency array.",["1029"],"'path' is assigned a value but never used.","'url' is assigned a value but never used.","'client' is assigned a value but never used.",["1030"],["1031"],"'useState' is defined but never used.","'useEffect' is defined but never used.","'Store' is defined but never used.","'handleCloseModal' is assigned a value but never used.","'OrderServ' is assigned a value but never used.",["1032"],["1033"],"React Hook useEffect has missing dependencies: 'OrderServ' and 'state.currentClients'. Either include them or remove the dependency array.",["1034"],"React Hook useEffect has missing dependencies: 'DocumentClassServ' and 'getFacilities'. Either include them or remove the dependency array.",["1035"],"'productId' is assigned a value but never used.","'name' is assigned a value but never used.","'productEntry' is assigned a value but never used.","'setProductEntry' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'user.currentEmployee.facilityDetail._id' and 'user.currentEmployee.facilityDetail.facilityName'. Either include them or remove the dependency array.",["1036"],["1037"],"'handleBlur' is assigned a value but never used.","React Hook useEffect has a missing dependency: 'value'. Either include it or remove the dependency array.",["1038"],"react/jsx-no-comment-textnodes","Comments inside children section of tag should be placed inside braces","Literal",["1039"],"React Hook useEffect has missing dependencies: 'getTotal', 'medication', 'productItem.length', and 'source'. Either include them or remove the dependency array.",["1040"],"React Hook useEffect has missing dependencies: 'getTotal' and 'totalamount'. Either include them or remove the dependency array.",["1041"],["1042"],["1043"],["1044"],"React Hook useEffect has missing dependencies: 'LocationServ', 'getFacilities', and 'user'. Either include them or remove the dependency array.",["1045"],"React Hook useEffect has missing dependencies: 'ProductServ', 'getFacilities', and 'user'. Either include them or remove the dependency array.",["1046"],"'selectedAppointment' is assigned a value but never used.","'setSelectedAppointment' is assigned a value but never used.","'setValue' is assigned a value but never used.","'setType' is assigned a value but never used.","'selectedClient' is assigned a value but never used.","'setSelectedClient' is assigned a value but never used.",["1047"],"'FinanceReport' is defined but never used.","'FinanceSetup' is defined but never used.","'FinanceStore' is defined but never used.","'ProductEntry' is defined but never used.","'ProductExit' is defined but never used.","'Products' is defined but never used.","'BillPrescription' is defined but never used.",["1048"],"React Hook useEffect has missing dependencies: 'StoreServ', 'getFacilities', and 'user'. Either include them or remove the dependency array.",["1049"],["1050"],["1051"],["1052"],["1053"],["1054"],["1055"],"'DocumentClassList' is defined but never used.","'BillDispenseCreate' is defined but never used.",["1056"],"'client' is defined but never used.","'VideoConference' is defined but never used.","'phone' is assigned a value but never used.","'email' is assigned a value but never used.","'nok_name' is assigned a value but never used.","'nok_phoneno' is assigned a value but never used.","'nok_email' is assigned a value but never used.","'nok_relationship' is assigned a value but never used.","'mrn' is assigned a value but never used.","'address' is assigned a value but never used.","'city' is assigned a value but never used.","'lga' is assigned a value but never used.","'country' is assigned a value but never used.","'paymentinfo' is assigned a value but never used.","'cashDetails' is assigned a value but never used.","'familyDetails' is assigned a value but never used.","'companyDetails' is assigned a value but never used.","'hmoDetails' is assigned a value but never used.","React Hook useEffect contains a call to 'setSelectedClient'. Without a list of dependencies, this can lead to an infinite chain of updates. To fix this, pass [state.ClientModule.selectedClient] as a second argument to the useEffect Hook.",["1057"],"jsx-a11y/img-redundant-alt","Redundant alt attribute. Screen-readers already announce `img` tags as an image. You dont need to use the words `image`, `photo,` or `picture` (or any specified custom words) in the alt prop.","JSXOpeningElement",{"desc":"1058","fix":"1059"},{"desc":"1060","fix":"1061"},{"desc":"1062","fix":"1063"},{"desc":"1064","fix":"1065"},{"desc":"1066","fix":"1067"},{"desc":"1068","fix":"1069"},{"desc":"1070","fix":"1071"},{"desc":"1072","fix":"1073"},"no-global-assign","no-unsafe-negation",{"desc":"1074","fix":"1075"},{"desc":"1076","fix":"1077"},{"desc":"1078","fix":"1079"},{"desc":"1080","fix":"1081"},{"desc":"1082","fix":"1083"},{"desc":"1084","fix":"1085"},{"desc":"1086","fix":"1087"},{"desc":"1088","fix":"1089"},{"desc":"1090","fix":"1091"},{"desc":"1084","fix":"1092"},{"desc":"1086","fix":"1093"},{"desc":"1088","fix":"1094"},{"desc":"1090","fix":"1095"},{"desc":"1096","fix":"1097"},{"desc":"1086","fix":"1098"},{"desc":"1066","fix":"1099"},{"desc":"1096","fix":"1100"},{"desc":"1086","fix":"1101"},{"desc":"1084","fix":"1102"},{"desc":"1086","fix":"1103"},{"desc":"1088","fix":"1104"},{"desc":"1090","fix":"1105"},{"desc":"1106","fix":"1107"},{"desc":"1108","fix":"1109"},{"desc":"1066","fix":"1110"},{"desc":"1111","fix":"1112"},{"desc":"1113","fix":"1114"},{"desc":"1066","fix":"1115"},{"desc":"1116","fix":"1117"},{"desc":"1118","fix":"1119"},{"desc":"1060","fix":"1120"},{"desc":"1062","fix":"1121"},{"desc":"1064","fix":"1122"},{"desc":"1066","fix":"1123"},{"desc":"1096","fix":"1124"},{"desc":"1086","fix":"1125"},{"desc":"1126","fix":"1127"},{"desc":"1128","fix":"1129"},{"desc":"1096","fix":"1130"},{"desc":"1086","fix":"1131"},{"desc":"1108","fix":"1132"},{"desc":"1062","fix":"1133"},{"desc":"1134","fix":"1135"},{"desc":"1136","fix":"1137"},{"desc":"1138","fix":"1139"},{"desc":"1108","fix":"1140"},{"desc":"1141","fix":"1142"},{"desc":"1066","fix":"1143"},{"desc":"1144","fix":"1145"},{"desc":"1146","fix":"1147"},{"desc":"1096","fix":"1148"},{"desc":"1086","fix":"1149"},{"desc":"1113","fix":"1150"},{"desc":"1151","fix":"1152"},{"desc":"1153","fix":"1154"},{"desc":"1128","fix":"1155"},{"desc":"1076","fix":"1156"},{"desc":"1157","fix":"1158"},{"desc":"1157","fix":"1159"},{"desc":"1157","fix":"1160"},{"desc":"1157","fix":"1161"},{"desc":"1108","fix":"1162"},{"desc":"1062","fix":"1163"},{"desc":"1134","fix":"1164"},{"desc":"1108","fix":"1165"},{"desc":"1166","fix":"1167"},"Update the dependencies array to be: [BillServ, getFacilities]",{"range":"1168","text":"1169"},"Update the dependencies array to be: [selectedOrders, state.financeModule.show]",{"range":"1170","text":"1171"},"Update the dependencies array to be: [state.DispenseModule.selectedDispense, state.currentClients]",{"range":"1172","text":"1173"},"Update the dependencies array to be: [BillServ, state.currentClients]",{"range":"1174","text":"1175"},"Update the dependencies array to be: [date, documentNo, quantity, sellingprice, source, totalamount, type]",{"range":"1176","text":"1177"},"Update the dependencies array to be: [getFacilities, medication, productItem.length, source, state.financeModule]",{"range":"1178","text":"1179"},"Update the dependencies array to be: [getTotal, productItem]",{"range":"1180","text":"1181"},"Update the dependencies array to be: [SubwalletServ, getFacilities, setState]",{"range":"1182","text":"1183"},"Update the dependencies array to be: [reAuth, setUser, user]",{"range":"1184","text":"1185"},"Update the dependencies array to be: [handleChangeStore, selectedStore]",{"range":"1186","text":"1187"},"Update the dependencies array to be: [selectedClinic]",{"range":"1188","text":"1189"},"Update the dependencies array to be: [setValue, user]",{"range":"1190","text":"1191"},"Update the dependencies array to be: [EmployeeServ, getFacilities, user]",{"range":"1192","text":"1193"},"Update the dependencies array to be: [InventoryServ, getFacilities, user]",{"range":"1194","text":"1195"},"Update the dependencies array to be: [getFacilities, state.StoreModule.selectedStore]",{"range":"1196","text":"1197"},"Update the dependencies array to be: [Inventory, getFacilities]",{"range":"1198","text":"1199"},"Update the dependencies array to be: [handleSetPrice]",{"range":"1200","text":"1201"},{"range":"1202","text":"1195"},{"range":"1203","text":"1197"},{"range":"1204","text":"1199"},{"range":"1205","text":"1201"},"Update the dependencies array to be: [ProductEntryServ, getFacilities, state.StoreModule.selectedStore]",{"range":"1206","text":"1207"},{"range":"1208","text":"1197"},{"range":"1209","text":"1177"},{"range":"1210","text":"1207"},{"range":"1211","text":"1197"},{"range":"1212","text":"1195"},{"range":"1213","text":"1197"},{"range":"1214","text":"1199"},{"range":"1215","text":"1201"},"Update the dependencies array to be: [ClinicServ, getFacilities, user]",{"range":"1216","text":"1217"},"Update the dependencies array to be: [OrderServ, getFacilities]",{"range":"1218","text":"1219"},{"range":"1220","text":"1177"},"Update the dependencies array to be: [ClinicServ, getFacilities, page, user]",{"range":"1221","text":"1222"},"Update the dependencies array to be: [facilityServ, getFacilities]",{"range":"1223","text":"1224"},{"range":"1225","text":"1177"},"Update the dependencies array to be: [billMode, medication, source]",{"range":"1226","text":"1227"},"Update the dependencies array to be: [BillServ, cleanup, getFacilities]",{"range":"1228","text":"1229"},{"range":"1230","text":"1171"},{"range":"1231","text":"1173"},{"range":"1232","text":"1175"},{"range":"1233","text":"1177"},{"range":"1234","text":"1207"},{"range":"1235","text":"1197"},"Update the dependencies array to be: [setUser, user]",{"range":"1236","text":"1237"},"Update the dependencies array to be: [ClientServ, getFacilities, user]",{"range":"1238","text":"1239"},{"range":"1240","text":"1207"},{"range":"1241","text":"1197"},{"range":"1242","text":"1219"},{"range":"1243","text":"1173"},"Update the dependencies array to be: [OrderServ, state.currentClients]",{"range":"1244","text":"1245"},"Update the dependencies array to be: [DocumentClassServ, getFacilities]",{"range":"1246","text":"1247"},"Update the dependencies array to be: [user.currentEmployee.facilityDetail._id, user.currentEmployee.facilityDetail.facilityName]",{"range":"1248","text":"1249"},{"range":"1250","text":"1219"},"Update the dependencies array to be: [simpa, value]",{"range":"1251","text":"1252"},{"range":"1253","text":"1177"},"Update the dependencies array to be: [getTotal, medication, productItem.length, source, state.financeModule]",{"range":"1254","text":"1255"},"Update the dependencies array to be: [getTotal, productItem, totalamount]",{"range":"1256","text":"1257"},{"range":"1258","text":"1207"},{"range":"1259","text":"1197"},{"range":"1260","text":"1224"},"Update the dependencies array to be: [LocationServ, getFacilities, user]",{"range":"1261","text":"1262"},"Update the dependencies array to be: [ProductServ, getFacilities, user]",{"range":"1263","text":"1264"},{"range":"1265","text":"1239"},{"range":"1266","text":"1187"},"Update the dependencies array to be: [StoreServ, getFacilities, user]",{"range":"1267","text":"1268"},{"range":"1269","text":"1268"},{"range":"1270","text":"1268"},{"range":"1271","text":"1268"},{"range":"1272","text":"1219"},{"range":"1273","text":"1173"},{"range":"1274","text":"1245"},{"range":"1275","text":"1219"},"Add dependencies array: [state.ClientModule.selectedClient]",{"range":"1276","text":"1277"},[8802,8804],"[BillServ, getFacilities]",[9216,9242],"[selectedOrders, state.financeModule.show]",[17725,17727],"[state.DispenseModule.selectedDispense, state.currentClients]",[18552,18554],"[BillServ, state.currentClients]",[11447,11453],"[date, documentNo, quantity, sellingprice, source, totalamount, type]",[17373,17394],"[getFacilities, medication, productItem.length, source, state.financeModule]",[17952,17965],"[getTotal, productItem]",[19821,19823],"[SubwalletServ, getFacilities, setState]",[3294,3296],"[reAuth, setUser, user]",[1278,1280],"[handleChangeStore, selectedStore]",[1106,1108],"[selectedClinic]",[2746,2752],"[setValue, user]",[14951,14953],"[EmployeeServ, getFacilities, user]",[16336,16338],"[InventoryServ, getFacilities, user]",[16478,16511],"[getFacilities, state.StoreModule.selectedStore]",[22406,22417],"[Inventory, getFacilities]",[28104,28106],"[handleSetPrice]",[16336,16338],[16478,16511],[22339,22350],[28037,28039],[21183,21185],"[ProductEntryServ, getFacilities, state.StoreModule.selectedStore]",[21387,21420],[7305,7311],[25911,25913],[26115,26148],[16336,16338],[16478,16511],[22351,22362],[28049,28051],[14984,14986],"[ClinicServ, getFacilities, user]",[5864,5866],"[OrderServ, getFacilities]",[6347,6353],[7642,7644],"[ClinicServ, getFacilities, page, user]",[10690,10692],"[facilityServ, getFacilities]",[12109,12115],[19059,19071],"[billMode, medication, source]",[8955,8957],"[BillServ, cleanup, getFacilities]",[9811,9837],[18326,18328],[19153,19155],[7409,7415],[26208,26210],[26412,26445],[3526,3528],"[setUser, user]",[26998,27000],"[ClientServ, getFacilities, user]",[21183,21185],[21387,21420],[8196,8198],[15611,15613],[16442,16444],"[OrderServ, state.currentClients]",[11271,11273],"[DocumentClassServ, getFacilities]",[9033,9035],"[user.currentEmployee.facilityDetail._id, user.currentEmployee.facilityDetail.facilityName]",[20188,20190],[48278,48285],"[simpa, value]",[7409,7415],[12809,12830],"[getTotal, medication, productItem.length, source, state.financeModule]",[13186,13199],"[getTotal, productItem, totalamount]",[28393,28395],[28597,28630],[10381,10383],[14869,14871],"[LocationServ, getFacilities, user]",[14978,14980],"[ProductServ, getFacilities, user]",[19050,19052],[1234,1236],[14939,14941],"[StoreServ, getFacilities, user]",[25087,25089],[14927,14929],[25064,25066],[8231,8233],[15647,15649],[16478,16480],[5864,5866],[2209,2209],", [state.ClientModule.selectedClient]"]